using System;
using System.Globalization;
using System.Drawing;
using System.Threading;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Selenium.Scripts.Pages;
using Selenium.Scripts.Reusable.Generic;
using System.IO;
using OpenQA.Selenium;
using OpenQA.Selenium.Interactions;
using OpenQA.Selenium.Internal;
using OpenQA.Selenium.Support.UI;
using Selenium.Scripts.Pages.HoldingPen;
using Selenium.Scripts.Pages.iConnect;
using Selenium.Scripts.Pages.MPAC;
using Selenium.Scripts.Pages.Putty;
using Selenium.Scripts.Pages.MergeServiceTool;
using TestStack.White.Configuration;
using TestStack.White.Factory;
using TestStack.White.UIItems;
using TestStack.White.UIItems.Finders;
using TestStack.White.UIItems.TabItems;
using TestStack.White.UIItems.TableItems;
using TestStack.White.InputDevices;
using TestStack.White.WindowsAPI;
using Application = TestStack.White.Application;
using System.Diagnostics;
using ComboBox = TestStack.White.UIItems.ListBoxItems.ComboBox;
using Window = TestStack.White.UIItems.WindowItems.Window;
using OpenQA.Selenium.Remote;

namespace Selenium.Scripts.Tests
{
    class Internationalization : BasePage
    {
        public Login login { get; set; }
        public string filepath { get; set; }
        public ExamImporter ei { get; set; }

        //public ServiceTool servicetool { get; set; }
        Studies studies = new Studies();
        ServiceTool servicetool = new ServiceTool();
        RoleManagement rolemanagement;
        DomainManagement domainmanagement;
        UserManagement usermanagement;
        Maintenance maintenance;
        ConferenceFolders conferenceFolders;
        SystemSettings systemsettings;
        Viewer viewer = new Viewer();
        StudyViewer studyviewer = new StudyViewer();
        String ICA_MappingFilePath = Config.ica_Mappingfilepath;
        Image_Sharing imagesharing;
        

        /// <summary>
        /// Constructor - Test Suite
        /// </summary>
        /// <param name="classname"></param>
        public Internationalization(String classname)
        {
            login = new Login();
            login.DriverGoTo(login.url);
            filepath = Config.TestSuitePath + Path.DirectorySeparatorChar + classname + ".xls";
            wpfobject = new WpfObjects();
            ei = new ExamImporter();
        }        

        /// <summary>
        /// Configure Language culture in iCA
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90503(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            
            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data

                //Step 1 - Precondition
                Executedsteps++;

                //Step 2 - Precondition
                Executedsteps++;

                //Step 3 - Precondition
                Executedsteps++;

                //Step 4 - Precondition               
                Executedsteps++;                

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                //login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }            
        }

        /// <summary>
        /// iCA Login Page
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90551(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String AdminContact = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AdminContact");
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String[] PageList = { "LoginPage", "DomainListPage" };

                //Step 1 - Go to http://localhost/webaccess
                login.DriverGoTo(login.url);
                if (login.UserIdTxtBox().Displayed && login.PreferredLanguageSelectList().SelectedOption.Text.Equals(Langs[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Click on the arrow sign in Preferred Language box
                int items = login.PreferredLanguageSelectList().Options.Count;
                //select element->items count
                if (items>1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select English and login as Administrator/Administrator Log out.
                login.PreferredLanguageSelectList().SelectByText(Langs[0]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                DomainManagement domain = (DomainManagement)login.Navigate("DomainManagement");
                bool UIValidate3 = ValidateLocalization(ICA_MappingFilePath, PageList[1], "English");
                bool Tab = login.IsTabPresent("Studies");
                if (Tab && UIValidate3)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 4 - Click on the arrow sign in Preferred Language box Select Japanese  
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                bool UIValidate4 = ValidateLocalization(ICA_MappingFilePath, PageList[0]);
                if (UIValidate4)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Login as Administrator/Administrator and verify the application launches in Japanese Log out.
                login.LoginIConnect(AdminUsername, AdminPassword);
                domain = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                bool UIValidate5 = ValidateLocalization(ICA_MappingFilePath, PageList[1]);
                if (UIValidate5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 6 - Select Japanese in Preferred Language box , Enter an invalid user id or password .  Click Log In
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.UserIdTxtBox().Clear();
                login.UserIdTxtBox().SendKeys("a");
                login.PasswordTxtBox().Clear();
                login.PasswordTxtBox().SendKeys(AdminPassword);
                login.LoginBtn().Click();
                PageLoadWait.WaitForFrameLoad(10);
                String ErrorMsg = login.LoginErrorMsgLabel().Text;
                String ResValueError = login.ReadDataFromResourceFile(Localization.Facade, "data", "Message_LoginFailure");
                if (ResValueError.Equals(ErrorMsg.Replace(":", "")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Goto Security Tab\Password Policy sub-tab in Service Tool, click on Modify.Enable Password Policy.Enter text in target language in Admin contact.
                //Apply changes , Restart IIS
                servicetool.LaunchServiceTool();
                servicetool.NavigateToConfigToolSecurityTab();
                servicetool.NavigateSubTab(ServiceTool.Security.Name.PasswordPolicy_tab);
                servicetool.ClickModifyFromTab();
                servicetool.SetPassWordPolicy(true);
                servicetool.UpdateAdminContact(AdminContact);
                servicetool.ClickApplyButtonFromTab();
                servicetool.AcceptDialogWindow();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;

                //Step 8 - Open the iCA login page and enter user id,Click on Forgot Password
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.UserIdTxtBox().SendKeys(AdminUsername);
                login.ForgotPwdBtn().Click();
                PageLoadWait.WaitForFrameLoad(10);
                String Msg8 = login.AdminContact().Text;
                String ResValueError8 = login.ReadDataFromResourceFile(Localization.Login, "data", "Label_AdminContactMsg");
                if (ResValueError8.Equals(Msg8) && login.ContacInfo().GetAttribute("innerHTML").Equals(AdminContact))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                //login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                //Reset Servicetool
                servicetool.LaunchServiceTool();
                servicetool.NavigateToConfigToolSecurityTab();
                servicetool.NavigateSubTab(ServiceTool.Security.Name.PasswordPolicy_tab);
                servicetool.ClickModifyFromTab();
                servicetool.SetPassWordPolicy(false);
                servicetool.UpdateAdminContact("");
                servicetool.ClickApplyButtonFromTab();
                servicetool.AcceptDialogWindow();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
            }
        }


        /// <summary>
        /// Add Additional Details to Study
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90641(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String pacusername = Config.pacsadmin;
                String pacpassword = Config.pacspassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String AdminContact = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AdminContact");
                String studypath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String pid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String mail = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "EmailID");
                String name = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String comments = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");               

                //Precondition
                BasePage.RunBatchFile(Config.batchfilepath, studypath + " " + Config.dicomsendpath + " " + Config.SanityPACS);

                //Send the study to dicom devices from MergePacs management page
                login.DriverGoTo(login.mpacstudyurl);
                MpacLogin mplogin = new MpacLogin();
                MPHomePage homepage = mplogin.Loginpacs(pacusername, pacpassword);
                Tool tools = (Tool)homepage.NavigateTopMenu("Tools");
                tools.NavigateToSendStudy();
                tools.SearchStudy("Accession", acc, 0);
                tools.MpacSelectStudy("Patient ID", pid);
                Dictionary<String, String> MpacResults = Tool.MPacGetSearchResults(Tool.MPacGetSearchResults());
                tools.SendStudy(1);
                mplogin.LogoutPacs();

                //Step:1-Enable Image Sharing in Domain and Features in Service Tool
                ExecutedSteps++;
               

                //Step:2-Open the login page of iCA and select a target language
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                String Page1 = login.ReadDataFromResourceFile(Localization.Login, "data", "Label_UserID");
                String Page2 = login.ReadDataFromResourceFile(Localization.Login, "data", "Button_Login");
                String UseridLabel = login.UserIdLbl().Text;
                String LoginBtn = login.LoginBtn().Text;               
                if (Page1.Equals(UseridLabel) && Page2.Equals(LoginBtn))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Click 'GO' in the section 'Add Additional Details to a Study'
                login.AddDetailBtn().Click();
                String MRNData1 = login.ReadDataFromResourceFile(Localization.AddAdditionalReceiver, "data", "Label_MRN");
                String DOBData2 = login.ReadDataFromResourceFile(Localization.AddAdditionalReceiver, "data", "Label_DoB");
                String MRNLabel = login.MRNFieldLbl().Text;
                String DOBLbl = login.DOBFieldLbl().Text;
                if (MRNData1.Equals(MRNLabel) && DOBData2.Equals(DOBLbl))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }            

                //Step:4-Click on Apply the Changes without filling any details
                login.ShowMeExamBtn().Click();
                String Error = login.ReadDataFromResourceFile("","data","");             
                String ValidationMsg = login.ValidationMsg().Text;                        
                if (Error.Equals(ValidationMsg))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }            

                //Step:5-Fill the required contact information and study information to match a study record
                //Click on Show me the Exam
                login.DriverGoTo(url);
                login.AddInfo(mail, pid, name.Split(',')[0].ToUpper(), MpacResults["DOB"], acc, name.Split(',')[1].ToUpper(), Config.Dest1, MpacResults["Sex"]);
                String CommentsLablVal = login.ReadDataFromResourceFile(Localization.AddAdditionalReceiverControl, "data", "Label_Comments");
                String EmailLablVal = login.ReadDataFromResourceFile(Localization.AddAdditionalReceiverControl, "data", "Menu_EmailText");
                String CommentLbl = login.CommentLbl().Text;
                String EmailLbl = login.EmailLbl().Text;
                if (CommentLbl.Equals(CommentsLablVal) && EmailLbl.Equals(EmailLablVal))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }                

                //Step:6-Select priority value and click on Apply the Changes                
                Priority().Click();           
                //Click Applychanges button
                ApplyChangesBtn().Click();
                String Error6 = login.ReadDataFromResourceFile("","data","");             
                String ValidationMsg6 = login.ValidationMsg().Text;                        
                if (Error6.Equals(ValidationMsg6))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step:7-Select priority, enter comments in target language, select receiver
                //Click on Apply the Changes
                Comment().SendKeys(comments);                
                Receiver().SendKeys(Config.ph2UserName);
                BasePage.wait.Until((d) => d.FindElement(By.CssSelector("body>ul")).GetAttribute("style").ToLower().Contains("display: block"));              
                Chooserec().Click();
                PageLoadWait.WaitForPageLoad(30);               
                ApplyChangesBtn().Click();
                //Check Detials in Completion Page
                String PriorityLbl = login.PriorLbl().Text;
                String ResValueError7_1 = login.ReadDataFromResourceFile(Localization.AddAdditionalDetailsCompletion, "data", "Label_priority");              
                String AddRecLbl = login.AdditionalRecLbl().Text;
                String ResValueError7_2 = login.ReadDataFromResourceFile(Localization.AddAdditionalDetailsCompletion, "data", "Label_additonalReceiver");
                if (ResValueError7_1.Equals(PriorityLbl) && ResValueError7_2.Equals(AddRecLbl))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);
               
                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Emergency Search
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90557(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            Maintenance maintenance;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String pacusername = Config.pacsadmin;
                String pacpassword = Config.pacspassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String studypath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String pid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String PatientName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String Genders = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Gender");
                String[] gender = Genders.Split(':');
                String DOB = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DOB");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String PACSA7 = login.GetHostName(Config.SanityPACS);
                //GridColumnNames
                String AccCol = GetStudyGridColName("Accession");
                String PIDCol = GetStudyGridColName("Patient ID");
                String ModCol = GetStudyGridColName("Modality");
                String PNameCOl = GetStudyGridColName("Patient Name");
                int eventcount_before = 0;
                int eventcount_after = 0;
                string[] locales = Config.Locale.Split('-');
                String eventtype = locales[0] + "Security Alert" + locales[1] + "/" + locales[0] + "Emergency Override" + locales[1];
                string auditcol = ReadDataFromResourceFile(Localization.System,"data","Grid_AuditEventName");

                //Step:1-Enable the Emergency Access feature from Service Tool
                //Enable the feature for the user (Administrator) from Domain and Role Management page
                //Ensure at least one data source is enabled for Administrator
                //Precondition
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("emergency", 0);
                domainmanagement.ClickSaveNewDomain();
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SearchRole(SuperRole, SuperAdminGroup);
                rolemanagement.SelectRole(SuperRole);
                rolemanagement.ClickEditRole();
                rolemanagement.SetCheckboxInEditRole("emergency", 0);
                rolemanagement.ClickSaveEditRole();
                login.Logout();
                ExecutedSteps++;


                //Step:2-Login as Administrator/Administrator in preferred(target language) who was set up to have Emergency Access
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                eventcount_before = maintenance.GetEventCount(eventtype, 1, "110113", auditcol,1);                
                ExecutedSteps++;

                //Step:3-Go to studylist and Click on the Radio button"Emergency Search"
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.Emergencybtn().Click();
                IWebElement Warningdialogbox, Warningmessage;
                studies.EmergencyWarning(out Warningdialogbox, out Warningmessage);
                //String Warningmsg = ReadDataFromResourceFile(Localization.StudySearchControl, "data", "Warning_EmergencySearch");
                String Warningdialog = ReadDataFromResourceFile(Localization.StudySearchControl, "data", "Warning_StartEmergencySearch");
                String CustomLbl = ReadDataFromResourceFile(Localization.StudySearchControl, "data", "Label_CustomSearch");
                String custom = studies.CustomSearchLbl().GetAttribute("innerHTML");

                if (Warningdialog.Replace(" ", "").Equals(Warningdialogbox.Text.Replace(" ", "")) && CustomLbl.Equals(custom))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step:4-Click Cancel and go to Audit log from Maintenance page
                studies.Cancelbtn().Click();
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                eventcount_after = maintenance.GetEventCount(eventtype, 1, "110113", auditcol, 1);               
                //maintenance.SetCheckBoxInAudit();             
                if (!(IsElementVisible(maintenance.By_EmergencyLog())) && eventcount_before == eventcount_after)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-Goto Studylist and enable Emergency Search  and accept the warning 
                //View Audit log entry
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.Emergencybtn().Click();
                studies.Acceptbtn().Click();
                PageLoadWait.WaitForFrameLoad(5);
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                //Check all the checkboxes
                maintenance.SetCheckBoxInAudit();
                //Select Security Alert in Event ID
                maintenance.SelectEventID("110113", 1);
                maintenance.Btn_Search().Click();
                PageLoadWait.WaitForFrameLoad(5);
                int eventcount_after5 = maintenance.GetEventCount(eventtype, 1, "110113", auditcol, 1);
                //***Target Language should be validated

                if (maintenance.EmergencyLog().Displayed && eventcount_before + 1 == eventcount_after5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Perform an emergency search by filling in all required patient info (Last Name, First Name, Gender, DOB).
                //Press Search button
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.Emergencybtn().Click();
                studies.Acceptbtn().Click();
                PageLoadWait.WaitForFrameLoad(5);
                studies.EmergencySearchStudy(PatientName.Split(',')[0], PatientName.Split(',')[1].Trim(), gender[0], DOB, Datasource: PACSA7);
                Dictionary<string, string> row = studies.GetMatchingRow(new string[] { AccCol, PIDCol, ModCol }, new string[] { Accession[0], PatientID, "CR" });
                if (row != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Load the study to viewer to verify the patient info
                studies.SelectStudy1(AccCol, Accession[0]);
                studies.LaunchStudy();
                String patientinfo = BasePage.Driver.FindElement(By.CssSelector("span.patientInfoDiv")).GetAttribute("innerHTML");
                String details = patientinfo.ToLower();
                String studyinfo = BasePage.Driver.FindElement(By.CssSelector("span.studyInfoDiv")).GetAttribute("innerHTML");

                if (studies.ViewStudy() == true && patientinfo.Contains(row[PNameCOl].Split(',')[0]) && patientinfo.Contains(row[PNameCOl].Split(',')[1]) && patientinfo.Contains(row[PIDCol]) && studyinfo.Contains(row[AccCol]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CloseStudy();
                studies.Acceptbtn().Click();
                PageLoadWait.WaitForFrameLoad(5);

                //Step-8:Go to Audit log again
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                maintenance.SelectEventID("110103", 1);
                maintenance.Btn_Search().Click();
                if (maintenance.DICOMAccesslog().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Exit Maintenance and go back to Studies Tab 
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                PageLoadWait.WaitForFrameLoad(20);
                //Validate the default search is in Custom search               
                if (studies.CustomSearchRadioBtn().Enabled == true)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();


                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SearchRole(SuperRole, SuperAdminGroup);
                rolemanagement.SelectRole(SuperRole);
                rolemanagement.ClickEditRole();
                rolemanagement.SetCheckboxInEditRole("emergency", 1);
                rolemanagement.ClickSaveEditRole();
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("emergency", 1);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();
            }
        }

        /// <summary>
        /// UI message for decimal input
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_91829(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            DomainManagement domain;
            RoleManagement role;
            UserPreferences UserPref = new UserPreferences();
            ServiceTool st = new ServiceTool();
            WpfObjects wpfobject = new WpfObjects();
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String Testdomain = "TestProtocolDomain_" + random.Next(1, limit);
            String Testrole = "TestRole1_" + random.Next(1, limit);
            String AdminUsername = Config.adminUserName;
            String AdminPassword = Config.adminPassword;
            String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            String EA_91 = login.GetHostName(Config.EA91);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data               
                String pacusername = Config.pacsadmin;
                String pacpassword = Config.pacspassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');                
                String UIMsgfromResc = ReadDataFromResourceFile(Localization.ViewingProtocolsControl, "data", "Label_DotNotation");
                String AutoLayout = ReadDataFromResourceFile(Localization.ViewingProtocolsControl, "data", "auto_layout");
                String ToolTip = ReadDataFromResourceFile(Localization.Tooltip, "data", "UserPreferenceTool");
                String AccCol = GetStudyGridColName("Accession");


                //Step:1-Pre-conditions:
                //1. WebAccess has at least one data source connected
                //2. Default Window Width/Level presets in Service Tools are configured, i.e., no Presets are defined               
                ExecutedSteps++;

                //Step:2-Login iCA as Administrator in preferred language
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("#ctl00_LoginMasterContentPlaceHolder_LoginButton")));
                login.LoginIConnect(AdminUsername, AdminPassword);
                ExecutedSteps++;

                //Step:3-Create a new domain, e.g., Domain1, with presets as below in Domain Management
                // From Default Settings Per Modality section, define Width/Level presets for MR modality, e.g.,- Default Layout for MR: 2x2
                //- MR DP1: Width 111.1, Level 111.5
                //- MR DP2: Width 222.2, Level 222.8
                domain = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                if (!domain.IsDomainExist(Testdomain))
                {
                    domain.CreateDomain(Testdomain, Testdomain, EA_91);
                    domain.ClickSaveNewDomain();
                }
                PageLoadWait.WaitForFrameLoad(10);
                domain.SearchDomain(Testdomain);
                domain.SelectDomain(Testdomain);
                domain.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(10);
                domain.AddPresetForDomain("MR", "DP1", "111.1", "111.5", layout: AutoLayout);
                domain.AddPresetForDomain("MR", "DP2", "222.2", "222.8", layout: AutoLayout);
                domain.SaveButton().Click();
                if (domain.SearchDomain(Testdomain))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step:4-Go to Role Management page
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                role = (RoleManagement)login.Navigate("RoleManagement", 1, "Role");
                ExecutedSteps++;

                //Step:5-Create a new non-admin role in the new domain created (e.g., Role1)
                // Uncheck Use Domain Settings in Default Settings Per Modality
                //Define Width/Level presets for CT modality, e.g.,
                //- Default Layout for CT: 2x2 
                //- CT RP1: Width 333.3, Level 333.5 
                //- CT RP2: Width 444.4, Level 444.7
                role.ClickNewRoleBtn();
                role.CreateRole(Testdomain, Testrole, GrantAccess: 0);
                role.SearchRole(Testrole);
                role.SelectRole(Testrole);
                role.ClickEditRole();
                role.SetCheckboxInEditRole("ViewingProtocol", 1);
                role.AddPresetForRole("CT", "CT RP1", "333.3", "333.5", "2x2");
                role.AddPresetForRole("CT", "CT RP2", "444.4", "444.7", "2x2");
                string UIMsginRole = DotNotationLbl();
                role.ClickSaveEditRole();
                if (UIMsginRole.Equals(UIMsgfromResc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-6:Load a study in study viewer
                //Open User Preferences from toolbar
                //Define a Width/Level Presets for any modality available in the Modality dropdown list.
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: acc, Datasource: EA_91);
                studies.SelectStudy(AccCol, acc);
                StudyViewer viewer = studies.LaunchStudy();
                PageLoadWait.WaitForFrameLoad(10);
                viewer.SelectToolInToolBar(ToolTip);
                PageLoadWait.WaitForFrameLoad(10);
                UserPref.ModifyPresetsInToolBarUserPref("CR", "2x3", "CR DP2", "1001", "101");
                string UIMsginUserPref = DotNotationLbl();
                UserPref.SaveToolBarUserPreferences();
                if (UIMsginUserPref.Equals(UIMsgfromResc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();
                login.Logout();

                //Step-7:In Service Tool,go to Viewer,subtab protocol
                st.LaunchServiceTool();
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                st.NavigateToTab("Viewer");
                st.NavigateSubTab("Protocols");
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                if (st.UIMsginProtocols().Visible)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Goto Download report
                st.NavigateSubTab("Download Report");
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                if (st.UIMsginDwldRpt().Visible)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-9:Goto Linked Scrolling tab
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                st.NavigateToTab("Linked Scrolling");
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                if (st.UIMsginLinkedScrolling().Visible)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                st.CloseConfigTool();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //close service tool
                st.CloseConfigTool();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: acc, Datasource: EA_91);
                studies.SelectStudy("Accession", acc);
                StudyViewer viewer = studies.LaunchStudy();
                PageLoadWait.WaitForFrameLoad(10);
                viewer.SelectToolInToolBar("UserPreferences");
                PageLoadWait.WaitForFrameLoad(10);
                UserPref.ModifyPresetsInToolBarUserPref("CR", "auto", "", "", "");
                viewer.CloseStudy();
                login.Logout();
            }
        }

        /// <summary>
        /// Domain Management
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90599(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String DomainName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");

                String[] Langs = Languages.Split(':');
                String[] Domain = DomainName.Split(':');

                String TestDomain = Domain[0] + "_90599_1_" + new Random().Next(1, 1000);
                String TestDomain1 = "TestDomain1_90599_" + new Random().Next(1, 1000);
                String TestDomain2 = Domain[0] + "_90599_2_" + new Random().Next(1, 1000);
                String TestDomain3 = Domain[0] + "_90599_3_" + new Random().Next(1, 1000);

                String datasource = login.GetHostName(Config.SanityPACS);

                //Step 1 - Login as Administrator in target language
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                if (ValidateLocalization(ICA_MappingFilePath, "DomainListPage"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Do not fill any of the fields, and click save.
                domainmanagement.ClickNewDomainBtn();
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.DomainInfoInputControl, "data", "Message_DomainNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Enter Domain name , click Save
                domainmanagement.DomainNameTxtBox().SendKeys(TestDomain);
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.DomainInfoInputControl, "data", "Message_DomainDescriptionRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Enter Domain description, click Save               
                domainmanagement.DomainDescriptionTxtBox().SendKeys(TestDomain + " Desc");
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.DomainInfoInputControl, "data", "Message_ReceivingInstitutionRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Enter receiving institution, click Save               
                domainmanagement.ReceivingInstTxtBox().SendKeys(TestDomain + " Receiving Inst");
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.InstitutionDataSourceInputControl, "data", "Message_OneDataSourceIsRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Connect a datasource, click Save
                domainmanagement.ConnectAllDataSources();
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_UserIDRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Enter User ID testD, click Save
                domainmanagement.UserIDTxtBox().SendKeys(TestDomain);
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_FirstNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Enter first name testD F, click Save
                domainmanagement.UserFirstNameTxtBox().SendKeys(TestDomain);
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_LastNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Enter last name testD L, click Save
                domainmanagement.UserLastNameTxtBox().SendKeys(TestDomain + " LName");
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_PasswordOrEmailRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Enter password, click Save
                domainmanagement.UserPasswordTxtBox().SendKeys(TestDomain);
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_PasswordDontMatch")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Enter confirm password click Save
                domainmanagement.UserConfirmPasswordTxtBox().SendKeys(TestDomain);
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Message_RoleNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Enter role name click Save
                domainmanagement.RoleNameTxtBox().SendKeys(TestDomain);
                domainmanagement.SaveButton().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(domainmanagement.By_DomainMgmtErrorMsg()));
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Message_RoleDescriptionRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Enter role description, click Save
                domainmanagement.RoleDescriptionTxtBox().SendKeys(TestDomain);
                domainmanagement.ClickSaveNewDomain();
                ExecutedSteps++;

                //Step 14 - Select a created Domain from the list and Click Delete Click OK
                domainmanagement.SearchDomain(TestDomain);
                domainmanagement.SelectDomain(TestDomain);
                domainmanagement.ClickDeleteDomainBtn();
                domainmanagement.SwitchToDefault();
                domainmanagement.SwitchTo("id", "UserHomeFrame");
                if (domainmanagement.AlertTextLabel().Text.Contains(login.ReadDataFromResourceFile(Localization.DomainList, "data", "AlertMessage_ConfirmDomainDeletion").Split('{')[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                domainmanagement.ConfirmDeleteDomain();
                domainmanagement.SwitchToDefault();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");

                //Step 15 - Select New Domain   
                //This step covered in step 16
                ExecutedSteps++;

                //Step 16 - Input name for new domain and domain user and fill out fields in target language if applicable
                //          Select"Save"to exit anad close domain screen.
                domainmanagement.CreateDomain(TestDomain, TestDomain, datasource);
                domainmanagement.ClickSaveDomain();
                if (domainmanagement.IsDomainExist(TestDomain))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17 - Create a domain with role filter (access role filter) defined with Patient name in target language (make sure there is a patient available in the database)                
                domainmanagement.CreateDomain(TestDomain3, TestDomain3, datasource, "MR");
                domainmanagement.ClickSaveDomain();
                if (domainmanagement.IsDomainExist(TestDomain3))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 18 - Create one more new domain in English
                domainmanagement.CreateDomain(TestDomain1, TestDomain1, datasource);
                domainmanagement.ClickSaveDomain();
                if (domainmanagement.IsDomainExist(TestDomain1))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 19 - From Domain search field, enter the newly created domains' name in target language and press Search                
                if (domainmanagement.IsDomainExist(TestDomain))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 20 - Check info by press Edit
                domainmanagement.SearchDomain(TestDomain);
                domainmanagement.SelectDomain(TestDomain);
                domainmanagement.ClickEditDomain();
                if (domainmanagement.DomainNameEditLabel().Text.Equals(TestDomain) &&
                   domainmanagement.DomainDescriptionTxtBox().GetAttribute("value").Equals(TestDomain) &&
                   (domainmanagement.ReceivingInstTxtBox().GetAttribute("value").ToString()).Equals(TestDomain + "Inst"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                domainmanagement.CloseDomainManagement();

                //Step 21 - Hover over each column header    
                domainmanagement.SwitchToDefault();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                if (ValidateLocalization(ICA_MappingFilePath, "DomainListPage"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 22 - Click Edit for created domain in target language and look for Toolbar Type drop down box. Select the drop down menu.
                domainmanagement.SearchDomain(TestDomain);
                domainmanagement.SelectDomain(TestDomain);
                domainmanagement.ClickEditDomain();
                if (ValidateLocalization(ICA_MappingFilePath, "DomainManagementPage"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 23 - Look for Study Search Fields box.
                ExecutedSteps++; //Covered in step 22

                //Step 24 - Look for Patient History Layout - Group By drop down box. Select the drop down menu.
                ExecutedSteps++; //Covered in step 22

                //Step 25 - Look for Study List Layout - Group By drop down box. Select the drop down menu.
                ExecutedSteps++; //Covered in step 22

                //Step 26 - Look for Default Role drop down box. Select the drop down menu.
                result.steps[++ExecutedSteps].status = "On Hold";
                domainmanagement.CloseDomainManagement();

                //Step 27 - Create a domain that already exists in the target language
                domainmanagement.CreateDomain(TestDomain, TestDomain, datasource, domainFlag: true);
                domainmanagement.ClickSaveDomain();
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.Facade, "data", "Message_DomainAlreadyExists").Replace("  ", " ")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                domainmanagement.CloseDomainManagement();

                //Step 28 - Create a domain admin user that already exists in the target language
                domainmanagement.CreateDomain(TestDomain2, TestDomain2, datasource, TestDomain, TestDomain, domainFlag: true);
                domainmanagement.ClickSaveDomain();
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.Facade, "data", "Error_RegistrationProcess_AlreadyExists")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                domainmanagement.CloseDomainManagement();

                //Step 29 - Create a domain admin role that already exists in the target language
                domainmanagement.CreateDomain(TestDomain2, TestDomain, datasource, TestDomain2, TestDomain2, domainFlag: true);
                domainmanagement.ClickSaveDomain();
                if (domainmanagement.DomainMgmtErrorMsg().Text.Equals(login.ReadDataFromResourceFile(Localization.Facade, "data", "Message_RoleAlreadyExits")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                domainmanagement.CloseDomainManagement();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Role Management
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90600(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String DomainName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String RoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String SuperAdmin = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DefaultDomain");
                String SuperRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DefaultRole");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");

                String[] Domain = DomainName.Split(':');
                String[] Role = RoleName.Split(':');
                String[] Accession = AccessionIDList.Split(':');
                String[] Langs = Languages.Split(':');

                String TestDomain = Domain[0] + "_90600_1_" + new Random().Next(1, 1000);
                String TestDomain1 = "Domain" + "_90600_1_" + new Random().Next(1, 1000);
                String TestRole = Role[0] + "_90600_1_" + new Random().Next(1, 1000);
                String TestRole1 = "Role" + "_90600_1_" + new Random().Next(1, 1000);

                //Step 1 - Login as Administrator in target language Go to Role Management and check the label from each area (columns, searching areas, buttons)
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement", 1, "Role");
                if (ValidateLocalization(ICA_MappingFilePath, "RoleListPage"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Select New Role
                rolemanagement.ClickNewRoleBtn();
                PageLoadWait.WaitForFrameLoad(30);
                if (ValidateLocalization(ICA_MappingFilePath, "RoleManagementPage"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                rolemanagement.CloseRoleManagement();

                //Step 3 - Input name for new role and fill out all fields in target language if applicable and save
                rolemanagement.ClickNewRoleBtn();
                rolemanagement.CreateRole(SuperAdmin, TestRole, GrantAccess: 0);
                ExecutedSteps++;

                //Step 4 - Create one more new role in English
                rolemanagement.ClickNewRoleBtn();
                rolemanagement.CreateRole(SuperAdmin, TestRole1, GrantAccess: 0);
                if (rolemanagement.RoleExists(TestRole1, SuperAdmin))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - From Role search field, enter newly created roles' name in target language and press search
                if (rolemanagement.RoleExists(TestRole, SuperAdmin))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Check info by press Edit
                rolemanagement.SearchRole(TestRole, SuperAdmin);
                rolemanagement.SelectRole(TestRole);
                rolemanagement.ClickEditRole();
                if (rolemanagement.RoleNameTxt().GetAttribute("value").Equals(TestRole) &&
                    rolemanagement.RoleDescriptionTxt().GetAttribute("value").Equals(TestRole + " Description"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                rolemanagement.CloseRoleManagement();

                //Step 7 - Hover over each column header
                PageLoadWait.WaitForFrameLoad(30);
                if (ValidateLocalization(ICA_MappingFilePath, "RoleListPage"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Click Edit for created Role in target language and look for Toolbar Type drop down box. Select the drop down menu.
                rolemanagement.SearchRole(TestRole);
                rolemanagement.SelectRole(TestRole);
                rolemanagement.ClickEditRole();
                if (ValidateLocalization(ICA_MappingFilePath, "ToolbarType"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Look for Study Search Fields box.
                PageLoadWait.WaitForFrameLoad(20);
                if (ValidateLocalization(ICA_MappingFilePath, "StudySearch"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Look for Patient History Layout - Group By drop down box. Select the drop down menu.
                rolemanagement.UnCheckCheckbox(rolemanagement.PatientHistoryLayoutUseDomainSetting_CB());
                PageLoadWait.WaitForPageLoad(60);
                if (ValidateLocalization(ICA_MappingFilePath, "PatientHistoryLayout"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Look for Study List Layout - Group By drop down box. Select the drop down menu.
                PageLoadWait.WaitForPageLoad(60);
                rolemanagement.UnCheckCheckbox(rolemanagement.StudyListlayoutUseDomainSetting_CB());
                PageLoadWait.WaitForPageLoad(60);
                if (ValidateLocalization(ICA_MappingFilePath, "StudyListLayout"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Look for Default Role drop down box. Select the drop down menu.           
                result.steps[++ExecutedSteps].status = "Hold";

                //Step 13 - Select Access Filter drop down, and select Patient Name.
                if (ValidateLocalization(ICA_MappingFilePath, "AccessFilter"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 14 - Enter text manually, and select Add
                rolemanagement.AccessFiltersInformation().SelectByValue("Accession Number");
                rolemanagement.RoleAccessFiltersTextBox().SendKeys(Accession[0]);
                rolemanagement.AddAccessFilters().Click();
                string accession_number_in_locale = login.ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Filter_AccessionNumber") + " = ";
                if (rolemanagement.SelectedFilterCriteria().Options.Select(filter => filter.Text).ToArray().Contains(string.Concat(accession_number_in_locale, Accession[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                rolemanagement.CloseRoleManagement();
                PageLoadWait.WaitForPageLoad(60);

                //Step 15 - Create a Role user that already exists in the target language
                rolemanagement.ClickNewRoleBtn();
                rolemanagement.CreateRole(SuperAdmin, TestRole, GrantAccess: 0);
                wait.Until(ExpectedConditions.ElementToBeClickable(rolemanagement.ErrorMessage()));
                if (rolemanagement.ErrorMessage().Text.Equals(login.ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Message_RoleAlreadyExists")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                rolemanagement.CloseRoleManagement();

                //Step 16 - Do not fill any of the fields, and click save.
                rolemanagement.ClickNewRoleBtn();
                PageLoadWait.WaitForPageLoad(60);
                Driver.SwitchTo().DefaultContent();
                Driver.SwitchTo().Frame("UserHomeFrame");
                ClickButton("#ctl00_MasterContentPlaceHolder_SaveButton");
                wait.Until(ExpectedConditions.ElementToBeClickable(rolemanagement.ErrorMessage()));
                if (rolemanagement.ErrorMessage().Text.Equals(login.ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Message_RoleNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17 - Enter role name ,click Save
                rolemanagement.RoleNameTxt().SendKeys(TestRole);
                rolemanagement.SaveBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(rolemanagement.ErrorMessage()));
                if (rolemanagement.ErrorMessage().Text.Equals(login.ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Message_RoleDescriptionRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                rolemanagement.CloseRoleManagement();

                //Step 18 - Select a created Role from the list and Click Delete Click OK
                rolemanagement.SearchRole(TestRole, SuperAdmin);
                rolemanagement.SelectRole(TestRole);
                rolemanagement.DeleteRoleBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                PageLoadWait.WaitForElementToDisplay(rolemanagement.ConfirmRoleDeletion(), 10);
                bool bConfirmText = Driver.FindElement(By.CssSelector("#ctl00_ConfirmationText")).Text.Contains(login.ReadDataFromResourceFile(Localization.RoleList, "data", "AlertMessage_ConfirmRoleDeletion").Split('{')[0]);
                rolemanagement.ConfirmRoleDeletion().Click();
                PageLoadWait.WaitForPageLoad(30);
                PageLoadWait.WaitForFrameLoad(30);
                if (bConfirmText && !rolemanagement.RoleExists(TestRole, SuperAdmin))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Create Folders and Add Folder Descriptions
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>        
        public TestCaseResult Test_99183(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            UserManagement user;
            RoleManagement role;
            DomainManagement domain;
            ConferenceFolders conf;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String AdminContact = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AdminContact");
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String LocaleText = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");

                //Domain Admin
                String daA = "daB_99183_" + random.Next(1, limit);
                String daC = "daC_99183_" + random.Next(1, limit);

                //Roles                
                String roleA1 = "roleA1_99183_1_" + random.Next(1, limit);
                String roleA2 = "roleA2_99183_1_" + random.Next(1, limit);
                String roleC2 = "roleC2_99183_1_" + random.Next(1, limit);

                //Users
                String userA1 = "userA1_99183_" + random.Next(1, limit);
                String userA2 = "userA2_99183_" + random.Next(1, limit); //non conference user
                String userC2 = "userC2_99183_" + random.Next(1, limit);

                //TopFolders               
                String topA1 = LocaleText + "1_" + random.Next(1, 10000); //locale - ATop1_
                String topA2 = LocaleText + "2_" + random.Next(1, 10000); //locale
                String topA3 = LocaleText + "3_" + random.Next(1, 10000); //locale
                String topC1 = LocaleText + "4_" + random.Next(1, 10000); //locale

                //SubFolders
                String subA1 = LocaleText + "S1_" + random.Next(1, 10000); //locale -"SubA1_"
                String subA2 = "October 13_" + random.Next(1, 10000);
                String subA2_1 = "SubOfOct_" + random.Next(1, 10000);
                String subA3 = LocaleText + "S3" + random.Next(1, 10000);//locale

                //FolderDescriptions
                String Desc1 = topA1 + "_description"; //locale
                String Desc2 = subA1 + "_description"; //locale
                String Desc3 = topA3 + "_description"; //locale
                String Desc4 = subA3 + "_description"; //locale

                //Step:1-[Pre-conditions:]1. iCA build under testing has been installed 2. System level option Enable Conference Lists is turned ON from iCA Service Tool\Enable Features tab 3. at least one data source is available
                //4. Explanation: Conference User is a user with permission to view all Conference Studies within their domain.
                ExecutedSteps++;

                //Step:2-[Pre-conditions:]Define domains, roles, users in locale language and Conference User settings 
                //Domain: DomainA (Conference User enabled)
                //Domain Admin: daA (Conference User enabled)
                //Role: roleA1 (Conference User enabled)
                //User in roleA1: userA1 (conference user)
                //Role: roleA2 (Conference User disabled)
                //User in roleA2: userA2 (non-conference user)
                //Domain: DomainC (Conference User enabled)
                //Domain Admin: daC (Conference User enabled)
                //Role: roleC2 (Conference User)
                //User in roleC2: userC2 (conference user)
                login.LoginIConnect(AdminUsername, AdminPassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                var domainattr = domain.CreateDomainAttr();
                String DomainA = domainattr[DomainManagement.DomainAttr.DomainName];
                String domainNameA = domainattr[DomainManagement.DomainAttr.UserID];
                String domainpwd = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(30);
                bool bDomainA = domain.IsDomainExist(DomainA);
                user = (UserManagement)login.Navigate("UserManagement");
                if (!user.SearchUser(daA, DomainA)) user.CreateDomainAdminUser(daA, DomainA, 0, "", 0, "", 1);//Domain admin

                //Create roleA1 -- Conference enabled
                role = login.Navigate<RoleManagement>();
                role.CreateRole(DomainA, roleA1, "Conference");
                //Create roleA2 -- Conference disabled
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                role = login.Navigate<RoleManagement>();
                role.CreateRole(DomainA, roleA2, "any");

                //Create users
                user = (UserManagement)login.Navigate("UserManagement");
                if (!user.SearchUser(userA1, DomainA)) user.CreateUser(userA1, DomainA, roleA1); //Conference User               
                if (!user.SearchUser(userA2, DomainA)) user.CreateUser(userA2, DomainA, roleA2); //Non Conference User
                bool bdaA = user.SearchUser(daA, DomainA);
                bool buserA1 = user.SearchUser(userA1, DomainA);
                bool buserA2 = user.SearchUser(userA2, DomainA);

                //DomainC
                domain = (DomainManagement)login.Navigate("DomainManagement");
                var domainattr1 = domain.CreateDomainAttr();
                String DomainC = domainattr1[DomainManagement.DomainAttr.DomainName];
                String domainNameC = domainattr1[DomainManagement.DomainAttr.UserID];
                domain.CreateDomain(domainattr1, isconferenceneeded: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool bDomainC = domain.IsDomainExist(DomainC);
                user = (UserManagement)login.Navigate("UserManagement");
                if (!user.SearchUser(daC, DomainC)) user.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool bdaC = user.SearchUser(daC, DomainC);

                //Role: RoleC2
                role = login.Navigate<RoleManagement>();
                if (!role.RoleExists(roleC2, DomainC)) role.CreateConfListRole(DomainC, roleC2);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool broleC2 = role.RoleExists(roleC2, DomainC);

                //Users: UserC2
                user = (UserManagement)login.Navigate("UserManagement");
                if (!user.SearchUser(userC2, DomainC)) user.CreateUser(userC2, DomainC, roleC2); //Conference User                
                bool buserC2 = user.SearchUser(userC2, DomainC);

                if (bDomainA && bdaA && buserA1 && buserA2 && bDomainC && bdaC && broleC2 && buserC2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step:3-Login iCA as Administrator in preferred language, navigate to the Conference Tab, select a domain (DomainA), click Manage Top Level Folder button to open Manage Top Level Folders dialog                              
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                conf = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                ExecutedSteps++;

                //Step:4-Click Add Top Level Folder button.
                ExecutedSteps++;

                //Step:5-Enter the folder name in locale language (e.g. top level folder 1 in DomainA), search users and add a Folder Manager (e.g. select userA1 created in the Pre-conditions), 
                //click Save to create a Top Level Folder.-[Note- users from other domain should not list in the user list. Detailed assigning Folder Manager is tested in a separated test case.]

                bool Top1 = conf.CreateToplevelFolder(topA1, userA1, DomainA);
                if (Top1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Create another Top Level Folder in the same domain in locale language, e.g. folder name (top level folder 2 in DomainA) without a folder manager assigned.
                bool Top2 = conf.CreateToplevelFolder(topA2, domain: DomainA);
                if (Top2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Select a different domain in preferred language(DomainC), create a Top Level Folder with folder name in locale langauge (top level folder 3 in DomainC) and with no Folder Manager assigned to it.
                bool Top3 = conf.CreateToplevelFolder(topC1, domain: DomainC);
                if (Top3)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Attempt to create a Top Level Folder without a Folder Name (e.g. leave the name text field blank) and with no Folder Manage assigned.
                PageLoadWait.WaitForFrameLoad(20);
                conf.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList_7 = conf.GetToplevelFolders();
                conf.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conf.InputFolder()));
                conf.InputFolder().Click();
                conf.InputFolder().SendKeys("");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform(); //Have to replace Actions
                IList<IWebElement> TopFolderList_8 = conf.GetToplevelFolders();
                if (TopFolderList_8.Count == TopFolderList_7.Count)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Attempt to create a Top Level Folder without a Folder Name, but with a Folder Manager assigned.
                bool IsTextboxDisabled;
                try
                {
                    if (conf.FolderManagerTextBox().GetAttribute("disabled").Contains(""))
                        IsTextboxDisabled = true;
                    else
                        IsTextboxDisabled = false;
                }
                catch (Exception)
                {
                    IsTextboxDisabled = false;
                }

                if (IsTextboxDisabled)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conf.CloseManageTopLevelFolder();

                //Step-10:As a SuperAdmin logged in iCA, from Conference Tab, select a domain (DomainA), select a Top Level Folder (e.g. top level folder 1 in DomainA) in folder browser, click EDIT Folder Description button.                
                conf.ExpandAndSelectFolder(topA1, DomainA);
                ExecutedSteps++;

                //Step-11:Enter the folder description in locale text (e.g. description for top level folder 1 in DomainA), click OK.
                conf.EditDescription(Desc1);
                if (conf.EditDesc_CurrentDesc().Text.Equals(Desc1))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-12:Login iCA as a Domain Admin (e.g. daA for DomainA), navigate to the Conference Tab, click Manage Top Level Folder button.                
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(domainNameA, domainpwd);
                conf = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                ExecutedSteps++;

                //Step-13:Create a Top Level Folder with a folder name in locale text (e.g. top folder 4 in DomainA) and assign a folder manager to it (e.g. userA2)
                bool top12 = conf.CreateToplevelFolder(topA3, userA2);
                if (top12)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:From the folder browser, select the Top Level Folder created by the domain admin, click EDIT Folder Description button.                
                conf.ExpandAndSelectFolder(topA3);
                ExecutedSteps++;

                //Step-15:Enter the folder description in locale text (e.g. top folder 4 in DomainA - folder description), click OK.
                conf.EditDescription(Desc3);
                if (conf.EditDesc_CurrentDesc().Text.Equals(Desc3))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Attempt to create a Top Level Folder without providing a Folder Name and Folder Manager.
                PageLoadWait.WaitForFrameLoad(20);
                conf.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList1_16 = conf.GetToplevelFolders();
                conf.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conf.InputFolder()));
                conf.InputFolder().Click();
                conf.InputFolder().SendKeys("");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                IList<IWebElement> TopFolderList2_16 = conf.GetToplevelFolders();
                bool IsTextboxDisabled16;
                try
                {
                    if (conf.FolderManagerTextBox().GetAttribute("disabled").Contains(""))
                        IsTextboxDisabled16 = true;
                    else
                        IsTextboxDisabled16 = false;
                }
                catch (Exception)
                {
                    IsTextboxDisabled16 = false;
                }
                if (TopFolderList2_16.Count == TopFolderList1_16.Count && IsTextboxDisabled16)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conf.CloseManageTopLevelFolder();
                login.Logout();

                //Step-17:Login iCA as a folder manager (e.g. userA1), navigate to the Conference Tab, from folder browser select the a top level folder where the user is a Folder's manager (top level folder 1 in DomainA), click Add Folder button to create a sub-folder.                
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conf = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conf.ExpandAndSelectFolder(topA1);
                ExecutedSteps++;

                //Step-18:Enter the folder name in locale text, press Enter button on the keyboard.
                bool subA18 = conf.CreateSubFolder(topA1, subA1);
                if (subA18)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-19:Select the newly created sub-folder , click EDIT Folder Description button.                
                conf.ExpandAndSelectFolder(topA1 + "/" + subA1);
                ExecutedSteps++;

                //Step-20:Enter a sub-folder description in locale text, click OK.
                conf.EditDescription(Desc2);
                if (conf.EditDesc_CurrentDesc().Text.Equals(Desc2))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-21:From the folder browser select the same top level folder, create another level 2 Sub-Folder with folder name (e.g. October 13), press Enter button on the keyboard
                bool subA21 = conf.CreateSubFolder(topA1, subA2);
                if (subA21)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-22:Select a sub-folder (level2) e.g. October 13, add a sub-folder under the sub-folder.
                bool subA22 = conf.CreateSubFolder(topA1 + "/" + subA2, subA2_1);
                if (subA22)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-23:Select the same Top Level Folder managed by the Folder Manager, attempt to add a new sub-folder without providing a folder name.               
                bool step23 = conf.CreateSubFolder(topA1, "");
                if (!step23)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-24:Select the same Top Level Folder, select a sub-folder under it, attempt to add a sub-folder without providing a folder name.
                bool step24 = conf.CreateSubFolder(topA1 + "/" + subA2, "");
                if (!step24)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-25:Login as the Domain Admin (daA in DomainA), navigate to the Conference Tab, select a top level folder that is added by SuperAdmin (e.g. top level folder 1 in DomainA), click Add Folder button                               
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(domainNameA, domainpwd);
                conf = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                ExecutedSteps++;

                //Step-26:Create a sub-folder with sub-folder name in locale text, press the Enter button on the keyboard.
                PageLoadWait.WaitForFrameLoad(10);
                bool subA25 = conf.CreateSubFolder(topA1, subA3);
                if (subA25)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-27:Select the sub-folder just created , click EDIT Folder Description button, add a folder description for it in locale text
                conf.ExpandAndSelectFolder(topA1 + "/" + subA3);
                conf.EditDescription(Desc4);
                if (conf.EditDesc_CurrentDesc().Text.Equals(Desc4))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);


                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Delete Folder descriptions
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_99181(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String LastNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String FirstNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Descriptions = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");

                String[] LastName = LastNames.Split(':');
                String[] FirstName = FirstNames.Split(':');
                String[] Description = Descriptions.Split(':');
                String[] Langs = Languages.Split(':');
                String[] Name = Names.Split(':');

                //Step 1 - Precondition              
                ExecutedSteps++;

                //Step 2 - Precondition
                String DomainA = "DomainA_99181_" + new Random().Next(1000);
                String daA = "daA_99181_" + new Random().Next(1000);
                String userA1 = "userA1_99181_" + new Random().Next(1000);//Folder Manager
                String userA3 = "userA3_99181_" + new Random().Next(1000);//conference user

                String roleA1 = "roleA1_99181_" + new Random().Next(1000);
                String roleA2 = "roleA2_99181_" + new Random().Next(1000); 
                String userA2 = "userA2_99181_" + new Random().Next(1000); //non-conference user, Folder Manager
                String userA4 = "userA4_99181_" + new Random().Next(1000); //non-conference user
                String DomainC = "DomainC_99181_" + new Random().Next(1000);
                String daC = "daC_99181_" + new Random().Next(1000);

                String roleC1 = "roleC1_99181_" + new Random().Next(1000);
                String roleC2 = "roleC2_99181_" + new Random().Next(1000);
                String userC2 = "userC2_99181_" + new Random().Next(1000);

                //Domain: DomainA (Conference User enabled) -Domain Admin-  daA (Conference User enabled)
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(DomainA, DomainA, null);
                domainmanagement.ConferenceListsCB().Click();
                domainmanagement.ClickSaveNewDomain();

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateDomainAdminUser(daA, DomainA, IsConfUser: 1);

                //roleA1 (Conference User enabled)
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(DomainA, roleA1, "conference");

                //Users in roleA1
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(userA1, DomainA, roleA1);//Folder Manager
                usermanagement.CreateUser(userA3, DomainA, roleA1);//Conference User

                //roleA2: (Conference User disabled) 
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(DomainA, roleA2, "any");

                //User in roleA2 
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(userA2, DomainA, roleA2);//Non-Conference User
                usermanagement.CreateUser(userA4, DomainA, roleA2);//Non-Conference User

                //DomainC  DomainC (Conference User enabled) -Domain Admin-  daC (Conference User enabled)
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(DomainC, DomainC, datasources: null);
                domainmanagement.ConferenceListsCB().Click();
                domainmanagement.ClickSaveNewDomain();

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateDomainAdminUser(daC, DomainC, IsConfUser: 1);

                //roleC1 (Conference User enabled)
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(DomainC, roleC1, "conference");

                //roleC2 (Conference User enabled)
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(DomainC, roleC2, "conference");

                //User in roleC2-  userC2 (conference user)
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(userC2, DomainC, roleC2);//Folder Manager
                login.Logout();
                ExecutedSteps++;

                //Step 3 - Preconditions
                String TopFolder_1 = Name[0] + "_99181_" + new Random().Next(1000);//userA1 as FolderManager
                //String TopFolder_1 = "Adult Bone Marrow Transplant_99181_" + new Random().Next(1000);//userA1 as FolderManager
                String TopFolder_1_Desc = Description[0] + "_99181_" + new Random().Next(1000);//userA1 as FolderManager
                //String TopFolder_1_Desc = "sa modified description for top level folder 1 in DomainA_94430_" + new Random().Next(1000);//userA1 as FolderManager
                String TopFolder_1_Manager = userA1 + new Random().Next(1000);

                String SubFolder_1_Level_2 = Name[1] + "_99181_" + new Random().Next(1000);
                //String SubFolder_1_Level_2 = "October 6, 2016_99181_" + new Random().Next(1000);
                String SubFolder_1_Desc = Description[1] + "_99181_" + new Random().Next(1000);
                //String SubFolder_1_Desc = "userA1 modified Meeting- October 6.2016_94430_" + new Random().Next(1000);
                String SubFolder_1_Level_3 = Name[2] + "_99181_" + new Random().Next(1000);
                //String SubFolder_1_Level_3 = "Level_3_99181_" + new Random().Next(1000);
                String SubFolder_1_Desc_Level_3 = Description[2] + "_99181_" + new Random().Next(1000);
                //String SubFolder_1_Desc_Level_3 = "Subfolder 1 Level_3_Description_94430_" + new Random().Next(1000);

                String SubFolder_2_Level_2 = Name[3] + "_99181_" + new Random().Next(1000);
                //String SubFolder_2_Level_2 = "October 13, 2016_94430_" + new Random().Next(1000)
                String SubFolder_2_Desc = Description[3] + "_99181_" + new Random().Next(1000);
                //String SubFolder_2_Desc = "daA modified- Meeting - October 13, 2016_94430_" + new Random().Next(1000);
                String SubFolder_2_Level_3 = Name[4] + "_99181_" + new Random().Next(1000);
                //String SubFolder_2_Level_3 = "Subfolder 2 Level_3_99181_" + new Random().Next(1000);
                String SubFolder_2_Desc_Level_3 = Description[4] + "_99181_" + new Random().Next(1000);
                //String SubFolder_2_Desc_Level_3 = "Description of Level 3_94430_" + new Random().Next(1000)
                String SubFolder_3_Level2 = Name[5] + "_99181_" + new Random().Next(1000);
                //String SubFolder_3_Level2 = "October 20_99181_" + new Random().Next(1000);
                String SubFolder_3_Desc = Description[5] + "_99181_" + new Random().Next(1000);
                //String SubFolder_3_Desc = "Meeting 10.20.2016_94430_" + new Random().Next(1000);
                String TopFolder_2 = Name[6] + "_99181_" + new Random().Next(1000); //userA1 as FolderManager
                //String TopFolder_2 = "Brain Tumor (Neurologic Oncology)_99181_" + new Random().Next(1000); //userA1 as FolderManager
                String TopFolder_2_Desc = Description[6] + "_99181_" + new Random().Next(1000);
                //String TopFolder_2_Desc = "daA modified description- top level folder 2 in DomainA_94430_" + new Random().Next(1000);

                String TopFolder_4 = Name[7] + "_99181_" + new Random().Next(1000);
                //String TopFolder_4 = "top folder 4 in DomainA_99181_" + new Random().Next(1000);
                String TopFolder_4_Desc = Description[7] + "_99181_" + new Random().Next(1000);
                //String TopFolder_4_Desc = "top folder 4 in DomainA_94430_" + new Random().Next(1000);
                String TopFolder_4_Manager = userA2 + new Random().Next(1000);
                String SubFolder_4_Level_2 = Name[7] + "_99181_" + new Random().Next(1000);
                //String SubFolder_4_Level_2 = "Subfolder 4 Level_2_99181_" + new Random().Next(1000);
                String SubFolder_4_Desc_Level_2 = Description[8] + "_99181_" + new Random().Next(1000);
                //String SubFolder_4_Desc_Level_2 = "Description of Level 2_94430_" + new Random().Next(1000);
                String TopFolder_5 = Name[8] + "_99181_" + new Random().Next(1000);
                //String TopFolder_5 = "top folder 5 in DomainA_99181_" + new Random().Next(1000);                                
                String SubFolder_5_Level_2 = Name[9] + "_99181_" + new Random().Next(1000);
                //String SubFolder_5_Level_2 = "Subfolder 5 Level_2_99181_" + new Random().Next(1000);
                String SubFolder_5_Desc_Level_2 = Description[9] + "_99181_" + new Random().Next(1000);
                //String SubFolder_5_Desc_Level_2 = "Sobfolder 5 Description of Level 2_94430_" + new Random().Next(1000);
                String TopFolder_3 = Name[10] + "_99181_" + new Random().Next(1000);
                //String TopFolder_3 = "Cutaneous T-cell Lymphoma_99181_" + new Random().Next(1000);
                String TopFolder_3_Desc = Description[10] + "_99181_" + new Random().Next(1000);
                //String TopFolder_3_Desc = "daC modified description top level folder 3 in DomainC_99181_" + new Random().Next(1000);
                String SubFolder_3_Level_2 = Name[11] + "_99181_" + new Random().Next(1000);
                //String SubFolder_3_Level_2 = "Subfolder 3 Level 2_99181_" + new Random().Next(1000);
                String SubFolder_3_Desc_Level_2 = Name[12] + "_99181_" + new Random().Next(1000);
                //String SubFolder_3_Desc_Level_2 = "Description of Subfolder 3 Level 2_99181_" + new Random().Next(1000); 

                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.CreateToplevelFolder(TopFolder_1, userA1, DomainA, TopFolder_1_Desc); //Adult Bone Marrow Transplant
                bool step3_1 = conferenceFolders.CreateSubFolder(TopFolder_1, SubFolder_1_Level_2, DomainA, SubFolder_1_Desc);
                bool step3_2 = conferenceFolders.CreateSubFolder(TopFolder_1 + "/" + SubFolder_1_Level_2, SubFolder_1_Level_3, DomainA, SubFolder_1_Desc_Level_3);
                bool step3_3 = conferenceFolders.CreateSubFolder(TopFolder_1, SubFolder_2_Level_2, DomainA, SubFolder_2_Desc);
                bool step3_4 = conferenceFolders.CreateSubFolder(TopFolder_1 + "/" + SubFolder_2_Level_2, SubFolder_2_Level_3, DomainA, SubFolder_2_Desc_Level_3);
                login.Logout();

                //Domain Admin (daA) ##**
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                bool step3_5 = conferenceFolders.CreateSubFolder(TopFolder_1, SubFolder_3_Level2, Description: SubFolder_3_Desc);
                login.Logout();

                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies"); ;
                conferenceFolders.CreateToplevelFolder(TopFolder_2, domain: DomainA, description: TopFolder_2_Desc);
                conferenceFolders.CreateToplevelFolder(TopFolder_4, userA2, DomainA, TopFolder_4_Desc);
                bool step3_6 = conferenceFolders.CreateSubFolder(TopFolder_4, SubFolder_4_Level_2, Description: SubFolder_4_Desc_Level_2);

                conferenceFolders.CreateToplevelFolder(TopFolder_5, domain: DomainA);
                bool step3_7 = conferenceFolders.CreateSubFolder(TopFolder_5, SubFolder_5_Level_2, Description: SubFolder_5_Desc_Level_2);

                conferenceFolders.CreateToplevelFolder(TopFolder_3, domain: DomainC, description: TopFolder_3_Desc);
                bool step3_8 = conferenceFolders.CreateSubFolder(TopFolder_3, SubFolder_3_Level_2, Domain_Name: DomainC, Description: SubFolder_3_Desc_Level_2);

                if (step3_1 && step3_2 && step3_3 && step3_4 && step3_5 && step3_6 && step3_7 && step3_8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    Logger.Instance.ErrorLog("Active Folder " + step3_1 + "-" + step3_2 + "-" + step3_3 + "-" + step3_4 + "-" + step3_5 + "-" + step3_6 + "-" + step3_7 + "-" + step3_8);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 4 - Super Admin deletes Top Level Folder description                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1, DomainA);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_1_Desc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Delete the folder description text, click OK.
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - From Conference Tab select a different domain (DomainC), select a Top Level Folder named 'Breast Care Center', delete the folder description text 'daC modified description top level folder 3 in DomainC'
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                conferenceFolders.ExpandAndSelectFolder(TopFolder_3, DomainC);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                Boolean step_6 = conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_3_Desc);
                conferenceFolders.DeleteDescription();
                if (step_6 &&
                   conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - [Super Admin deletes Sub-Folder's description]<br/>From Conference Tab select a Domain (DomainA), select a sub-folder wishes to modify, e.g. from top level folder named 'Adult Bone Marrow Transplant' in preferred language select a level 2 sub-folder (October 6, 2016), click EDIT Folder Description button.
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_1_Level_2, DomainA);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_1_Desc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Delete the level 2 sub-folder description text, click OK.
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Select a level 3 sub-folder under the level 2 sub-folder. Delete the description of the level 3 sub-folders.
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_1_Level_2 + "/" + SubFolder_1_Level_3, DomainA);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                Boolean step_9 = conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_1_Desc_Level_3);
                conferenceFolders.DeleteDescription();
                if (step_9 && conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 10 - Domain Admin deletes Top Level Folder descriptions                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder_4);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_4_Desc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Delete the folder description text of the top level folder, click OK.
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Select a top level folder that has a folder description (e.g. top level folder Brain Tumor (Neurologic Oncology), click EDIT Folder Description button
                conferenceFolders.ExpandAndSelectFolder(TopFolder_2);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_2_Desc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Without delete any folder description text, click OK.
                conferenceFolders.EditDesc_TextArea().Click();
                conferenceFolders.EditDesc_OKbutton().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_CurrentDesc()));
                if (conferenceFolders.DescriptionText().Equals(TopFolder_2_Desc) &&
                    conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_2_Desc) &&
                    conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: none;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 14 - [Domain Admin deletes Sub-Folder descriptions]<br/>Select a level 2 sub-folder under the same top level folder (e.g. top folder 4 in DomainA), click EDIT Folder Description button,
                conferenceFolders.ExpandAndSelectFolder(TopFolder_4 + "/" + SubFolder_4_Level_2);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_4_Desc_Level_2))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 15 - Delete the folder description text of the selected level 2 sub-folder.
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 16 - Select a top level folder that has a level 3 sub-folder under it (e.g. Adult Bone Marrow Transplant), select the level 3 sub-folder under a level 2 sub-folder (October 13, 2016), click EDIT Folder Description button.
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_2_Level_2 + "/" + SubFolder_2_Level_3);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_2_Desc_Level_3))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    //**##
                    Logger.Instance.ErrorLog("conferenceFolders.EditDesc_CurrentDesc().GetAttribute(innerHTML)" + conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML"));
                    Logger.Instance.ErrorLog("SubFolder_2_Desc_Level_3" + SubFolder_2_Desc_Level_3);

                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17 - Delete the folder description text of the selected level 3 sub-folder.
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 18 - Folder Manager deletes Sub-Folder descriptions                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_2_Level_2);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_2_Desc))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 19 - Delete the folder description text of the selected sub-folder, click OK.
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") && conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 20 - Folder Manager attempts to delete Sub-Folder description under top level folder the user is not an administrator of
                conferenceFolders.ExpandAndSelectFolder(TopFolder_5 + "/" + SubFolder_5_Level_2);
                if (conferenceFolders.EditDesc_Button().Displayed == false)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 21 - Login ICA as a Domain Admin (daA) assign the user (userA1) as a Folder Manage of that top level folde                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");

                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='divFolderManagement'] input[id='ConferenceFolderManagementControl_AddFolderButton']")));
                conferenceFolders.SwitchtoConferenceFrame();
                Thread.Sleep(3000);
                Boolean Foldermanager5 = conferenceFolders.AddFolderManager(TopFolder_5, userA1);
                conferenceFolders.SaveFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(10);
                Thread.Sleep(10000);
                //BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("#ConferenceFolderConfigurationMsgDialogDiv")));
                conferenceFolders.ManageFolderOkBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                login.Logout();

                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder_5 + "/" + SubFolder_5_Level_2);
                conferenceFolders.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                conferenceFolders.DeleteDescription();
                if (conferenceFolders.DescriptionText().Equals("") &&
                    conferenceFolders.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 22 - Folder Manage attempts to delete Top Level Folder description]<br/>Login iCA as the Folder Manager                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1, DomainA);
                String New_Description = "Description of Top level Folder To test the userA1_94430_";
                conferenceFolders.EditDescription(New_Description);
                login.Logout();

                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1);
                if (conferenceFolders.DescriptionText().Equals(New_Description) && conferenceFolders.EditDesc_Button().Displayed == false)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 23 - conferenceFolders User attempts to delete folder descriptions                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA3, userA3);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder_1);
                if (conferenceFolders.DescriptionText().Equals(New_Description) && conferenceFolders.EditDesc_Button().Displayed == false)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout 
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Modify Folder Names and Descriptions
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_99182(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String LastNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String FirstNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Descriptions = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");

                String[] LastName = LastNames.Split(':');
                String[] FirstName = FirstNames.Split(':');
                String[] Description = Descriptions.Split(':');
                String[] Langs = Languages.Split(':');
                String[] Name = Names.Split(':');

                //Group A
                String DomainA = "DomainA_99182_" + new Random().Next(1, 1000); //Conf List
                String daA = "daA_99182_" + new Random().Next(1, 1000); //Conf User
                String roleA1 = "roleA1_99182_" + new Random().Next(1, 1000); //Conf User
                String roleA2 = "roleA2_99182_" + new Random().Next(1, 1000); //non-Conf User
                String userA1 = "userA1_99182_" + new Random().Next(1, 1000); //Folder Manager
                String userA2 = "userA2_99182_" + new Random().Next(1, 1000); //Conf User
                String userA3 = "userA3_99182_" + new Random().Next(1, 1000); //Conf User
                String userA4 = "userA4_99182_" + new Random().Next(1, 1000); //non-Conf User

                //Group C
                String DomainC = "DomainC_99182_" + new Random().Next(1, 1000); //Conf List
                String daC = "daC_99182_" + new Random().Next(1, 1000); //Conf User
                String roleC2 = "roleC2_99182_" + new Random().Next(1, 1000); //Conf User                                
                String userC2 = "userC2_99182_" + new Random().Next(1, 1000); //Conf User     

                //Conf folders
                String TopFolder1 = "TopFolder1_99182_" + new Random().Next(1, 1000);
                String SubFolder1_1_Level2 = "October06_99182_" + new Random().Next(1, 1000);
                String SubFolder1_1_Level3 = "Level3_99182_" + new Random().Next(1, 1000);
                String SubFolder1_2_Level2 = "October13_99182_" + new Random().Next(1, 1000);
                String SubFolder1_3_Level2 = "October20_99182_" + new Random().Next(1, 1000);

                String TopFolder2 = "TopFolder2_99182_" + new Random().Next(1, 1000);
                String TopFolder3 = "TopFolder3_99182_" + new Random().Next(1, 1000);
                String SubFolder3_1_Level2 = "TopFoler3_Level2_99182_" + new Random().Next(1, 1000);
                String TopFolder4 = "TopFolder4_99182_" + new Random().Next(1, 1000);
                String SubFolder4_1_Level2 = "SubFolder4_1_Level2_99182_" + new Random().Next(1, 1000);
                String TopFolder5 = "TopFolder5_99182_" + new Random().Next(1, 1000);
                String SubFolder5_1_Level2 = "SubFolder5_1_Level2_99182_" + new Random().Next(1, 1000);

                //Step 1 - Precondition
                ExecutedSteps++;

                //Step 2 - Precondition
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                //Group A
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateConfUsrDomain(DomainA);

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateDomainAdminUser(daA, DomainA, 0, "", 0, "", 1);

                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateConfListRole(DomainA, roleA1);
                rolemanagement.ClickNewRoleBtn(); rolemanagement.CreateRole(DomainA, roleA2, GrantAccess: 0);

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(userA1, DomainA, roleA1); //Folder Manager
                usermanagement.CreateUser(userA3, DomainA, roleA1); //Conference User
                usermanagement.CreateUser(userA2, DomainA, roleA2); //Conference User
                usermanagement.CreateUser(userA4, DomainA, roleA2); //Non-Conference User

                //Group C
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateConfUsrDomain(DomainC);

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);

                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateConfListRole(DomainC, roleC2);

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(userC2, DomainC, roleC2); //Conference User
                ExecutedSteps++;

                //Step 3 - Precondition               
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.CreateToplevelFolder(TopFolder1, userA1, DomainA, Description[0]);
                conferenceFolders.CreateSubFolder(TopFolder1, SubFolder1_1_Level2, DomainA, "Meeting 10.06.2016");
                conferenceFolders.CreateSubFolder(TopFolder1, SubFolder1_2_Level2, DomainA, "October 13");
                conferenceFolders.CreateSubFolder(TopFolder1, SubFolder1_3_Level2, DomainA, "October 20");
                conferenceFolders.CreateSubFolder(TopFolder1 + "/" + SubFolder1_1_Level2, SubFolder1_1_Level3, DomainA, SubFolder1_1_Level3 + " Description");

                conferenceFolders.CreateToplevelFolder(TopFolder2, null, DomainA, Description[1]);
                conferenceFolders.CreateToplevelFolder(TopFolder3, null, DomainC, "");
                conferenceFolders.CreateSubFolder(TopFolder3, SubFolder3_1_Level2, DomainC, "");
                conferenceFolders.CreateToplevelFolder(TopFolder4, userA2, DomainA, Description[2]);
                conferenceFolders.CreateSubFolder(TopFolder4, SubFolder4_1_Level2, DomainA, SubFolder4_1_Level2);
                conferenceFolders.CreateToplevelFolder(TopFolder5, null, DomainA, "");
                conferenceFolders.CreateSubFolder(TopFolder5, SubFolder5_1_Level2, DomainA, SubFolder5_1_Level2);
                login.Logout();

                ExecutedSteps++;

                //Step 4 - Super Admin modifies Top Level Folder name and description
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1).Text.Equals(TopFolder1))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Change the folder name from 'top level folder 1 in DomainA' to 'Adult Bone Marrow Transplant' in preferred language in the text box, press Enter on the keyboard.
                conferenceFolders.RenameFolder(TopFolder1, Name[0]);
                TopFolder1 = Name[0];
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1).Text.Equals(Name[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Select the same top level folder in the folder browser, click EDIT Folder Description button
                conferenceFolders.ExpandAndSelectFolder(TopFolder1);
                conferenceFolders.EditDesc_Button().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(Description[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conferenceFolders.EditDesc_CANCELbutton().Click();

                //Step 7 - Modify the folder description to a new value in preferred language(e.g. sa modified description for top level folder 1 in DomainA), click OK
                conferenceFolders.EditDescription(Description[3]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[3]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - From Conference Tab select a different domain (DomainC), select a Top Level Folder wishes to modify in the folder browser e.g. click the folder named 'top level folder 3 in DomainC' again, change the folder name to 'Breast Care Center' press Enter on the keyboard.
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                conferenceFolders.RenameFolder(TopFolder3, Name[1]);
                TopFolder3 = Name[1];
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder3).Text.Equals(Name[1]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Select the same top level folder in the folder browser, click EDIT Folder Description button
                conferenceFolders.ExpandAndSelectFolder(TopFolder3);
                conferenceFolders.EditDesc_Button().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(""))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conferenceFolders.EditDesc_CANCELbutton().Click();

                //Step 10 - Change the folder description to a new value (e.g. sa modified top level folder 3 in DomainC), click OK
                conferenceFolders.EditDescription(Description[4]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[4]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 11 - double click the folder named 'top level folder 2 in DomainA' which was created by the Domain Admin
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder2).Text.Equals(TopFolder2))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Change the folder name from 'top level folder 2 in DomainA' to 'Brain Tumor (Neurologic Oncology)' in preferred language, press Enter on the keyboard.                
                conferenceFolders.RenameFolder(TopFolder2, Name[2]);
                TopFolder2 = Name[2];
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder2).Text.Equals(Name[2]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Select the same top level folder in the folder browser, click EDIT Folder Description button.
                conferenceFolders.ExpandAndSelectFolder(TopFolder2);
                conferenceFolders.EditDesc_Button().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(Description[1]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conferenceFolders.EditDesc_CANCELbutton().Click();

                //Step 14 - Change the Folder Description to a new value in preferred language (e.g. daA modified description: top level folder 2 in DomainA), click OK.
                conferenceFolders.EditDescription(Description[5]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[5]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 15 - Login iCA as a Domain Admin who is an administrator of a different domain (daC in DomainC), navigate to the Conference Tab, from folder browser select a Top Level Folder wishes to modify, e.g. select the folder was created and modified by Super Admin, update folder name from ' Breast Care Center' to 'Cutaneous T-cell Lymphoma' in preferred language
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(daC, daC);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.RenameFolder(TopFolder3, Name[3]);
                TopFolder3 = Name[3];
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder3).Text.Equals(Name[3]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 16 - Select the same top level folder in the folder browser, update the folder description to a new value (e.g. daC modified description top level folder 3 in DomainC)
                conferenceFolders.EditDescription(Description[6]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[6]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17 - [3. Domain Admin attempts to modify Top Level Folder name and description in a domain the user is not an administrator of]<br/>With a Domain Admin logged in (daC in DomainC) attempt to modify a top level folder name and description that is not managed by this logged domain admin (e.g. a folder in DomainA).
                conferenceFolders.SwitchtoConferenceFrame();
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 18 - [4. Folder Manager attempts to modify Top Level Folder name and description] <br/>Login ICA as the Folder Manager in preferred language(userA1), navigate to the Conference Tab, select a Top Level Folder the user is an administrator of (Adult Bone Marrow Transplant), attempt to modify a Top Level Folder name and description.                
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.SelectFolder(TopFolder1, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopFolder1, 1);
                Thread.Sleep(1000);
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 19 - [5. Conference User attempts to modify Top Level Folder name and description]<br/>Login ICA as a conference user in preferred language(userA3), navigate to the Conference Tab, select a Top Level Folder from folder browser, attempt to modify folder name and description.
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.SelectFolder(TopFolder1, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopFolder1, 1);
                Thread.Sleep(1000);
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 20 - [6. Folder Manager modifies Sub-Folder name and description]<br/>Login iCA as a folder manager (e.g. userA1), navigate to the Conference Tab, select a top level folder that the user is a Folder Manager (Adult Bone Marrow Transplant), select a sub-folder (e.g. October 6) wishes to modify under the top level folder, click the sub-folder again
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ClickTopLevelFolderExpander(TopFolder1);
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_1_Level2).Text.Equals(SubFolder1_1_Level2))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 21 - Modify the sub-folder name from 'October 6' to a new name in preferred language(e.g. October 6, 2016) press Enter on the keyboard.
                conferenceFolders.RenameFolder(TopFolder1 + "/" + SubFolder1_1_Level2, Name[6]);
                Thread.Sleep(2000);
                SubFolder1_1_Level2 = Name[6];
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_1_Level2).Text.Equals(Name[6]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 22 - Select the same sub-folder in the folder browser, click EDIT Folder Description button.
                conferenceFolders.EditDesc_Button().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals("Meeting 10.06.2016"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conferenceFolders.EditDesc_CANCELbutton().Click();

                //Step 23 - Modify the sub-folder's Description from the current value to a new value in preferred language(e.g. userA1 modified Meeting: October 6, 2016), click OK.
                conferenceFolders.EditDescription(Description[7]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[7]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 24 - Select a level 3 folder under a level 2 sub-folder (e.g. October 6, 2016), edit the level 3 sub-folder's name and description.
                conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_1_Level2 + "/" + SubFolder1_1_Level3);
                conferenceFolders.RenameFolder(TopFolder1 + "/" + SubFolder1_1_Level2 + "/" + SubFolder1_1_Level3, Name[4]);
                SubFolder1_1_Level3 = Name[4];
                conferenceFolders.EditDescription(Description[8]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_1_Level2 + "/" + SubFolder1_1_Level3).Text.Equals(Name[4]) &&
                    conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[8]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 25 - [7. Folder Manager attempts to modify Sub-Folder name and description, the user is not a Folder Manager of the folder]<br/>With a Folder Manager logged in iCA (UserA1), select a Top Level Folder that is not managed by the Folder Manager (userA1), e.g. select the folder named 'top folder 4 in DomainA', attempt to modify the name and description of a sub-folder under this top level folder.
                conferenceFolders.SelectFolder(TopFolder4, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopFolder4, 1);
                Thread.Sleep(1000);
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 26 - [8. Conference User attempts to modify Sub-Folder name and description]<br/>Login ICA as a conference user (e.g. userA3 in DomainA) who is not a Folder Manager but is a conference user, navigate to the Conference Tab, attempt to modify Sub-Folder's names and descriptions.
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA3, userA3);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                PageLoadWait.WaitForFrameLoad(10);
                conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_1_Level2);
                conferenceFolders.ActiveFolder().Click();
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 27 - [9. Domain Admin modifies Sub-Folder name and description]<br/>Login as the Domain Admin (daA in DomainA), navigate to the Conference Tab, select a top level folder (e.g. Adult Bone Marrow Transplant), from folder browser select a sub-folder under the top level folder selected (e.g. October 13), click the folder again
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_2_Level2);
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_2_Level2).Text.Equals(SubFolder1_2_Level2))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 28 - Edit the folder Name from 'October 13' to 'October 13, 2016' in preferred language, press Enter on the keyboard.
                conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_2_Level2);
                conferenceFolders.RenameFolder(TopFolder1 + "/" + SubFolder1_2_Level2, Name[5]);
                SubFolder1_2_Level2 = Name[5];
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder1 + "/" + SubFolder1_2_Level2).Text.Equals(Name[5]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 29 - Select the same sub-folder (October 13, 2016), click EDIT Folder Description button.
                conferenceFolders.EditDesc_Button().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals("October 13"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conferenceFolders.EditDesc_CANCELbutton().Click();

                //Step 30 - Change the folder description to a new value in preferred language (e.g. daA modified: Meeting - October 13, 20YY), press Enter.
                conferenceFolders.EditDescription(Description[9]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[9]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 31 - [Domain Admin attempts to modify Sub-Folder in a domain the user is not an administrator]<br/>With the same Domain Admin (daA) still logged in, attempt to modify a sub-folder from a top level folder which is under a different domain (e.g. DomainC) and the logged in user is not an administrator of that domain.
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 32 - [SuperAdmin modifies Sub-Folder name and description]<br/>Login as a SuperAdmin, navigate to the Conference Tab, select a domain (DomainA), from folder browser select a Top Level Folder that is added by the Domain Admin (e.g. top folder 4 in DomainA), select a sub-folder, click the sub-folder again.
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                conferenceFolders.ExpandAndSelectFolder(TopFolder4 + "/" + SubFolder4_1_Level2);
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.IsSubLevel2FolderExist(TopFolder4, SubFolder4_1_Level2))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 33 - Modify the sub-folder name in the folder browser, and then click EDIT Folder Description button to modify the folder description.
                conferenceFolders.EditDescription(Description[10]);
                PageLoadWait.WaitForFrameLoad(20);
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(Description[10]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 34 - From Conference Tab select a different domain (DomainC), modify a sub-folder's name and description in preferred language.
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                Thread.Sleep(5000);
                conferenceFolders.ExpandAndSelectFolder(TopFolder3 + "/" + SubFolder3_1_Level2);
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.RenameFolder(TopFolder3 + "/" + SubFolder3_1_Level2, Name[7]);
                SubFolder3_1_Level2 = Name[7];
                Thread.Sleep(2000);
                if (conferenceFolders.ExpandAndSelectFolder(TopFolder3 + "/" + SubFolder3_1_Level2).Text.Equals(Name[7]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout 
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// User Management
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90601(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            DomainManagement domainmanagement;
            UserManagement usermanagement;
            Random random = new Random();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String pacusername = Config.pacsadmin;
                String pacpassword = Config.pacspassword;
                String SuperAdminGroup = Config.adminGroupName;
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                //String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = { "リー_" + random.Next(1, 1000), "Firstname_" + random.Next(1, 1000), "ミマツヒコ_" + random.Next(1, 1000), "カシャイン_" + random.Next(1, 1000) };
                //String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = { "キム_" + random.Next(1, 1000), "Lastname_" + random.Next(1, 1000), "カシャイン_" + random.Next(1, 1000), "David_" + random.Next(1, 1000) };
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String[] PageList = { "UserManagementPage", "NewUserPage", "NewGroupPage" };
                String[] data = { "last_" + random.Next(1, 1000), "first_" + random.Next(1, 1000) };
                String[] group1user = { "g1name_" + random.Next(1, 1000), "g1last" + random.Next(1, 1000), "g1user_" + random.Next(1, 1000) };
                String[] group2user = { "g2name_" + random.Next(1, 1000), "g2last" + random.Next(1, 1000) };
                String[] group3 = { "g3name_" + random.Next(1, 1000), "g3last" + random.Next(1, 1000) };
                String[] group4 = { "g4name_" + random.Next(1, 1000), "g4last" + random.Next(1, 1000) };
                String SubGroup1 = "Subgroup_" + random.Next(1, 1000);

                //Step-1:Login as Administrator in target language
                //Go to User Management page and check the label from each area (columns, searching areas, buttons)
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                bool UIValidate1 = ValidateLocalization(ICA_MappingFilePath, PageList[0]);
                if (UIValidate1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2:Select New User
                usermanagement.NewUsrBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                bool UIValidate2 = ValidateLocalization(ICA_MappingFilePath, PageList[1]);
                if (UIValidate2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-3:Create a user under a created domain in target language and fill out all fields in target language if applicable and save
                usermanagement.XBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.DomainDropDown().SelectByText(SuperAdminGroup);
                usermanagement.CreateUser(Lastnames[0], SuperRole, FName: Firstnames[0], LName: Lastnames[0]);

                bool IsU1Exist = usermanagement.SearchUser(Lastnames[0]);
                if (IsU1Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step:4-Create one more new user in English
                usermanagement.DomainDropDown().SelectByText(SuperAdminGroup);
                usermanagement.CreateUser(Lastnames[1], SuperRole, FName: Firstnames[1], LName: Lastnames[1]);
                bool IsU2Exist = usermanagement.SearchUser(Lastnames[1]);
                if (IsU2Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-From user search field, enter newly created users' name in target language and press search
                IsU1Exist = usermanagement.SearchUser(Lastnames[0]);
                if (IsU1Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Check info by press Edit
                usermanagement.SelectUser(Lastnames[0]);
                usermanagement.ClickEditUser();
                String lstname = usermanagement.LastNameTextBox().GetAttribute("value");
                String fstname = usermanagement.FirstNameTextBox().GetAttribute("value");
                String userid = usermanagement.UseridInfoLbl().Text;
                usermanagement.CloseBtn().Click();
                if (lstname.Equals(Lastnames[0]) && fstname.Equals(Firstnames[0]) && userid.Equals(Lastnames[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Hover over each column header
                ExecutedSteps++;

                //Step-8:Create a user in target language with long name & Save
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.DomainDropDown().SelectByText(SuperAdminGroup);
                usermanagement.CreateUser(Lastnames[2], SuperRole, FName: Firstnames[2], LName: Lastnames[2]);
                bool IsU3Exist = usermanagement.SearchUser(Lastnames[2]);
                if (IsU3Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Press Edit and check the info
                usermanagement.SelectUser(Lastnames[2]);
                usermanagement.ClickEditUser();
                String lstname9 = usermanagement.LastNameTextBox().GetAttribute("value");
                String fstname9 = usermanagement.FirstNameTextBox().GetAttribute("value");
                String userid9 = usermanagement.UseridInfoLbl().Text;
                usermanagement.CloseBtn().Click();
                if (lstname9.Equals(Lastnames[2]) && fstname9.Equals(Firstnames[2]) && userid9.Equals(Lastnames[2]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Create a user with name combining target language and English.
                //Fill in all required info with some in target language and some in English & Save
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.DomainDropDown().SelectByText(SuperAdminGroup);
                usermanagement.CreateUser(Lastnames[3], SuperRole, FName: Firstnames[3], LName: Lastnames[3]);
                bool IsU4Exist = usermanagement.SearchUser(Lastnames[3]);
                if (IsU4Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Press Edit and check the info
                usermanagement.SelectUser(Lastnames[3]);
                usermanagement.ClickEditUser();
                String lstname11 = usermanagement.LastNameTextBox().GetAttribute("value");
                String fstname11 = usermanagement.FirstNameTextBox().GetAttribute("value");
                String userid11 = usermanagement.UseridInfoLbl().Text;
                usermanagement.CloseBtn().Click();
                if (lstname11.Equals(Lastnames[3]) && fstname11.Equals(Firstnames[3]) && userid11.Equals(Lastnames[3]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Click New User , Do not fill any of the fields, and click create
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.DomainDropDown().SelectByText(SuperAdminGroup);
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.NewUsrBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String Errormsg = usermanagement.NewUsrErrMsg().Text;
                String errormsg = usermanagement.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_UserIDRequired");
                if (Errormsg.Equals(errormsg))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter all fields in target language with an exisitng user ID, click Create
                usermanagement.UserIdTxtBox().SendKeys(Lastnames[1]);
                usermanagement.LastNameTxtBox().SendKeys(data[0]);
                usermanagement.FirstNameTxtBox().SendKeys(data[1]);
                usermanagement.PasswordTxtBox().SendKeys(data[0]);
                usermanagement.ConfirmPwdTxtBox().SendKeys(data[0]);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String Errormsg13 = usermanagement.NewUsrErrMsg().Text;
                String errormsg13 = usermanagement.ReadDataFromResourceFile(Localization.Facade, "data", "Error_RegistrationProcess_AlreadyExists");
                if (Errormsg13.Equals(errormsg13))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.XBtn().Click();

                //Step-14:Enter User ID , click Create
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.NewUsrBtn().Click();
                usermanagement.UserIdTxtBox().SendKeys(data[0]);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String Errormsg14 = usermanagement.NewUsrErrMsg().Text;
                String errormsg14 = usermanagement.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_FirstNameRequired");
                if (Errormsg14.Equals(errormsg14))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter first name , click Create               
                usermanagement.FirstNameTxtBox().SendKeys(data[1]);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String Errormsg15 = usermanagement.NewUsrErrMsg().Text;
                String errormsg15 = usermanagement.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_LastNameRequired");
                if (Errormsg15.Equals(errormsg15))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter last name , click Create               
                usermanagement.LastNameTxtBox().SendKeys(data[0]);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String Errormsg16 = usermanagement.NewUsrErrMsg().Text;
                String errormsg16 = usermanagement.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_PasswordOrEmailRequired");
                if (Errormsg16.Equals(errormsg16))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-17:Enter password, click Create               
                usermanagement.PasswordTxtBox().SendKeys(data[0]);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String Errormsg17 = usermanagement.NewUsrErrMsg().Text;
                String errormsg17 = usermanagement.ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_PasswordDontMatch");
                if (Errormsg17.Equals(errormsg17))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-18:Enter confirm password, click Create                
                usermanagement.ConfirmPwdTxtBox().SendKeys(data[0]);
                usermanagement.CreateBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                bool IsU5Exist = usermanagement.SearchUser(data[0]);
                if (IsU5Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-19:Try to update user name with target language, update a few more info and save the change
                ExecutedSteps++;

                //Step-20:Perform a query upon updated user name
                ExecutedSteps++;

                //Step-21:Logout and log back in using user created in target language (within the domain) with incorrect password
                login.Logout();
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                //login.LoginIConnect(Lastnames[0], "1");
                login.UserIdTxtBox().Clear();
                login.UserIdTxtBox().SendKeys(Lastnames[0]);
                login.PasswordTxtBox().Clear();
                login.PasswordTxtBox().SendKeys("1");
                login.LoginBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                String ErrorMsg = login.LoginErrorMsgLabel().Text;
                String ResValueError = login.ReadDataFromResourceFile(Localization.Facade, "data", "Message_LoginFailure");
                if (ResValueError.Equals(ErrorMsg.Replace(":", "")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-22:Login again with user created in target language with correct password
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Lastnames[0], Lastnames[0]);
                PageLoadWait.WaitForFrameLoad(20);
                if (login.SearchPanelDiv().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-23:select target language
                //Login as Administrator
                //navigate to user management tab
                //Select New Group button
                //Enter in target language Group Name &Descriptiop
                //Select yes in the Group management section 
                //In the Group is managed by: Select *^<^*New User*^>^* in the drop down list. 
                //Create new user in target language
                //Select the new user in the Group Manangement dropdown. 
                //Select Save and view my Groups
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.NewGrpBtn().Click();
                bool UIValidate23 = ValidateLocalization(ICA_MappingFilePath, PageList[2]);
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.GroupXbtn().Click();
                //usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                usermanagement.CreateGroup(SuperAdminGroup, group1user[0], group1user[1], SuperRole, IsManaged: 1, GroupUser: group1user[1]);
                bool IsGroup1Exists = usermanagement.SearchGroup(group1user[0], SuperAdminGroup, 0);
                if (UIValidate23 && IsGroup1Exists)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-24:Select above created group in the list
                //Select"New User"button. 
                //In the New user popup enter the following.
                //User ID = 
                //Last Name = 
                //First Name = 
                //E-mail Address: 
                //Password = 
                //Confirm Password = 
                //Role = 
                //Select Create
                usermanagement.CreateUserForGroup(group1user[0], group1user[2], SuperAdminGroup, SuperRole);
                bool IsGroupUserExist = usermanagement.SearchUser(group1user[2]);
                usermanagement.CreateGroup(SuperAdminGroup, group2user[0], group2user[1], SuperRole, IsManaged: 1, GroupUser: group2user[1]);
                bool IsG2Exist = usermanagement.SearchGroup(group2user[0], SuperAdminGroup, 0);
                if (IsGroupUserExist && IsG2Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-25:Click on user group and select the Move Users tab
                usermanagement.SearchGroup(group1user[0], SuperAdminGroup, 0);
                usermanagement.SelectGroup(group1user[0], SuperAdminGroup);
                usermanagement.MoveUsrBtn().Click();
                if (usermanagement.ManageUserPopupWindow().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-26:search and select user and select ADD button
                usermanagement.FilterUserNameTextBox().Clear();
                usermanagement.FilterUserNameTextBox().SendKeys(group1user[2]);
                usermanagement.FilterUserNameSearchButton().Click();
                usermanagement.SearchAndSelectUser(group1user[2]);
                usermanagement.AddButtonInManageUsersPopup().Click();
                if (Driver.FindElement(By.CssSelector("#SelectedUsersTableBody tr[id^='Selected_'] span")).Text.ToLowerInvariant().Contains(group1user[2].ToLowerInvariant()))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-27:Select the Group destination on the bottom left under Move To:
                usermanagement.SelectMoveToElement(group2user[0]);
                if (Driver.FindElement(By.CssSelector("#hierarchyList_destination div[class='groupList collapsed itemListHighlight'] div[class='groupListTitleDiv'] ")).Text.ToLowerInvariant().Contains(group2user[0].ToLowerInvariant()))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-28:Select move
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(usermanagement.MoveButtonInManageUsersPopup()));
                PageLoadWait.WaitForPageLoad(20);
                usermanagement.MoveButtonInManageUsersPopup().Click();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                if (Driver.FindElements(By.CssSelector("#SelectedUsersTableBody tr")).Count == 0)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-29:Click on done
                PageLoadWait.WaitForPageLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(usermanagement.DoneButtonInManageUsersPopup()));
                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("arguments[0].click();", usermanagement.DoneButtonInManageUsersPopup());
                if (usermanagement.NewGrpBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-30:while group is still selected click on Edit Group
                PageLoadWait.WaitForPageLoad(10);
                usermanagement.SearchGroup(group2user[0], SuperAdminGroup, 0);
                usermanagement.SelectGroup(group2user[0], SuperAdminGroup);
                usermanagement.EditGrpBtn().Click();
                if (usermanagement.CreateAndEditGroupPopupWindow().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-31:Change some of the fields and click on"Save and View my Groups"
                PageLoadWait.WaitForPageLoad(10);
                PageLoadWait.WaitForFrameLoad(10);
                usermanagement.GroupDescTxtBox().SendKeys(" adding description");
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(usermanagement.SaveAndViewMyGroupBtn()));
                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("arguments[0].click();", usermanagement.SaveAndViewMyGroupBtn());
                PageLoadWait.WaitForFrameLoad(10);
                if (usermanagement.NewGrpBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-32:while group is still selected , click on the Delete group button.
                PageLoadWait.WaitForFrameLoad(10);
                usermanagement.SearchGroup(group2user[0], SuperAdminGroup, 0);
                usermanagement.SelectGroup(group2user[0], SuperAdminGroup);
                usermanagement.DelGrpBtn().Click();
                PageLoadWait.WaitForPageLoad(10);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                if (BasePage.Driver.FindElement(By.CssSelector("#DialogDiv #ConfirmationDiv")).Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                usermanagement.CancelButtonInConfirmGroupDeletionMsgBox().Click();

                //Step-33:Select Delete group again
                PageLoadWait.WaitForFrameLoad(10);
                usermanagement.SearchGroup(group2user[0], SuperAdminGroup, 0);
                usermanagement.SelectGroup(group2user[0], SuperAdminGroup);
                usermanagement.DelGrpBtn().Click();
                PageLoadWait.WaitForPageLoad(10);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                if (BasePage.Driver.FindElement(By.CssSelector("#DialogDiv #ConfirmationDiv")).Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-34:Click on Ok in the Confirmation dialog.
                PageLoadWait.WaitForPageLoad(20);
                usermanagement.OkButtonConfirmGroupDeletionMsgBox().Click();
                if (!usermanagement.SearchGroup(group2user[0], SuperAdminGroup, 0))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-35:Create two new groups G3 and G4
                usermanagement.CreateGroup(SuperAdminGroup, group3[0]);
                bool IsG3Exist = usermanagement.SearchGroup(group3[0], SuperAdminGroup, 0);
                usermanagement.CreateGroup(SuperAdminGroup, group4[0]);
                bool IsG4Exist = usermanagement.SearchGroup(group4[0], SuperAdminGroup, 0);
                if (IsG3Exist && IsG4Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-36:Select the group G3 and click on the Move Group button
                usermanagement.SearchGroup(group3[0], SuperAdminGroup, 0);
                usermanagement.SelectGroup(group3[0], SuperAdminGroup);
                usermanagement.MoveGrpBtn().Click();
                bool IsUngroupedListed = Driver.FindElements(By.CssSelector("#destGroupsDiv div[class ='groupListTitleDiv']")).Any(d1 => d1.Text.ToLowerInvariant().Contains("ungrouped".ToLowerInvariant()));
                if (IsUngroupedListed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-37:Select a group and click on Move
                usermanagement.SelectMoveToElement(group4[0]);
                usermanagement.MoveButtonInManageUsersPopup().Click();
                if (usermanagement.SearchGroup(group4[0], SuperAdminGroup, 0))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-38:Click on the Triangle ajacent to group, the triangle points UP/or DOWN. 
                //Click several times notice display changes.
                usermanagement.SearchGroup(group4[0], SuperAdminGroup, 0);
                PageLoadWait.WaitForFrameLoad(20);
                if (usermanagement.SelectSubGroup(group4[0], group3[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-39:Select the G4 group and click on the New SubGroup  button               
                usermanagement.SelectGroup(group4[0], SuperAdminGroup);
                ExecutedSteps++;

                //Step-40:Fill in all the fields and click on Save and View My groups
                usermanagement.CreateSubGroup(group4[0], SubGroup1, IsManaged: 0);
                if (usermanagement.SearchGroup(SubGroup1, SuperAdminGroup, check: 1))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-41:Enter group name in the search field and click on Search
                usermanagement.SearchGroup("G", SuperAdminGroup, 0);
                bool ta2as = Driver.FindElements(By.CssSelector("#hierarchyList_0 div[class ='groupListTitleDiv']")).Any(d1 => d1.Text.ToLowerInvariant().Contains("ungrouped".ToLowerInvariant()));
                if (ta2as)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Study search-multi component Exact-Ideographic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113203(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');                
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = Firstname.Split(':');
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = Lastname.Split(':');               
                String Datasource = "DCM4CHEE";
                //GridColumnNames               
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Prconditions- 
                //Open config tool and navigate to Study search tab.
                //Select 'Ideographic' radio button in 'UI study search filter' and click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");            
                servicetool.IdeographicRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;


                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                //Note- for all test cases use patient name Hong^Gildong
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol },1);
                studies.SearchStudy(LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);

                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in First Name field and click on search.
                //e.g. enter first name 'Gildong'
                studies.SearchStudy(FirstName: Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name 'Gidong'
                studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);

                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0])) && Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  First Name field and click on search.
                //e.g. enter first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  First Name field and click on search.
                //e.g. enter first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2])) && Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2])) && Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0])) && Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2])) && Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0])) && Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }
       
        /// <summary>
        /// Study search-multi component Any
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113205(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = Firstname.Split(':');
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = Lastname.Split(':');
                String Datasource = "DCM4CHEE";
                //GridColumnNames              
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Prconditions- 
                //Open config tool and navigate to Study search tab.
                //Select 'Any Component' option from dropdown list in 'UI study search filter' and click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("any");
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;


                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("#ctl00_LoginMasterContentPlaceHolder_LoginButton")));
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol },1);
                studies.SearchStudy(LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);

                if (results2.Count != 0 && columnvalues2.All(s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])))              
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in  First Name field and click on search.
                //e.g. enter first name 'Gildong'
                studies.SearchStudy(FirstName: Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && columnvalues3.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])))                   
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name 'Gidong'
                studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);

                if (results4.Count != 0 && columnvalues4_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues4_2.All( s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])) )                    
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && columnvalues5.All(s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])))                    
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  First Name field and click on search.
                //e.g. enter first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && columnvalues6.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && columnvalues7_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues7_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && columnvalues8.All(s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  First Name field and click on search.
                //e.g. enter first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && columnvalues9.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && columnvalues10_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues10_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && columnvalues11_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues11_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], LastName: Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && columnvalues12_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues12_2.All( s => s.Equals(Lastnames[0])||s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && columnvalues13_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues13_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[2], LastName: Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && columnvalues14_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues14_2.All( s => s.Equals(Lastnames[0])||s.Equals(Lastnames[1])|| s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && columnvalues15_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues15_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'
                studies.SearchStudy(FirstName: Firstnames[1], LastName: Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && columnvalues16_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues16_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }

        /// <summary>
        /// Patient name search-multi component Exact-Ideographic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113207(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = Firstname.Split(':');
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = Lastname.Split(':');               
                String Datasource = "DCM4CHEE";
                //GridColumnNames              
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Preconditions-
                //Open config tool. 
                //Go to 'Study search' tab. Select 'Ideographic' radio button option in 'UI study search filter' .
                //Click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.IdeographicRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();               
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(true);
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();

                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 0);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();
                ExecutedSteps++;


                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Patient Name Search' radio button.
                //Enter alphabetic last name in Patient Name field and click on search.
                //e.g. enter patient name as 'Hong' 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("#ctl00_LoginMasterContentPlaceHolder_LoginButton")));
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol },1);
                //studies.SearchStudy(LastName: Lastnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);

                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in  Patient Name field and click on search.
                //e.g. enter patient name as 'Gildong'
                //studies.SearchStudy(FirstName: Firstnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as 'Hong^Gidong' or 'Hong Gidong'
                //studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);

                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0])) && Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Patient Name field and click on search.
                //e.g. enter patient name as '?'
                studies.PatientNameSearch(Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  Patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Patient Name field and click on search.
                //e.g. enter patient name as '?'
                studies.PatientNameSearch(Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  Patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2])) && Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name 'Hong^??' or 'Hong ??'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name 'Hong^??' or 'Hong ??'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2])) && Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^Gildong' or '? Gildong'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0])) && Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2])) && Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^Gildong' or '? Gildong'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0])) && Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 1);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();

                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(false);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }

        /// <summary>
        /// Patient name search-multi component Any
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113209(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');               
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = Firstname.Split(':');
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = Lastname.Split(':');               
                String Datasource = "DCM4CHEE";
                //GridColumnNames                
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Prconditions- 
                //Open config tool and navigate to Study search tab.
                //Select 'Any Component' option from dropdown list in 'UI study search filter' and click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("any");
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(true);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();

                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 0);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();
                ExecutedSteps++;


                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Patient Name Search' radio button.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol },1);
                studies.PatientNameSearch(Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);

                if (results2.Count != 0 && columnvalues2.All(s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in  patient Name field and click on search.
                //e.g. enter patient name field 'Gildong'
                studies.PatientNameSearch(Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && columnvalues3.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and  first name separated by '^' or space in patient name field  and click on search.
                //e.g. enter patient  name as 'Hong^Gidong' or 'Hong Gidong'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);

                if (results4.Count != 0 && columnvalues4_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues4_2.All(s => s.Equals(Lastnames[0])||s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in patient Name field and click on search.
                //e.g. enter patient name '?'
                studies.PatientNameSearch(Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && columnvalues5.All(s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && columnvalues6.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name separated by '^' or space in patient name field  and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && columnvalues7_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues7_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Patient Name field and click on search.
                //e.g. enter patient name '?'
                studies.PatientNameSearch(Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && columnvalues8.All(s => s.Equals(Lastnames[0]) || s.Equals(Lastnames[1]) || s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && columnvalues9.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name separated by '^' or space in patient name field  and click on search.
                //e.g. enter last name '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && columnvalues10_1.All(s => s.Equals(Firstnames[0]) || s.Equals(Firstnames[1]) || s.Equals(Firstnames[2])) &&
                    columnvalues10_2.All( s => s.Equals(Lastnames[0])|| s.Equals(Lastnames[1])||s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 1);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();

                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(false);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }

        /// <summary>
        /// Study search-multi component
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113202(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String dataSourceName = "DCM4CHEE";
            String LstnameCol = GetStudyGridColName("Last Name");
            String FstnameCol = GetStudyGridColName("First Name");

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String LastNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String FirstNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");

                String[] Langs = Languages.Split(':');
                String[] LastName = LastNames.Split(':');
                String[] FirstName = FirstNames.Split(':');

                //Step 1 - Precondition                
                servicetool.LaunchServiceTool();
                servicetool.NavigateToConfigToolDataSourceTab();
                wpfobject.WaitTillLoad();
                GroupBox datasource_grp = wpfobject.GetAnyUIItem<ITabPage, GroupBox>(servicetool.GetCurrentTabItem(), ServiceTool.DataSource.Name.DataSourceList_grp, 1);
                ListView datasource_view = wpfobject.GetAnyUIItem<GroupBox, ListView>(datasource_grp, "ListView");
                foreach (var row in datasource_view.Rows)
                {
                    if (row.Cells[0].Text.Equals(dataSourceName))
                    {
                        row.Focus();
                        row.Click();
                        wpfobject.WaitTillLoad();
                        row.Cells[0].DoubleClick();
                        wpfobject.WaitTillLoad();
                        break;
                    }
                }
                wpfobject.GetMainWindowByTitle(ServiceTool.DataSource.Name.EditDataSource_Window);
                servicetool.wpfobject.WaitTillLoad();
                wpfobject.SelectTabFromTabItems(ServiceTool.DataSource.Name.Dicom_Tab);
                Thread.Sleep(3000);
                wpfobject.SelectCheckBox("specificCharacterSet", 1);
                wpfobject.SelectCheckBox("Include multi - component Person Name separator in C FIND", 1);
                wpfobject.GetMainWindowByTitle(ServiceTool.DataSource.Name.EditDataSource_Window);
                wpfobject.ClickButton(ServiceTool.DataSource.ID.OkBtn);
                wpfobject.WaitTillLoad();
                Thread.Sleep(3000);
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                wpfobject.WaitTillLoad();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;                

                //Step 2 - Login to iCA and go to Studies tab. Select 'DCM4CHEE' from Datasource list. Enter alphabetic last name in Last Name field and click on search.   
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol }, 1);

                studies.SearchStudy(LastName: LastName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step2_results = BasePage.GetSearchResults();
                string[] step2_columnnames = BasePage.GetColumnNames();
                string[] step2_columnvalues = BasePage.GetColumnValues(step2_results, LstnameCol, step2_columnnames);
                if (step2_results.Count != 0 && Array.TrueForAll(step2_columnvalues, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Enter alphabetic first name in First Name field and click on search.                
                studies.SearchStudy(FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step3_results = BasePage.GetSearchResults();
                string[] step3_columnnames = BasePage.GetColumnNames();
                string[] step3_columnvalues = BasePage.GetColumnValues(step3_results, FstnameCol, step3_columnnames);
                if (step3_results.Count != 0 && Array.TrueForAll(step3_columnvalues, s => s.Equals(FirstName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search.
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step4_results = BasePage.GetSearchResults();
                string[] step4_columnnames = BasePage.GetColumnNames();
                string[] step4_columnvaluesFst = BasePage.GetColumnValues(step4_results, FstnameCol, step4_columnnames);
                string[] step4_columnvaluesLst = BasePage.GetColumnValues(step4_results, LstnameCol, step4_columnnames);
                if (step4_results.Count != 0 && Array.TrueForAll(step4_columnvaluesFst, s => s.Equals(FirstName[0])) &&
                    Array.TrueForAll(step4_columnvaluesLst, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Enter ideographic last name in Last Name field and click on search.
                studies.SearchStudy(LastName: LastName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step5_results = BasePage.GetSearchResults();
                string[] step5_columnnames = BasePage.GetColumnNames();
                string[] step5_columnvalues = BasePage.GetColumnValues(step5_results, LstnameCol, step5_columnnames);
                if (step5_results.Count != 0 && Array.TrueForAll(step5_columnvalues, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Enter ideographic first name in First Name field and click on search. e.g. enter first name '??'
                studies.SearchStudy(FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step6_results = BasePage.GetSearchResults();
                string[] step6_columnnames = BasePage.GetColumnNames();
                string[] step6_columnvalues = BasePage.GetColumnValues(step6_results, FstnameCol, step6_columnnames);
                if (step6_results.Count != 0 && Array.TrueForAll(step6_columnvalues, s => s.Equals(FirstName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Enter ideographic last name and first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[1], FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step7_results = BasePage.GetSearchResults();
                string[] step7_columnnames = BasePage.GetColumnNames();
                string[] step7_columnvaluesFst = BasePage.GetColumnValues(step7_results, FstnameCol, step7_columnnames);
                string[] step7_columnvaluesLst = BasePage.GetColumnValues(step7_results, LstnameCol, step7_columnnames);
                if (step7_results.Count != 0 && Array.TrueForAll(step7_columnvaluesFst, s => s.Equals(FirstName[1])) &&
                    Array.TrueForAll(step7_columnvaluesLst, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Enter phonetic last name in Last Name field and click on search. e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: LastName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step8_results = BasePage.GetSearchResults();
                string[] step8_columnnames = BasePage.GetColumnNames();
                string[] step8_columnvalues = BasePage.GetColumnValues(step8_results, LstnameCol, step8_columnnames);
                if (step8_results.Count != 0 && Array.TrueForAll(step8_columnvalues, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Enter phonetic first name in First Name field and click on search. e.g. enter first name '??'
                studies.SearchStudy(FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step9_results = BasePage.GetSearchResults();
                string[] step9_columnnames = BasePage.GetColumnNames();
                string[] step9_columnvalues = BasePage.GetColumnValues(step9_results, FstnameCol, step9_columnnames);
                if (step9_results.Count != 0 && Array.TrueForAll(step9_columnvalues, s => s.Equals(FirstName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Enter phonetic last name and first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[2], FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step10_results = BasePage.GetSearchResults();
                string[] step10_columnnames = BasePage.GetColumnNames();
                string[] step10_columnvaluesFst = BasePage.GetColumnValues(step10_results, FstnameCol, step10_columnnames);
                string[] step10_columnvaluesLst = BasePage.GetColumnValues(step10_results, LstnameCol, step10_columnnames);
                if (step10_results.Count != 0 && Array.TrueForAll(step10_columnvaluesFst, s => s.Equals(FirstName[2])) &&
                    Array.TrueForAll(step10_columnvaluesLst, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Enter alphabetic last name and ideographic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step11_results = BasePage.GetSearchResults();
                string[] step11_columnnames = BasePage.GetColumnNames();
                string[] step11_columnvaluesFst = BasePage.GetColumnValues(step11_results, FstnameCol, step11_columnnames);
                string[] step11_columnvaluesLst = BasePage.GetColumnValues(step11_results, LstnameCol, step11_columnnames);
                if (step11_results.Count != 0 && Array.TrueForAll(step11_columnvaluesFst, s => s.Equals(FirstName[1])) &&
                    Array.TrueForAll(step11_columnvaluesLst, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Enter alphabetic last name and phonetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name 'Hong' and first name '??'                
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step12_results = BasePage.GetSearchResults();
                string[] step12_columnnames = BasePage.GetColumnNames();
                string[] step12_columnvaluesFst = BasePage.GetColumnValues(step12_results, FstnameCol, step12_columnnames);
                string[] step12_columnvaluesLst = BasePage.GetColumnValues(step12_results, LstnameCol, step12_columnnames);
                if (step12_results.Count != 0 && Array.TrueForAll(step12_columnvaluesFst, s => s.Equals(FirstName[2])) &&
                    Array.TrueForAll(step12_columnvaluesLst, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Enter Ideographic last name and alphabetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(LastName: LastName[1], FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step13_results = BasePage.GetSearchResults();
                string[] step13_columnnames = BasePage.GetColumnNames();
                string[] step13_columnvaluesFst = BasePage.GetColumnValues(step13_results, FstnameCol, step13_columnnames);
                string[] step13_columnvaluesLst = BasePage.GetColumnValues(step13_results, LstnameCol, step13_columnnames);
                if (step13_results.Count != 0 && Array.TrueForAll(step13_columnvaluesFst, s => s.Equals(FirstName[0])) &&
                    Array.TrueForAll(step13_columnvaluesLst, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 14 - Enter Ideographic last name and phonetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[1], FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step14_results = BasePage.GetSearchResults();
                string[] step14_columnnames = BasePage.GetColumnNames();
                string[] step14_columnvaluesFst = BasePage.GetColumnValues(step14_results, FstnameCol, step14_columnnames);
                string[] step14_columnvaluesLst = BasePage.GetColumnValues(step14_results, LstnameCol, step14_columnnames);
                if (step14_results.Count != 0 && Array.TrueForAll(step14_columnvaluesFst, s => s.Equals(FirstName[2])) &&
                    Array.TrueForAll(step14_columnvaluesLst, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 15 - Enter phonetic last name and alphabetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(LastName: LastName[2], FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step15_results = BasePage.GetSearchResults();
                string[] step15_columnnames = BasePage.GetColumnNames();
                string[] step15_columnvaluesFst = BasePage.GetColumnValues(step15_results, FstnameCol, step15_columnnames);
                string[] step15_columnvaluesLst = BasePage.GetColumnValues(step15_results, LstnameCol, step15_columnnames);
                if (step15_results.Count != 0 && Array.TrueForAll(step15_columnvaluesFst, s => s.Equals(FirstName[0])) &&
                    Array.TrueForAll(step15_columnvaluesLst, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 16 - Enter phonetic last name and ideographic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[2], FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step16_results = BasePage.GetSearchResults();
                string[] step16_columnnames = BasePage.GetColumnNames();
                string[] step16_columnvaluesFst = BasePage.GetColumnValues(step16_results, FstnameCol, step16_columnnames);
                string[] step16_columnvaluesLst = BasePage.GetColumnValues(step16_results, LstnameCol, step16_columnnames);
                if (step16_results.Count != 0 && Array.TrueForAll(step16_columnvaluesFst, s => s.Equals(FirstName[1])) &&
                    Array.TrueForAll(step16_columnvaluesLst, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Study search-multi component Exact-phonetic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113204(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String dataSourceName = "DCM4CHEE";
            String LstnameCol = GetStudyGridColName("Last Name");
            String FstnameCol = GetStudyGridColName("First Name");

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String LastNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String FirstNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");

                String[] Langs = Languages.Split(':');
                String[] LastName = LastNames.Split(':');
                String[] FirstName = FirstNames.Split(':');

                //Step 1 - Precondition                
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.PhoneticRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;

                //Step 2 - enter last name 'Hong' for above patient name example
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");

                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol }, 1);
                studies.SearchStudy(LastName: LastName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step2_results = BasePage.GetSearchResults();
                string[] step2_columnnames = BasePage.GetColumnNames();
                string[] step2_columnvalues = BasePage.GetColumnValues(step2_results, LstnameCol, step2_columnnames);
                if (step2_results.Count != 0 && Array.TrueForAll(step2_columnvalues, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Enter alphabetic first name in First Name field and click on search. e.g. enter first name 'Gildong'
                studies.SearchStudy(FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step3_results = BasePage.GetSearchResults();
                string[] step3_columnnames = BasePage.GetColumnNames();
                string[] step3_columnvalues = BasePage.GetColumnValues(step3_results, FstnameCol, step3_columnnames);
                if (step3_results.Count != 0 && Array.TrueForAll(step3_columnvalues, s => s.Equals(FirstName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search. e.g. enter last name 'Hong' and first name 'Gidong'
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step4_results = BasePage.GetSearchResults();
                string[] step4_columnnames = BasePage.GetColumnNames();
                string[] step4_columnvalueslst = BasePage.GetColumnValues(step4_results, LstnameCol, step4_columnnames);
                string[] step4_columnvaluesfst = BasePage.GetColumnValues(step4_results, FstnameCol, step4_columnnames);
                if (step4_results.Count != 0 && Array.TrueForAll(step4_columnvalueslst, s => s.Equals(LastName[0])) &&
                    Array.TrueForAll(step4_columnvaluesfst, s => s.Equals(FirstName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Enter ideographic last name in Last Name field and click on search.e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: LastName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step5_results = BasePage.GetSearchResults();
                string[] step5_columnnames = BasePage.GetColumnNames();
                string[] step5_columnvalues = BasePage.GetColumnValues(step5_results, LstnameCol, step5_columnnames);
                if (step5_results.Count != 0 && Array.TrueForAll(step5_columnvalues, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Enter ideographic first name in First Name field and click on search. e.g. enter first name '??'
                studies.SearchStudy(FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step6_results = BasePage.GetSearchResults();
                string[] step6_columnnames = BasePage.GetColumnNames();
                string[] step6_columnvalues = BasePage.GetColumnValues(step6_results, FstnameCol, step6_columnnames);
                if (step6_results.Count != 0 && Array.TrueForAll(step6_columnvalues, s => s.Equals(FirstName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Enter ideographic last name and first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[1], FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step7_results = BasePage.GetSearchResults();
                string[] step7_columnnames = BasePage.GetColumnNames();
                string[] step7_columnvaluesLst = BasePage.GetColumnValues(step7_results, LstnameCol, step7_columnnames);
                string[] step7_columnvaluesFst = BasePage.GetColumnValues(step7_results, FstnameCol, step7_columnnames);
                if (step7_results.Count != 0 && Array.TrueForAll(step7_columnvaluesFst, s => s.Equals(FirstName[1])) &&
                    Array.TrueForAll(step7_columnvaluesLst, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Enter phonetic last name in Last Name field and click on search. e.g. enter last name '?' for above patient name example
                studies.SearchStudy(LastName: LastName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step8_results = BasePage.GetSearchResults();
                string[] step8_columnnames = BasePage.GetColumnNames();
                string[] step8_columnvalues = BasePage.GetColumnValues(step8_results, LstnameCol, step8_columnnames);
                if (step8_results.Count != 0 && Array.TrueForAll(step8_columnvalues, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Enter phonetic first name in First Name field and click on search. e.g. enter first name '??'
                studies.SearchStudy(FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step9_results = BasePage.GetSearchResults();
                string[] step9_columnnames = BasePage.GetColumnNames();
                string[] step9_columnvalues = BasePage.GetColumnValues(step9_results, FstnameCol, step9_columnnames);
                if (step9_results.Count != 0 && Array.TrueForAll(step9_columnvalues, s => s.Equals(FirstName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Enter phonetic last name and first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[2], FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step10_results = BasePage.GetSearchResults();
                string[] step10_columnnames = BasePage.GetColumnNames();
                string[] step10_columnvaluesLst = BasePage.GetColumnValues(step10_results, LstnameCol, step10_columnnames);
                string[] step10_columnvaluesFst = BasePage.GetColumnValues(step10_results, FstnameCol, step10_columnnames);
                if (step10_results.Count != 0 && Array.TrueForAll(step10_columnvaluesFst, s => s.Equals(FirstName[2])) &&
                    Array.TrueForAll(step10_columnvaluesLst, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Enter alphabetic last name and ideographic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step11_results = BasePage.GetSearchResults();
                string[] step11_columnnames = BasePage.GetColumnNames();
                string[] step11_columnvaluesFst = BasePage.GetColumnValues(step11_results, FstnameCol, step11_columnnames);
                string[] step11_columnvaluesLst = BasePage.GetColumnValues(step11_results, LstnameCol, step11_columnnames);
                if (step11_results.Count != 0 && Array.TrueForAll(step11_columnvaluesFst, s => s.Equals(FirstName[1])) &&
                    Array.TrueForAll(step11_columnvaluesLst, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Enter alphabetic last name and phonetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name 'Hong' and first name '??'
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step12_results = BasePage.GetSearchResults();
                string[] step12_columnnames = BasePage.GetColumnNames();
                string[] step12_columnvaluesFst = BasePage.GetColumnValues(step12_results, FstnameCol, step12_columnnames);
                string[] step12_columnvaluesLst = BasePage.GetColumnValues(step12_results, LstnameCol, step12_columnnames);
                if (step12_results.Count != 0 && Array.TrueForAll(step12_columnvaluesFst, s => s.Equals(FirstName[2])) &&
                    Array.TrueForAll(step12_columnvaluesLst, s => s.Equals(LastName[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Enter Ideographic last name and alphabetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(LastName: LastName[1], FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step13_results = BasePage.GetSearchResults();
                string[] step13_columnnames = BasePage.GetColumnNames();
                string[] step13_columnvaluesFst = BasePage.GetColumnValues(step13_results, FstnameCol, step13_columnnames);
                string[] step13_columnvaluesLst = BasePage.GetColumnValues(step13_results, LstnameCol, step13_columnnames);
                if (step13_results.Count != 0 && Array.TrueForAll(step13_columnvaluesFst, s => s.Equals(FirstName[0])) &&
                    Array.TrueForAll(step13_columnvaluesLst, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 14 - Enter Ideographic last name and phonetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[1], FirstName: FirstName[2], Datasource: dataSourceName);
                Dictionary<int, string[]> step14_results = BasePage.GetSearchResults();
                string[] step14_columnnames = BasePage.GetColumnNames();
                string[] step14_columnvaluesFst = BasePage.GetColumnValues(step14_results, FstnameCol, step14_columnnames);
                string[] step14_columnvaluesLst = BasePage.GetColumnValues(step14_results, LstnameCol, step14_columnnames);
                if (step14_results.Count != 0 && Array.TrueForAll(step14_columnvaluesFst, s => s.Equals(FirstName[2])) &&
                    Array.TrueForAll(step14_columnvaluesLst, s => s.Equals(LastName[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 15 - Enter phonetic last name and alphabetic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name 'Gildong'
                studies.SearchStudy(LastName: LastName[2], FirstName: FirstName[0], Datasource: dataSourceName);
                Dictionary<int, string[]> step15_results = BasePage.GetSearchResults();
                string[] step15_columnnames = BasePage.GetColumnNames();
                string[] step15_columnvaluesFst = BasePage.GetColumnValues(step15_results, FstnameCol, step15_columnnames);
                string[] step15_columnvaluesLst = BasePage.GetColumnValues(step15_results, LstnameCol, step15_columnnames);
                if (step15_results.Count != 0 && Array.TrueForAll(step15_columnvaluesFst, s => s.Equals(FirstName[0])) &&
                    Array.TrueForAll(step15_columnvaluesLst, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 16 - Enter phonetic last name and ideographic first name in Last Name and First Name fields respectively and click on search. e.g. enter last name '?' and first name '??'
                studies.SearchStudy(LastName: LastName[2], FirstName: FirstName[1], Datasource: dataSourceName);
                Dictionary<int, string[]> step16_results = BasePage.GetSearchResults();
                string[] step16_columnnames = BasePage.GetColumnNames();
                string[] step16_columnvaluesFst = BasePage.GetColumnValues(step16_results, FstnameCol, step16_columnnames);
                string[] step16_columnvaluesLst = BasePage.GetColumnValues(step16_results, LstnameCol, step16_columnnames);
                if (step16_results.Count != 0 && Array.TrueForAll(step16_columnvaluesFst, s => s.Equals(FirstName[1])) &&
                    Array.TrueForAll(step16_columnvaluesLst, s => s.Equals(LastName[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }
        
        /// <summary>
        /// Patient name search-multi component Exact-Alphabetic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113206(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Datasource = "DCM4CHEE";

                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");

                String[] Langs = Languages.Split(':');
                String[] Firstnames = Firstname.Split(':');
                String[] Lastnames = Lastname.Split(':');

                //GridColumnNames              
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Preconditions-
                //Open config tool. 
                //Go to 'Study search' tab. Select 'Phonetic' radio button option in 'UI study search filter' .
                //Click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(true);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();

                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 0);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();
                ExecutedSteps++;

                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Patient Name Search' radio button.
                //Enter alphabetic last name in Patient Name field and click on search.
                //e.g. enter patient name as 'Hong' 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol }, 1);

                studies.PatientNameSearch(Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);
                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in  Patient Name field and click on search.
                //e.g. enter patient name as 'Gildong'
                //studies.SearchStudy(FirstName: Firstnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);
                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as 'Hong^Gidong' or 'Hong Gidong'
                //studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);
                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0])) &&
                    Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Patient Name field and click on search.
                //e.g. enter patient name as '?'
                studies.PatientNameSearch(Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);
                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  Patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);
                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);
                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) &&
                    Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Patient Name field and click on search.
                //e.g. enter patient name as '?'
                studies.PatientNameSearch(Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);
                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  Patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);
                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);
                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2])) &&
                    Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name 'Hong^??' or 'Hong ??'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);
                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1])) &&
                    Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name 'Hong^??' or 'Hong ??'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);
                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2])) &&
                    Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^Gildong' or '? Gildong'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);
                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0])) &&
                    Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);
                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2])) &&
                    Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^Gildong' or '? Gildong'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);
                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0])) &&
                    Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);
                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1])) &&
                    Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 1);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();

                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(false);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }

        /// <summary>
        /// Patient name search-multi component Exact-Phonetic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113208(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Datasource = "DCM4CHEE";

                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");

                String[] Langs = Languages.Split(':');
                String[] Firstnames = Firstname.Split(':');
                String[] Lastnames = Lastname.Split(':');

                //GridColumnNames              
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Preconditions-
                //Open config tool. 
                //Go to 'Study search' tab. Select 'Phonetic' radio button option in 'UI study search filter' .
                //Click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.PhoneticRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(true);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();

                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 0);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();
                ExecutedSteps++;

                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Patient Name Search' radio button.
                //Enter alphabetic last name in Patient Name field and click on search.
                //e.g. enter patient name as 'Hong' 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol }, 1);

                studies.PatientNameSearch(Lastnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);
                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in  Patient Name field and click on search.
                //e.g. enter patient name as 'Gildong'
                //studies.SearchStudy(FirstName: Firstnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);
                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as 'Hong^Gidong' or 'Hong Gidong'
                //studies.SearchStudy(FirstName: Firstnames[0], LastName: Lastnames[0], Datasource: Datasource);
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);
                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0])) &&
                    Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Patient Name field and click on search.
                //e.g. enter patient name as '?'
                studies.PatientNameSearch(Lastnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);
                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  Patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);
                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);
                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) &&
                    Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Patient Name field and click on search.
                //e.g. enter patient name as '?'
                studies.PatientNameSearch(Lastnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);
                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  Patient Name field and click on search.
                //e.g. enter patient name as '??'
                studies.PatientNameSearch(Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);
                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);
                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2])) &&
                    Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name 'Hong^??' or 'Hong ??'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);
                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1])) &&
                    Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name 'Hong^??' or 'Hong ??'
                studies.PatientNameSearch(Lastnames[0] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);
                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2])) &&
                    Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^Gildong' or '? Gildong'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);
                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0])) &&
                    Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[1] + "^" + Firstnames[2], Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);
                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2])) &&
                    Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^Gildong' or '? Gildong'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[0], Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);
                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0])) &&
                    Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name separated by '^' or space in patient Name field and click on search.
                //e.g. enter patient name as '?^??' or '? ??'
                studies.PatientNameSearch(Lastnames[2] + "^" + Firstnames[1], Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);
                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1])) &&
                    Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("patientnamesearch", 1);
                domainmanagement.ClickSaveNewDomain();
                login.Logout();

                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.NavigateToEnableFeatures();
                servicetool.ClickModifyFromTab();
                servicetool.EnablePatientNameSearch(false);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }

        /// <summary>
        /// Emergeny search multi component Exact-Alphabetic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113210(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            DomainManagement domain;
            Studies studies;
            RoleManagement role;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data    
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String DOB = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DOB");
                String Modality = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Modality");
                String Gender = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Gender");
                String Datasource = "DCM4CHEE";

                String[] Langs = Languages.Split(':');
                String[] Firstnames = Firstname.Split(':');
                String[] Lastnames = Lastname.Split(':');

                //GridColumnNames               
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Precondition: - Open config tool and naviagate to Enable features->General tab ,and select 'Enable Emergency Access' checkbox and click on apply.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableEmergencyAccess();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();

                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();

                login.DriverGoTo(url);
                login.LoginIConnect(AdminUsername, AdminPassword);
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("emergency", 0);
                domain.ClickSaveNewDomain();
                role = login.Navigate<RoleManagement>();
                role.SearchRole(SuperRole, SuperAdminGroup);
                role.SelectRole(SuperRole);
                role.ClickEditRole();
                role.SetCheckboxInEditRole("emergency", 0);
                role.ClickSaveEditRole();
                login.Logout();
                ExecutedSteps++;

                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Emergancy Access' radio button option.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SelectEmergencySearch();
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol });
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);
                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in First Name field and click on search.
                //e.g. enter first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name 'Gidong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);
                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0]))
                                        && Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  First Name field and click on search.
                //e.g. enter first name '??'                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  First Name field and click on search.
                //e.g. enter first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'              
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Emergeny search multi component Exact-Ideographic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113211(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            DomainManagement domain;
            Studies studies;
            RoleManagement role;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data    
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String DOB = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DOB");
                String Modality = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Modality");
                String Gender = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Gender");
                String Datasource = "DCM4CHEE";

                String[] Langs = Languages.Split(':');
                String[] Firstnames = Firstname.Split(':');
                String[] Lastnames = Lastname.Split(':');

                //GridColumnNames               
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Prconditions: 
                //Open config tool and navigate to Study search tab.
                //Select 'Ideographic' radio button in 'UI study search filter' and click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.IdeographicRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;

                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Emergancy Access' radio button option.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SelectEmergencySearch();
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol });
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);
                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in First Name field and click on search.
                //e.g. enter first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name 'Gidong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);
                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0]))
                                        && Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  First Name field and click on search.
                //e.g. enter first name '??'                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  First Name field and click on search.
                //e.g. enter first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'              
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Emergeny search multi component Exact-Phonetic
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113212(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data    
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String DOB = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DOB");
                String Gender = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Gender");
                String Datasource = "DCM4CHEE";

                String[] Langs = Languages.Split(':');
                String[] Firstnames = Firstname.Split(':');
                String[] Lastnames = Lastname.Split(':');

                //GridColumnNames               
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Prconditions: 
                //Open config tool and navigate to Study search tab.
                //Select 'Ideographic' radio button in 'UI study search filter' and click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.PhoneticRadioBtn().Click();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;

                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Emergancy Access' radio button option.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SelectEmergencySearch();
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol });
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);
                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in First Name field and click on search.
                //e.g. enter first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name 'Gidong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);
                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0]))
                                        && Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  First Name field and click on search.
                //e.g. enter first name '??'                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  First Name field and click on search.
                //e.g. enter first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'              
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Emergeny search multi component Any
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_113213(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            DomainManagement domain;
            Studies studies;
            RoleManagement role;
            String SuperAdminGroup = Config.adminGroupName;
            String SuperRole = Config.adminRoleName;


            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = Firstname.Split(':');
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = Lastname.Split(':');
                String DOB = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DOB");
                String Modality = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Modality");
                String Gender = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Gender");
                String Datasource = "DCM4CHEE";
                //GridColumnNames               
                String LstnameCol = GetStudyGridColName("Last Name");
                String FstnameCol = GetStudyGridColName("First Name");

                //Step:1-Prconditions: 
                //Open config tool and navigate to Study search tab.
                //Select 'Any Component' option from dropdown list in 'UI study search filter' and click on 'Apply' and restart IIS.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("any");
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;

                //Step:2-Login to iCA and go to Studies tab.Select 'DCM4CHEE' from Datasource list.
                //Select 'Emergancy Access' radio button option.
                //Enter alphabetic last name in Last Name field and click on search.
                //e.g. enter last name 'Hong' for above patient name example 
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SelectEmergencySearch();
                studies.ChooseColumns(new string[] { LstnameCol, FstnameCol });
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results2 = BasePage.GetSearchResults();
                string[] columnnames2 = BasePage.GetColumnNames();
                string[] columnvalues2 = BasePage.GetColumnValues(results2, LstnameCol, columnnames2);
                if (results2.Count != 0 && Array.TrueForAll(columnvalues2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Enter alphabetic first name in First Name field and click on search.
                //e.g. enter first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results3 = BasePage.GetSearchResults();
                string[] columnnames3 = BasePage.GetColumnNames();
                string[] columnvalues3 = BasePage.GetColumnValues(results3, FstnameCol, columnnames3);

                if (results3.Count != 0 && Array.TrueForAll(columnvalues3, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-4:Enter alphabetic last name and first name in Last Name and First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name 'Gidong'               
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results4 = BasePage.GetSearchResults();
                string[] columnnames4 = BasePage.GetColumnNames();
                string[] columnvalues4_1 = BasePage.GetColumnValues(results4, FstnameCol, columnnames4);
                string[] columnvalues4_2 = BasePage.GetColumnValues(results4, LstnameCol, columnnames4);
                if (results4.Count != 0 && Array.TrueForAll(columnvalues4_1, s => s.Equals(Firstnames[0]))
                                        && Array.TrueForAll(columnvalues4_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Enter ideographic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results5 = BasePage.GetSearchResults();
                string[] columnnames5 = BasePage.GetColumnNames();
                string[] columnvalues5 = BasePage.GetColumnValues(results5, LstnameCol, columnnames5);

                if (results5.Count != 0 && Array.TrueForAll(columnvalues5, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Enter ideographic first name in  First Name field and click on search.
                //e.g. enter first name '??'                
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results6 = BasePage.GetSearchResults();
                string[] columnnames6 = BasePage.GetColumnNames();
                string[] columnvalues6 = BasePage.GetColumnValues(results6, FstnameCol, columnnames6);

                if (results6.Count != 0 && Array.TrueForAll(columnvalues6, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Enter ideographic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results7 = BasePage.GetSearchResults();
                string[] columnnames7 = BasePage.GetColumnNames();
                string[] columnvalues7_1 = BasePage.GetColumnValues(results7, FstnameCol, columnnames7);
                string[] columnvalues7_2 = BasePage.GetColumnValues(results7, LstnameCol, columnnames7);

                if (results7.Count != 0 && Array.TrueForAll(columnvalues7_1, s => s.Equals(Firstnames[1])) && Array.TrueForAll(columnvalues7_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Enter phonetic last name in Last Name field and click on search.
                //e.g. enter last name '?' for above patient name example               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, LstnameCol, columnnames8);

                if (results8.Count != 0 && Array.TrueForAll(columnvalues8, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Enter phonetic first name in  First Name field and click on search.
                //e.g. enter first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results9 = BasePage.GetSearchResults();
                string[] columnnames9 = BasePage.GetColumnNames();
                string[] columnvalues9 = BasePage.GetColumnValues(results9, FstnameCol, columnnames9);

                if (results9.Count != 0 && Array.TrueForAll(columnvalues9, s => s.Equals(Firstnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10:Enter phonetic last name and  first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results10 = BasePage.GetSearchResults();
                string[] columnnames10 = BasePage.GetColumnNames();
                string[] columnvalues10_1 = BasePage.GetColumnValues(results10, FstnameCol, columnnames10);
                string[] columnvalues10_2 = BasePage.GetColumnValues(results10, LstnameCol, columnnames10);

                if (results10.Count != 0 && Array.TrueForAll(columnvalues10_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues10_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Enter alphabetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results11 = BasePage.GetSearchResults();
                string[] columnnames11 = BasePage.GetColumnNames();
                string[] columnvalues11_1 = BasePage.GetColumnValues(results11, FstnameCol, columnnames11);
                string[] columnvalues11_2 = BasePage.GetColumnValues(results11, LstnameCol, columnnames11);

                if (results11.Count != 0 && Array.TrueForAll(columnvalues11_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues11_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:Enter alphabetic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name 'Hong' and first name '??'                
                studies.EmergencySearchStudy(Lastnames[0], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results12 = BasePage.GetSearchResults();
                string[] columnnames12 = BasePage.GetColumnNames();
                string[] columnvalues12_1 = BasePage.GetColumnValues(results12, FstnameCol, columnnames12);
                string[] columnvalues12_2 = BasePage.GetColumnValues(results12, LstnameCol, columnnames12);

                if (results12.Count != 0 && Array.TrueForAll(columnvalues12_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues12_2, s => s.Equals(Lastnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-13:Enter Ideographic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results13 = BasePage.GetSearchResults();
                string[] columnnames13 = BasePage.GetColumnNames();
                string[] columnvalues13_1 = BasePage.GetColumnValues(results13, FstnameCol, columnnames13);
                string[] columnvalues13_2 = BasePage.GetColumnValues(results13, LstnameCol, columnnames13);

                if (results13.Count != 0 && Array.TrueForAll(columnvalues13_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues13_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Enter Ideographic last name and phonetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'              
                studies.EmergencySearchStudy(Lastnames[1], Firstnames[2], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results14 = BasePage.GetSearchResults();
                string[] columnnames14 = BasePage.GetColumnNames();
                string[] columnvalues14_1 = BasePage.GetColumnValues(results14, FstnameCol, columnnames14);
                string[] columnvalues14_2 = BasePage.GetColumnValues(results14, LstnameCol, columnnames14);

                if (results14.Count != 0 && Array.TrueForAll(columnvalues14_1, s => s.Equals(Firstnames[2]))
                                         && Array.TrueForAll(columnvalues14_2, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Enter phonetic last name and alphabetic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name 'Gildong'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[0], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results15 = BasePage.GetSearchResults();
                string[] columnnames15 = BasePage.GetColumnNames();
                string[] columnvalues15_1 = BasePage.GetColumnValues(results15, FstnameCol, columnnames15);
                string[] columnvalues15_2 = BasePage.GetColumnValues(results15, LstnameCol, columnnames15);

                if (results15.Count != 0 && Array.TrueForAll(columnvalues15_1, s => s.Equals(Firstnames[0]))
                                         && Array.TrueForAll(columnvalues15_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Enter phonetic last name and ideographic first name in Last Name and  First Name fields respectively and click on search.
                //e.g. enter last name '?' and first name '??'               
                studies.EmergencySearchStudy(Lastnames[2], Firstnames[1], Gender, DOB, Datasource: Datasource);
                Dictionary<int, string[]> results16 = BasePage.GetSearchResults();
                string[] columnnames16 = BasePage.GetColumnNames();
                string[] columnvalues16_1 = BasePage.GetColumnValues(results16, FstnameCol, columnnames16);
                string[] columnvalues16_2 = BasePage.GetColumnValues(results16, LstnameCol, columnnames16);

                if (results16.Count != 0 && Array.TrueForAll(columnvalues16_1, s => s.Equals(Firstnames[1]))
                                         && Array.TrueForAll(columnvalues16_2, s => s.Equals(Lastnames[2])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                //Resetting in Service tool
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();

                //ICA
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                role = login.Navigate<RoleManagement>();
                role.SearchRole(SuperRole, SuperAdminGroup);
                role.SelectRole(SuperRole);
                role.ClickEditRole();
                role.SetCheckboxInEditRole("emergency", 1);
                role.ClickSaveEditRole();
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("emergency", 1);
                domain.ClickSaveNewDomain();
                login.Logout();
            }
        }

        /// <summary>
        /// Email Study to non-registered user
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90598(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            string EnableEmailmsg = "This action enables the email study feature. As a result, protected health information may be sent to non-registered users. Do you want to continue?";

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            DateTime now = DateTime.Now;
            string t1 = now.ToString();
            string[] st = t1.Split(' ');

            try
            {
                //Fetch required Test data
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String Emails = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Email");
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String Reason = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");

                String[] Name = Names.Split(':');
                String[] Langs = Languages.Split(':');
                String[] Email = Emails.Split(':');
                String[] Accessions = AccessionList.Split(':');

                //Step 1 - Precondition
                servicetool.LaunchServiceTool();
                servicetool.SetEmailNotification();

                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                CheckBox EmailStudy = wpfobject.GetAnyUIItem<Panel, CheckBox>(wpfobject.GetCurrentPane(), "Enable Email Study", 1);
                if (EmailStudy.Checked)
                {
                    EmailStudy.Click();
                    wpfobject.WaitTillLoad();
                    servicetool.ApplyEnableFeatures();
                    wpfobject.WaitTillLoad();
                    servicetool.wpfobject.ClickOkPopUp();
                    servicetool.RestartService();
                    wpfobject.WaitTillLoad();
                }
                ExecutedSteps++;

                //Step 2 - From the Enable Features tab --> Select Enable Email Study check box.
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                servicetool.WaitWhileBusy();
                CheckBox EmailStudy2 = wpfobject.GetAnyUIItem<Panel, CheckBox>(wpfobject.GetCurrentPane(), ServiceTool.EnableFeatures.Name.EnableEmailStudy, 1);
                string msg = "";
                if (!EmailStudy2.Checked)
                {
                    CheckBox EmailStudyChkBox = wpfobject.GetAnyUIItem<Panel, CheckBox>(wpfobject.GetCurrentPane(), ServiceTool.EnableFeatures.Name.EnableEmailStudy, 1);
                    EmailStudyChkBox.Checked = true;
                    Window dialog = WpfObjects._mainWindow.MessageBox(ServiceTool.EnableFeatures.Name.EnableEmailStudy);
                    msg = wpfobject.GetAnyUIItem<Window, Label>(dialog, "65535").Text;
                    wpfobject.GetAnyUIItem<Window, Button>(dialog, "6").Click();
                    wpfobject.WaitTillLoad();
                    servicetool.ApplyEnableFeatures();
                    servicetool.AcceptDialogWindow();
                }
                else
                {
                    Logger.Instance.InfoLog("Email Study checkbox already enabled in Service tool");
                }
                if (msg == EnableEmailmsg)//msg
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Yes button and then Apply button. IISRESET.
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                ExecutedSteps++;

                //Step 4 - From the Enable Featuers --> select Email Study tab     
                servicetool.NavigateSubTab(ServiceTool.EnableFeatures.Name.EmailStudy);
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();

                ITabPage Subtab = wpfobject.GetTabFromTab(ServiceTool.EnableFeatures.Name.EmailStudy);
                CheckBox Enablepin = wpfobject.GetAnyUIItem<ITabPage, CheckBox>(Subtab, "Enable PIN System for Non-Registered Users", 1);
                ComboBox ComboBox = WpfObjects._mainWindow.Get<ComboBox>(SearchCriteria.ByClassName("ComboBox"));
                TextBox Pinsize = wpfobject.GetUIItem<ITabPage, TextBox>(Subtab, "AutoSelectTextBox", 0, "1");

                Enablepin.Checked = true;
                ComboBox.Select("Alphabetic");
                Pinsize.Text = "8";

                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                ExecutedSteps++;

                //Step 5 - Login iConnect Access as Administrator in preferred target language other than English
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(DefaultDomain);
                domainmanagement.SelectDomain(DefaultDomain);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("emailstudy", 0);
                domainmanagement.AddToolsToToolbarByName(new string[] { "Email Study" });
                domainmanagement.ClickSaveEditDomain();

                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(DefaultDomain);
                rolemanagement.SearchRole(DefaultRoleName);
                rolemanagement.SelectRole(DefaultRoleName);
                rolemanagement.ClickEditRole();
                rolemanagement.SetCheckboxInEditRole("email", 0);
                rolemanagement.ClickSaveEditRole();
                login.Logout();
                ExecutedSteps++;

                //Step 6 - Go to the User Management tab.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                if (usermanagement.WarningMsgLbl().Text.Equals(login.ReadDataFromResourceFile(Localization.UserList, "data", "WarningMsg_EmailStudy")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Select Studies tab and load a study.
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[0]);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                StudyViewer viewer = LaunchStudy();
                if (studies.ViewStudy() == true)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Select Email Study button
                viewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "emailStudy"));
                wait.Until(ExpectedConditions.ElementIsVisible(viewer.By_EmailStudyDiv()));
                if (ValidateLocalization(ICA_MappingFilePath, "EmailStudy"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Enter a bogus destination email. Select Sent Email button
                viewer.ToEmailTxtBox().SendKeys(Email[0]);
                viewer.EmailStudySendBtn().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(viewer.By_EmailStudyErrMsgLbl()));
                if (viewer.EmailStudyErrorMsgLbl().Text.Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ErrorMsg_EmailStudyNameToEmpty")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Enter a name in To Name box. Select Sent Email button
                viewer.ToNameTxtBox().SendKeys(Name[0]);
                viewer.EmailStudySendBtn().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(viewer.By_EmailStudyErrMsgLbl()));
                if (viewer.EmailStudyErrorMsgLbl().Text.Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ErrorMsg_EmailStudyReasonToEmpty")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Enter a reason in Reason box. Select Sent Email button
                viewer.ReasonTxtBox().SendKeys(Reason);
                viewer.EmailStudySendBtn().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(viewer.By_EmailStudyErrMsgLbl()));
                if (viewer.EmailStudyErrorMsgLbl().Text.Equals(login.ReadDataFromResourceFile(Localization.Facade, "data", "Message_EmailStudyOperationSendingEmailFailed")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Enter a valid email addresses. Select Sent Email button
                viewer.ToEmailTxtBox().Clear();
                viewer.ToEmailTxtBox().SendKeys(Email[1]);
                viewer.EmailStudySendBtn().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(viewer.By_EmailStudyErrMsgLbl()));
                if (viewer.EmailStudyErrorMsgLbl().Text.Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ErrorMsg_SuccessEmailStudy")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step 13 - Select Maintenance tab and then select Audit tab. Check for Email Study To Guest/Email Study Sent entry in the target language.
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                //maintenance.Txt_AccessionNumber().SendKeys(Accessions[0]);
                maintenance.SelectEventID("110115", 1);
                PageLoadWait.WaitForFrameLoad(20);
                maintenance.Btn_Search().Click();
                PageLoadWait.WaitForPageLoad(10);
                PageLoadWait.WaitForFrameLoad(10);

                int count = maintenance.AuditListTable().Count;
                IList<IWebElement> AuditEvent = maintenance.AuditListTable()[1].FindElements(By.CssSelector("td"));
                string date = AuditEvent[3].Text;
                //string studydate = System.DateTime.ParseExact(date.ToString(), "dd-MMM-yyyy h:mm:ss tt", CultureInfo.InvariantCulture).ToShortDateString();
                //var day = System.DateTime.ParseExact(st[0], "M/d/yyyy", CultureInfo.InvariantCulture).ToShortDateString();
                maintenance.AuditListTable()[1].Click();
                wait.Until(ExpectedConditions.ElementIsVisible(maintenance.By_MessageDetailsDiv()));
                bool IsMessageDivPresent = IsElementPresent(maintenance.By_MessageDetailsDiv());
                if (AuditEvent[1].Text.Equals(login.ReadDataFromResourceFile(Localization.Audit, "data", "Outcome_Success")) && IsMessageDivPresent)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 14 - Go to the destination email and select the URL
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 15 - Type a bogus PIN number in the PIN code box.
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 16 - Type the PIN number that was generated (8 digit numbers) from the steps above.
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// French locale applied for the fields Choose Column, Search Date Range and Reset
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_120802(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
                        

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');


                //Step:1-In the Client, ensure the culture that is under test such as French (PRC-Simplified) is added to the Language bar in Control Panel-- Regional Setting-- Language-- Advanced
                //From web server where the current build is installed and perform the followings for configuring language (French)
                //Ensure that iCA server has jdk installed for testing
                //and Microsoft Windows SDK for Windows 7 and .NET Framework 3.5 SP1 is installed on iCA servers
                ExecutedSteps++;


                //Step:2-1. From Command Prompt, go to -installDir-\LocalizationSDK, (e.g., c-\WebAccess\LocalizationSDK.)
                //2. Run the script Localization_Prepare.wsf. Input the culture name in the dialog box, e.g., fr-FR Then click OK button.
                //3. A sub-directory fr-FR will be created under the LocalizationSDK directory, this directory contains the resource files for fr-FR culture.
                //4. Copy the TranslationTool.exe to ..\WebAccess\LocalizationSDK folder and run it (this is a test tool and should be available from the build machine. to modify all of the resx files in the newly created folder so that the changed text values are easily identifiable. The changes need to include some characters from the target locale.
                //5. TranslationTool.exe will modify the xml files to contain localized values using the same modifications as in step 4. (Everytime you have to change the xml files on the fly you should use iisreset and run Localization_Complete.wsf to make sure the server picks up your changes).
                ExecutedSteps++;

                //Step:3-6.Run Localization_Complete.wsf to compile resource files and create -installDir-\WebAccess\bin\fr-FR
                //7. Modify -installDir-\WebAccess\web.config, change-
                //-add key-"Application.Culture" value-"en-US" to -add key-"Application.Culture" value-"en-US,fr-FR"/-8. Restart IIS.
                //Dropdown list is displayed in login page with Preferred language.
                //Select preferred language -target language- and login into iCA
                ExecutedSteps++;

                //Step-4:Login to ICA as Administrator and navigate to studies tab
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                ExecutedSteps++;

                //Step:5-Verify the choose columns and reset buttons on the left bottom corner.
                string ChooseColumn = GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ChooseColumnsButton");
                string ResetBtn = GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ResetButton");
                string ChooseCol4 = ChooseColBtn().Text;
                string Reset4 = Reset().Text;
                if (ChooseColumn.Equals(ChooseCol4) && Reset4.Equals(ResetBtn))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:6-Verify the Search Date Range
                string StudyPerfLbl = ReadDataFromResourceFile(Localization.StudyList, "data", "Label_StudyPerformed");
                if (StudyPerfLbl.Equals(StudyPerformedLbl()))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:7-Click on Choose Columns button on left bottom corner
                ClickChooseColumns(check: 1);
                string RemoveAllLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "removeAll");
                string AddAllLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "addAll");
                string SelectColLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "caption", "col");
                string itemsSelectedLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "itemsCount");
                string OkBtn = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "bSubmit", "col");
                string CancelBtn = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "bCancel", "col");
                string itemsLbl = itemsSelected().Text;
                string SelectCol = SelectColumns().Text;
                string RemoveLbl = RemoveAllLink().GetAttribute("innerHTML");
                string AddLbl = AddAllLink().GetAttribute("innerHTML");

                if (itemsLbl.Contains(itemsSelectedLbl) && SelectColLbl.Equals(SelectCol) && RemoveAllLbl.Equals(RemoveLbl) &&
                    AddAllLbl.Equals(AddLbl) && OkBtn.Equals(OKChooseColLbl()) && CancelBtn.Equals(CancelChooseColLbl()))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:8-Click on Search Performed drop down 
                IList<IWebElement> List = BasePage.Driver.FindElements(By.CssSelector("div#searchStudySubMenu a"));

                result.steps[++ExecutedSteps].status = "On Hold";


                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            
        }

        /// <summary>
        /// Referring Physician studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90558(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String AdminUsername = Config.adminUserName;
            String AdminPassword = Config.adminPassword;
            String SuperAdmin = Config.adminGroupName;
            String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data               
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String pid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Datasource = "DCM4CHEE";
                //GridColumnNames
                String AccCol = GetStudyGridColName("Accession");
                String PIDCol = GetStudyGridColName("Patient ID");
                String RefPhyCol = GetStudyGridColName("Refer. Physician");

                //Step:1-Referring Physician name (FN,LN)should be in target language in the data set for at least one study                          
                ExecutedSteps++;


                //Step:2-Login as Administrator in target language and search for Referring Physician of a study with name in locale characters
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: acc, patientID: pid, Datasource: Datasource);
                Dictionary<string, string> row2 = studies.GetMatchingRow(new string[] { RefPhyCol }, new string[] { Lastname + ", " + Firstname }); ;
                if (row2 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Create user with similar Referring Physician details (FN,LN)
                UserManagement usermgt = (UserManagement)login.Navigate("UserManagement", 1, "User");
                usermgt.DomainDropDown().SelectByText(SuperAdmin);
                usermgt.CreateUser(Lastname, SuperRole, FName: Firstname, LName: Lastname);
                bool IsUserExists = usermgt.SearchUser(Lastname);
                if (IsUserExists)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step:4-Login as the created user - Referring Physician and goto studies tab
                //Select My Patient only radio button
                login.LoginIConnect(Lastname, Lastname);
                studies = login.Navigate<Studies>();
                studies.SearchStudy(MyPatientOnly: true);
                Dictionary<string, string> row = studies.GetMatchingRow(new string[] { "Accession", "Patient ID" }, new string[] { acc, pid }); ;
                if (row != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-Launch the study
                login.SelectStudy("Patient ID", pid);
                StudyViewer viewer = login.LaunchStudy();
                if (viewer.SeriesViewer_1X1().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();
                login.Logout();


                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(url);
                login.LoginIConnect(AdminUsername, AdminPassword);
                UserManagement usermgt = (UserManagement)login.Navigate("UserManagement");
                usermgt.DeleteUser(SuperAdmin, Lastname);
                login.Logout();
            }
        }

        /// <summary>
        /// Requisition
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90597(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String AdminUsername = Config.adminUserName;
            String AdminPassword = Config.adminPassword;
            String SuperAdmin = Config.adminGroupName;
            String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data               
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                String Title = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Title");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String PACSA7 = login.GetHostName(Config.SanityPACS);
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String[] PageList = { "RequisitionViewer" };
                //GridColumnNames
                String StudyIDCol = GetStudyGridColName("Study ID");
                //Tools
                String InvertToolTip = ReadDataFromResourceFile(Localization.Tooltip, "data", "Invert");
                String AllinOneToolTip = ReadDataFromResourceFile(Localization.Tooltip, "data", "AllInOne");
                String LineMeasurementTip = ReadDataFromResourceFile(Localization.Tooltip, "data", "AnnotationOrthoLine");
                String ResetToolTip = ReadDataFromResourceFile(Localization.Tooltip, "data", "Reset");
                String ReqToolBar = ReadDataFromResourceFile(Localization.ToolBar, "data", "Dropdown_RequisitionToolbar");
                String ReqIcon = ReadDataFromResourceFile(Localization.StudyPanelControl, "data", "Tooltip_RequisitionAvailable");
                String TitleCol = ReadDataFromResourceFile(Localization.RequisitionViewer, "data", "RequisitionTable_TitleHeading");

                //Step:1-In the service tool select Enable Features-> Enable Requisition Report flag,
                //Login into iCA and in Domain management enable the Enable Requisition Reports box
                login.DriverGoTo(login.url);
                login.LoginIConnect(AdminUsername, AdminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(SuperAdmin);
                domainmanagement.SelectDomain(SuperAdmin);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("requisitionreport", 0);
                domainmanagement.SetCheckBoxInEditDomain("attachment", 0);
                domainmanagement.SetCheckBoxInEditDomain("attachmentupload", 0);
                domainmanagement.ClickSaveDomain();
                login.Logout();
                ExecutedSteps++;


                //Step:2-login in ica
                //search and load a study with requisition
                //Hover and Click on Requisition icon.
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { StudyIDCol }, 1);
                studies.SearchStudy(studyID: StudyID, Datasource: PACSA7);
                studies.SelectStudy1(StudyIDCol, StudyID);
                StudyViewer viewer = StudyViewer.LaunchStudy();
                PageLoadWait.WaitForFrameLoad(20);
                viewer.RequisitionIcon(ReqIcon).Click();
                PageLoadWait.WaitForFrameLoad(60);
                IList<string> Tools = GetReviewToolsFromviewer();
                if (viewer.RequisitionViewerInStudyPanel().Displayed && Tools.Contains(InvertToolTip))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Click on the patient history tab -> select Requisition tab and check labels,column header and tooltip of the icons in toolbar
                viewer.NavigateToHistoryPanel();
                viewer.NavigateTabInHistoryPanel("Requisition");
                bool UIValidate3 = ValidateLocalization(ICA_MappingFilePath, PageList[0]);
                IList<String> ToolTitles3 = viewer.GetToolsFromViewer("requisition");
                if (UIValidate3 && ToolTitles3.Contains(AllinOneToolTip))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseHistoryPanel();
                viewer.CloseStudy();

                //Step:4-Test Data: 
                //1. Select to edit the SuperAdminGroup domain and change the toolbar configuration for Requisition Toolbar to have only the following tools: All In One, Invert and Measurements.
                //Save the changes.
                //Select Role Management tab and make sure the Requisition Toolbar has use domain settings checked
                //2. load study with requisition and verify the requisition toolbar
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                domainmanagement.SearchDomain(SuperAdmin);
                domainmanagement.SelectDomain(SuperAdmin);
                domainmanagement.ClickEditDomain();
                domainmanagement.SelectToolbarType(ReqToolBar);
                IList<String> ToolsAdded = domainmanagement.GetConnectedTools();
                domainmanagement.RemoveAllToolsFromToolBar();
                domainmanagement.AddToolsToToolbarByName(new String[] { AllinOneToolTip, InvertToolTip, LineMeasurementTip });
                domainmanagement.ClickSaveDomain();
                PageLoadWait.WaitForFrameLoad(30);

                RoleManagement role = (RoleManagement)login.Navigate("RoleManagement", 1, "Role");
                role.SearchRole(SuperRole);
                role.SelectRole(SuperRole);
                role.ClickEditRole();
                role.SelectToolbarType(ReqToolBar);
                role.SetCheckboxInEditRole("toolbar", 0);
                role.ClickSaveEditRole();
                PageLoadWait.WaitForFrameLoad(30);

                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { StudyIDCol }, 1);
                studies.SearchStudy(studyID: StudyID, Datasource: PACSA7);
                studies.SelectStudy1(StudyIDCol, StudyID);
                viewer = StudyViewer.LaunchStudy();
                PageLoadWait.WaitForFrameLoad(20);
                viewer.NavigateToHistoryPanel();
                viewer.NavigateTabInHistoryPanel("Requisition");
                viewer.SelectItemInStudyViewerList(TitleCol, Title, "PatientHistory", "Requisition");
                PageLoadWait.WaitForFrameLoad(20);
                IList<String> ToolTitles = viewer.GetToolsFromViewer("requisition");
                IList<String> DefaultTitles = new List<String> { AllinOneToolTip, InvertToolTip, LineMeasurementTip };
                Boolean compare = studies.CompareList(ToolTitles, DefaultTitles);
                if (compare)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-Select each of the tools and perform them on the requisition image.
                viewer.SelectToolInToolBar(InvertToolTip, "requisition");
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement image0 = BasePage.Driver.FindElement(By.CssSelector("img[src*='invertImages']"));
                //Validate Image 
                if (image0.Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseHistoryPanel();
                viewer.CloseStudy();
                login.Logout();


                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                /*Resetting the tools in Requisition Toolbar*/
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(SuperAdmin);
                domainmanagement.SelectDomain(SuperAdmin);
                domainmanagement.ClickEditDomain();
                domainmanagement.SelectToolbarType("Requisition Toolbar");
                domainmanagement.RemoveAllToolsFromToolBar();
                domainmanagement.AddToolsToToolbarByName(new String[] { "All in One Tool", "Window Level", "Auto Window Level", "Zoom", "Pan", "Rotate Clockwise", "Flip Vertical", "Reset", "Toggle Text", "Print View" });
                domainmanagement.ClickSaveDomain();
                login.Logout();
            }
        }

        /// <summary>
        /// Attachment to Study
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90594(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String AdminUsername = Config.adminUserName;
            String AdminPassword = Config.adminPassword;
            String SuperAdmin = Config.adminGroupName;
            String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data               
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                String FilePath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String[] Filepaths = FilePath.Split('=');
                String PACSA7 = login.GetHostName(Config.SanityPACS);
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;

                //GridColumnNames
                String StudyIDCol = GetStudyGridColName("Study ID");

                String NameCol = ReadDataFromResourceFile(Localization.AttachmentViewer, "data", "AttachmentTable_NameHeading");

                //Step:1-Enable Attachment and upload in Service Tool & Domain Management
                login.DriverGoTo(login.url);
                login.LoginIConnect(AdminUsername, AdminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(SuperAdmin);
                domainmanagement.SelectDomain(SuperAdmin);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("attachment", 0);
                domainmanagement.SetCheckBoxInEditDomain("attachmentupload", 0);
                domainmanagement.ClickSaveDomain();
                login.Logout();
                ExecutedSteps++;

                //Step-2:Create text file or jpeg, bmp with saved names in target language
                //Create text file in target language
                ExecutedSteps++;

                //Step-3:login in ica
                //search and load a study
                //Click on Patient History tab and goto Attachment panel
                //Verify the header ,buttons,warning text , column headers on the page              
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { StudyIDCol }, 1);
                studies.SearchStudy(studyID: StudyID, Datasource: PACSA7);
                studies.SelectStudy1(StudyIDCol, StudyID);
                StudyViewer viewer = StudyViewer.LaunchStudy();
                viewer.NavigateToHistoryPanel();
                viewer.NavigateTabInHistoryPanel("Attachment");
                bool UIValidate3 = ValidateLocalization(ICA_MappingFilePath, "Attachment");
                if (UIValidate3)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step:4-Browse to the location where the files to be attached are saved. Select the .jpg file created in target language. Save with the name as target language.
                PageLoadWait.WaitForFrameLoad(20);
                bool attachment4 = viewer.UploadAttachment(Filepaths[0], 20, NameCol);
                if (attachment4)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-After saving is completed, open the attachment
                result.steps[++ExecutedSteps].status = "No Automation";

                //Step-6:Attach another file (.jpeg) and save in target language
                PageLoadWait.WaitForFrameLoad(20);
                bool attachment6 = viewer.UploadAttachment(Filepaths[1], 20, NameCol);
                if (attachment6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Open the saved attachment
                result.steps[++ExecutedSteps].status = "No Automation";

                //Step-8:Click on Save without selecting any file as attachment
                PageLoadWait.WaitForFrameLoad(10);
                Driver.SwitchTo().Frame("iframeAttachment");
                ((IJavaScriptExecutor)Driver).ExecuteScript("document.querySelector(\"input#m_sendAttachmentButton\").click()");
                PageLoadWait.WaitForFrameLoad(10);
                string ErrorMsg = viewer.ErrorMessage().GetAttribute("innerHTML");
                string AttachWarning = ReadDataFromResourceFile(Localization.UploadFile, "data", "Message_EmptyFile");
                if (ErrorMsg.Equals(AttachWarning))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseHistoryPanel();
                viewer.CloseStudy();
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Conference Lists - Conference Studies always launch in HTML4 viewer
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_99180(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data               
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String PID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String Datasource = "DCM4CHEE";
                //GridColumnNames
                String AccCol = GetStudyGridColName("Accession");

                //Domain A
                String DomainA = "DomainA_99180_" + new Random().Next(1, 1000); //Conf List
                String daA = "daA_99180_" + new Random().Next(1, 1000); //Conf User
                String roleA1 = "roleA1_99180_" + new Random().Next(1, 1000); //Conf User               
                String userA1 = "userA1_99180_" + new Random().Next(1, 1000); //Folder Manager
                String userA2 = "userA2_99180_" + new Random().Next(1, 1000); //Conf User                  

                //Conf folders
                String TopFolder1 = "TopFolder1_99180_" + new Random().Next(1, 1000);
                String SubFolder1_1_Level2 = "October06_99180_" + new Random().Next(1, 1000);
                String folderpath = TopFolder1 + "/" + SubFolder1_1_Level2;

                //Step 1 - Pre-conditions--1. iCA build under testing is installed on the main iCA server.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Enable HTML5 viewer with HTML4 Viewer as default in Service Tool-
                //4. Domains, Roles, Folder Managers, Conference users, non-conference users and Conference Folders, Study Folders are available for the test.-
                //5. Other iCA configurations under testing are specified in Test Assignments and PQA Test Plan for the release. (e.g., version of remote iCA server, HTTP or HTTPS, etc...)

                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateConfUsrDomain(DomainA);

                UserManagement usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateDomainAdminUser(daA, DomainA, 0, "", 0, "", 1);

                RoleManagement rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateConfListRole(DomainA, roleA1);

                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(userA1, DomainA, roleA1); //Folder Manager                
                usermanagement.CreateUser(userA2, DomainA, roleA1); //Conference User

                ConferenceFolders conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.CreateToplevelFolder(TopFolder1, userA1, DomainA);
                conferenceFolders.CreateSubFolder(TopFolder1, SubFolder1_1_Level2, DomainA);
                login.Logout();

                //Add study to same subfolder
                login.LoginIConnect(daA, daA);
                studies = login.Navigate<Studies>();
                studies.SelectAllDateAndData();
                studies.SearchStudy(AccessionNo: Accession, Datasource: Datasource);
                studies.SelectStudy("Patient ID", PID);
                StudyViewer studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(TopFolder1 + "/" + SubFolder1_1_Level2, notes: "Step5_Test");
                studyViewer.CloseStudy();
                login.Logout();
                ExecutedSteps++;

                //Step-2:[Conference User launches Conference Studies into HTML4 Viewer]-Ensure there are conference study in the domain. Login iCA as a Conference user using browser Chrome, navigate to Conference Folders tab, browser to a Study Folder.                               
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA2, userA2);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(folderpath);
                if (BasePage.GetSearchResults().Count == 1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-3:From Conference Folders tab, load a study.
                conferenceFolders.SelectStudy(AccCol, Accession);
                conferenceFolders.LaunchStudy(isConferenceTab: true);
                if (BasePage.Driver.FindElement(By.CssSelector("div#viewerImgDiv>img#m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_viewerImg")).Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-4:Attempt to load this study into HTML5 viewer from the Conference Folders tab (e.g. click HTLM5 View)
                conferenceFolders.CloseStudy();
                bool isHtml5;
                try { isHtml5 = BasePage.Driver.FindElement(By.CssSelector("#m_html5ViewStudyButton")).Displayed; }
                catch { isHtml5 = false; }
                if (!isHtml5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-Navigate to Studies tab, load a study into HTML5 Viewer
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SelectAllDateAndData();
                studies.SearchStudy(AccessionNo: Accession, Datasource: Datasource);
                studies.SelectStudy(AccCol, Accession);                
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Equals("chrome"))
                {
                    studyViewer.LaunchStudyHTML5();
                    if (studyViewer.html5seriesViewer_1X1().Displayed)
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Not Applicable";
                }
                studyViewer.CloseStudy();
                login.Logout();

                //Step 6 - [Folder Manager launches Conference Studies into HTML4 Viewer]-Repeat above steps by login as a Folder Manager instead.
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conferenceFolders.ExpandAndSelectFolder(folderpath);
                conferenceFolders.SelectStudy(AccCol, Accession);
                conferenceFolders.LaunchStudy(isConferenceTab: true);
                //Validate Launched in HTML4
                if (BasePage.Driver.FindElement(By.CssSelector("div#viewerImgDiv>img#m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_viewerImg")).Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                conferenceFolders.CloseStudy();
                login.Logout();



                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout 
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Modify users list in Destination
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90636(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            UserManagement user;
            Image_Sharing imagesharing;
            Random random = new Random();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String SuperAdminGroup = Config.adminGroupName;
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String AdminContact = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AdminContact");
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] userids = { Users.Split(':')[0] + "_" + random.Next(1, 1000), Users.Split(':')[1] + "_" + random.Next(1, 1000), Users.Split(':')[2] + "_" + random.Next(1, 1000), Users.Split(':')[3] + "_" + random.Next(1, 1000) };
                String datasource = login.GetHostName(Config.SanityPACS);
                String DestName = Users.Split(':')[4] + "_" + random.Next(1, 1000);   
                String DestinationPage = GetRespectivePage("Destination", 1, "ImageSharing");

                //Step-1:Create Users with their role title (receiver,archivist)  in target langauge
                //Precondition
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                user = (UserManagement)login.Navigate("UserManagement", 1, "User");
                user.DomainDropDown().SelectByText(SuperAdminGroup);
                user.CreateUser(userids[0], "Physician", FName: userids[0], LName: userids[0]);
                user.CreateUser(userids[1], "Archivist", FName: userids[1], LName: userids[1]);
                user.CreateUser(userids[2], "Physician", FName: userids[2], LName: userids[2]);
                user.CreateUser(userids[3], "Archivist", FName: userids[3], LName: userids[3]);
                bool IsU1Exist = user.SearchUser(userids[0]);
                bool IsU2Exist = user.SearchUser(userids[1]);
                bool IsU3Exist = user.SearchUser(userids[2]);
                bool IsU4Exist = user.SearchUser(userids[3]);
                if (IsU1Exist && IsU2Exist && IsU3Exist && IsU4Exist)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-2:Login as Administrator in target language and goto Image Sharing->Destination tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                imagesharing = (Image_Sharing)login.Navigate("Image Sharing", 1, "ImageSharing");
                Image_Sharing.Destination dest = (Image_Sharing.Destination)imagesharing.NavigateToSubTab("Destination", DestinationPage);

                bool UIvalidate2 = ValidateLocalization(ICA_MappingFilePath, "DestinationPage");

                if (UIvalidate2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-3:Select Domain, click New Destination
                dest.SelectDomain(SuperAdminGroup);
                dest.NewDestinationButton().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#DestinationEditDialogDiv")));

                bool UIvalidate3 = ValidateLocalization(ICA_MappingFilePath, "NewDestinationPage");

                if (UIvalidate3)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-4:Enter Destination name in English , and select receiver and archivist created in target language,Click OK
                dest.DestName().SendKeys(DestName);
                new SelectElement(dest.DataSource()).SelectByText(datasource);
                dest.ReceiverUser().SendKeys(userids[0]);
                dest.SearchReceivers().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(dest.SearchReceivers()));
                //Syncup and click the Receiver User
                BasePage.wait.Until(new Func<IWebDriver, IWebElement>((driver) =>
                {
                    IList<IWebElement> rows = dest.ReceiverUserList().FindElements(By.CssSelector("tbody>tr"));
                    foreach (IWebElement row in rows)
                    {
                        if (row.FindElement(By.CssSelector("td>span")).GetAttribute("innerHTML").Split('(')[0].Trim().Equals(userids[0]))
                        {
                            return row;
                        }
                        else
                        {
                            continue;
                        }
                    }
                    return null;
                })).Click();
                dest.AddReceivers().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(dest.AddReceivers()));
                dest.ArchivistUser().SendKeys(userids[1]);
                dest.SearchArchivist().Click();
                //Syncup and click the Archivist User
                BasePage.wait.Until(new Func<IWebDriver, IWebElement>((driver) =>
                {
                    IList<IWebElement> rows = dest.ArchivistUserList().FindElements(By.CssSelector("tbody>tr"));
                    foreach (IWebElement row in rows)
                    {
                        if (row.FindElement(By.CssSelector("td>span")).GetAttribute("innerHTML").Split('(')[0].Trim().Equals(userids[1]))
                        {
                            return row;
                        }
                        else
                        {
                            return null;
                        }
                    }
                    return null;
                })).Click();

                dest.AddArchivist().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(dest.AddArchivist()));
                dest.OKButton().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#DestinationEditDialogDiv")));
                if (dest.SearchDestination(SuperAdminGroup, DestName))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Seelct Destination, click Edit Destiantion
                //Remove the added receiver 
                //Search receiver and add a new receiver
                //Search archivist, add new archivist
                //Click OK
                dest.EditDestination(SuperAdminGroup, DestName);
                dest.RemoveUserFromDestination(userids[0]); //Remove
                dest.AddUserToDestination(userids[2], userids[3]); //Add
                dest.ClickOKinEditDestination();
                PageLoadWait.WaitForFrameLoad(20);
                if (dest.SearchDestination(SuperAdminGroup, DestName))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:Select the updated Destination, double click the entry and verify details
                dest.SelectDestination(SuperAdminGroup, DestName);
                dest.DoubleClickDest(SuperAdminGroup, DestName);
                bool IsU3Added = dest.IsReceiverinList(userids[2]);
                bool IsU4Added = dest.IsArchivistinList(userids[3]);
                if (IsU3Added && IsU4Added)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Downloader & Transfer Service
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90560(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String InProcess = login.ReadDataFromResourceFile(Localization.DataManagement, "data", "Processing");
            String Ready = login.ReadDataFromResourceFile(Localization.DataManagement, "data", "Ready");

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String StudyIDs = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                String Datasources = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                String SuperAdmin = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DefaultDomain");
                String SuperRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DefaultRole");
                String Email = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Email");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");

                String[] Langs = Languages.Split(':');
                String[] Accession = AccessionList.Split(':');
                String[] Datasource = Datasources.Split(':');
                String[] StudyID = StudyIDs.Split(':');
                String[] Accessions = AccessionList.Split(':');

                WebDriverWait wait = new WebDriverWait(Driver, new TimeSpan(0, 0, 120));

                //Step 1 - In Options-->User Preferences in the download studies at the bottom confirm or select "As Zip Files" click on OK and Close
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.OpenUserPreferences();
                login.EditDownloadPreferences("as zip files");
                login.CloseUserPreferences();
                login.Logout();
                ExecutedSteps++;

                //Step 2 - In the service tool select Enable Features--> Transfer Service.
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableStudySharing();
                servicetool.EnableDataTransfer();
                servicetool.EnableDataDownloader();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();

                servicetool.SetEnableFeaturesTransferService();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableTransferService();
                servicetool.RestartIISandWindowsServices();
                servicetool.CloseConfigTool();

                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(SuperAdmin);
                domainmanagement.SelectDomain(SuperAdmin);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("datatransfer", 0);
                domainmanagement.SetCheckBoxInEditDomain("grant", 0);
                domainmanagement.GrantAccessValidDaysTxtBox().Clear();
                domainmanagement.GrantAccessValidDaysTxtBox().SendKeys("1");
                domainmanagement.SetCheckBoxInEditDomain("datadownload", 0);
                domainmanagement.ClickSaveDomain();

                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(SuperAdmin);
                rolemanagement.SearchRole(SuperRole);
                rolemanagement.SelectRole(SuperRole);
                rolemanagement.ClickEditRole();
                rolemanagement.SetCheckboxInEditRole("transfer", 0);
                rolemanagement.SetCheckboxInEditRole("download", 0);
                rolemanagement.GrantAccessRadioBtn_Anyone().Click();
                rolemanagement.ConnectAllDataSources();
                rolemanagement.ClickSaveEditRole();
                login.Logout();
                ExecutedSteps++;

                //Step 3 - Select the Studies Tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.SanityPACS));
                ExecutedSteps++;

                //Step 4 - Select two studies in English and target language            
                studies.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                ExecutedSteps++;

                //Step 5 - Select Transfer button
                studies.TransferButton().Click();
                if (ValidateLocalization(ICA_MappingFilePath, "StudyTransferControl"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Select "Local System" from the drop down Transfer to: field. And click on Transfer button.                
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame"); //remove this
                studies.Dropdown_TransferTo().SelectByValue("-1");
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                studies.Btn_StudyPageTransferBtn().Click();                
                if (ValidateLocalization(ICA_MappingFilePath, "DataQCControl"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Select the Confirm all label
                //studies.ConfirmAllButton().Click();
                ExecutedSteps++;

                //Step 8 - Click on Submit
                studies.QCSubmitButton().Click();
                try { wait.Until(ExpectedConditions.ElementIsVisible(studies.By_Status(InProcess))); }
                catch (Exception) { }
                wait.Until(ExpectedConditions.ElementIsVisible(studies.By_Status(Ready)));
                if (ValidateLocalization(ICA_MappingFilePath, "TransferJobsList"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Select one studies (target language) with Status = Ready
                Driver.FindElement(studies.By_Status(Ready)).Click();
                wait.Until(ExpectedConditions.ElementIsVisible(studies.By_DownloadButton()));
                if (studies.DownloadButton().Enabled)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Click on the download button.    
                studies.DownloadButton().Click();
                if (ValidateLocalization(ICA_MappingFilePath, "DownloadPackages"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.DownloadPackagesButton().Click();
                studies.CloseDownloadButton().Click();
                PageLoadWait.WaitForFrameLoad(20);

                //Step 11 - Open the downloaded folder to view the study files
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 12 - Select study with priors in target language, click Transfer
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.SanityPACS));
                studies.SelectStudy(GetStudyGridColName("Accession"), Accession[1]);
                studies.Btn_StudyPageTransfer().Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                try { wait.Until(ExpectedConditions.ElementIsVisible(studies.By_RelatedStudy(2))); }
                catch (Exception) { }
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                if (Driver.FindElement(studies.By_RelatedStudy(2)).Text.Equals(StudyID[0]) &&
                    Driver.FindElement(studies.By_RelatedStudy(3)).Text.Equals(StudyID[1]) &&
                    Driver.FindElement(studies.By_RelatedStudy(4)).Text.Equals(StudyID[2]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Submit the details and refresh the status and download one study when the status is Ready
                studies.SelectAllButton().Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                studies.Dropdown_TransferTo().SelectByValue("-1");
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                studies.Btn_StudyPageTransferBtn().Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                studies.ConfirmAllButton().Click();
                studies.QCSubmitButton().Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                try { wait.Until(ExpectedConditions.ElementIsVisible(studies.By_Status(Ready))); }
                catch (Exception) { }
                Driver.FindElement(studies.By_Status(Ready)).Click();
                wait.Until(ExpectedConditions.ElementIsVisible(studies.By_DownloadButton()));
                BasePage.Driver.FindElement(studies.By_DownloadButton()).Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                studies.DownloadPackagesButton().Click();
                studies.CloseDownloadButton().Click();
                PageLoadWait.WaitForFrameLoad(20);

                String description;
                studies.GetMatchingRow(GetStudyGridColName("Accession"), Accession[1]).TryGetValue(GetStudyGridColName("Description"), out description);
                PageLoadWait.WaitForDownload("_" + description, Config.downloadpath, "zip");
                Boolean studydownloaded = BasePage.CheckFile("_" + description, Config.downloadpath, "zip");
                if (studydownloaded == true)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// User Registration - Self Enrolment
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90602(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data                                
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String FirstName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String LastName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String Email = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Email");

                String[] Langs = Languages.Split(':');
                String[] Name = Names.Split(':');

                String GroupName = Name[0] + "_90602_0_" + new Random().Next(1, 1000);
                String EnrolUser1 = Name[1] + "_90602_1_" + new Random().Next(1, 1000);
                String EnrolUser2 = Name[1] + "_90602_2_" + new Random().Next(1, 1000);
                String EnrolUser3 = Name[1] + "_90602_3_" + new Random().Next(1, 1000);

                //Step 1 - Enable the feature in ICA Service Tool -> Enable Self Enrollment. Restart IIS. Create Group for a Domain in iCA in target language                
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableSelfEnrollment();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();

                //Create group
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                usermanagement.CreateGroup(Config.adminGroupName, GroupName);
                login.Logout();
                ExecutedSteps++;

                //Step 2 - Select a target language other than English. Click on the Register link.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.RegisterLink().Click();
                PageLoadWait.WaitForPageLoad(20);
                wait.Until(ExpectedConditions.ElementToBeClickable(login.EnrollNewUserDiv()));
                if (ValidateLocalization(ICA_MappingFilePath, "EnrolUser"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Do not fill any of the fields, and click save.
                login.RegEnrolUser().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(login.By_EnrolUserErrorMsg()));
                if (Driver.FindElement(login.By_EnrolUserErrorMsg()).Text.Equals(ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_UserIDRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Enter user Id in target language, click Save
                login.RegUserID().SendKeys(EnrolUser1);
                login.RegEnrolUser().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(login.By_EnrolUserErrorMsg()));
                if (Driver.FindElement(login.By_EnrolUserErrorMsg()).Text.Equals(ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_FirstNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Enter user Id, first name, Click Save
                login.RegFirstName().SendKeys(FirstName);
                login.RegEnrolUser().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(login.By_EnrolUserErrorMsg()));
                if (Driver.FindElement(login.By_EnrolUserErrorMsg()).Text.Equals(ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_LastNameRequired")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Enter user Id, first name, last name Click Save
                login.RegLastName().SendKeys(LastName);
                login.RegEnrolUser().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(login.By_EnrolUserErrorMsg()));
                if (Driver.FindElement(login.By_EnrolUserErrorMsg()).Text.Equals(ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_EmailMandatory")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Enter user Id, first name, last name, Group Click Save
                SelectFromList(login.Regdomainlistbox(), Config.adminGroupName);
                SelectFromList(login.Reggrouplistbox(), GroupName);
                login.RegEnrolUser().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(login.By_EnrolUserErrorMsg()));
                if (Driver.FindElement(login.By_EnrolUserErrorMsg()).Text.Equals(ReadDataFromResourceFile(Localization.UserInfoInputControl, "data", "Message_EmailMandatory")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Fill in the required fields and attempt to enrol. Return to the login page when done.
                login.RegEmail().SendKeys(Email);
                login.RegEnrolUser().Click();
                PageLoadWait.WaitForElement(login.EnrolProgress(), WaitTypes.Exists);
                PageLoadWait.WaitForElementToDisplay(login.RegErrorMessage(), 30);
                wait.Until(ExpectedConditions.ElementExists(login.DialogDiv()));
                wait.Until(ExpectedConditions.ElementExists(login.ConfirmButton()));
                String ConfirmCaption = login.RegConfirmCaption().Text;
                String ConfirmText = login.RegConfirmText().Text;
                String ConfirmButton = Driver.FindElement(login.ConfirmButton()).GetAttribute("value");
                ((IJavaScriptExecutor)Driver).ExecuteScript("document.querySelector(\"#ctl00_ConfirmButton\").click()");
                PageLoadWait.WaitForPageLoad(20);
                //Enrol two more user in target language.
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                bool bEnrollUser2 = login.FillEnrollForm(EnrolUser2, Config.adminGroupName, Email, GroupName);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                bool bEnrollUser3 = login.FillEnrollForm(EnrolUser3, Config.adminGroupName, Email, GroupName);
                if (ConfirmCaption.Equals(ReadDataFromResourceFile(Localization.EnrolUser, "data", "AlertBox_ConfirmSubmitEnrolUser")) &&
                    ConfirmText.Equals(ReadDataFromResourceFile(Localization.EnrolUser, "data", "AlertMessage_ConfirmSubmitEnrolUser")) &&
                    ConfirmButton.Equals(ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Button_OK")) &&
                    bEnrollUser2 == true && bEnrollUser3 == true)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Enter an exisiting user ID and other mandatory details in the enroll new user account page .Click Enroll
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                PageLoadWait.WaitForElement(login.EnrolLinkButton(), WaitTypes.Clickable);
                login.RegisterLink().Click();
                PageLoadWait.WaitForPageLoad(20);
                SendKeys(login.RegUserID(), EnrolUser1);
                SendKeys(login.RegLastName(), LastName);
                SendKeys(login.RegFirstName(), FirstName);
                SendKeys(login.RegEmail(), Email);
                SelectFromList(login.Regdomainlistbox(), Config.adminGroupName);
                SelectFromList(login.Reggrouplistbox(), GroupName);
                login.RegEnrolUser().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(login.By_EnrolUserErrorMsg()));
                if (Driver.FindElement(login.By_EnrolUserErrorMsg()).Text.Equals(ReadDataFromResourceFile(Localization.Facade, "data", "Error_RegistrationProcess_AlreadyExists")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.RegCloseButton().Click();
                PageLoadWait.WaitForPageLoad(20);

                //Step 10 - Login as Administrator in target language and goto Users->Requests tab and check the label from each area (columns, searching areas, buttons)
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                NavigateToRequestsUserManagementTab(1);
                if (ValidateLocalization(ICA_MappingFilePath, "Requests"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Select one newly created user and click on Register. Close the page.
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                usermanagement.RefreshBtn().Click();
                if (usermanagement.RequestUser(EnrolUser1, "accept", firstname: FirstName))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Login to iCA from the email url received for the user
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 13 - Enter and Save password for the new user
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 14 - Login as Administrator in target language and goto Users->Requests tab 
                //          Select another newly created user, update user's first/last name and click on Register
                //          Click OK.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                NavigateToRequestsUserManagementTab(1);
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                usermanagement.RefreshBtn().Click();
                if (usermanagement.RequestUser(EnrolUser2, "accept", firstname: FirstName))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 15 - Login to iCA from the email url received for the user
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 16 - Enter and Save password for the new user
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 17 - Login as Administrator in target language and goto Users->Requests tab
                //          Select another newly created user and click on Reject
                //          Click OK.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                NavigateToRequestsUserManagementTab(1);
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                usermanagement.RefreshBtn().Click();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                usermanagement.RequestUserList()[Array.FindIndex(usermanagement.RequestUserList().Select(user => user.Text).ToArray(), uid => string.Equals(uid, EnrolUser3))].Click();
                usermanagement.RejectBtn().Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool bConfirmCaption = login.RegConfirmCaption().Text.Equals(login.ReadDataFromResourceFile(Localization.EnrolUserListControl, "data", "Title_ConfirmUserDeletion"));
                bool bConfirmText = login.RegConfirmText().Text.Contains(login.ReadDataFromResourceFile(Localization.EnrolUserListControl, "data", "Msg_ConfirmUserDeletion").Split('{')[0]);
                bool bConfirmBtn = Driver.FindElement(login.ConfirmButton()).GetAttribute("value").Equals(login.ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Button_OK"));
                bool bCancelBtn = usermanagement.CancelButtonInConfirmGroupDeletionMsgBox().GetAttribute("value").Equals(login.ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Button_Cancel"));
                usermanagement.OkButtonConfirmGroupDeletionMsgBox().Click();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                if (bConfirmCaption && bConfirmText && bConfirmBtn && bCancelBtn && !usermanagement.RequestUserExist(EnrolUser3))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 18 - Verify the email received by the user
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// PDF Report
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90596(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            DateTime now = DateTime.Now;
            string t1 = now.ToString();
            string[] st = t1.Split(' ');

            try
            {
                //Fetch required Test data                
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Reason = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String pid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String FileName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");

                String[] Langs = Languages.Split(':');
                String[] Accessions = AccessionList.Split(':');

                //Step 1 - In the service tool enable the PDF report Restart IIS    
                servicetool.LaunchServiceTool();
                servicetool.SetEnableFeaturesGeneral();
                servicetool.wpfobject.ClickButton(ServiceTool.ModifyBtn_Name, 1);
                servicetool.EnablePDFReport();
                servicetool.ApplyEnableFeatures();
                servicetool.wpfobject.ClickOkPopUp();
                servicetool.RestartService();
                servicetool.NavigateToTab(ServiceTool.Viewer_Tab);
                servicetool.wpfobject.GetTabWpf(1).SelectTabPage(4);
                servicetool.wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickButton(ServiceTool.ModifyBtn_Name, 1);
                servicetool.wpfobject.ClearText(ServiceTool.Viewer.ID.FileNameTxtBox);
                servicetool.wpfobject.SetText(ServiceTool.Viewer.ID.FileNameTxtBox, "MERGE HEALTHCARE.pdf");
                servicetool.wpfobject.SelectCheckBox(ServiceTool.Viewer.ID.Caliper);
                servicetool.wpfobject.SelectCheckBox(ServiceTool.Viewer.ID.OrientationLabel);
                servicetool.wpfobject.SelectCheckBox(ServiceTool.Viewer.ID.GraphicAnnotation);
                servicetool.ApplyEnableFeatures();
                servicetool.RestartService();
                servicetool.CloseServiceTool();

                //Delete existing downloaded files if any
                var dir = new DirectoryInfo(Config.downloadpath);
                foreach (var file in dir.EnumerateFiles("MERGE*.pdf")) { file.Delete(); }
                ExecutedSteps++;

                //Step 2 - Login as administrator Enable the PDF report flag at Domain and Role Management tabs
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                domainmanagement.SetCheckBoxInEditDomain("pdfreport", 0);
                domainmanagement.ClickSaveEditDomain();
                PageLoadWait.WaitForPageLoad(5);

                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(Config.adminRoleName, Config.adminGroupName);
                rolemanagement.SelectRole(Config.adminRoleName);
                rolemanagement.ClickEditRole();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                rolemanagement.SetCheckboxInEditRole("pdfreport", 0);
                rolemanagement.ClickSaveEditRole();
                PageLoadWait.WaitForPageLoad(5);
                login.Logout();
                ExecutedSteps++;

                //Step 3 - Load a study that has a text report in target language.    
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy("patientID", pid);
                studies.SearchStudy("PatientLastName", lastname);
                studies.SelectStudy1(GetStudyGridColName("Patient ID"), pid);
                studies.LaunchStudy();
                if (studies.ViewStudy() == true &&
                    Driver.FindElement(By.CssSelector("img[title='" + login.ReadDataFromResourceFile(Localization.Tooltip, "data", "PDFReport") + "']")).GetAttribute("class").Equals("notSelected32 enabledOnCine disableOnCine"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Select the Report viewer button. Click on Download PDF icon
                viewer.ReportView();
                viewer.ClickElement(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "PDFReport"));
                PageLoadWait.WaitForPageLoad(10);
                //********POP -UP******//
                if (Config.BrowserType == "wires-firefox")
                {
                    var x = Process.GetProcessesByName("firefox")[0].Id;
                    Logger.Instance.InfoLog("Application's process ID : " + x);
                    WpfObjects._application = Application.Attach(x);
                    wpfobject.GetMainWindowByIndex(1);
                    wpfobject.ClickButton("OK", 1);
                }
                else if (Config.BrowserType == "ie")
                {
                    var x = Process.GetProcessesByName("iexplore")[0].Id;
                    Logger.Instance.InfoLog("Application's process ID : " + x);
                    WpfObjects._application = Application.Attach(x);
                    wpfobject.GetMainWindowByIndex(0);
                    Panel pane = WpfObjects._application.GetWindows()[0].Get<TestStack.White.UIItems.Panel>(TestStack.White.UIItems.Finders.SearchCriteria.All);
                    wpfobject.WaitTillLoad();
                    //Click at location where Save button is present
                    TestStack.White.InputDevices.Mouse.Instance.Click(new System.Windows.Point(((pane.Items[1].Location.X + pane.Items[2].Location.X) / 2 + 1), ((pane.Items[1].Location.Y + pane.Items[2].Location.Y) / 2 + 1)));
                    wpfobject.WaitTillLoad();
                }
                result.steps[++ExecutedSteps].status = "Partially Automated";

                //Step 5 - Click on the save button
                PageLoadWait.WaitForDownload(FileName.Split('.')[0], Config.downloadpath, FileName.Split('.')[1]);
                if (File.Exists(Config.downloadpath + Path.DirectorySeparatorChar + FileName))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    PageLoadWait.WaitForDownload(FileName, Config.downloadpath, "pdf");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CloseStudy();

                //Step 6 - Open the PDF files previously saved using the local PDF reader.                
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 7 - Print the PDF report to a local printer
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 8 - In the service tool Viewer Tab--> Download Report Page add text in Institution Name, Institution Information and File Name in target language.
                //         Upload logo in target language Restart IIS
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 9 - Print the PDF report to a local printer
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Manage Archived Folders (desktop)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_99177(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainA, RoleA and UserA
            String DomainName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
            String RoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
            String UserName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
            String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");

            String[] Domain = DomainName.Split(':');
            String[] Role = RoleName.Split(':');
            String[] Name = UserName.Split(':');
            String[] Langs = Languages.Split(':');

            String domainA = Domain[0] + "_99177_" + new Random().Next(1, 1000);
            String domainadminA = Domain[1] + "_99177_" + new Random().Next(1, 1000);
            String passwordA = domainA;
            String roleA = Role[0] + "_99177_" + new Random().Next(1, 1000);
            String userA = Name[0] + "_99177_" + new Random().Next(1, 1000);

            //Folders
            String topfoldername1 = Name[1] + "_1_99177_" + new Random().Next(1, 1000);
            String subfoldername1 = Name[2] + "_1_99177_" + new Random().Next(1, 1000);
            String subfoldername2 = Name[2] + "_2_99177_" + new Random().Next(1, 1000);
            String subfoldername3 = Name[2] + "_3_99177_" + new Random().Next(1, 1000);
            String foldermanager = String.Empty;
            String description1 = Name[3] + "_1_99177_" + new Random().Next(1, 1000);
            String notes1 = Name[4] + "1_99177_" + new Random().Next(1, 1000);
            String folderpath1 = topfoldername1;

            String topfoldername2 = Name[1] + "_2_99177_" + new Random().Next(1, 1000);
            String subfoldername22 = Name[2] + "_22_99177_" + new Random().Next(1, 1000);
            String subfoldername23 = Name[2] + "_23_99177_" + new Random().Next(1, 1000);
            String description2 = Name[3] + "_2_99177_" + new Random().Next(1, 1000);
            String notes2 = Name[4] + "_2_99177_" + new Random().Next(1, 1000);
            String folderpath21 = topfoldername2;
            String folderpath22 = topfoldername2;

            String topfoldername3 = Name[1] + "_3_99177_" + new Random().Next(1, 1000);
            String subfoldername31 = Name[2] + "_31_99177_" + new Random().Next(1, 1000);
            String description3 = Name[3] + "_3_99177_" + new Random().Next(1, 1000);
            String notes3 = Name[4] + "_3_99177_" + new Random().Next(1, 1000);
            String folderpath3 = topfoldername3;

            String topfoldername4 = Name[1] + "_4_99177_" + new Random().Next(1, 1000);
            String subfoldername41 = Name[2] + "_41_99177_" + new Random().Next(1, 1000);
            String subfoldername42 = Name[2] + "_42_99177_" + new Random().Next(1, 1000);
            String description4 = Name[3] + "_4_99177_" + new Random().Next(1, 1000);
            String notes4 = Name[4] + "_4_99177_" + new Random().Next(1, 1000);
            String folderpath41 = topfoldername4;
            String folderpath42 = topfoldername4;

            StudyViewer viewer = null;

            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            String[] arraccession = accession.Split('-');

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainA, RoleA and User A
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                domainmanagement.CreateDomain(domainA, domainA, datasources: null);
                domainmanagement.ConferenceListsCB().Click();
                domainmanagement.ClickSaveNewDomain();

                //Create Role with Conference enabled
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement", 1, "Role");
                rolemanagement.CreateRole(domainA, roleA, "Conference");

                //Create UserA of RoleA
                usermanagement = (UserManagement)login.Navigate("UserManagement", 1, "User");
                usermanagement.CreateUser(userA, domainA, roleA, 1, Config.emailid, 1, userA);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(domainA, passwordA);
                var confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");

                ////Case-1
                confolder.CreateToplevelFolder(topfoldername1, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername1, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername1;
                confolder.CreateSubFolder(folderpath1, subfoldername2, Description: description1);
                folderpath1 = folderpath1 + "/" + subfoldername2;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername22, Description: description2);
                folderpath21 = topfoldername2 + "/" + subfoldername22;
                confolder.CreateSubFolder(topfoldername2, subfoldername23, Description: description2);
                folderpath22 = topfoldername2 + "/" + subfoldername23;

                //Case-3
                confolder.CreateToplevelFolder(topfoldername3, description: description3);
                confolder.CreateSubFolder(topfoldername3, subfoldername31, Description: description3);
                folderpath3 = topfoldername3 + "/" + subfoldername31;

                //Add Studies to Case-1
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                String[] studyset1 = arraccession[0].Split(':');
                foreach (String accessionno in studyset1)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                    viewer.AddStudyToStudyFolder(folderpath1, notes: notes1);
                    viewer.CloseStudy();
                }

                //Add Studies to Case-2 SubFolder-1                
                String[] studyset2 = arraccession[1].Split(':');
                foreach (String accessionno in studyset2)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                    viewer.AddStudyToStudyFolder(topfoldername2 + "/" + subfoldername22, notes: notes2);
                    viewer.CloseStudy();
                }

                //Add Studies to Case-2 SubFolder-2 (Priors)             
                String[] studyset3 = arraccession[2].Split(':');
                foreach (String accessionno in studyset3)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1); ;
                    viewer.AddStudyToStudyFolder(topfoldername2 + "/" + subfoldername23, notes: notes3);
                    viewer.CloseStudy();
                }

                //Archive Folders
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.ArchiveConferenceFolder(folderpath1, null, 1);
                confolder.ArchiveConferenceFolder(folderpath21, null, 1);
                confolder.ArchiveConferenceFolder(folderpath22, null, 1);
                executedsteps++;
                #endregion Step-3-Precondition

                //Step 4 - Login iCA as a domain admin (e.g. daA), navigate to the Conference Folders tab, select Archive sub-tab in the folder browser, browse to a study folder (e.g. top level folder 1 -> level2>level3 -> references to multiple studies)
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(domainA, passwordA);
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(folderpath1);
                if (confolder.AddFolderBtn().GetAttribute("style").Contains("opacity: 1") == false && confolder.ManageTopLevelFolders().Enabled == false)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 5 - Verify the Folder Description and conference studies list.
                bool isDescription = confolder.DescriptionText().Equals(description1);
                bool isStudycount = BasePage.GetSearchResults().Count == studyset1.Length;
                if (isDescription && isStudycount)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 6 - Edit the top level folder name and folder description.
                String topfolder1new = Name[5] + random.Next() + random.Next(1, limit);
                String description1new = Name[6] + random.Next() + random.Next(1, limit);
                confolder.EditTopLevelFolder(topfoldername1, topfolder1new);
                confolder.EditDescription(description1new);
                bool isNamechanged = confolder.ExpandAndSelectFolder(topfolder1new).Text.Equals(topfolder1new);
                bool isDescription6 = confolder.DescriptionText().Equals(description1new);
                if (isNamechanged && isDescription6)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 7 - Repeat above step this time edit a sub-folder name and description.
                String subfolder1new = Name[7] + random.Next() + random.Next(1, limit);
                String subdescription1new = Name[7] + random.Next() + random.Next(1, limit);
                confolder.RenameFolder(topfolder1new + "/" + subfoldername1, subfolder1new);
                confolder.EditDescription(subdescription1new);
                bool isNamechanged7 = false;
                try { isNamechanged7 = confolder.ExpandAndSelectFolder(topfolder1new + "/" + subfolder1new).Text.Equals(subfolder1new); }
                catch (Exception) { isNamechanged7 = false; }
                bool isDescription7 = confolder.DescriptionText().Equals(subdescription1new);
                if (isNamechanged7 && isDescription7)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 8 - From a study folder, select a study, edit the conference notes.
                String notes8 = Name[4] + random.Next(1, limit);
                folderpath1 = topfolder1new + "/" + subfolder1new + "/" + subfoldername2;
                confolder.ExpandAndSelectFolder(folderpath1);
                confolder.SelectStudy(GetStudyGridColName("Accession"), studyset1[0]);
                confolder.ModifyConferenceStudyNotes(notes8);
                bool isNotesupdated8 = confolder.GetStudyNotesFromTextArea().Equals(notes8);
                if (isNotesupdated8)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 9 - Load the study and view the conference in the History fly-out.
                viewer = confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.StudyNotesTab().Click();
                Thread.Sleep(1000);
                bool isNotesupdated9 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes8);
                viewer.CloseStudy();
                if (isNotesupdated9)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-10 - Apply functions in the conference studies list (sort, group, add/remove columns)
                #region  Validate Sort, Add remove and Grop By
                executedsteps++;

                //Step-Validate sort works                
                bool isSortedAsc = false;
                IWebElement[] elements = BasePage.GetColumnElements(isConferenceTab: true);
                IWebElement Col_accession = null;
                foreach (IWebElement element in elements)
                {
                    String columnname = element.Text.Trim().Replace(" ", "");
                    if (columnname.Equals(GetStudyGridColName("Accession"))) { Col_accession = element; break; }
                }
                Col_accession.Click();
                String[] values = BasePage.GetColumnValues(BasePage.GetSearchResults(), GetStudyGridColName("Accession"), BasePage.GetColumnNames());
                String[] sortedvalues = values.ToList().OrderBy<String, String>(value => value).ToArray();
                isSortedAsc = values.SequenceEqual(sortedvalues);

                if (isSortedAsc)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }

                //Validate group by
                confolder.SelectGroupByInStudiesTab(GetStudyGridColName("Accession"), 1);
                if (confolder.IsGroupedBy(GetStudyGridColName("Accession"), 1))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }
                confolder.SelectGroupByInStudiesTab(login.ReadDataFromResourceFile(Localization.ConferenceStudyGridControl, "data", "No_Grouping"), 1);

                //Validate Add Remove column
                confolder.ChooseColumns(new string[] { GetStudyGridColName("Last Name") });
                if (BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Last Name"))))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }

                confolder.ClickChooseColumns();
                confolder.SelectColumns(new string[] { GetStudyGridColName("Last Name") }, "Remove", isConferenceTab: true, isRerarrange: false);
                confolder.OKButton_ChooseColumns().Click();
                if (!BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Last Name"))))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }


                if (result.steps[executedsteps].statuslist.Contains("Fail"))
                {
                    result.steps[executedsteps].status = "Fail";
                }
                else
                {
                    result.steps[executedsteps].status = "Pass";
                }
                #endregion  Validate Sort, Add remove and Grop By

                //Step 11 - Select a study from the conference studies list, delete study (Pease keep the study that has notes been modified.)
                confolder.DeleteStudy(GetStudyGridColName("Accession"), studyset1[1]);
                int studycount11 = BasePage.GetSearchResults().Count;
                if (studycount11 == studyset1.Length - 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 12 - Undo Archive this folder that has been modified in the Archive mode 
                //          (e.g. top level folder 1 -> level2>level3 -> references to multiple studies). Verify the study folder is restored.
                confolder.UndoArchiveFolder(folderpath1, 1);
                bool isFolderRemoved = false;
                try { isFolderRemoved = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderRemoved = false; }
                confolder.NavigateToActiveMode();
                bool isFolderRestored = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2);
                if (!isFolderRemoved && isFolderRestored)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 13 - Login as the conference user in preferred language(userA1), 
                //          navigate to the Conference Folders tab, browse to the study folder that just restored
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA, userA);
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.ExpandAndSelectFolder(folderpath1);
                bool isStudycount13 = BasePage.GetSearchResults().Count == (studyset1.Length - 1);

                //Take Topfoldername and description
                bool isTopfolderupdated13 = confolder.ExpandAndSelectFolder(topfolder1new).Text.Equals(topfolder1new);
                bool isDescription13 = confolder.DescriptionText().Equals(description1new);

                //Take subfoldername and Descritption
                bool isSubfolderupdated13 = confolder.ExpandAndSelectFolder(topfolder1new + "/" + subfolder1new).Text.Equals(subfolder1new);
                bool isSubDescription13 = confolder.DescriptionText().Equals(subdescription1new);

                if (isStudycount13 && isTopfolderupdated13 && isDescription13 && isSubfolderupdated13 && isSubDescription13)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 14 - Load these restored studies.
                confolder.ExpandAndSelectFolder(folderpath1);
                confolder.SelectStudy(GetStudyGridColName("Accession"), studyset1[0]);
                viewer = confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.StudyNotesTab().Click();
                Thread.Sleep(1000);
                bool isNotesupdated14 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes8);
                if (isNotesupdated14)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step-15 - Login as the domain admin in preferred language (daA in DomainA), 
                //          from the Conference Folders tab toggle on the Archive mode, 
                //          select an archived study folder that contains reference to prior studies, 
                //          modify study notes of these prior studies.
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(domainA, passwordA);
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23);
                String notes15 = "NotesPriors" + random.Next(1, limit);
                bool isNotesUpdated15 = false;
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    confolder.ModifyConferenceStudyNotes(notes15);
                }
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    isNotesUpdated15 = confolder.GetStudyNotesFromTextArea().Equals(notes15);
                    if (!isNotesUpdated15) break;
                }
                if (isNotesUpdated15)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 16 - Undo Archive the study that has been modified in the Archive mode 
                //          (e.g. top level folder 2 -> sub folder2 -> references to prior studies with notes). 
                //          Verify the study folder is restored.
                confolder.UndoArchiveFolder(topfoldername2 + "/" + subfoldername23, 1);
                confolder.NavigateToActiveMode();
                bool isFolderRestored16 = confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23).Text.Equals(subfoldername23);
                if (isFolderRestored16)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 17 - Login as the conference user (userA1), navigate to the Conference Folders tab, browse to the study folder that just restored,
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userA, userA);
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23);
                int studycount17 = BasePage.GetSearchResults().Count;
                bool isNotesUpdated17 = false;
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy(GetStudyGridColName("Accession"), studyset3[0]);
                    isNotesUpdated17 = confolder.GetStudyNotesFromTextArea().Equals(notes15);
                    if (!isNotesUpdated17) break;
                }
                if (isNotesUpdated17)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 18 - Load these restored prior studies.
                confolder.SelectStudy(GetStudyGridColName("Accession"), studyset3[0]);
                confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.ChooseColumns(new string[] { GetStudyGridColName("Accession") });
                bool isNotesUpdated18 = false;
                foreach (String accessionno in studyset3)
                {
                    viewer.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    viewer.StudyNotesTab().Click();
                    Thread.Sleep(1000);
                    isNotesUpdated18 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes15);
                    if (!isNotesUpdated18) break;
                }
                if (isNotesUpdated18)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step 19 - Login as the Domain admin in preferred language (daA in DomainA), 
                //          from the Conference Folders tab Active sub-tab, Archive both restored folders.
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(domainA, passwordA);
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.ArchiveConferenceFolder(folderpath1, null, 1);
                confolder.ArchiveConferenceFolder(topfoldername2 + "/" + subfoldername23, null, 1);
                confolder.NavigateToArchiveMode();
                bool isArchived19_1 = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2);
                bool isArchived19_2 = confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23).Text.Equals(subfoldername23);
                if (isArchived19_1 && isArchived19_2)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 20 - Toggle on Archive mode, delete a study folder (e.g. top level folder 1 -> level2>level3 -> references to multiple studies .
                confolder.DeleteFolder(folderpath1, 1);
                bool isFolderDeleted = false;
                try { isFolderDeleted = !confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderDeleted = true; }
                if (isFolderDeleted)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-21 - Repeat above step this time delete a top folder that contains multiple folders (e.g. top level folder 2)
                confolder.DeleteFolder(topfoldername2, 1);
                bool isFolderDeleted21 = false;
                try { isFolderDeleted21 = !confolder.ExpandAndSelectFolder(topfoldername2).Text.Equals(topfoldername2); }
                catch (Exception) { isFolderDeleted21 = true; }
                if (isFolderDeleted21)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-22 - Repeat above step this time delete a top folder that does not contain a study folder (e.g. top level folder 0 -> sub 1 -> references to 0 studies)
                confolder.DeleteFolder(topfoldername3, 1);
                bool isFolderDeleted22 = false;
                try { isFolderDeleted22 = !confolder.ExpandAndSelectFolder(topfoldername3).Text.Equals(topfoldername3); }
                catch (Exception) { isFolderDeleted22 = true; }
                if (isFolderDeleted22)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-23 - Select the Active sub-tab, add a new top level folder, add at least 2 sub-folders under it, add studies to both sub-folders. Archive one of study folder.
                confolder.NavigateToActiveMode();
                confolder.CreateToplevelFolder(topfoldername4, description: description4);
                confolder.CreateSubFolder(topfoldername4, subfoldername41, Description: description4);
                folderpath41 = topfoldername4 + "/" + subfoldername41;
                confolder.CreateSubFolder(topfoldername4, subfoldername42, Description: description4);
                folderpath42 = topfoldername4 + "/" + subfoldername42;
                //Add Studies            
                String[] studyset4 = arraccession[3].Split(':');
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                foreach (String accessionno in studyset4)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                    viewer.AddStudyToStudyFolder(folderpath41, notes: notes4);
                    viewer.CloseStudy();
                }
                String[] studyset5 = arraccession[4].Split(':');
                foreach (String accessionno in studyset5)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy(GetStudyGridColName("Accession"), accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                    viewer.AddStudyToStudyFolder(folderpath42, notes: notes4);
                    viewer.CloseStudy();
                }
                confolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                confolder.ArchiveConferenceFolder(folderpath41, null, 1);
                executedsteps++;

                //Step-24 - From the Archive mode, delete the top level folder under it one study folder in Archive mode and one is still in Active mode.
                confolder.NavigateToArchiveMode();
                confolder.DeleteFolder(topfoldername4, 1);
                bool isFolderDeleted24 = false;
                try { isFolderDeleted24 = !(confolder.ExpandAndSelectFolder(topfoldername4).Text.Equals(topfoldername4)); }
                catch (Exception) { isFolderDeleted24 = true; }
                if (isFolderDeleted24)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step 25 - This will be covered in separate Test
                result.steps[++executedsteps].status = "Not Automated";

                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// System Setting and Maintenance
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90603(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String EventTypeUserAuthentication = ReadDataFromResourceFile(Localization.Audit, "data", "EVENT_DCM_110114");

            WebDriverWait wait = new WebDriverWait(Driver, new TimeSpan(0, 0, 120));

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data                                
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String Emails = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Email");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Reason = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String URLs = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");

                String[] Langs = Languages.Split(':');
                String[] Name = Names.Split(':');
                String[] Email = Emails.Split(':');
                String[] Accessions = AccessionList.Split(':');
                String[] url = URLs.Split(':');

                String User = Name[0] + "_90603_" + new Random().Next(1, 1000);

                //Step 1 - Create user in SuperAdmin Domain               
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(User, Config.adminGroupName, Config.adminRoleName);
                login.Logout();
                ExecutedSteps++;

                //Step 2 - Go to System setting page.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                systemsettings = (SystemSettings)login.Navigate("SystemSettings", 1, "System");
                if (ValidateLocalization(ICA_MappingFilePath, "SystemSettings"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Change the Default Study Search Date Range to last Month, and select Save..
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                PageLoadWait.WaitForFrameLoad(20);
                systemsettings.DefaultStudySearchDateRange().SelectByValue("1.month");
                systemsettings.SystemSettingsSaveButton().Click();
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                wait.Until(ExpectedConditions.ElementToBeClickable(systemsettings.By_CloseButton()));
                if (systemsettings.SysetmSettingsSaveMessage().Text.Equals(ReadDataFromResourceFile(Localization.SystemConfigurationDisplay, "data", "Message_SystemUpdateSuccess")) &&
                    Driver.FindElement(systemsettings.By_CloseButton()).GetAttribute("value").Equals(ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Button_Close")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                systemsettings.SystemSettingsCloseButton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(systemsettings.By_SaveSystemButton()));

                //Step 4 - Logout and login as a use in the same domain and Select Studies Tab, observe the Study Performed value.
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(User, User);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                if (Driver.FindElement(By.CssSelector("#searchStudyMainText")).GetAttribute("innerHTML").Equals("Last Month"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 - Login as Administrator in target language
                //         Go to Maintenance tab, check Statistics ,Audit, Log and Viewer Services page.
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                bool bAudit = ValidateLocalization(ICA_MappingFilePath, "Audit");
                maintenance.Navigate("Statistics", 1, 1, "Maintenance");
                bool bStatistics = ValidateLocalization(ICA_MappingFilePath, "Statistics");
                maintenance.Navigate("Log", 1, 1, "Maintenance");
                bool bLog = ValidateLocalization(ICA_MappingFilePath, "Log");
                maintenance.Navigate("ViewerServices", 1, 1, "Maintenance");
                bool bViewerservices = ValidateLocalization(ICA_MappingFilePath, "ViewerServices");
                if (bAudit && bStatistics && bLog && bViewerservices)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 6 - Login iConnect Access as Administrator in target language
                //         Select Maintenance tab->Log and check the log page, when there is no transaction
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Log", 1, 1, "Maintenance");
                if (Driver.FindElement(By.CssSelector("#m_listControl_m_dataListGrid tbody tr:nth-child(2)")).GetAttribute("innerText").
                    Equals(ReadDataFromResourceFile(Localization.System, "data", "Message_LogEmpty")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 7 - Generate an error (such as wrong login, abnormal ending session..) and check the log page
                servicetool.LaunchServiceTool(); servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableEmailStudy();
                servicetool.ApplyEnableFeatures();
                Thread.Sleep(2000);
                wpfobject.ClickOkPopUp();
                Thread.Sleep(2000);
                servicetool.RestartService();
                servicetool.CloseServiceTool();

                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("emailstudy", 0);
                domainmanagement.AddToolsToToolbarByName(new string[] { "Email Study" });
                domainmanagement.ClickSaveEditDomain();

                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(Config.adminGroupName);
                rolemanagement.SearchRole(Config.adminRoleName);
                rolemanagement.SelectRole(Config.adminRoleName);
                rolemanagement.ClickEditRole();
                rolemanagement.SetCheckboxInEditRole("email", 0);
                rolemanagement.ClickSaveEditRole();
                login.Logout();

                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, "Test");
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[0]);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                studyviewer = studies.LaunchStudy();
                studyviewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "emailStudy"), "review", 1);
                wait.Until(ExpectedConditions.ElementIsVisible(studyviewer.By_EmailStudyDiv()));
                studyviewer.ToEmailTxtBox().SendKeys(Email[0]);
                studyviewer.ToNameTxtBox().SendKeys(Name[0]);
                studyviewer.ReasonTxtBox().SendKeys(Reason);
                studyviewer.EmailStudySendBtn().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(studyviewer.By_EmailStudyErrMsgLbl()));
                viewer.CloseStudy();

                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Log", 1, 1, "Maintenance");
                if (Driver.FindElement(By.CssSelector("#m_listControl_m_dataListGrid tbody tr:nth-child(2)")).Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Check Audit page
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                maintenance.SetCheckBoxInAudit("success", false);
                maintenance.SetCheckBoxInAudit("minor");
                maintenance.SelectEventID(EventTypeUserAuthentication, 0);
                maintenance.Btn_Search().Click();
                maintenance.AuditListTable()[1].Click();
                PageLoadWait.WaitForPageLoad(10);
                PageLoadWait.WaitForFrameLoad(10);
                //wait.Until(ExpectedConditions.ElementIsVisible(maintenance.By_MessageDetailsDiv()));
                bool bTypeCode = Driver.FindElement(By.CssSelector("#m_messageDetail_EventTypeCodeDetail")).GetAttribute("value").Equals(ReadDataFromResourceFile(Localization.Audit, "data", "EVENTTYPE_DCM_110122"));
                bool bOutcome = Driver.FindElement(By.CssSelector("#m_messageDetail_EventOutcomeDetail")).GetAttribute("value").Equals(ReadDataFromResourceFile(Localization.Audit, "data", "Outcome_MinorFailure"));
                if (bTypeCode && bOutcome)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - In Audit page View the date format for the target languge in Search criteria and the entries
                String FromDate = maintenance.Edt_FromeDate().GetAttribute("value");
                String ToDate = maintenance.Edt_ToDate().GetAttribute("value");
                String Format = "dd-MMM-yyy";
                DateTime dt;
                if (FromDate.Equals(ToDate))
                //if (DateTime.TryParseExact(FromDate, Format, new CultureInfo(Config.Locale), DateTimeStyles.None, out dt) &&
                //    DateTime.TryParseExact(ToDate, Format, new CultureInfo(Config.Locale), DateTimeStyles.None, out dt))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - In Audit page, select specific date value i.e. date from 1-12 (entries should be present) .Click Search
                maintenance.SetCheckBoxInAudit("success");
                maintenance.SetCheckBoxInAudit("minor", false);
                maintenance.SelectEventID(EventTypeUserAuthentication, 0);
                maintenance.Btn_Search().Click();
                IList<IWebElement> td = maintenance.AuditListTable()[1].FindElements(By.CssSelector("td"));
                if (td[0].Text.Split('/')[0].Equals(login.ReadDataFromResourceFile(Localization.MaintenanceSearchControl, "data", "EventID_UserAuthentication")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - In Audit page, select specific date value i.e date beyond 12(entries should be present) .Click Search                
                maintenance.SetCheckBoxInAudit("success");
                maintenance.SetCheckBoxInAudit("minor", false);
                maintenance.SelectEventID(EventTypeUserAuthentication, 0);
                maintenance.Btn_Search().Click();
                IList<IWebElement> td1 = maintenance.AuditListTable()[1].FindElements(By.CssSelector("td"));
                if (td1[0].Text.Split('/')[0].Equals(login.ReadDataFromResourceFile(Localization.MaintenanceSearchControl, "data", "EventID_UserAuthentication")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - In Log page View the date format for the target languge in Search criteria and the entries
                maintenance.Navigate("Log", 1, 1, "Maintenance");
                String LogFromDate = maintenance.Edt_FromeDate().GetAttribute("value");
                String LogToDate = maintenance.Edt_ToDate().GetAttribute("value");
                if (LogFromDate.Equals(LogToDate))
                //if (DateTime.TryParseExact(LogFromDate, Format, new CultureInfo(Config.Locale), DateTimeStyles.None, out dt) &&
                //    DateTime.TryParseExact(LogToDate, Format, new CultureInfo(Config.Locale), DateTimeStyles.None, out dt))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - In Log page, select specific date value i.e. date from 1-12 (entries should be present) .Click Search
                IList<IWebElement> LogRecords = Driver.FindElements(By.CssSelector("#m_listControl_m_dataListGrid tbody tr"));
                IList<IWebElement> LogTr = LogRecords[1].FindElements(By.CssSelector("td"));
                if (LogTr[1].Text.Equals("Error") || LogTr[1].Text.Equals("Warning"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //In Log page, select specific date value i.e date beyond 12(entries should be present) .Click Search                
                if (LogTr[1].Text.Equals("Error") || LogTr[1].Text.Equals("Warning"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 15 - Login to iCA from the email url received for the user
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                ExecutedSteps++;

                //Step 16 - Go to System settings page
                systemsettings = (SystemSettings)login.Navigate("SystemSettings", 1, "System");
                if (systemsettings.LoginMsgAddressBox().Displayed && systemsettings.AllowSuppressLoginMsgChkBox().Selected == true)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17 - Fill in the URL address for the Log in Message address box and save
                systemsettings.ModifyLoginURLinSys(url[0]);
                systemsettings.SaveSystemSettings();
                ExecutedSteps++;

                //Step 18 - Logout the application and login again as Administrator
                login.Logout();
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                try
                {
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("LoginMessageIframe");
                    IWebElement yahoo = BasePage.Driver.FindElement(By.CssSelector("#UHSearchBox"));

                    if (Driver.FindElement(By.CssSelector("label[for='DisableWarningCheck']")).GetAttribute("innerText").Equals(login.ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Disable_Login_Message")) &&
                        Driver.FindElement(By.CssSelector("#OkButton")).GetAttribute("value").Equals(login.ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Button_OK")))
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                catch (Exception)
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 19 - Click OK to dismiss the page
                Driver.SwitchTo().DefaultContent();
                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("document.querySelector('#OkButton').click()");
                ExecutedSteps++;

                //Step 20 - Go to the studylist and load a study
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[0]);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                studies.LaunchStudy();
                if (studies.ViewStudy() == true)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CloseStudy();

                //Step 21 - Go to Domain Management page --> Select Edit button and Uncheck "Use system settings for login message"
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                domainmanagement.SetCheckBoxInEditDomain("login", 1);
                domainmanagement.ModifyLoginURLinDomain(url[1]);
                domainmanagement.SetCheckBoxInEditDomain("allow", 0);
                domainmanagement.ClickSaveDomain();
                ExecutedSteps++;

                //Step 22 - Logout and login as the same user: Administrator
                login.Logout();
                login.LoginMessageBox(Config.adminUserName, Config.adminPassword, 0, 1, Langs[1]);
                Driver.SwitchTo().DefaultContent();
                try
                {
                    Driver.SwitchTo().Frame("LoginMessageIframe");
                    IWebElement google = Driver.FindElement(By.CssSelector("#lst-ib"));
                    if (google.Displayed)
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                catch (Exception)
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 23 - Click on :Don't display this message check box and OK
                login.DismissLoginPopup();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                IWebElement element1 = BasePage.Driver.FindElement(By.Id("TabText0"));
                if (element1.Displayed == true)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                systemsettings = (SystemSettings)login.Navigate("SystemSettings");
                systemsettings.DefaultStudySearchDateRange().SelectByValue("all.dates");
                systemsettings.ModifyLoginURLinSys("");
                systemsettings.SaveSystemSettings();

                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                domainmanagement.SetCheckBoxInEditDomain("login", 0);
                domainmanagement.SetCheckBoxInEditDomain("allow", 1);
                domainmanagement.ClickSaveDomain();
                login.Logout();
            }
        }

        /// <summary>
        /// Study Viewer
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90555(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            String AdminUsername = Config.adminUserName;
            String AdminPassword = Config.adminPassword;
            String SuperAdmin = Config.adminGroupName;
            Random random = new Random();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data               
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                String FilePath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String[] Filepaths = FilePath.Split('=');
                String Acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = Acc.Split(':');
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = Firstname.Split(':');
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] Lastnames = Lastname.Split(':');
                String PID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] PatientIds = PID.Split(':');
                String PACSA7 = login.GetHostName(Config.SanityPACS);
                String DCM4CHEE = "DCM4CHEE";
                String EA91 = login.GetHostName(Config.EA91);
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String Preset = "テスト_" + random.Next(1, 1000);

                //GridColumnNames
                String StudyIDCol = GetStudyGridColName("Study ID");
                String AccCol = GetStudyGridColName("Accession");
                String PatCol = GetStudyGridColName("Patient ID");
                String NameCol = ReadDataFromResourceFile(Localization.AttachmentViewer, "data", "AttachmentTable_NameHeading");
                String AutoLayout = ReadDataFromResourceFile(Localization.ViewingProtocolsControl, "data", "auto_layout");
                String AddTextTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "AnnotationTextAdd");
                String EditAnnTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "AnnotationEdit");
                String ResetTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "Reset");
                String EllipseToolTip = ReadDataFromResourceFile(Localization.Tooltip, "data", "AnnotationEllipse");

                //Step:1-Login in iCA as Administrator with a preferred (target)language
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                domainmanagement.SearchDomain(SuperAdmin);
                domainmanagement.SelectDomain(SuperAdmin);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(10);
                domainmanagement.AddPresetForDomain("CT", Preset, "123", "456", layout: AutoLayout);
                domainmanagement.AddPresetForDomain("MR", Preset, "100", "456", layout: AutoLayout);
                domainmanagement.SaveButton().Click();
                PageLoadWait.WaitForPageLoad(10);
                PageLoadWait.WaitForFrameLoad(10);
                UserManagement usermgt = (UserManagement)login.Navigate("UserManagement", 1, "User");
                usermgt.DomainDropDown().SelectByText(SuperAdmin);
                String userid = Lastnames[0] + random.Next(1, 1000);
                usermgt.CreateUser(userid, SuperRole, FName: Firstnames[0] + random.Next(1, 1000), LName: userid);
                bool user = usermgt.SearchUser(userid, SuperAdmin);
                if (user)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2:Load any study to the viewer
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { StudyIDCol }, 1);
                studies.SearchStudy(studyID: StudyID, Datasource: PACSA7);
                studies.SelectStudy1(StudyIDCol, StudyID);
                StudyViewer viewer = StudyViewer.LaunchStudy();
                if (viewer.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-3:Checking the following tools, hover texts, dropdown menu:
                //--Each manipulation tool including Lossy Compressed text (hover)
                //--Dropdown menu from"scope selection","Layouts","Veritical Flip/Horizontal Flip","Save Annotation..","Measurements"
                //-"History"on left side and Cine -Group play icons on right side            
                IList<string> Tools = GetReviewToolsFromviewer();
                String SaveAnnTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "SaveAnnotatedImage").Replace(" ", "");
                String JointlineTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "OrthoJointLine").Replace(" ", "");
                String FlipVerTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "FlipVertical").Replace(" ", "");
                String ImgaelayoutTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "ImageLayout2x2").Replace(" ", "");
                String SeriesScopeTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "SeriesViewer2x3").Replace(" ", "");
                if (Tools.Contains(SaveAnnTooltip) && Tools.Contains(JointlineTooltip) && Tools.Contains(FlipVerTooltip) &&
                    Tools.Contains(ImgaelayoutTooltip) && Tools.Contains(SeriesScopeTooltip))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step:4-Check the hover text for the following button and options from Viewer:
                //--Close Viewer
                //- Window Presets (add in Options->User Preferences)
                IList<String> CT_APresets = new List<String>();
                IList<IWebElement> CT_EPresets = BasePage.Driver.FindElements(By.CssSelector("#StudyToolbar div[style*='inline'] ul li[title]"));
                String CloseviewerTooltip = ReadDataFromResourceFile(Localization.Tooltip, "data", "CloseViewer").Replace(" ", "");

                foreach (IWebElement title in CT_EPresets)
                {
                    CT_APresets.Add(title.GetAttribute("title"));
                }

                if (CT_APresets.Contains(Preset + ":123/456") && Tools.Contains(CloseviewerTooltip))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step:5-Load a study that was created in target language
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[0], Datasource: DCM4CHEE);
                studies.SelectStudy1(AccCol, Accessions[0]);
                viewer = StudyViewer.LaunchStudy();

                if (viewer.PatientInfo().Contains(Firstnames[0]) && viewer.PatientInfo().Contains(Lastnames[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step-6:Load studies in target language as per the test data created
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[1], Datasource: DCM4CHEE);
                studies.SelectStudy1(PatCol, PatientIds[0]);
                viewer = StudyViewer.LaunchStudy();

                if (viewer.PatientInfo().Contains(Firstnames[1]) && viewer.PatientInfo().Contains(Lastnames[1]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step-7:Load a study having a PR with any annotation (values present in text Attributes of the DICOM content)
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(patientID: PatientIds[1], Datasource: EA91);
                studies.SelectStudy1(PatCol, PatientIds[1]);
                viewer = StudyViewer.LaunchStudy();
                if (viewer.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Input texts (in target language) on the image from Measurement tools                
                viewer.SelectToolInToolBar(AddTextTooltip);
                viewer.AddTextAnnotation(viewer.SeriesViewer_1X1(), 200, 200, Lastnames[0]);
                //viewer.SelectToolInToolBar(EditAnnTooltip);
                if (viewer.GetElementCursorType(viewer.SeriesViewer_1X1()).Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Save the Annotation
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step-10:Reload this PR series
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step-11:Click on Patient History tab and view patient details on left side
                viewer.NavigateToHistoryPanel();
                bool validate11 = ValidateLocalization(ICA_MappingFilePath, "HistoryPanelPage");
                if (validate11)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.CloseStudy();
                login.Logout();

                //Step-12:Logout and log back in using user created in target language (within the domain)
                login.DriverGoTo(url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid, userid);
                ExecutedSteps++;

                //Step-13:Load a study that has multiple series
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(patientID: PatientIds[2], Datasource: EA91);
                studies.SelectStudy1(PatCol, PatientIds[2]);
                viewer = StudyViewer.LaunchStudy();
                if (viewer.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Add a few measurements, combined with input text in target language on a few images from different series
                viewer.SelectToolInToolBar(AddTextTooltip);
                viewer.AddTextAnnotation(viewer.SeriesViewer_1X1(), 200, 200, Lastnames[0]);
                bool viewer1 = viewer.GetElementCursorType(viewer.SeriesViewer_1X1()).Equals("crosshair");
                viewer.SeriesViewer_1X2().Click();
                viewer.SelectToolInToolBar(AddTextTooltip);
                viewer.AddTextAnnotation(viewer.SeriesViewer_1X2(), 250, 200, Lastnames[0], X_Viewer: 1, Y_Viewer: 2);
                bool viewer2 = viewer.GetElementCursorType(viewer.SeriesViewer_1X2()).Equals("crosshair");
                if (viewer1 && viewer2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Save series
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step-16:Apply the predefined Window Preset value by selecting from the icon on the left side of viewer
                viewer.SeriesViewer_2X2().Click();
                viewer.SelectToolInToolBar(ResetTooltip);
                IList<String> MR_APresets = new List<String>();
                IList<IWebElement> MR_EPresets = BasePage.Driver.FindElements(By.CssSelector("#StudyToolbar div[style*='inline'] ul li[title]"));

                foreach (IWebElement title in MR_EPresets)
                {
                    MR_APresets.Add(title.GetAttribute("title"));
                }
                Thread.Sleep(3000);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForAllViewportsToLoad(30);

                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("document.querySelector(\"#StudyToolbar div[style*='inline'] ul li[title='" + Preset + ":100/456']\").click()");
                Thread.Sleep(3000);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForAllViewportsToLoad(30);

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool Step_16 = studies.CompareImage(result.steps[ExecutedSteps], viewer.SeriesViewer_2X2());


                if (MR_APresets.Contains(Preset + ":100/456") && Step_16)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step-17:Load a data which is not calibrated. Draw few measurements, then select to calibrate the image. and input decimal value
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[1], Datasource: DCM4CHEE);
                studies.SelectStudy1(PatCol, PatientIds[0]);
                viewer = StudyViewer.LaunchStudy();

                if (viewer.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step-18:Load a study which has PR series with measurements on it in target language
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(patientID: PatientIds[1], Datasource: EA91);
                studies.SelectStudy1(PatCol, PatientIds[1]);
                viewer = StudyViewer.LaunchStudy();
                ExecutedSteps++;

                //Step-19:Input some text in the target language (ex. Chinese) from Add text
                viewer.SeriesViewer_1X1().Click();
                viewer.SelectToolInToolBar(AddTextTooltip);
                viewer.AddTextAnnotation(viewer.SeriesViewer_1X1(), 200, 200, Lastnames[0]);
                bool viewer2_19 = viewer.GetElementCursorType(viewer.SeriesViewer_1X1()).Equals("crosshair");
                if (viewer2_19)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-20:Save the annotation and reload the image back to active viewport
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step-21:Draw a rectangle
                viewer.SelectToolInToolBar(ResetTooltip);
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Equals("firefox"))
                {
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.DrawRectangle);
                    viewer.DrawRectangle(viewer.SeriesViewer_1X2(), 90, 30, 120, 130);

                    result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                    bool step_21 = studies.CompareImage(result.steps[ExecutedSteps], viewer.SeriesViewer_1X2());
                    if (step_21)
                    {
                        result.steps[ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Not Automated";
                }

                //Step-22:Draw a Ellipse
                viewer.SelectToolInToolBar(EllipseToolTip);
                viewer.DrawEllipse(viewer.SeriesViewer_1X1(), 120, 120, 180, 150);
                PageLoadWait.WaitForFrameLoad(20);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool Step_22 = studies.CompareImage(result.steps[ExecutedSteps], viewer.SeriesViewer_1X1());
                if (Step_22)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-23:Save the series
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step-24:Re-load the study.
                result.steps[++ExecutedSteps].status = "Not Automated";

                viewer.CloseStudy();
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Study viewing from Patients tab
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90659(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies;
            StudyViewer viewer;
            Patients patient;
            string WebaccessConfigurationpath = Config.FileLocationPath;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String Acc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = Acc.Split(':');
                String Datasource = Config.xds2; //EA-46
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String[] PageList = { "ReportErrorPage", "PatientsTab", "PatientRecord" };
                String email = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "EmailID");
                String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String comments = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");
                String phonenum = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PhoneNumber");
                String FullName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                //Resource file values
                String AccCol = GetStudyGridColName("Accession");
                String ReportErrorTool = ReadDataFromResourceFile(Localization.Tooltip, "data", "ReportErrorTool");
                String XdsStudiesTab_AccCol = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "AccessionNumber");


                //Step:1-IPatients
                //Enable patients in service tool
                //setup XDS(General setup guide for XDS is explained here, so make sure you go through it.                                        https-//dc.merge.com/display/DEV/Configuring+XDS
                //execute test case #73368)
                // In the service tool in the Encryption Tab enter an AES Encryption Service
                //Click on Add and enter the following settings-
                //Key - AES
                //Assembly- - OpenContent.Generic.Core.dll
                //Class- - OpenContent.Core.Security.Services.AES
                //In the Service parameters enter the Following - 
                //key----------------- string ----------JnQ5gOD1/ZlH4GGeahQZVA
                //iv-----------------------string------------ 
                //characterSet--------string------------Windows-1252 
                //operationMode----string----------CBC
                //paddingMode------string----------Zeros
                //Enable the Error Report Tool (MDM) in the Viewer /Miscellaneous 
                //Click on Modify/Details and select Encrypted, select from the drop down the Cryptographic.AES, OK 
                //Enable the Report Error Tool in the Domain management ( this enables the reporting of errors in the XDS for documents) 
                servicetool.LaunchServiceTool();
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                wpfobject.WaitTillLoad();
                Thread.Sleep(10000);
                wpfobject.SelectTabFromTabItems(ServiceTool.Encryption.Name.Encryption_tab);
                Thread.Sleep(10000);
                servicetool.Enc_ServiceTab().Focus();
                servicetool.Enc_ServiceTab().Click();
                servicetool.EnterServiceEntry("AES", "OpenContent.Generic.Core.dll", "OpenContent.Core.Security.Services.AES");
                servicetool.EnterServiceParameters("key", "string", "JnQ5gOD1/ZlH4GGeahQZVA==");
                servicetool.EnterServiceParameters("iv", "string", "");
                servicetool.EnterServiceParameters("characterset", "string", "Windows-1252");
                servicetool.EnterServiceParameters("operationMode", "string", "CBC");
                servicetool.EnterServiceParameters("paddingMode", "string", "Zeros");
                wpfobject.GetMainWindowByTitle("Service Entry Form");
                wpfobject.GetButton("OK", 1).Click();
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                wpfobject.WaitTillLoad();
                //Enable the Error Report Tool (MDM) in the Viewer /Miscellaneous 
                //Click on Modify/Details and select Encrypted, select from the drop down the Cryptographic.AES, OK 
                servicetool.EnableReportTool(true, 0, "Cryptographic.AES");
                //Restart the service
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                //Login in iCA as Administrator
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                ExecutedSteps++;


                //Step:2-Navigate to the Studies Tab do a search for  a study that has XDS Document , a Radiology studies and Priors. Open it in the viewer
                //Chris,PQA
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accessions[0], Datasource: Datasource);
                studies.SelectStudy(AccCol, Accessions[0]);
                viewer = studies.LaunchStudy();
                if (viewer.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:3-Select an XDS document and then select the Error Reporting Icon
                viewer.SeriesViewer_2X3().Click();
                PageLoadWait.WaitForFrameLoad(10);
                viewer.SelectToolInToolBar(ReportErrorTool);
                ExecutedSteps++;

                //Step-4:Do not enter any information in the window that comes up
                //click on Submit Button
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.Driver.SwitchTo().Frame("m_ReportErrorFrame");
                viewer.ReportErrorOKBtn().Click();
                bool UIValidate4 = ValidateLocalization(ICA_MappingFilePath, PageList[0]); //This includes both step 3 & 4 validation
                if (UIValidate4)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:5-Enter the required data in the form(in target language) and Submit
                //click on Submit Button
                viewer.FillReportErrorForm(Firstname, Lastname, phonenum, email, comments);
                BasePage.Driver.SwitchTo().Frame("m_ReportErrorFrame");
                //if (viewer.ResultPopup().Displayed)
                //{
                //    result.steps[++ExecutedSteps].status = "Pass";
                //    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                //}
                //else
                //{
                //    result.steps[++ExecutedSteps].status = "Fail";
                //    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                //    result.steps[ExecutedSteps].SetLogs();
                //}
                result.steps[++ExecutedSteps].status = "ON HOLD";

                //Step:6-Close the Error acceptance popup
                //close study
                viewer.ReportErrorCloseBtn().Click();
                viewer.CloseStudy();
                ExecutedSteps++;

                //Step:7-Go to Patients tab
                patient = (Patients)login.Navigate("Patients", 1, "Patients");
                patient.ExpandPanel();
                PageLoadWait.WaitForFrameLoad(20);
                bool UIValidate7 = ValidateLocalization(ICA_MappingFilePath, PageList[1]);
                if (UIValidate7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step:8-Click Search button with text box empty
                PageLoadWait.WaitForFrameLoad(20);
                patient.ExpandPanel();
                PageLoadWait.WaitForFrameLoad(20);
                patient.ClickPatientSearch();
                String UIMsg = patient.FreeSearchErrorMsg().Text;
                String RescValue = ReadDataFromResourceFile(Localization.FreeTextPatientSearchControl, "data", "MissingSearchCriteria");
                bool ErrorMsg8 = UIMsg.Equals(RescValue);
                if (ErrorMsg8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-9:Configure the max number of patients displayed as a result of a search to the number within the limit (WebAccess\WebAccess\Config\WebAccessConfiguration.xml under PatientRecord---ResultList xml element path, change the MaxRecords to 3), reset IIS
                ChangeNodeValue(WebaccessConfigurationpath, "/PatientRecord/ResultList/MaxRecords", "3");
                RestartIISUsingexe();
                ExecutedSteps++;

                //step-10:From the Patient record page, type"s"in the Last Name box, click Search
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                patient = (Patients)login.Navigate("Patients", 1, "Patients");
                PageLoadWait.WaitForFrameLoad(20);
                patient.InputData("s");
                PageLoadWait.WaitForFrameLoad(20);
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                if (patient.PatientSearchTableErrorMsg().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-11:Revert the changes in WebAccess\WebAccess\Config\WebAccessConfiguration.xml
                ChangeNodeValue(WebaccessConfigurationpath, "/PatientRecord/ResultList/MaxRecords", "200");
                RestartIISUsingexe();
                ExecutedSteps++;

                //Step-12:From the Patient record page do a search for Patient with First name in target language
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                patient = (Patients)login.Navigate("Patients", 1, "Patients");

                result.steps[++ExecutedSteps].status = "On Hold";

                //Step-13:do a search for Patient with First name in English language
                patient.ExpandPanel();
                PageLoadWait.WaitForFrameLoad(20);
                patient.AdvancedSearch(firtsname: Firstname);
                PageLoadWait.WaitForFrameLoad(20);
                patient.ClickPatientSearch(1);
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                string[] names = BasePage.GetColumnValues(BasePage.GetSearchResults(), "Name", BasePage.GetColumnNames());
                if (names.All(name => name.ToLowerInvariant().Contains(Firstname.ToLowerInvariant())))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Double click on one patient(studies tab all date selected)
                patient.LoadStudyInPatientRecord(FullName); //firstname
                patient.NavigateToTabs("PmjRadiologyStudies", 1);
                string IdColumn = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "ID");
                string DescColumn14 = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "Description");
                string DataTimeColumn = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "DateTime");
                string ModColumn = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "Modalities");
                string AccColumn = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "AccessionNumber");
                string DatasourceColumn14 = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "DataSourceIDListUI");

                string[] IDCol = Driver.FindElement(By.CssSelector("table#RadiologyStudiesListControl_parentGrid td#ID")).GetAttribute("innerHTML").Split('<');
                string[] DescCol14 = Driver.FindElement(By.CssSelector("table#RadiologyStudiesListControl_parentGrid td#Description")).GetAttribute("innerHTML").Split('<');
                string[] DatatimeCol = Driver.FindElement(By.CssSelector("table#RadiologyStudiesListControl_parentGrid td#DateTime")).GetAttribute("innerHTML").Split('<');
                string[] ModCol = Driver.FindElement(By.CssSelector("table#RadiologyStudiesListControl_parentGrid td#Modalities")).GetAttribute("innerHTML").Split('<');
                string[] AccCol14 = Driver.FindElement(By.CssSelector("table#RadiologyStudiesListControl_parentGrid td#AccessionNumber")).GetAttribute("innerHTML").Split('<');
                string[] DatasourceCol14 = Driver.FindElement(By.CssSelector("table#RadiologyStudiesListControl_parentGrid td#DataSourceIDListUI")).GetAttribute("innerHTML").Split('<');

                if (IdColumn.Contains(IDCol[0]) && DescColumn14.Contains(DescCol14[0]) && DataTimeColumn.Contains(DatatimeCol[0]) &&
                    ModColumn.Contains(ModCol[0]) && AccColumn.Contains(AccCol14[0]) && DatasourceColumn14.Contains(DatasourceCol14[0]))
                {

                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:Select XDS tab -- Visits tab. 
                patient.NavigateToTabs("PmjXds", 1);
                patient.NavigateToSubTabs("PmjVisits", 1);
                string NameColumn = ReadDataFromResourceFile(Localization.PmjXdsSubmissionSets, "data", "Name");
                string AuthorColumn = ReadDataFromResourceFile(Localization.PmjXdsSubmissionSets, "data", "Author");
                string SubmissionColumn = ReadDataFromResourceFile(Localization.PmjXdsSubmissionSets, "data", "SubmissionTime");
                string[] NameCol = Driver.FindElement(By.CssSelector("td#Name span")).GetAttribute("innerHTML").Split('<');
                string[] AuthorCol = Driver.FindElement(By.CssSelector("td#Author span")).GetAttribute("innerHTML").Split('<');
                string[] SubmissionCol = Driver.FindElement(By.CssSelector("td#SubmissionTime span")).GetAttribute("innerHTML").Split('<');

                if (NameColumn.Equals(NameCol[0]) && AuthorColumn.Contains(AuthorCol[0]) && SubmissionColumn.Contains(SubmissionCol[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Select XDS tab -- Folders tab. 
                patient.NavigateToTabs("PmjXds", 1);
                patient.NavigateToSubTabs("PmjFolders", 1);
                string NameColumn16 = ReadDataFromResourceFile(Localization.PmjXdsFolders, "data", "Name");
                string DescColumn = ReadDataFromResourceFile(Localization.PmjXdsFolders, "data", "Description");
                string ModifiedColumn = ReadDataFromResourceFile(Localization.PmjXdsFolders, "data", "LastUpdateTime");
                string[] NameCol16 = Driver.FindElement(By.CssSelector("th#Name span span")).GetAttribute("innerHTML").Split('<');
                string[] DescCol = Driver.FindElement(By.CssSelector("th#Description span span")).GetAttribute("innerHTML").Split('<');
                string[] ModifiedCol = Driver.FindElement(By.CssSelector("th#LastUpdateTime span span")).GetAttribute("innerHTML").Split('<');
                if (NameColumn16.Contains(NameCol16[0]) && DescColumn.Contains(DescCol[0]) && ModifiedColumn.Contains(ModifiedCol[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-17:Select XDS tab -- Docs tab and select to view study/ document. 
                patient.NavigateToTabs("PmjXds", 1);
                patient.NavigateToSubTabs("PmjDocs", 1);
                string NameColumn17 = ReadDataFromResourceFile(Localization.PmjXdsDocs, "data", "Name");
                string AuthorsColumn = ReadDataFromResourceFile(Localization.PmjXdsDocs, "data", "Author");
                string DataTypeColumn = ReadDataFromResourceFile(Localization.PmjXdsDocs, "data", "MimeType");
                string CreatedColumn = ReadDataFromResourceFile(Localization.PmjXdsDocs, "data", "CreationTime");
                string AccessionColumn = ReadDataFromResourceFile(Localization.PmjXdsDocs, "data", "Accession");
                string AdmissionIDColumn = ReadDataFromResourceFile(Localization.PmjXdsDocs, "data", "AdmissionId");

                string[] NameCol17 = Driver.FindElement(By.CssSelector("td#Name span")).GetAttribute("innerHTML").Split('<');
                string[] AuthorsCol = Driver.FindElement(By.CssSelector("td#Author span")).GetAttribute("innerHTML").Split('<');
                string[] DatatypeCol = Driver.FindElement(By.CssSelector("td#MimeType span")).GetAttribute("innerHTML").Split('<');
                string[] CreatedCol = Driver.FindElement(By.CssSelector("td#CreationTime span")).GetAttribute("innerHTML").Split('<');
                string[] AccessionCol = Driver.FindElement(By.CssSelector("td#Accession span")).GetAttribute("innerHTML").Split('<');
                string[] AdmissionCol = Driver.FindElement(By.CssSelector("td#AdmissionId span")).GetAttribute("innerHTML").Split('<');

                if (NameColumn17.Contains(NameCol17[0]) && AuthorsColumn.Contains(AuthorsCol[0]) && DataTypeColumn.Contains(DatatypeCol[0]) &&
                    CreatedColumn.Contains(CreatedCol[0]) && AccessionColumn.Contains(AccessionCol[0]) && AdmissionIDColumn.Contains(AdmissionCol[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-18:Select Other Documents tab. 
                patient.NavigateToTabs("PmjOtherDocs", 1);
                string NameColumn18 = ReadDataFromResourceFile(Localization.PmjOtherDocs, "data", "Name");
                string TypeColumn = ReadDataFromResourceFile(Localization.PmjOtherDocs, "data", "Type");
                string DataTypeColumn18 = ReadDataFromResourceFile(Localization.PmjOtherDocs, "data", "MimeType");
                string CreatedColumn18 = ReadDataFromResourceFile(Localization.PmjOtherDocs, "data", "CreationDate");
                string ModifiedColumn18 = ReadDataFromResourceFile(Localization.PmjOtherDocs, "data", "LastUpdateDate");
                string DatasourceColumn = ReadDataFromResourceFile(Localization.PmjOtherDocs, "data", "DataSourceID");

                string[] NameCol18 = Driver.FindElement(By.CssSelector("td#Name")).GetAttribute("innerHTML").Split('<');
                string[] TypeCol = Driver.FindElement(By.CssSelector("td#Type")).GetAttribute("innerHTML").Split('<');
                string[] DatatypeCol18 = Driver.FindElement(By.CssSelector("td#MimeType")).GetAttribute("innerHTML").Split('<');
                string[] CreatedCol18 = Driver.FindElement(By.CssSelector("td#CreationDate")).GetAttribute("innerHTML").Split('<');
                string[] ModifiedCol18 = Driver.FindElement(By.CssSelector("td#LastUpdateDate")).GetAttribute("innerHTML").Split('<');
                string[] DataSourceCol = Driver.FindElement(By.CssSelector("td#DataSourceIDListUI")).GetAttribute("innerHTML").Split('<');

                if (NameColumn18.Contains(NameCol18[0]) && TypeColumn.Contains(TypeCol[0]) && DataTypeColumn18.Contains(DatatypeCol18[0]) &&
                    CreatedColumn18.Contains(CreatedCol18[0]) && ModifiedColumn18.Contains(ModifiedCol18[0]) && DatasourceColumn.Contains(DataSourceCol[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-19:Select Patients-Studies tab. And double click study to view the images. //PmjXds,PmjRadiologyStudies
                patient.NavigateToTabs("PmjRadiologyStudies", 1);
                viewer = patient.LaunchStudy(new string[] { XdsStudiesTab_AccCol }, Accessions[1]);
                if (viewer.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-20:Go to the History panel
                patient.NavigateToHistoryPanel();
                ExecutedSteps++;

                //Step-21:User clicks Add Columns located at the bottom left of Patient History list.
                ClickChooseColumns(check: 1);
                string RemoveAllLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "removeAll");
                string AddAllLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "addAll");
                string SelectColLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "caption", "col");
                string itemsSelectedLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "itemsCount");
                string OkBtn = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "bSubmit", "col");
                string CancelBtn = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "bCancel", "col");
                string itemsLbl = itemsSelected().Text;
                string SelectCol = SelectColumns().Text;
                string RemoveLbl = RemoveAllLink().GetAttribute("innerHTML");
                string AddLbl = AddAllLink().GetAttribute("innerHTML");

                if (itemsLbl.Contains(itemsSelectedLbl) && SelectColLbl.Equals(SelectCol) && RemoveAllLbl.Equals(RemoveLbl) &&
                    AddAllLbl.Equals(AddLbl) && OkBtn.Equals(OKChooseColLbl()) && CancelBtn.Equals(CancelChooseColLbl()))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                CancelButton_ChooseColumns().Click();

                //Step-22:Use clicks plus sign on column tile or clicks and drags the tile to the visible list. Click ok
                ExecutedSteps++;

                //Step-23:Verify the values displayed are valid and match settings.
                patient.ChooseColumns(new string[] { AccCol }, 1);
                Dictionary<string, string> secondstudy = viewer.GetMatchingRow(AccCol, Accessions[2]);
                if (secondstudy != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-24:Open a prior study by double-clicking               
                patient.OpenPriors(new string[] { AccCol }, new string[] { Accessions[2] });
                PageLoadWait.WaitForFrameLoad(20);
                String Studyinfo = viewer.StudyInfo(2);

                if (viewer.studyPanel(2).Displayed && secondstudy[AccCol].Equals(Studyinfo.Split(',')[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                patient.CloseStudy();
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);


                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                servicetool.LaunchServiceTool();
                wpfobject.GetMainWindow(ServiceTool.ConfigTool_Name);
                wpfobject.WaitTillLoad();
                Thread.Sleep(10000);
                wpfobject.SelectTabFromTabItems(ServiceTool.Encryption.Name.Encryption_tab);
                servicetool.DeleteServiceParameters("Key", "AES");
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }

        }

        /// <summary>
        /// Studies List & Search
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90556(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            String dataSourceName = "DCM4CHEE";
            String Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
            String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
            String[] Firstnames = Firstname.Split(':');
            String[] Lastnames = Lastname.Split(':');

            String FromDate = "23-7-2000";
            //String todate = String.Format("{0:dd-MMM-yyyy}", DateTime.Now);
            //DateTime fromdt = DateTime.ParseExact(FromDate, "dd-MMM-yyyy", System.Globalization.CultureInfo.InvariantCulture);
            //DateTime todt = DateTime.ParseExact(todate, "dd-MMM-yyyy", System.Globalization.CultureInfo.InvariantCulture);
            String todate = "23-7-2017";

            By fromdatecalender = By.CssSelector("#DateRangeSelectorCalendarFrom_calendar");
            By todatecalender = By.CssSelector("#DateRangeSelectorCalendarTo_calendar");

            try
            {
                //Fetch required Test data                
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Reason = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String pid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String SearchName = Names.Split(':')[0] + "_" + new Random().Next(1, 1000);

                String[] Langs = Languages.Split(':');
                String[] Accessions = AccessionList.Split(':');

                //Step 1 - Send Datasets created in Japanese ,Chinese from Japanese & Chinese OS respectively                

                //Other Precondition.
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                domainmanagement.VisibleAllStudySearchField();
                domainmanagement.ClickSaveNewDomain();
                login.Logout();
                ExecutedSteps++;

                //Step 2 - Verify the label of th Tabs -7 tabs
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                String Studies = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "Studies");
                String Patients = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "Patients");
                String DomainManagement = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "Domain");
                String RoleManagement = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "Role");
                String UserManagement = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "User");
                String SystemSettings = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "System");
                String Maintenance = ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Tab_" + "Maintenance");
                if (GetElement("cssselector", "div[id^='TabText0']").Text.Equals(Studies)
                   && GetElement("cssselector", "div[id^='TabText1']").Text.Equals(Patients)
                   && GetElement("cssselector", "div[id^='TabText2']").Text.Equals(DomainManagement)
                   && GetElement("cssselector", "div[id^='TabText3']").Text.Equals(RoleManagement)
                   && GetElement("cssselector", "div[id^='TabText4']").Text.Equals(UserManagement)
                   && GetElement("cssselector", "div[id^='TabText5']").Text.Equals(SystemSettings)
                   && GetElement("cssselector", "div[id^='TabText6']").Text.Equals(Maintenance))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Click on the first Tab from left (Studies) and verify the contents of the page in target language
                studies = (Studies)login.Navigate("Studies", 1, "Studies");

                //The text for Searching fields are in target language                
                //All Column headers - TODO
                //View Study ,Clear ,Search button is in target language
                //Group By text and column headers in dropdown should be in target language - TODO     
                //Total number of studies count are in target language - TODO
                //3 options (Administrator Logout, Options, Help) are all in target language - false
                bool bStudies = ValidateLocalization(ICA_MappingFilePath, "Studies");

                //Hide Search Criteria text
                bool bHideSearch = GetElement("cssselector", "#ExpandSearchPanelButton").GetAttribute("title").Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "hideSearch"));

                //Warning (in red) for query items exceeded limit is in target language
                studies.SearchStudy(LastName: "*", Study_Performed_Period: "Last Hour");
                PageLoadWait.WaitForLoadingMessage(65);
                bool bWarningMsg = GetElement("cssselector", "#m_studyGrid_m_messageLabel").Text.Equals(ReadDataFromResourceFile(Localization.Study, "data", "DefaultErrorMessage"));

                //If no records displayed text No records to view should be in target language
                bool bNoRecords = GetElement("cssselector", "#gridPagerDivStudyList_right div[class='ui-paging-info']").GetAttribute("innerText").Equals(GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "emptyrecords"));

                //Button label (Choose Columns ,Reset) should be in target language
                bool bChooseColumns = GetElement("cssselector", "#gridPagerDivStudyList_left table tbody tr td:nth-child(1) div[class='ui-pg-div']").GetAttribute("innerText").Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ChooseColumnsButton"));
                bool bReset = GetElement("cssselector", "#gridPagerDivStudyList_left table tbody tr td:nth-child(3) div[class='ui-pg-div']").GetAttribute("innerText").Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "ResetButton"));

                if (bStudies && bNoRecords && bChooseColumns && bReset && bWarningMsg)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Browse through the tabs
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step 5 - Click on each header per column - TODO
                studies.SearchStudy(LastName: "*", Datasource: "All");
                PageLoadWait.WaitForLoadingMessage(45);
                //string[] colnames = new string[] { "Modality", "Patient Name", "Patient ID", "Accession" };
                string[] colnames = new string[] { "Modality" };
                studies.SearchStudy(Modality: "MR");
                bool[] step5 = new bool[colnames.Length];
                for (int i = 0; i < colnames.Length; i++)
                {
                    studies.ClickColumnHeading(colnames[i]);
                    Thread.Sleep(700);
                    string[] step5_1 = studies.GetStudyDetails(colnames[i]);
                    step5[i] = (step5_1 == null || step5_1.Length == 0) ? false : step5_1.Select(s => s.ToLower()).SequenceEqual((step5_1.OrderBy(q => q)).Select(s => s.ToLower()));
                }
                if (studies.ValidateBoolArray(step5))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Click on Choose Columns button on left bottom corner of search results section
                ClickChooseColumns(check: 1);
                string RemoveAllLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "removeAll");
                string AddAllLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "addAll");
                string SelectColLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "caption", "col");
                string itemsSelectedLbl = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "itemsCount");
                string OkBtn = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "bSubmit", "col");
                string CancelBtn = GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "bCancel", "col");
                string itemsLbl = itemsSelected().Text;
                string SelectCol = SelectColumns().Text;
                string RemoveLbl = RemoveAllLink().GetAttribute("innerHTML");
                string AddLbl = AddAllLink().GetAttribute("innerHTML");

                if (itemsLbl.Contains(itemsSelectedLbl) && SelectColLbl.Equals(SelectCol) && RemoveAllLbl.Equals(RemoveLbl) &&
                    AddAllLbl.Equals(AddLbl) && OkBtn.Equals(OKChooseColLbl()) && CancelBtn.Equals(CancelChooseColLbl()))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                PageLoadWait.WaitForFrameLoad(10);
                CancelButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);

                //Step 7 - Verify the button label for My Search, Preset , Delete
                //Verified in Setp 3
                ExecutedSteps++;

                //Step 8 - Click on the arrow on extreme right side to Hide Search criteria Verify tool tip
                if (GetElement("cssselector", "#ExpandSearchPanelButton").GetAttribute("title").Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "hideSearch")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Click on My Search                
                SwitchToDefault();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                Driver.FindElement(By.CssSelector("#m_studySearchControl_m_defaultSearchButton")).Click();
                if (GetText("id", "SearchWarningSpan").Equals(GetVariableValueFromJSFile(Localization.GlobalResourceJSFile, "noMySearchDefinedWarning")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Click Save. Enter search text name in target language for specific search criteria. Click Save
                studies.SearchStudy(Modality: "US", Study_Performed_Period: "All Dates");
                PageLoadWait.WaitForFrameLoad(30);
                ((IJavaScriptExecutor)Driver).ExecuteScript("document.querySelector('#m_studySearchControl_m_saveSearchButton').click()");
                studies.ClickButton("#m_studySearchControl_m_saveSearchButton");
                Driver.FindElement(studies.SearchName()).SendKeys(SearchName);
                studies.ClickElement(BasePage.Driver.FindElement(studies.SaveSearch()));
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(studies.SavePopup()));
                ExecutedSteps++;

                //Step 11 - Click on arrow for Search Preset and select saved Preset. Click Search.
                var searchpreset = new SelectElement(studies.SearchPreset());
                new Actions(BasePage.Driver).Click(studies.SearchPreset());
                bool flag11 = searchpreset.Options.Any<IWebElement>(element => element.GetAttribute("innerHTML").Trim().Equals(SearchName));
                if (flag11)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Select any study and click View study                
                studies.SearchStudy(Modality: "US", patientID: "MRN_ABS@012");
                PageLoadWait.WaitForLoadingMessage(45);
                studies.SelectStudy(GetStudyGridColName("Patient ID"), "MRN_ABS@012");
                studies.LaunchStudy();
                if (studies.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - CLose study. Click on Study Performed field
                studies.CloseStudy();
                new Actions(BasePage.Driver).MoveToElement(studies.StudyPerformed()).Click().Build().Perform();
                if (Driver.FindElement(By.LinkText("All Dates")).Displayed
                    && Driver.FindElement(By.LinkText("Last Hour")).Displayed
                    && Driver.FindElement(By.LinkText("Last 2 Hours")).Displayed
                    && Driver.FindElement(By.LinkText("Last 5 Hours")).Displayed
                    && Driver.FindElement(By.LinkText("After Midnight")).Displayed
                    && Driver.FindElement(By.LinkText("Last 24 Hours")).Displayed
                    && Driver.FindElement(By.LinkText("Last 2 Days")).Displayed
                    && Driver.FindElement(By.LinkText("Last 7 Days")).Displayed
                    && Driver.FindElement(By.LinkText("Last 14 Days")).Displayed
                    && Driver.FindElement(By.LinkText("Last Month")).Displayed
                    && Driver.FindElement(By.LinkText("Custom Date Range")).Displayed
                    )
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 14 - Select Custom date Range and click OK without entering any date range
                studies.ClearFields();
                studies.SelectCustomeStudySearch(studies.StudyPerformed());
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox")) { studies.ClickElement(studies.SubmitButton()); }
                else { studies.SubmitButton().Click(); }
                if (Driver.FindElement(By.CssSelector("#dateErrorLabelFrom")).GetAttribute("innerHTML").Contains("*") &&
                    Driver.FindElement(By.CssSelector("#dateErrorLabelTo")).GetAttribute("innerHTML").Contains("*"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 15 - Select Custom Data Range and click the field
                studies.FromDate().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(fromdatecalender));
                if (studies.CalenderTable().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Partially Automated";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 16 - Hover on the Clear button ,previous, next arrow icon besides month dropdown
                IWebElement ClearButton = Driver.FindElement(By.CssSelector("input[title='" + ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Calendar_ClearToolTip") + "']"));
                IWebElement PreviousButton = Driver.FindElement(By.CssSelector("input[title='" + ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Calendar_monthdn_title") + "']"));
                IWebElement NextButton = Driver.FindElement(By.CssSelector("input[title='" + ReadDataFromResourceFile(Localization.GlobalResourceFilePath, "data", "Calendar_monthup_title") + "']"));
                if (ClearButton.Enabled && PreviousButton.Enabled && NextButton.Enabled)
                {
                    result.steps[++ExecutedSteps].status = "Partially Automated";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17 - Set the query to a range that have some studies in target language occurred in that period of time and press Search                
                SwitchToDefault();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("document.querySelector('#DateRangeSelectorCalendarFrom_tbody tr:nth-child(4) td div input').click();");
                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("document.getElementById('masterDateFrom').value='" + FromDate + "';");
                ((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("document.getElementById('masterDateTo').value='" + todate + "';");
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox")) { studies.ClickElement(studies.SubmitButton()); }
                else { studies.SubmitButton().Click(); }
                if (Driver.FindElement(By.CssSelector("#searchStudyMainText")).GetAttribute("innerHTML").Equals(FromDate + " - " + todate))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                };

                //Step 18 - Input in target language in Searching field for Patient Name (Last Nam or First Name )who is available in the datasource. Press search.
                studies.ChooseColumns(new string[] { GetStudyGridColName("Last Name"), GetStudyGridColName("First Name") }, 1);
                studies.SearchStudy(LastName: Lastnames[0], FirstName: Firstnames[0], Datasource: dataSourceName);
                Dictionary<int, string[]> results = BasePage.GetSearchResults();
                string[] columnnames = GetColumnNames();
                string[] lastnames = GetColumnValues(results, GetStudyGridColName("Last Name"), columnnames);
                string[] firstnames = GetColumnValues(results, GetStudyGridColName("First Name"), columnnames);
                if (results.Count != 0 && Array.TrueForAll(lastnames, s => s.Equals(Lastnames[0])) && Array.TrueForAll(firstnames, s => s.Equals(Firstnames[0])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 19 - Load the dataset in target language (e.g.Japanese ,Chinese) to the viewer.
                studies.SelectStudy(GetStudyGridColName("Last Name"), Lastnames[0]);
                studies.LaunchStudy();
                if (studies.ViewStudy())
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CloseStudy();

                //Step 20 - Patient name with multiple components (alphabetic=ideographic=phonetic) is present in a DS
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("any");
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
                ExecutedSteps++;

                //Step 21 -  Search for a patient's First name ' &#12383;&#12429;&#12358; ' (name with multiple components (alphabetic=ideographic=phonetic))
                studies.ChooseColumns(new string[] { GetStudyGridColName("Last Name"), GetStudyGridColName("First Name") }, 1);
                studies.SearchStudy(FirstName: Firstnames[1], Datasource: dataSourceName);
                string[] firstnames_21 = GetColumnValues(GetSearchResults(), GetStudyGridColName("First Name"), GetColumnNames());
                if (GetSearchResults().Count != 0 && Array.TrueForAll(firstnames_21, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 22 - Search for a patient's last name ' &#12420;&#12414;&#12384; ' (name with multiple components (alphabetic=ideographic=phonetic))
                studies.SearchStudy(LastName: Lastnames[1], Datasource: dataSourceName);
                string[] lastnames_22 = GetColumnValues(GetSearchResults(), GetStudyGridColName("Last Name"), GetColumnNames());
                if (GetSearchResults().Count != 0 && Array.TrueForAll(lastnames_22, s => s.Equals(Lastnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 23 - Search for a patient's ideographic first name or last name (&#23665;&#30000; or &#22826;&#37070;)
                studies.SearchStudy(LastName: Lastnames[1], FirstName: Firstnames[1], Datasource: dataSourceName);
                string[] lastnames_23 = GetColumnValues(GetSearchResults(), GetStudyGridColName("Last Name"), GetColumnNames());
                string[] firstnames_23 = GetColumnValues(GetSearchResults(), GetStudyGridColName("First Name"), GetColumnNames());
                if (GetSearchResults().Count != 0 && Array.TrueForAll(lastnames_23, s => s.Equals(Lastnames[1]))
                                                  && Array.TrueForAll(firstnames_23, s => s.Equals(Firstnames[1])))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test Step Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 24 - Priors are available for the patient with name:
                ExecutedSteps++;

                //Step 25 - Search for a patient's phonetic first or last name and launch the study to check priors
                result.steps[++ExecutedSteps].status = "On Hold";

                //Step 26 - Search for a patient's alphabetic first or last name and launch the study to check priors
                result.steps[++ExecutedSteps].status = "On Hold";

                //Step 27 - Search for a patient's ideographic first or last name and launch the study to check priors
                result.steps[++ExecutedSteps].status = "On Hold";

                //Step 28 - Perform a studies search action in the studies list with any of the supported parameters. View the wireshark tool for the C-FIND request
                result.steps[++ExecutedSteps].status = "On Hold";

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                servicetool.LaunchServiceTool();
                servicetool.NavigateToStudySearch();
                servicetool.ClickModifyFromTab();
                servicetool.SetUISearchFilter("exact");
                servicetool.AlphabeticRadioBtn().Click();
                wpfobject.WaitTillLoad();
                servicetool.ClickApplyButtonFromTab();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseConfigTool();
                Taskbar taskbar1 = new Taskbar();
                taskbar1.Show();
            }
        }

        /// <summary>
        /// Launch Exam Importer from within iCA
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_91760(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String StudyPath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Comments = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");
                String Order = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");

                String[] Langs = Languages.Split(':');

                String EIWindowName = "EI_" + new Random().Next(1, 1000);

                //Preconditions - Generate EI
                servicetool.LaunchServiceTool();
                servicetool.GenerateInstallerExamImporter(Config.adminGroupName, EIWindowName);
                servicetool.RestartService();
                servicetool.CloseServiceTool();
                Kill_EXEProcess("UploaderTool");

                //Step 1 - In Domain Management & User Preference uncheck the option Make Java Exam Importer as default Exam Importer
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[0]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("defaultJavaEI", 1);
                domainmanagement.ClickSaveDomain();

                studies = (Studies)login.Navigate("Studies");
                studies.OpenUserPreferences();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("m_preferenceFrame");
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div#DefaultToJavaExamImporterDiv")));
                if (BasePage.Driver.FindElement(By.CssSelector("input#defaultToJavaExamImporterCB")).Selected == true)
                {
                    studies.UnCheckCheckbox("cssselector", "input#defaultToJavaExamImporterCB");
                }
                studies.CloseUserPreferences();
                login.Logout();
                Executedsteps++;

                //Step 2 - Login into iCA with preferred language. Goto Inbounds tab , click Upload
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");

                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("input#m_launchUploaderButton")));
                Driver.FindElement(By.CssSelector("input#m_launchUploaderButton")).Click();
                Executedsteps++;

                //Step 3 -  Double click the installer to run the installer. Enter Administrator credentials for registered user. Follow the steps and complete the installation                
                ei.InstallEIInSelectedLocale(EIWindowName + " " + ei.Setup(), Config.eiInstaller, "msi");
                Executedsteps++;

                //Step 4 - Login to EI. Browse to select studies for upload.
                ei.LoginToEi(Config.ph1UserName, Config.ph1Password, EIWindowName: EIWindowName);
                wpfobject.GetMainWindow(EIWindowName);
                Tab SettingsOverlay = ei.SettingsTab();
                SettingsOverlay.Focus();
                ei.AskLaterBtn().Click();
                wpfobject.WaitTillLoad();
                ei.EI_SelectDestination(Config.Dest1, EIWindowName);

                ei.eiWinName = EIWindowName;
                ei.SelectFileFromHdd(StudyPath);
                WpfObjects._mainWindow.WaitWhileBusy();

                //Step 5 - Enter comments in comments field and select priority
                ei.UploadComments(Comments, EIWindowName);
                if (ei.CommentsTextBox().Text.Equals(Comments))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6 - Click on Send to upload the studies
                ei.SelectAllPatientsToUpload();
                ei.Send();

                //Close Uploader Tool
                ei.EI_Logout();
                ei.CloseUploaderTool();
                Executedsteps++;

                //Step 7 - Login to iCA as Receipient to view the uploaded study in Inbounds tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.ph1UserName, Config.ph1Password);
                inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                inbounds.SearchStudy("patientID", PatientID);
                bool phInbounds = ValidateLocalization(ICA_MappingFilePath, "Studies");
                Dictionary<string, string> phStudyrow = inbounds.GetMatchingRow(
                                                      new string[] { GetStudyGridColName("Patient ID"), GetStudyGridColName("Comments") },
                                                      new string[] { PatientID, Comments });
                if (phInbounds && phStudyrow != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8 - Select a study and click Nominate for Archive
                inbounds.SelectStudy1(GetStudyGridColName("Patient ID"), PatientID);
                //Click Nominate button 
                IWebElement ReasonField, OrderField;
                inbounds.ClickNominateButton(out ReasonField, out OrderField);
                if (ValidateLocalization(ICA_MappingFilePath, "StudyArchiveNomination"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 9 - Select reason and enter order notes in target language. Click Nominate
                inbounds.OrderNotes().SendKeys(Order);
                wait.Until(ExpectedConditions.ElementToBeClickable(inbounds.NominateButton()));
                inbounds.NominateButton().Click();
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(inbounds.By_NominateDiv()));
                login.Logout();
                Executedsteps++;

                //Step 10 - Login as Archivist and view the same study in Inbounds tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.ar1UserName, Config.arPassword);
                inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                bool arInbounds = ValidateLocalization(ICA_MappingFilePath, "Studies");
                Dictionary<string, string> arStudyrow = inbounds.GetMatchingRow(
                                                      new string[] { GetStudyGridColName("Patient ID"), GetStudyGridColName("Comments") },
                                                      new string[] { PatientID, Comments });
                if (arInbounds && arStudyrow != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11 - Select study and click Archive study
                IWebElement UploadCommentsField, ArchiveOrderField;
                this.ClickArchiveStudy(out UploadCommentsField, out ArchiveOrderField);
                if (ValidateLocalization(ICA_MappingFilePath, "ArchiveStudy"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Exam upload with EI in default language
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90634(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Random random = new Random();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String DestinationPage = GetRespectivePage("Destination", 1, "ImageSharing");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String StudyPath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String Comments = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Order = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] userids = { 
                                        Users.Split(':')[0] + "_" + random.Next(1, 1000), 
                                        Users.Split(':')[1] + "_" + random.Next(1, 1000), 
                                        Users.Split(':')[2] + "_" + random.Next(1, 1000), 
                                        Users.Split(':')[3] + "_" + random.Next(1, 1000) 
                                   };
                String datasource = login.GetHostName(Config.SanityPACS);
                String DestName = Users.Split(':')[4] + "_" + random.Next(1, 1000);


                String[] Langs = Languages.Split(':');

                String EIWindowName = "Exam Importer Setup";

                //Step 1 - Configure iCA in 3 target languages other than English
                Executedsteps++;

                //Step 2 - Login as Administrator in target language and goto Image Sharing->Destination tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                imagesharing = (Image_Sharing)login.Navigate("Image Sharing", 1, "ImageSharing");
                Image_Sharing.Destination dest = (Image_Sharing.Destination)imagesharing.NavigateToSubTab("Destination", DestinationPage);
                if (ValidateLocalization(ICA_MappingFilePath, "DestinationPage"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 3 - Enter Destination name in English , and select receiver and archivist created in target language. Click OK
                dest.SelectDomain(Config.adminGroupName);
                dest.NewDestinationButton().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#DestinationEditDialogDiv")));
                dest.DestName().SendKeys(DestName);
                new SelectElement(dest.DataSource()).SelectByText(datasource);
                dest.ReceiverUser().SendKeys(userids[0]);
                dest.SearchReceivers().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(dest.SearchReceivers()));
                //Syncup and click the Receiver User
                BasePage.wait.Until(new Func<IWebDriver, IWebElement>((driver) =>
                {
                    IList<IWebElement> rows = dest.ReceiverUserList().FindElements(By.CssSelector("tbody>tr"));
                    foreach (IWebElement row in rows)
                    {
                        if (row.FindElement(By.CssSelector("td>span")).GetAttribute("innerHTML").Split('(')[0].Trim().Equals(userids[0]))
                        {
                            return row;
                        }
                        else
                        {
                            continue;
                        }
                    }
                    return null;
                })).Click();
                dest.AddReceivers().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(dest.AddReceivers()));
                dest.ArchivistUser().SendKeys(userids[1]);
                dest.SearchArchivist().Click();
                //Syncup and click the Archivist User
                BasePage.wait.Until(new Func<IWebDriver, IWebElement>((driver) =>
                {
                    IList<IWebElement> rows = dest.ArchivistUserList().FindElements(By.CssSelector("tbody>tr"));
                    foreach (IWebElement row in rows)
                    {
                        if (row.FindElement(By.CssSelector("td>span")).GetAttribute("innerHTML").Split('(')[0].Trim().Equals(userids[1]))
                        {
                            return row;
                        }
                        else
                        {
                            return null;
                        }
                    }
                    return null;
                })).Click();

                dest.AddArchivist().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(dest.AddArchivist()));
                dest.OKButton().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#DestinationEditDialogDiv")));
                if (dest.SearchDestination(Config.adminGroupName, DestName))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 4 - Goto Domain Management and edit Domain with the created destination. Select the Default Domain Culture (English)
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement", 1, "Domain");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                domainmanagement.CultureDropDownList().SelectByValue("en-US");
                domainmanagement.ClickSaveDomain();
                login.Logout();
                Executedsteps++;

                //Step 5 - On the login page of iCA in Image Sharing section ,Select domain , click Install to download EI Installer
                login.DriverGoTo(login.url);
                ei.DownloadEIinstaller(Config.adminGroupName, Config.eiInstaller1);
                Executedsteps++;

                //step 6 - Double click the installer to run the installer. View the option to modify the EI installer language
                login._examImporterInstance = EIWindowName;
                wpfobject.InvokeApplication(Config.downloadpath + @"\" + Config.eiInstaller1 + ".exe");
                wpfobject.GetMainWindow("Exam Importer Setup");
                if (ei.SelectLanguageRadioBtn("English (United States)").Enabled &&
                    ei.SelectLanguageRadioBtn(ei.SelectLanguage()).Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7 - Do not modify the default language and follow the installer instructions
                ei.SelectLanguageRadioBtn("English (United States)").Click();
                Thread.Sleep(2000);
                ei.InstallBtn().Click();
                WpfObjects._mainWindow.WaitWhileBusy();
                wpfobject.GetMainWindow(login._examImporterInstance);
                wpfobject.WaitForButtonExist(login._examImporterInstance, "Cancel", 1);
                CoreAppXmlConfiguration.Instance.BusyTimeout = 90000;
                String acceptCheckBox = ei.AcceptCheckbox().Text;
                String printButton = ei.PrintButton().Text;
                String backButton = ei.BackBtn().Text;
                String nextButton = ei.NextBtn().Text;
                String cancelButton = ei.CancelBtn().Text;
                String installForAdmin = null;
                String installForAllUsers = null;

                ei.AcceptCheckbox().Click();
                WpfObjects._mainWindow.WaitWhileBusy();
                Boolean NextBtnStatus = ei.NextBtn().Enabled;
                ei.NextBtn().Click();
                WpfObjects._mainWindow.WaitWhileBusy();
                try
                {
                    //Choose install for Admin users and Next
                    wpfobject.GetMainWindow(login._examImporterInstance);
                    installForAdmin = ei.InstallForAdministrator().Name;
                    installForAllUsers = ei.InstallForAllUsers().Name;
                    ei.InstallForAdministrator().Click();
                    WpfObjects._mainWindow.WaitWhileBusy();
                    ei.NextBtn().Click();
                    WpfObjects._mainWindow.WaitWhileBusy();

                    //Choose default destination and click Next
                    wpfobject.GetMainWindow(login._examImporterInstance);
                    ei.NextBtn(1).Click();
                    WpfObjects._mainWindow.WaitWhileBusy();
                }
                catch (Exception) { }

                //Step 8 - Verify the Installer UI in the installation process
                if (acceptCheckBox.Equals("I accept the terms in the License Agreement") &&
                    printButton.Equals("Print") && backButton.Equals("Back") && cancelButton.Equals("Cancel") &&
                    installForAdmin.Equals("Install just for you (Administrator)") && installForAllUsers.Equals("Install just for you (Administrator)"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 9 - For registered user, input invalid credentials (user id/password) or click Install without entering credentials
                wpfobject.GetMainWindow(login._examImporterInstance);
                ei.InstallBtn().Click();
                WpfObjects._mainWindow.WaitWhileBusy();
                if (ei.ValidationMesssge().Visible)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                wpfobject.GetMainWindow(login._examImporterInstance);
                ei.ReturnBtn().Click();
                WpfObjects._mainWindow.WaitWhileBusy();

                //Step 10 - Click Cancel in the installation process and confirm "Yes" to interrupt installation
                wpfobject.GetMainWindow(login._examImporterInstance);
                ei.CancelBtn().Click();
                WpfObjects._mainWindow.WaitWhileBusy();
                wpfobject.GetMainWindow(login._examImporterInstance);
                if (ei.CanceleiInstallationText().Visible)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                wpfobject.GetMainWindow(login._examImporterInstance);
                wpfobject.ClickButton("Yes", 1);
                WpfObjects._mainWindow.WaitWhileBusy();
                wpfobject.GetMainWindow(login._examImporterInstance);
                ei.FinishBtn().Click();
                wpfobject.GetMainWindow(login._examImporterInstance);
                ei.CloseBtn();
                Thread.Sleep(2000);

                //Step 11 - Launch EI installer
                //          Enter Administrator credentials for registered user. Follow the steps and complete the installation
                ei.InstallEIInSelectedLocale(EIWindowName, Config.eiInstaller1, "exe", 1);
                Executedsteps++;

                //Step 12 - On EI login page view the option to modify the installed EI language , Do not modify the default language
                String windowname = "Exam Importer";
                ei.LaunchEI(Config.EIFilePath);
                wpfobject.GetMainWindow(windowname);
                if (wpfobject.GetComboBox().Items[0].Text.Equals("en-US") &&
                    wpfobject.GetComboBox().Items[1].Name.Equals("ja-JP") &&
                    wpfobject.GetComboBox().SelectedItem.Name.Equals("ja-JP"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13 - Login and Browse to select studies for upload                
                ei.LoginToEi(Config.adminUserName, Config.adminPassword, EIWindowName: EIWindowName);
                wpfobject.GetMainWindow(EIWindowName);
                Tab SettingsOverlay = ei.SettingsTab();
                SettingsOverlay.Focus();
                ei.AskLaterBtn().Click();
                wpfobject.WaitTillLoad();
                ei.EI_SelectDestination(Config.Dest1, EIWindowName);
                ei.eiWinName = EIWindowName;
                ei.SelectFileFromHdd(StudyPath);
                WpfObjects._mainWindow.WaitWhileBusy();
                Executedsteps++;

                //Step 14 - Enter comments in comments field and select priority
                ei.UploadComments(Comments, EIWindowName);
                if (ei.CommentsTextBox().Text.Equals(Comments))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15 - Click on Send to upload the studies
                ei.SelectAllPatientsToUpload();
                ei.Send();
                Executedsteps++;

                //Step 16 - Login into iCA as Administrator in target language and verify the Outbounds page for uploaded studies
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var outbounds = (Outbounds)login.Navigate("Outbounds", 1, "Outbounds");
                outbounds.SearchStudy("patientID", PatientID);
                bool bOutbounds = ValidateLocalization(ICA_MappingFilePath, "Studies");
                Dictionary<string, string> bStudyrow = outbounds.GetMatchingRow(
                                                      new string[] { GetStudyGridColName("Patient ID"), GetStudyGridColName("Comments") },
                                                      new string[] { PatientID, Comments });
                if (bOutbounds && bStudyrow != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 17 - Login to iCA as Receipient to view the uploaded study in Inbounds tab
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.ph1UserName, Config.ph1Password);
                var inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                inbounds.SearchStudy("patientID", PatientID);
                bool bInbounds = ValidateLocalization(ICA_MappingFilePath, "Studies");
                Dictionary<string, string> phStudyrow = inbounds.GetMatchingRow(
                                                      new string[] { GetStudyGridColName("Patient ID"), GetStudyGridColName("Comments") },
                                                      new string[] { PatientID, Comments });
                if (bInbounds && phStudyrow != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 18 - Select a study and click Nominate for Archive
                inbounds.SelectStudy1(GetStudyGridColName("Patient ID"), PatientID);
                IWebElement ReasonField, OrderField;
                inbounds.ClickNominateButton(out ReasonField, out OrderField);
                if (ValidateLocalization(ICA_MappingFilePath, "StudyArchiveNomination"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 19 - Select reason and enter order notes in target language. Click Nominate.
                inbounds.OrderNotes().SendKeys(Order);
                wait.Until(ExpectedConditions.ElementToBeClickable(inbounds.NominateButton()));
                inbounds.NominateButton().Click();
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(inbounds.By_NominateDiv()));
                login.Logout();
                Executedsteps++;

                //Step 20 - Login as Archivist and view the same study in Inbounds tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.ar1UserName, Config.arPassword);
                inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                bool arInbounds = ValidateLocalization(ICA_MappingFilePath, "Studies");
                Dictionary<string, string> arStudyrow = inbounds.GetMatchingRow(
                                                      new string[] { GetStudyGridColName("Patient ID"), GetStudyGridColName("Comments") },
                                                      new string[] { PatientID, Comments });
                if (arInbounds && arStudyrow != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21 - Select study and click Archive study
                IWebElement UploadCommentsField, ArchiveOrderField;
                this.ClickArchiveStudy(out UploadCommentsField, out ArchiveOrderField);
                if (ValidateLocalization(ICA_MappingFilePath, "ArchiveStudy"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Date format consistency
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_91710(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            UserManagement user;
            Image_Sharing imagesharing;
            Random random = new Random();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String SuperAdminGroup = Config.adminGroupName;
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String PID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] PatientIds = PID.Split(':');
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                String FilePath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "UploadFilePath");
                String PACSA7 = login.GetHostName(Config.SanityPACS);
                String EA91 = login.GetHostName(Config.EA91);
                String Testuser = "TestUser_" + random.Next(1, 1000);
                String email = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Email");
                String DOB = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DOB");
                String Lastname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String FullName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                var us = new CultureInfo("en-US");
                string xmlfilepath = @"C:\WebAccess\LocalizationSDK\ja-JP\XML\ResourceConfiguration.xml";
                string nodepath = "Resources/DateTime/dateFormat";
                string attribute = "pattern";
                String RescDateFormat = GetAttributeValue(xmlfilepath, nodepath, attribute);//"dd-MMM-yyyy";

                //GridColumn Names
                String DOBCol = GetStudyGridColName("Patient DOB");
                String PIDCol = GetStudyGridColName("Patient ID");
                String StudyDateCol = GetStudyGridColName("Study Date");
                String StudyIDCol = GetStudyGridColName("Study ID");
                String DestCol = GetStudyGridColName("To Destination", 2);
                String StatusCol = GetStudyGridColName("Status", 2);
                String DateRecCol = GetStudyGridColName("Date Received", 2);
                String DateSentCol = GetStudyGridColName("Date Sent", 2);
                String DateColumn = ReadDataFromResourceFile(Localization.AttachmentViewer, "data", "AttachmentTable_DateHeading");
                String NameColumn = ReadDataFromResourceFile(Localization.AttachmentViewer, "data", "AttachmentTable_NameHeading");
                String ReqIcon = ReadDataFromResourceFile(Localization.StudyPanelControl, "data", "Tooltip_RequisitionAvailable");
                //String reqtab = GetRespectivePage("EnrolUsers", parenttab: "UserManagement");
                String UploadDevicePage = GetRespectivePage("UploadDevice", 1, "ImageSharing");
                String XdsStudiesTab_AccCol = ReadDataFromResourceFile(Localization.PmjRadiologyStudies, "data", "AccessionNumber");
                String DateFilter = ReadDataFromResourceFile(Localization.RoleAccessFilterControl, "data", "Filter_StudyEnteredDate");
                String InstCol = ReadDataFromResourceFile(Localization.UploadDeviceViewDetailsControl, "data", "Label_InstitutionName");
                String DeviceCol = ReadDataFromResourceFile(Localization.UploadDeviceViewDetailsControl, "data", "Label_UploadDeviceID");
                String PatientsDOBCol = ReadDataFromResourceFile(Localization.PatientRecordSearch, "data", "PatientRecord_Column_dateOfBirth");

                //Step-1:1.Enable features : Patients ,Grant Access,Transfer in Domain & Role
                //2.XDS in service tool
                //3.Modify date format in the selected locale's ResourceConfiguration.xml file present in LocalizationSDK folder (eg:LocalizationSDK/ja-JP/XML) and save it. Execute Localization.complete_wsf script
                //4. Restart IIS         
                //Precondition
                login.DriverGoTo(login.url);
                login.LoginIConnect(AdminUsername, AdminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(SuperAdminGroup);
                domainmanagement.SelectDomain(SuperAdminGroup);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("datatransfer", 0);
                domainmanagement.SetCheckBoxInEditDomain("grant", 0);
                domainmanagement.ClickSaveEditDomain();
                RoleManagement role = (RoleManagement)login.Navigate("RoleManagement");
                role.SearchRole(SuperRole);
                role.SelectRole(SuperRole);
                role.ClickEditRole();
                role.GrantAccessRadioBtn_Anyone().Click();
                role.ClickSaveEditRole();
                login.Logout();
                ExecutedSteps++;

                //Step-2:Login to iCA as Administrator with a preferred language
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                ExecutedSteps++;

                //Step-3:Goto Studies tab, in Study Performed , select Custom Date Range and view the date format
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ClearFields();
                studies.SelectCustomeStudySearch(studies.StudyPerformed());
                if (studies.FromDate().Displayed
                    && studies.ToDate().Displayed
                    && studies.DateFormat().GetAttribute("innerHTML").Contains(RescDateFormat))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CancelButton().Click();

                //Step-4:view the date format in Study Date and DOB column
                studies.ChooseColumns(new string[] { DOBCol }, 1);
                studies.SearchStudy(patientID: PatientIds[0], Datasource: EA91);
                String[] studdatvalues = BasePage.GetColumnValues(BasePage.GetSearchResults(), StudyDateCol, BasePage.GetColumnNames());
                String[] DOBvalue = BasePage.GetColumnValues(BasePage.GetSearchResults(), DOBCol, BasePage.GetColumnNames());
                bool studdateformat = ValidateDateTimeFormat(studdatvalues[0].Split(' ')[0], "date");
                bool dobdateformat = ValidateDateTimeFormat(DOBvalue[0]);
                if (studdateformat && dobdateformat)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5:Select study and click Grant Access ,view the displayed date format
                studies.SelectStudy1(PIDCol, PatientIds[0]);
                studies.GrantAccessBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                string studdateGA = studies.StudyDate_GAWindow().GetAttribute("title");
                bool StuddateGA = ValidateDateTimeFormat(studdateGA);
                if (StuddateGA)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CancelBtn_GAWindow().Click();

                //Step-6:Select study and click Transfer ,view the displayed date format
                studies.SearchStudy(patientID: PatientIds[0], Datasource: EA91);
                studies.SelectStudy1(PIDCol, PatientIds[0]);
                studies.TransferBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                string studdatetr = studies.StudyDateTransWindow().Text;
                bool StuddateTr = ValidateDateTimeFormat(studdatetr);
                if (StuddateTr)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.CancelBtn().Click();

                //Step-7:Launch a study and view the titlebar for the study date format
                studies.SearchStudy(patientID: PatientIds[0], Datasource: EA91);
                studies.SelectStudy1(PIDCol, PatientIds[0]);
                StudyViewer viewer = StudyViewer.LaunchStudy();
                String StudyinfoDate = viewer.StudyInfo().Split(',')[1];
                bool StuddateVwr = ValidateDateTimeFormat(StudyinfoDate, "date");
                if (StuddateVwr)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:View the date format in the viewport (if present for a patient)
                result.steps[++ExecutedSteps].SetPath(testid+Config.Locale, ExecutedSteps);
                bool Step_8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.SeriesViewer_1X1());

                if (Step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Attach a file , view the date format
                viewer.NavigateToHistoryPanel();
                bool attachment = viewer.UploadAttachment(FilePath, 20, NameColumn);
                String filename = FilePath.Split('\\')[FilePath.Split('\\').Length - 1];
                Dictionary<string, string> Filerow = viewer.StudyViewerListMatchingRow(NameColumn, filename, "patienthistory", "attachment");
                String DateFormatAttch = Filerow[DateColumn];
                bool dateformatAttch = ValidateDateTimeFormat(DateFormatAttch.Split(' ')[0], "date");
                if (attachment && dateformatAttch)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseHistoryPanel();
                viewer.CloseStudy();

                //Step-10:View study with report ,requisition report , view the date format
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.ChooseColumns(new string[] { StudyIDCol }, 1);
                studies.SearchStudy(studyID: StudyID, Datasource: PACSA7);
                studies.SelectStudy1(StudyIDCol, StudyID);
                viewer = StudyViewer.LaunchStudy();
                PageLoadWait.WaitForFrameLoad(20);
                viewer.RequisitionIcon(ReqIcon).Click();
                PageLoadWait.WaitForFrameLoad(60);
                string ReqTitle = viewer.RequisitionTitle().GetAttribute("innerHTML").Split(' ')[0];
                bool ReqDate = ValidateDateTimeFormat(ReqTitle);
                if (viewer.RequisitionViewerInStudyPanel().Displayed && ReqDate)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.RequisitionCloseIcon().Click();

                //Step-11:Hover on a series thumbnail, view the date format (if i it exists for series)
                string ThumbnailDate = viewer.Thumbnails()[0].GetAttribute("title").Split(' ')[0].Split(':')[1];
                bool ThumbDate = ValidateDateTimeFormat(ThumbnailDate.Remove(0, 2));
                if (ThumbDate)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step-12:Click History and view date format in DOB field and Study Date column
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(patientID: PatientIds[0], Datasource: EA91);
                studies.SelectStudy1(PIDCol, PatientIds[0]);
                viewer = StudyViewer.LaunchStudy();
                viewer.NavigateToHistoryPanel();
                string DOBhistory = viewer.GetDemographicsData("DOB");
                bool DemoDOB = ValidateDateTimeFormat(DOBhistory);
                Dictionary<string, string> row = studies.GetMatchingRow(new string[] { PIDCol }, new string[] { PatientIds[0] });
                bool StudDatecol = ValidateDateTimeFormat(row[StudyDateCol].Split(' ')[0]);
                if (DemoDOB && StudDatecol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseHistoryPanel();
                viewer.CloseStudy();

                //Step-13:Goto Options--Transfer Status, view the date format in Submitted
                studies.TransferStatus();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                new WebDriverWait(BasePage.Driver, new TimeSpan(0, 1, 0)).Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#ctl00_TransferJobsListControl_parentGrid>tbody>tr:nth-child(2)>td:nth-child(11)>span")));
                string UpdatedDate = BasePage.Driver.FindElement(By.CssSelector("#ctl00_TransferJobsListControl_parentGrid>tbody>tr:nth-child(2)>td:nth-child(12)>span")).GetAttribute("title").Split(' ')[0];
                bool TransferStatusDate = ValidateDateTimeFormat(UpdatedDate);
                if (TransferStatusDate)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studies.TransferStatusClose();

                //Step-14:Goto Maintenance --Audit tab, view the date format in the search criteria
                Maintenance maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Audit", 1, 1, "Maintenance");
                string DateAudit = maintenance.GetValue("input#masterDateFrom");
                bool AuditDate = ValidateDateTimeFormat(DateAudit);
                if (AuditDate)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-15:View the audit entires in the Date column
                string DateColAudit = maintenance.AuditDateColumn().GetAttribute("title");
                bool AuditDateCol = ValidateDateTimeFormat(DateColAudit.Split(' ')[0]);
                if (AuditDateCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16:Goto Maintenance --Log tab, view the date format in the search criteria
                maintenance = (Maintenance)login.Navigate("Maintenance", 1, "Maintenance");
                maintenance.Navigate("Log", 1, 1, "Maintenance");
                string DateLog = maintenance.GetValue("input#masterDateFrom");
                bool LogDate = ValidateDateTimeFormat(DateLog);
                if (LogDate)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-17:View the log entires in the Date column
                string DateColLog = maintenance.LogDateColumn().GetAttribute("title");
                bool LogDateCol = ValidateDateTimeFormat(DateColLog.Split(' ')[0]);
                if (LogDateCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-18:Goto Inbounds tab, view the date format for Study Received
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.ph1UserName, Config.ph1Password);
                Inbounds inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                inbounds.SearchStudy(patientID: "*");
                Dictionary<string, string> row18 = studies.GetMatchingRow(new string[] { DestCol }, new string[] { Config.Dest1 });
                bool RecDateCol = ValidateDateTimeFormat(row18[DateRecCol].Split(' ')[0], "date");
                if (RecDateCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-19:Goto Outbounds tab, view the date format for Study Sent
                Outbounds outbounds = (Outbounds)login.Navigate("Outbounds", 1, "Outbounds");
                outbounds.SearchStudy(patientID: "*");
                Dictionary<string, string> row19 = studies.GetMatchingRow(new string[] { StatusCol }, new string[] { Config.Locale.Split('-')[0] + "Shared" + Config.Locale.Split('-')[1] });
                bool SentDateCol = ValidateDateTimeFormat(row19[DateSentCol].Split(' ')[0], "date");
                if (SentDateCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-20:Goto User Management tab , view the date format in Requests--Creation Date column
                login.DriverGoTo(login.url);
                login.FillEnrollForm(Testuser, SuperAdminGroup, email);
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                user = (UserManagement)login.Navigate("UserManagement", 1, "User");
                NavigateToRequestsUserManagementTab(1);
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                user.RefreshBtn().Click();
                string creationdate = user.CreationDate();
                bool CreateDateCol = ValidateDateTimeFormat(creationdate);
                if (CreateDateCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-21:Goto Patients tab, select a DOB and view the date format in the DOB field
                //Enter search parameter and click search
                Patients patient = (Patients)login.Navigate("Patients", 1, "Patients");
                patient.ExpandPanel();
                PageLoadWait.WaitForFrameLoad(20);
                patient.AdvancedSearch(dob: DOB);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                string DOBfiledvalue = GetValue("#AdvancedSearchControl_DOB");
                bool DOBValue = ValidateDateTimeFormat(DOBfiledvalue);
                if (DOBValue)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-22:For a study view the date format in the DOB field                
                string[] dateofbirth = BasePage.GetColumnValues(BasePage.GetSearchResults(), PatientsDOBCol, BasePage.GetColumnNames());
                bool DOBPatientsCol = ValidateDateTimeFormat(dateofbirth[0]);
                if (DOBPatientsCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-23:Double click on one patient, goto XDS --Visits tab , view date time format in Submission column
                patient.LoadStudyInPatientRecord(FullName); //firstname
                patient.NavigateToTabs("PmjXds", 1);
                patient.NavigateToSubTabs("PmjVisits", 1);
                string SubmissionDate = patient.SubmissionDate_VisitsTab();
                bool SubmissionCol = ValidateDateTimeFormat(SubmissionDate.Split(' ')[0]);
                if (SubmissionCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-24:In Patients --Folders tab , view date format in Modified column
                patient.NavigateToTabs("PmjXds", 1);
                patient.NavigateToSubTabs("PmjFolders", 1);
                //string ModifiedDate = patient.SubmissionDate_VisitsTab();
                //bool ModifiedCol = ValidateDateTimeFormat(ModifiedDate, "datetime");
                //if (ModifiedCol)
                //{
                //    result.steps[++ExecutedSteps].status = "Pass";
                //    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                //}
                //else
                //{
                //    result.steps[++ExecutedSteps].status = "Fail";
                //    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                //    result.steps[ExecutedSteps].SetLogs();
                //}
                result.steps[++ExecutedSteps].status = "On Hold";

                //Step-25:In Patients --Documents tab , view date time format in Created column
                patient.NavigateToTabs("PmjXds", 1);
                patient.NavigateToSubTabs("PmjDocs", 1);
                string CreatedDate = patient.CreatedDate_DocsTab();
                bool CreatedCol = ValidateDateTimeFormat(CreatedDate.Split(' ')[0]);
                if (CreatedCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-26:In Patients --Studies tab , view date time format in Date/Time column
                patient.NavigateToTabs("PmjRadiologyStudies", 1);
                string DateTime = patient.Date_time_StudiesTab();
                bool DateTimeCol = ValidateDateTimeFormat(DateTime.Split(' ')[0]);
                if (DateTimeCol)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                patient.ClosePatientRecord();

                //Step-27:In Patients --Studies list , view date format for Date field            

                result.steps[++ExecutedSteps].status = "On Hold";

                //Step-28:Goto Role Management ,edit a role in the filter add 'Study entered date' and view the date format
                role = (RoleManagement)login.Navigate("RoleManagement", 1, "Role");
                role.SearchRole(SuperRole, SuperAdminGroup);
                role.SelectRole(SuperRole);
                role.ClickEditRole();
                role.AccessFiltersInformation().SelectByValue(DateFilter);
                role.RoleDateFrom().SendKeys(DOB);
                role.RoleDateTo().Click();
                string FromDate = GetValue("#roleDateFrom");
                bool FromDateRole = ValidateDateTimeFormat(FromDate);
                if (FromDateRole)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                role.CloseBtn().Click();

                //Step-29:Goto Image Sharing--Upload device tab,edit a device entry and view date/time format in last contacted,created date,Next call home
                imagesharing = (Image_Sharing)login.Navigate("Image Sharing", 1, "ImageSharing");
                Image_Sharing.UploadDevice device = (Image_Sharing.UploadDevice)imagesharing.NavigateToSubTab("Upload Device", UploadDevicePage);
                device.SearchDevice(devicetype: "ExamImporter", domain: SuperAdminGroup, Institutioname: Config.Inst1, Instcolname: InstCol, DeviceColname: DeviceCol);
                SelectStudy(InstCol, Config.Inst1);
                device.ViewDetailsBtn().Click();
                string LastContacted = GetValue(device.LastContacted);
                bool LastContactedDevice = ValidateDateTimeFormat(LastContacted.Split(' ')[0]);
                string NextCall = GetValue(device.NextCallHome);
                bool NextCallDevice = ValidateDateTimeFormat(NextCall.Split(' ')[0]);
                string CreateDate = GetValue(device.CreatedDate);
                bool CreateDateDevice = ValidateDateTimeFormat(CreateDate.Split(' ')[0]);

                if (LastContactedDevice && NextCallDevice && CreateDateDevice)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();


                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Upload Device Settings Management
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_90635(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            UserManagement user;
            Image_Sharing imagesharing;
            Random random = new Random();
            ExamImporter ei = new ExamImporter();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AdminUsername = Config.adminUserName;
                String AdminPassword = Config.adminPassword;
                String SuperAdminGroup = Config.adminGroupName;
                String SuperRole = Config.adminRoleName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String AdminContact = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AdminContact");
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] userids = { Users.Split(':')[0] + "_" + random.Next(1, 1000), Users.Split(':')[1] + "_" + random.Next(1, 1000) };
                String datasource = login.GetHostName(Config.SanityPACS);
                String DestName = Users.Split(':')[4] + "_" + random.Next(1, 1000);
                String eiWindow = "EI_" + new Random().Next(1000);
                ei.eiWinName = eiWindow;
                String DestinationPage = GetRespectivePage("Destination", 1, "ImageSharing");
                String UploadDevicePage = GetRespectivePage("UploadDevice", 1, "ImageSharing");
                //GridColumn Names
                String InstCol = ReadDataFromResourceFile(Localization.UploadDeviceViewDetailsControl, "data", "Label_InstitutionName");
                String DeviceIDCol = ReadDataFromResourceFile(Localization.UploadDeviceViewDetailsControl, "data", "Label_UploadDeviceID");

                //Step-1:Configure iCA in 3 target languages other than English               
                ExecutedSteps++;
                //Precondition
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                user = (UserManagement)login.Navigate("UserManagement", 1, "User");
                user.DomainDropDown().SelectByText(SuperAdminGroup);
                user.CreateUser(userids[0], "Physician", FName: userids[0], LName: userids[0]);
                user.CreateUser(userids[1], "Archivist", FName: userids[1], LName: userids[1]);
                bool IsU1Exist = user.SearchUser(userids[0]);
                bool IsU2Exist = user.SearchUser(userids[1]);
                if (IsU1Exist && IsU2Exist)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-2:Login as Administrator in target language and goto Image Sharing->Destination tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                imagesharing = (Image_Sharing)login.Navigate("Image Sharing", 1, "ImageSharing");
                Image_Sharing.Destination dest = (Image_Sharing.Destination)imagesharing.NavigateToSubTab("Destination", DestinationPage);

                bool UIvalidate2 = ValidateLocalization(ICA_MappingFilePath, "DestinationPage");

                if (UIvalidate2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-3:Select Domain, click New Destination and save details
                dest.SelectDomain(SuperAdminGroup);
                dest.NewDestinationButton().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#DestinationEditDialogDiv")));
                bool UIvalidate3 = ValidateLocalization(ICA_MappingFilePath, "NewDestinationPage");
                dest.DestCancelButton().Click();
                dest.AddDestination(SuperAdminGroup, DestName, datasource, userids[0], userids[1]);
                bool Dest = dest.SearchDestination(SuperAdminGroup, DestName);
                if (UIvalidate3 && Dest)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-4:On the login page of iCA in Image Sharing section  ,Select domain , click Install to download EI Installer
                Taskbar taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                servicetool.GenerateInstallerAllDomain(SuperAdminGroup, eiWindow);
                servicetool.RestartService();
                servicetool.CloseServiceTool();
                taskbar.Show();
                ExecutedSteps++;

                //Step-5:Double click the installer  to run the installer
                //Modify the EI installer language and follow instructions to complete installation                
                ei = new ExamImporter();
                ei.DownloadEIinstaller(SuperAdminGroup, Config.eiInstaller1, "exe");
                ei.InstallEIInSelectedLocale(eiWindow + " " + ei.Setup(), Config.eiInstaller, "msi");

                //Step-6:Login to iCA and Goto Image Sharing ->Upload Device Settings tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(AdminUsername, AdminPassword);
                imagesharing = (Image_Sharing)login.Navigate("Image Sharing", 1, "ImageSharing");
                Image_Sharing.UploadDevice device = (Image_Sharing.UploadDevice)imagesharing.NavigateToSubTab("Upload Device", UploadDevicePage);
                bool UIvalidate6 = ValidateLocalization(ICA_MappingFilePath, "UploadDevicePage");
                if (UIvalidate6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7:Click  on Device Setting and view dropdown values
                String Device1 = ReadDataFromResourceFile(Localization.UploadDevice, "data", "DeviceType_1");
                String Device2 = ReadDataFromResourceFile(Localization.UploadDevice, "data", "DeviceType_2");
                String Device0 = ReadDataFromResourceFile(Localization.UploadDeviceSearchControl, "data", "Label_Unknown");
                string[] dropdownvalues = null;
                int i = 0;
                foreach (IWebElement d in device.DeviceType().Options)
                {
                    dropdownvalues[i] = d.GetAttribute("innerHTML");
                    i++;
                }
                if (dropdownvalues.Any(s => s.Equals(Device0)) && dropdownvalues.Any(s => s.Equals(Device1))
                    && dropdownvalues.Any(s => s.Equals(Device2)))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8:Select Exam Importer in Device Setting dropdown,click Search
                device.SearchDevice(devicetype: "ExamImporter", domain: SuperAdminGroup);
                Dictionary<int, string[]> results8 = BasePage.GetSearchResults();
                string[] columnnames8 = BasePage.GetColumnNames();
                string[] columnvalues8 = BasePage.GetColumnValues(results8, InstCol, columnnames8);

                if (Array.TrueForAll(columnvalues8, s => s.Equals(Device2)))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Double click on the entry on the list and Check the Device ID listed in iCA under Upload Device Management
                //Verify the text in the page
                result.steps[++ExecutedSteps].status = "Not Automated";

                //Step-10:Select entry in the Device list, click Edit
                //Update Device status and /or any other parameter
                //Click OK
                device.EditDevice(DeviceIDCol, "");
                bool UIvalidate10 = ValidateLocalization(ICA_MappingFilePath, "EditDevicePage");
                if (UIvalidate10)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Select entry in the Device list, click Delete
                SelectStudy(DeviceIDCol, "");
                device.DeleteDevice();
                Dictionary<string, string> row11 = studies.GetMatchingRow(new string[] { DeviceIDCol }, new string[] { "" }); ;

                if (row11 == null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Upload & Archive Studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_91810(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            UserManagement user;
            Image_Sharing imagesharing;
            Random random = new Random();

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String phUsername = Config.phUserName;
                String phPassword = Config.phPassword;
                String SuperAdminGroup = Config.adminGroupName;
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String[] Langs = Languages.Split(':');
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String ICA_MappingFilePath = Config.ica_Mappingfilepath;
                String FirstName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String[] Firstnames = FirstName.Split(':');
                String Comments = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");
                String[] Notes = Comments.Split(':');
                String datasource = login.GetHostName(Config.DestinationPACS);
                String DestName = Config.Dest1;
                String eiWindow = "EI_" + new Random().Next(1000);
                //ei.eiWinName = eiWindow;
                //GridColumn Names
                String AccInCol = GetStudyGridColName("Accession", 2);
                String StatusInCol = GetStudyGridColName("Status", 2);
                String AccStudiesCol = GetStudyGridColName("Accession");
                String UploadDevicePage = GetRespectivePage("UploadDevice", 1, "ImageSharing");


                //Step-1:Pre-condition -
                //Enable Image Sharing
                //Create users in the receiver(ph) and archivist(ar) role
                //Create Destination"Dest1"
                //Generate installer for EI and install on client system in target language               
                Taskbar taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                servicetool.GenerateInstallerAllDomain(SuperAdminGroup, eiWindow);
                servicetool.RestartService();
                servicetool.CloseServiceTool();
                taskbar.Show();
                ExecutedSteps++;


                //Step-2:Login to Exam Importer tool as a Registered User in a target language
                ExecutedSteps++;

                //Step-3:Examine whether"Dest1"is selected in the"TO"option
                ExecutedSteps++;

                //Step-4:Browse for the study available in any of the supported character sets and click on Upload button
                //String EIPath = ei.EI_Installation(SuperAdminGroup, eiWindow, Config.Inst1, Config.ph1UserName, Config.ph1Password, 1, Langs[1]);
                ExamImporter ei = new ExamImporter();
                ei.DownloadEIinstaller(SuperAdminGroup, Config.eiInstaller1, "exe");
                ei.InstallEIInSelectedLocale(eiWindow, Config.eiInstaller1, "exe", 1);

                //Step-5:Login as"ph"and Examine whether the sent study is listed in the ph Inbounds page               
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(phUsername, phPassword);
                Inbounds inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                inbounds.SearchStudy(AccessionNo: Accession);
                Dictionary<string, string> row5 = inbounds.GetMatchingRow(new string[] { AccInCol }, new string[] { Accession }); ;
                if (row5 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6:From"ph"inbounds page, select the sent study and Click on"Nominate for Archive"
                inbounds.SelectStudy1(AccInCol, Accession);
                inbounds.NominateForArchive(Notes[0], Notes[1]);
                ExecutedSteps++;

                //Step-7:Click on"Nominate"button choosing archive reason as"Interpretation Required".
                inbounds.SearchStudy(AccessionNo: Accession);
                Dictionary<string, string> study7 = inbounds.GetMatchingRow(new string[] { AccInCol, StatusInCol }, new string[] { Accession, "Nominated For Archive" });
                if (study7 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step-8:Login as"ar"and Examine whether the nominated study is listed in the Inbounds page.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(phUsername, phPassword);
                inbounds = (Inbounds)login.Navigate("Inbounds", 1, "Inbounds");
                inbounds.SearchStudy(AccessionNo: Accession);
                Dictionary<string, string> study8 = inbounds.GetMatchingRow(new string[] { AccInCol, StatusInCol }, new string[] { Accession, "Nominated For Archive" });
                if (study8 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9:Select the nominated study and Click on"Archive Study"
                inbounds.SelectStudy1(AccInCol, Accession);
                inbounds.ArchiveSearch("patient", "*", "", "", "", "", "", "", "", "");
                ExecutedSteps++;

                //Step-10:Select Search Patient and Enter the value "*" patient name in Lastname tab and click on the Search button.
                Dictionary<String, String> MatchingValues = inbounds.GetDataInArchive("Matching Order");
                if (MatchingValues["First Name"].Equals(Firstnames[0]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11:Update the First Name in target language in final section
                inbounds.EditFinalDetailsInArchive("First Name", Firstnames[1]);
                Dictionary<String, String> FinalDetails = inbounds.GetDataInArchive("Final Details");

                if (FinalDetails["First Name"].Equals(Firstnames[1]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12:User commits by clicking on Archive
                inbounds.ClickArchive();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step-13:Exam is fully archived
                inbounds.SearchStudy(AccessionNo: Accession);
                Dictionary<string, string> study13 = inbounds.GetMatchingRow(new string[] { AccInCol, StatusInCol }, new string[] { Accession, "Routing Completed" });
                if (study13 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14:Navigate to studylist
                //Search for the study archived with the first name in destination datasource
                Studies studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(FirstName: Firstnames[1], Datasource: datasource);
                Dictionary<string, string> study14 = inbounds.GetMatchingRow(new string[] { AccInCol, StatusInCol }, new string[] { Accession, "Routing Completed" });
                if (study14 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Logout
                login.Logout();

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Conference Folders tab GUI verifications
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test1_99178(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            String EA91 = login.GetHostName(Config.EA91);
            String PACSA7 = login.GetHostName(Config.SanityPACS);
            String MD1Physician = "MarketDomain1Physician";
            String MD1Archivist = "MarketDomain1Archivist";
            String MD1PACSAdmin = "MarketDomain1PACSAdmin";
            String MD1History1 = "MD1History1";
            String MD1G1 = "MD1G1";
            String Radiology = "Radiology";
            String Cardiology = "Cardiology";
            String Urology = "Urology";

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data                
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String FDescription = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String Checkboxes = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Checkboxes");
                String LDAP_Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");

                String[] Langs = Languages.Split(':');
                String[] FolderNames = Names.Split(':');
                String[] Descriptions = FDescription.Split(':');
                String[] LDAPUsers = LDAP_Users.Split('=');
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String[] Accessions = AccessionIDList.Split(':');

                String userid = LDAPUsers[0]; //Conference Userid
                String userid2 = LDAPUsers[1]; //Conference Userid
                String userid3 = LDAPUsers[2]; //Non Conference Userid                

                String user1 = LDAPUsernames[0]; //Conference Userid
                String user2 = LDAPUsernames[1]; //Conference Userid
                String user3 = LDAPUsernames[2]; //Non Conference Userid                

                Random random = new Random();
                String topfoldername = FolderNames[0] + "_1_" + new Random().Next(1, 1000);
                String topfoldername2 = FolderNames[0] + "_2_" + new Random().Next(1, 1000);
                String topfoldername3 = FolderNames[0] + "_3_" + new Random().Next(1, 1000);
                String topfoldername4 = FolderNames[0] + "_4_" + new Random().Next(1, 1000);

                String subfoldername1 = FolderNames[1] + "_01_" + new Random().Next(1, 1000);
                String subfoldername2 = FolderNames[1] + "_02_" + new Random().Next(1, 1000);
                String subfoldername3 = FolderNames[1] + "_03_" + new Random().Next(1, 1000);
                String sub2 = FolderNames[1] + "_2_" + new Random().Next(1, 1000);
                String StudyNotes = Descriptions[0] + "_" + new Random().Next(1, 1000);
                String Description = Descriptions[1] + "_" + new Random().Next(1, 1000);

                String folderpath1 = topfoldername + "/" + subfoldername1;
                String folderpath2 = topfoldername + "/" + subfoldername2 + "/" + subfoldername3;
                String FolderPath_2 = topfoldername2 + "/" + sub2;
                String folderpath3 = topfoldername + "/" + subfoldername2;
                

                //Step 1 - Pre-conditions--1. iCA build under testing is a fresh installation.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Mixed data base is used; Ldap user data base is configured (Server- ica.ldap.merge.ad IP- 10.4.38.27, Account Name- ica.administrator)-4. HTML5 viewer is enabled
                Taskbar taskbar = new Taskbar();
                taskbar.Hide();
                servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                servicetool.LDAPTenetFinaldmSetup();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                Executedsteps++;

                //Step 2 - Pre-conditions--Configure Domains, Roles, Groups are configured according to steps in test cases under LDAP/MultipleDomain Ldap Image Sharing (Test 27680 - Main PreSetup, Test 27681 - Setup Domain that are mapped in LDAP, Test 27682 - Create Roles that are configured in the LDAP, -Test 27683 - Create the Groups).
                Executedsteps++;

                //Step 3 - Pre-conditions--Ensure that Conference Lists in Domain Management tab and Conference User in Role Management tab are enabled for super admin and domain admin.-Ensure there is a user role under a domain with Conference User enabled; and another role with the option disabled-Ensure that there are Conference Users and non-Conference users in the same domain               
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.ClickSaveEditDomain();
                if (!domain.SearchDomain(Config.MarketDomain1))
                {
                    domain.CreateDomain(Config.MarketDomain1, Config.MarketDomain1, Config.MarketDomain1,
                                        Config.LdapDomainAdmin, null, Config.LdapDomainAdmin, Config.LdapDomainAdmin,
                                        Config.LdapUserPassword, Config.LdapDomainAdmin, Config.LdapDomainAdmin, 1,
                                        new string[] { EA91, PACSA7 }, Checkboxes);
                }
                var role = login.Navigate<RoleManagement>();
                role.DomainSelector().SelectByText(Config.MarketDomain1);
                PageLoadWait.WaitForFrameLoad(30);
                if (!role.RoleExists(MD1Physician))
                {
                    role.CreateRole(Config.MarketDomain1, MD1Physician, MD1Physician,
                                    new string[] { "receiveexam", "conferenceuser", "datadownload", "datatransfer" },
                                    isGrantAccessGrouponly: true);
                }
                if (!role.RoleExists(MD1Archivist))
                {
                    role.CreateRole(Config.MarketDomain1, MD1Archivist, MD1Archivist,
                                    new string[] { "archive", "datadownload", "datatransfer", "conferenceuser" },
                                    isGrantAccessAnyone: true);
                }
                if (!role.RoleExists(MD1PACSAdmin))
                {
                    role.CreateRole(Config.MarketDomain1, MD1PACSAdmin, MD1PACSAdmin,
                                    new string[] { "datadownload", "datatransfer" },
                                    isGrantAccessGrouponly: true);
                }
                var usermgmt = login.Navigate<UserManagement>();
                //Group and subgroup creation

                if (!usermgmt.SearchGroup(MD1History1, Config.MarketDomain1, 0))
                {
                    PageLoadWait.WaitForPageLoad(10);
                    usermgmt.CreateGroup(Config.MarketDomain1, MD1History1, groupdesc: MD1History1);
                    usermgmt.CreateSubGroup(MD1History1, Radiology);
                    usermgmt.CreateSubGroup(MD1History1, Cardiology);
                    usermgmt.CreateSubGroup(MD1History1, Urology);
                }
                bool IsGroupExist = usermgmt.SearchGroup(MD1History1, Config.MarketDomain1, 0);
                bool IsRadiologyExist = usermgmt.SearchGroup(MD1History1, Config.MarketDomain1, 1, subgroupname: Radiology);
                bool IsCardiologyExist = usermgmt.SearchGroup(MD1History1, Config.MarketDomain1, 1, Cardiology);
                bool IsUrologyExist = usermgmt.SearchGroup(MD1History1, Config.MarketDomain1, 1, Urology);
                bool User1 = usermgmt.SearchUser(user1, Config.MarketDomain1, userid);//Conference user
                bool User2 = usermgmt.SearchUser(user2, Config.MarketDomain1, userid2); //Conference user
                bool User3 = usermgmt.SearchUser(user3, Config.MarketDomain1, userid3); //Non Conference user                               

                if (User1 && User2 && User3 && IsGroupExist && IsRadiologyExist && IsCardiologyExist && IsUrologyExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }                                

                //As a precondition, Create Top Level and Sub level folder       
                var conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conffolder.NavigateToActiveMode();
                conffolder.CreateToplevelFolder(topfoldername, user1, Config.MarketDomain1, Description);
                conffolder.CreateSubFolder(topfoldername, subfoldername1, Config.MarketDomain1, Description);
                conffolder.CreateSubFolder(topfoldername, subfoldername2, Config.MarketDomain1);
                conffolder.CreateSubFolder(folderpath3, subfoldername3, Config.MarketDomain1);
                conffolder.CreateToplevelFolder(topfoldername2, domain: Config.MarketDomain1);
                conffolder.CreateSubFolder(topfoldername2, sub2, Config.MarketDomain1);
                login.Logout();

                //Step 4 - Login iCA as a super admin in preferred language, navigate to the Conference Folders tab. Verify the display of the tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapSuperAdmin, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                bool IsDomainDropdownExist = conffolder.IsElementVisible(By_DomainSelector());
                bool IsFolderBrowserSectionExist = conffolder.IsElementVisible(conffolder.By_LeftPane());
                bool IsConferenceStudySectionExist = conffolder.IsElementVisible(conffolder.By_MidPane());
                bool IsCommentsSectionExist = conffolder.IsElementVisible(conffolder.By_RightPane());
                if (IsDomainDropdownExist && IsFolderBrowserSectionExist && IsConferenceStudySectionExist && IsCommentsSectionExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }                

                //Step 5 - Verify the Folder Browser - Archive sub-tab in left pane
                bool IsArchiveFolderBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveFolder());
                bool IsDeleteFolderBtnExist = conffolder.IsElementPresent(conffolder.Btn_DeleteFolderBy());
                bool IsCreateFolderBtnExist = conffolder.IsElementPresent(conffolder.By_CreateFolderButton());
                bool IsManageTopLevelFoldersBtnExist = conffolder.IsElementPresent(conffolder.By_ManageTopLevelFolders());
                bool IsActiveModeBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_ActiveMode());
                bool IsArchiveModeBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveMode());
                if (IsArchiveFolderBtnExist && IsDeleteFolderBtnExist && IsCreateFolderBtnExist && IsManageTopLevelFoldersBtnExist && IsArchiveModeBtnExist &&
                    IsActiveModeBtnExist && conffolder.Btn_ActiveMode().GetAttribute("style").Contains("opacity: 1"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }                

                //Step 6 - Select Archive sub-tab, verify the Folder Browser - Archive sub-tab              
                conffolder.NavigateToArchiveMode();
                bool IsUndoArchiveFolderBtnExist = conffolder.Btn_UndoArchiveFolder().Enabled;
                bool IsDeleteFolderBtnExist6 = conffolder.Btn_DeleteFolder().Enabled;
                bool IsCreateFolderBtnExist6 = conffolder.CreateFolderButton().Enabled;
                bool IsManageTopLevelFoldersBtnExist6 = conffolder.ManageTopLevelFolders().Enabled;
                bool IsArchiveSelected = conffolder.Btn_ArchiveMode().GetAttribute("style").Contains("opacity: 1");
                bool IsActiveDeSelected = conffolder.Btn_ActiveMode().GetAttribute("style").Contains("opacity: 0.6");

                if (IsArchiveSelected && IsActiveDeSelected && !IsUndoArchiveFolderBtnExist && !IsDeleteFolderBtnExist6 &&
                    !IsManageTopLevelFoldersBtnExist6 && !IsCreateFolderBtnExist6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapDomainAdmin, Config.LdapUserPassword);
                var studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accession, StudyNotes: Descriptions[0] + "7", locale: 1);
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath_2, Accession, StudyNotes: Descriptions[0] + "71", locale: 1);
                login.Logout();

                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath1, Config.MarketDomain1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accession);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");

                //Step 7 - Verify NOTES / COMMENTS in right pane
                bool IsStudyNoteTimeExist = conffolder.IsElementPresent(conffolder.By_StudyNoteTime());
                bool IsStudyNotesExist = conffolder.GetConferenceStudyNotes().Equals(Descriptions[0] + "7");
                bool IsEditStudyNotesBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_EditStudyNotes());

                if (IsStudyNoteTimeExist && IsStudyNotesExist && IsEditStudyNotesBtnExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();                

                //Step 8 - Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step 9 - Login iCA as domain admin or a super admin. Navigate to the Conference Folders tab. 
                //         Repeat the same steps as the super admin logged cases, verify the display of the page.                
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapDomainAdmin, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool IsDomainDropdownExist_9 = conffolder.IsElementPresent(By_DomainSelector());
                bool IsFolderBrowserSectionExist_9 = conffolder.IsElementVisible(conffolder.By_LeftPane());
                bool IsConferenceStudySectionExist_9 = conffolder.IsElementVisible(conffolder.By_MidPane());
                bool IsCommentsSectionExist_9 = conffolder.IsElementVisible(conffolder.By_RightPane());
                bool IsArchiveFolderBtnExist_9 = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveFolder());
                bool IsDeleteFolderBtnExist_9 = conffolder.IsElementPresent(conffolder.Btn_DeleteFolderBy());
                bool IsCreateFolderBtnExist_9 = conffolder.IsElementPresent(conffolder.By_CreateFolderButton());
                bool IsManageTopLevelFoldersBtnExist_9 = conffolder.IsElementPresent(conffolder.By_ManageTopLevelFolders());
                bool IsActiveModeBtnExist_9 = conffolder.IsElementPresent(conffolder.By_Btn_ActiveMode());
                bool IsArchiveModeBtnExist_9 = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveMode());

                conffolder.NavigateToArchiveMode();
                bool IsUndoArchiveFolderBtnExist_9 = conffolder.Btn_UndoArchiveFolder().Enabled;
                bool IsDeleteFolderBtnExist1_9 = conffolder.Btn_DeleteFolder().Enabled;
                bool IsCreateFolderBtnExist1_9 = conffolder.CreateFolderButton().Enabled;
                bool IsManageTopLevelFoldersBtnExist1_9 = conffolder.ManageTopLevelFolders().Enabled;
                bool IsArchiveSelected_9 = conffolder.Btn_ArchiveMode().GetAttribute("style").Contains("opacity: 1");
                bool IsActiveDeSelected_9 = conffolder.Btn_ActiveMode().GetAttribute("style").Contains("opacity: 0.6");

                conffolder.NavigateToActiveMode();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accession);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool IsFoldernameExist_9 = conffolder.IsElementPresent(conffolder.By_FolderPathDiv());
                bool IsFolderdescAreaExist_9 = conffolder.IsElementPresent(conffolder.By_EditDesc_Emptydesc());
                bool IsEditBtnExist_9 = conffolder.IsElementPresent(conffolder.By_EditDesc_Button());
                bool IsGroupByExist_9 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsStudyGridExist_9 = conffolder.IsElementPresent(conffolder.By_StudyGrid());
                bool IsColumnHeadersExist_9 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_9 = conffolder.IsElementPresent(By.CssSelector("td[title='" + ReadDataFromResourceFile(Localization.StudyGridControl, "data", "ToolTip_ChooseColumns") + "']"));
                bool IsResetExist_9 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist_9 = conffolder.IsElementPresent(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist_9 = conffolder.IsElementPresent(conffolder.By_ViewStudyBtn());
                //bool IsRecordSummaryExist_9 = conffolder.RecordSummaryText().Contains(GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "data", "recordtext").Split('{')[0]);

                if (!IsDomainDropdownExist_9 && IsFolderBrowserSectionExist_9 && IsConferenceStudySectionExist_9 && IsCommentsSectionExist_9
                    && IsArchiveFolderBtnExist_9 && IsDeleteFolderBtnExist_9 && IsCreateFolderBtnExist_9 && IsManageTopLevelFoldersBtnExist_9
                    && IsActiveModeBtnExist_9 && IsArchiveModeBtnExist_9 && !IsUndoArchiveFolderBtnExist_9 && !IsDeleteFolderBtnExist1_9
                    && !IsCreateFolderBtnExist1_9 && !IsManageTopLevelFoldersBtnExist1_9 && IsArchiveSelected_9 && IsActiveDeSelected_9
                    && IsFoldernameExist_9 && IsFolderdescAreaExist_9 && IsEditBtnExist_9 && IsGroupByExist_9 && IsStudyGridExist_9
                    && IsColumnHeadersExist_9 && IsChooseColumnExist_9 && IsResetExist_9 && IsDeleteBtnExist_9 && IsViewBtnExist_9)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();                

                //Step 10 - Login iCA as a Conference User (Folder manager). Navigate to the Conference Folders tab. Repeat the same steps, verify the display of the page.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                bool IsCreateFolderBtnExist_10 = conffolder.IsElementPresent(conffolder.By_CreateFolderButton());
                bool IsGroupByExist_10 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsStudyGridExist_10 = conffolder.IsElementPresent(conffolder.By_StudyGrid());
                bool IsColumnHeadersExist_10 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_10 = conffolder.IsElementPresent(By.CssSelector("td[title='" + ReadDataFromResourceFile(Localization.StudyGridControl, "data", "ToolTip_ChooseColumns") + "']"));
                bool IsResetExist_10 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist_10 = conffolder.IsElementPresent(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist_10 = conffolder.IsElementPresent(conffolder.By_ViewStudyBtn());
                bool IsEditBtnExist_10 = conffolder.IsElementPresent(conffolder.By_EditDesc_Button());
                bool IsDeleteFolderBtnExist1_10 = conffolder.IsElementVisible(conffolder.Btn_DeleteFolderBy());//conffolder.Btn_DeleteFolder().Enabled;
                bool IsManageTopLevelFoldersBtnExist_10 = conffolder.IsElementVisible(conffolder.By_ManageTopLevelFolders());//conffolder.ManageTopLevelFolders().Enabled;
                bool IsArchiveTabExist10 = conffolder.IsElementVisible(conffolder.By_Btn_ArchiveMode());
                bool IsActiveTabExist10 = conffolder.IsElementVisible(conffolder.By_Btn_ActiveMode());

                if (IsCreateFolderBtnExist_10 && IsGroupByExist_10 && IsStudyGridExist_10 && IsColumnHeadersExist_10 &&
                    IsChooseColumnExist_10 && IsResetExist_10 && IsDeleteBtnExist_10 && IsViewBtnExist_10 && IsEditBtnExist_10 &&
                    !IsDeleteFolderBtnExist1_10 && !IsManageTopLevelFoldersBtnExist_10 && !IsArchiveTabExist10 && !IsActiveTabExist10)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();                

                //Step 11 - Login iCA as a Conference User. Navigate to the Conference Folders tab. Repeat the same steps, verify the display of the page.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid2, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accession);
                bool IsGroupByExist_11 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsColumnHeadersExist_11 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_11 = conffolder.IsElementPresent(By.CssSelector("td[title='" + ReadDataFromResourceFile(Localization.StudyGridControl, "data", "ToolTip_ChooseColumns") + "']"));
                bool IsResetExist_11 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsViewBtnExist_11 = conffolder.ViewStudyBtn().Enabled;
                bool IsEditBtnExist_11 = conffolder.Btn_EditStudyNotes().Enabled;
                bool IsCreateFolderBtnExist_11 = conffolder.IsElementVisible(conffolder.By_CreateFolderButton());
                bool IsArchiveTabExist11 = conffolder.IsElementVisible(conffolder.By_Btn_ArchiveMode());
                bool IsActiveTabExist11 = conffolder.IsElementVisible(conffolder.By_Btn_ActiveMode());

                if (IsGroupByExist_11 && IsColumnHeadersExist_11 && IsChooseColumnExist_11 && IsResetExist_11 && IsViewBtnExist_11 &&
                    !IsEditBtnExist_11 && !IsCreateFolderBtnExist_11 && !IsArchiveTabExist11 && !IsActiveTabExist11)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();                

                //Step 12 - Login as the domain admin (or super admin), navigate to the Conference Folders (if logged as a superadmin, select a domain), from Folder Browser Active sub-tab, click the Manage Top Level Folders button.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapDomainAdmin, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.NavigateToActiveMode();
                conffolder.OpenManageTopLevelFolder();
                bool IsAddTopFolderBtnExist = conffolder.AddFolderBtn().Displayed;
                bool IsAddFoldermanagerInputExist = conffolder.FolderManagerTextBox().Displayed;
                bool IsSaveBtnExist = conffolder.SaveFolderBtn().Displayed;
                bool IsDeleteBtnExist = conffolder.DeleteFolderManagerBtn().Displayed;
                bool IsCancelBtnExist = conffolder.CancelFolderBtn().Displayed;
                if (IsAddTopFolderBtnExist && IsAddFoldermanagerInputExist && IsSaveBtnExist && IsDeleteBtnExist && IsCancelBtnExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13 - Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step 14 - From the Manage Top Level Folders dialog, without adding any top level folder and folder manager, click Cancel button in the dialog.
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("input#ConferenceFolderManagementControl_Cancel")));
                conffolder.CancelFolderBtn().Click();
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(conffolder.By_FolderConfigurationdiv()));
                bool IsManageTopFolderDialogExist = conffolder.IsElementVisible(conffolder.By_FolderConfigurationdiv());
                IWebElement IsTopFolderExist14 = conffolder.ExpandAndSelectFolder(topfoldername3);
                if (!IsManageTopFolderDialogExist && IsTopFolderExist14 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15 - From the Manager Top Level Folders dialog, click the Add Top Level Folder button.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList_15 = conffolder.GetToplevelFolders();
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                bool IsInputFolderExist = conffolder.InputFolder().Displayed;
                if (IsInputFolderExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 16 - Without entering folder name, press Enter key on the keyboard
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys("");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                IList<IWebElement> TopFolderList_16 = conffolder.GetToplevelFolders();
                if (TopFolderList_16.Count == TopFolderList_15.Count)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17 - Enter a folder name, press Enter key on the keyboard
                conffolder.AddFolderBtn().Click();
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys(topfoldername3);
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                BasePage.wait.Until<Boolean>(d =>
                {
                    var folders = d.FindElements(By.CssSelector("div#divFolderManagement div#divtopLevelFolder>div"));
                    if (folders.Any(folder => folder.GetAttribute("innerHTML").Contains(topfoldername3)))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                IList<IWebElement> TopFolderList = conffolder.GetToplevelFolders();
                if (TopFolderList.Any(folder => folder.GetAttribute("innerHTML").Contains(topfoldername3)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 18 - Select the newly added top level folder, search users in the user search text box.                
                bool IsFolderManageradded = conffolder.AddFolderManager(topfoldername3, user1, isLDAPuser: true, LDAPusername: "User1");
                Executedsteps++;

                //Step 19 - Select and Add a Folder Manager to the created top level folder.
                if (IsFolderManageradded)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 20 - From the Manage Top Level Folders dialog, enter special characters in the folder name field (e.g. -, &, #), Save changes.
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.SaveFolderBtn()));
                conffolder.SaveTopLevelfolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys("~" + FolderNames[1] + ">/");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.By_SaveFolderBtn()));
                conffolder.SaveTopLevelfolder();
                IList<IWebElement> TopFolderList22 = conffolder.AllTopLevelfolders();
                if (TopFolderList22.Any(folder => folder.Text.Equals("~" + FolderNames[1] + ">/")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21 - Repeat above test all special characters in Top level Folder name field. Save changes.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys("~!@#$%^&*()_+{}|<>/");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.By_SaveFolderBtn()));
                conffolder.SaveTopLevelfolder();
                IList<IWebElement> TopFolderList23 = conffolder.AllTopLevelfolders();
                if (TopFolderList23.Any(folder => folder.Text.Equals("~!@#$%^&*()_+{}|<>/")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 22 - Login as the domain admin (or a folder manager), navigate to the Studies tab, load any study, click Add to Conference Folder tool from toolbar.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapDomainAdmin, Config.LdapUserPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accession);
                StudyViewer studyviewer = LaunchStudy();
                studyviewer.SelectToolInToolBar(ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                if (!studyviewer.AddConferenceStudyContainer().GetAttribute("style").Contains("display: none"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 23 - Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step 24 - Click on browse Button.
                studyviewer.BrowseBtn().Click();
                if (!studyviewer.FolderBrowserContainer().GetAttribute("style").Contains("display: none"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 25 - Select any bottom level sub-folder.
                studyviewer.ExpandAndSelectFolder(folderpath2);
                if (studyviewer.SelectFolderBtn().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 26 - Click on Select Folder button.
                studyviewer.SelectFolderBtn().Click();
                if (studyviewer.FolderBrowserContainer().GetAttribute("style").Contains("display: none"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 27 - Add study notes, click Add button
                studyviewer.AddStudyNotes().SendKeys(Descriptions[1] + "_27");
                studyviewer.AddBtn().Click();
                //Wait till Add folder Dialog Disappears
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (studyviewer.AddConferenceStudyContainer().GetAttribute("style").Contains("display: none"))                    
                        return true;                    
                    else
                        return false;                    
                });
                if (!studyviewer.AddConferenceStudyContainer().Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseStudy();

                //Step 28 - Reload the study, click the Add to Conference Folder tool from toolbar, attempt add the same study to the same sub-folder.
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accession);
                studyviewer = LaunchStudy();
                studyviewer.SelectToolInToolBar(ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                studyviewer.BrowseBtn().Click();
                studyviewer.ExpandAndSelectFolder(folderpath1);
                if (!studyviewer.SelectFolderBtn().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CancelFolderBtn().Click();
                studyviewer.CancelBtn().Click();
                studyviewer.CloseStudy();

                //Step 29 - Load any study, add the study to a sub-folder that is not a bottom level sub-folder.
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accession);
                studyviewer = LaunchStudy();
                studyviewer.SelectToolInToolBar(login.ReadDataFromResourceFile(Localization.Tooltip, "data", "AddConferenceStudy"), "review", 1);
                studyviewer.BrowseBtn().Click();
                studyviewer.ExpandAndSelectFolder(folderpath3);
                if (studyviewer.ErrorMessage_AddFolder().GetAttribute("innerHTML").Equals(ReadDataFromResourceFile(Localization.AddConferenceStudyControl, "data", "ErrorLabelInvalidFolderSelection_Label")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CancelFolderBtn().Click();
                studyviewer.CancelBtn().Click();
                studyviewer.CloseStudy();
                login.Logout();

                //Step 30 - Login as the domain admin, navigate to the Conference Folders tab
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapDomainAdmin, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                Executedsteps++;

                //Step 31 - Select a study folder that has Folder Description                
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accession);
                Executedsteps++;

                //Step 32 - select a study that has notes.
                String FolderDesc_32 = conffolder.EditDesc_CurrentDesc().Text;
                String StudyNotes_32 = conffolder.GetConferenceStudyNotes();
                if (StudyNotes_32.Equals(Descriptions[0] + "7") && FolderDesc_32.Equals(Description))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 33 - Click Delete Folder button
                conffolder.Btn_DeleteFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool IsDialogExist = conffolder.IsElementPresent(conffolder.Div_ConfirmationBy());
                bool IsOKExist = conffolder.IsElementPresent(conffolder.By_Btn_OKConfirmationDiv(1));
                bool IsCancelExist = conffolder.IsElementVisible(conffolder.By_Btn_CancelConfirmationDiv(1));
                if (IsDialogExist && IsOKExist && IsCancelExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 34 - Click Cancel
                conffolder.Btn_Cancel_ConfirmationDiv(1).Click();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accession);
                String FolderDesc_34 = conffolder.EditDesc_CurrentDesc().Text;
                String StudyNotes_34 = conffolder.GetConferenceStudyNotes();
                if (StudyNotes_34.Equals(Descriptions[0] + "7") && FolderDesc_34.Equals(Description))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 35 - Repeat above step, this time click OK in the dialog.
                conffolder.DeleteFolder(folderpath1, 1);
                IWebElement IsStudyFolderExist = conffolder.ExpandAndSelectFolder(folderpath1);
                if (IsStudyFolderExist == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 36 - Select any sub-folder, click Delete Folder button. Select Cancel in the dialog.
                conffolder.ExpandAndSelectFolder(folderpath2);
                conffolder.Btn_DeleteFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv(1).Click();
                IWebElement IsStudyFolderExist_36 = conffolder.ExpandAndSelectFolder(folderpath2);
                if (IsStudyFolderExist_36 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 37 - Repeat above step, this time click OK in the dialog.
                conffolder.DeleteFolder(folderpath2, 1);
                IWebElement IsStudyFolderExist_37 = conffolder.ExpandAndSelectFolder(folderpath2);
                if (IsStudyFolderExist_37 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 38 - Select a top level folder, click Delete Folder button, click OK in the confirmation dialog.
                conffolder.DeleteFolder(topfoldername, 1);
                IWebElement IsTopFolderExist_38 = conffolder.ExpandAndSelectFolder(topfoldername);
                if (IsTopFolderExist_38 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 39 - Repeat above steps, this time click Archive Folder button instead of the Delete Folder button.
                conffolder.ExpandAndSelectFolder(FolderPath_2);
                conffolder.Btn_ArchiveFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv(1).Click(); 
                IWebElement IsStudyFolderExist1_39 = conffolder.ExpandAndSelectFolder(FolderPath_2);
                conffolder.ArchiveConferenceFolder(FolderPath_2, locale: 1); 
                IWebElement IsStudyFolderExist2_39 = conffolder.ExpandAndSelectFolder(FolderPath_2);
                if (IsStudyFolderExist1_39 != null && IsStudyFolderExist2_39 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 40 - From the Conference Folders tab, the Archive sub-tab,
                conffolder.NavigateToArchiveMode();
                IWebElement IsStudyFolderExist_40 = conffolder.ExpandAndSelectFolder(FolderPath_2);
                bool IsUndoBtnEnabled = conffolder.Btn_UndoArchiveFolder().Enabled;
                if (IsStudyFolderExist_40 != null && IsUndoBtnEnabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 41 - Select an archived folder, click Undo Archive button
                conffolder.ExpandAndSelectFolder(FolderPath_2);
                conffolder.Btn_UndoArchiveFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool IsDialogExist41 = conffolder.IsElementPresent(conffolder.Div_ConfirmationBy());
                bool IsOKExist41 = conffolder.IsElementPresent(conffolder.By_Btn_OKConfirmationDiv(1));
                bool IsCancelExist41 = conffolder.IsElementVisible(conffolder.By_Btn_CancelConfirmationDiv(1));
                if (IsDialogExist41 && IsOKExist41 && IsCancelExist41)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 42 - Click Cancel in the dialog
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv(1).Click();
                if (conffolder.ExpandAndSelectFolder(FolderPath_2) != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 43 - Repeat above steps, this time click OK in the dialog.
                conffolder.UndoArchiveFolder(FolderPath_2, 1);
                IWebElement IsStudyFolderExist1_43 = conffolder.ExpandAndSelectFolder(FolderPath_2);
                conffolder.NavigateToActiveMode();
                IWebElement IsStudyFolderExist2_43 = conffolder.ExpandAndSelectFolder(FolderPath_2);
                if (IsStudyFolderExist1_43 == null && IsStudyFolderExist2_43 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }              

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Conference Folders tab GUI verifications
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_99178(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);           

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data                
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Languages = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Languages");
                String Names = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Name");
                String FDescription = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String Checkboxes = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Checkboxes");
                String LDAP_Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Comments");
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");

                String[] Langs = Languages.Split(':');
                String[] FolderNames = Names.Split(':');
                String[] Descriptions = FDescription.Split(':');
                String[] LDAPUsers = LDAP_Users.Split('=');
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String[] Accessions = AccessionIDList.Split(':');

                String userid = LDAPUsers[0]; //Conference Userid
                String userid2 = LDAPUsers[1]; //Conference Userid
                String userid3 = LDAPUsers[2]; //Non Conference Userid                

                String user1 = LDAPUsernames[0]; //Conference Userid
                String user2 = LDAPUsernames[1]; //Conference Userid
                String user3 = LDAPUsernames[2]; //Non Conference Userid                

                Random random = new Random();                
                //Preconditions:
                String topfoldername5_1 = "5_" + FolderNames[0] + "_1_103";// +new Random().Next(1, 1000);
                String topfoldername5_2 = "5_" + FolderNames[0] + "_2_674";// +new Random().Next(1, 1000);
                String subfoldername5_1 = "5_" + FolderNames[1] + "_1_225"; //+new Random().Next(1, 1000);
                String subfoldername5_2 = "5_" + FolderNames[1] + "_2_329";// +new Random().Next(1, 1000);
                String subfoldername5_3 = "5_" + FolderNames[1] + "_3_402";// +new Random().Next(1, 1000);   //sub2     
                String subfoldername5_4 = "5_" + FolderNames[1] + "_4_754"; // +new Random().Next(1, 1000);
                String StudyNotes_5 = Descriptions[4] + new Random().Next(1, 1000);
                String Description_5 = Descriptions[5] + new Random().Next(1, 1000);

                String folderpath5_1 = topfoldername5_1 + "/" + subfoldername5_1;
                String folderpath5_2 = topfoldername5_2 + "/" + subfoldername5_2;
                String folderpath5_3 = topfoldername5_2 + "/" + subfoldername5_3;
                String folderpath5_4 = topfoldername5_2 + "/" + subfoldername5_4;

                //Preconditions
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.CreateToplevelFolder(topfoldername5_1, user1, Config.MarketDomain1, Description_5); //to Folder1
                conffolder.CreateSubFolder(topfoldername5_1, subfoldername5_1, Config.MarketDomain1, Description_5); //Level2 with description &study,notes 
                conffolder.CreateSubFolder(topfoldername5_1, subfoldername5_2, Config.MarketDomain1); //Level2
                conffolder.CreateSubFolder(folderpath5_2, subfoldername5_3, Config.MarketDomain1); //Level3 without description and with study(no notes)
                conffolder.CreateToplevelFolder(topfoldername5_2, domain: Config.MarketDomain1);  //Top Folder2 
                conffolder.CreateSubFolder(topfoldername5_2, subfoldername5_4, Config.MarketDomain1); //Level2 without description and with study(no notes)
                login.Logout();

                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapDomainAdmin, Config.LdapUserPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_1, Accessions[0], StudyNotes: StudyNotes_5, locale: 1);  //Level2 with description &study,notes 
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_1, Accessions[3], locale: 1);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_1, Accessions[4], locale: 1);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_1, Accessions[5], locale: 1);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_1, Accessions[6], locale: 1);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_1, Accessions[7], locale: 1);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_3, Accessions[1], StudyNotes: StudyNotes_5, locale: 1);   //Level3 without description and with study(no notes)
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_3, Accessions[2], StudyNotes: StudyNotes_5 + "Test", locale: 1);
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath5_4, Accessions[0], locale: 1); //Level2 without description and with study(no notes)
                login.Logout();

                //Step 44 - Login as the domain admin user of the same domain (or Folder Manage, or super admin), navigate to the Conference Folders tab, select a study folder contains studies with conference notes.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(Config.LdapSuperAdmin, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.DomainSelector().SelectByText(Config.MarketDomain1);
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(50);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                String StudyNotes_44 = conffolder.GetConferenceStudyNotes();
                bool IsEditNotesBtnEnabled = conffolder.Btn_EditStudyNotes().Enabled;
                if (StudyNotes_44.Equals(StudyNotes_5) && IsEditNotesBtnEnabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 45 - Without clicking the Edit Study Notes button in the NOTES / COMMENTS pane, attempt to modify the conference notes.
                bool Modify = true;
                try
                {
                    conffolder.TxtArea_StudyNotes().Clear();
                    Modify = false;
                }
                catch (Exception){Modify = true;}
                if (Modify)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 46 - Click the Edit Study Notes button
                conffolder.Btn_EditStudyNotes().Click();
                Driver.SwitchTo().DefaultContent();
                Driver.SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool Okbtn = conffolder.Btn_OkStudyNotes().Enabled;
                bool Cancelbtn = conffolder.Btn_CancelStudyNotes().Enabled;
                if (Okbtn && Cancelbtn)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 47 - Enter plain text, press Enter button
                conffolder.Btn_CancelStudyNotes().Click();
                conffolder.ModifyConferenceStudyNotes(Descriptions[4]);
                String StudyNotes_47 = conffolder.GetConferenceStudyNotes();
                if (StudyNotes_47.Equals(Descriptions[4]))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 48 - Edit the study notes, copy and paste a large text to the area so that it is exceeded the Notes /COMMENTS display area. Press Enter button.
                PageLoadWait.WaitForPageLoad(30);
                PageLoadWait.WaitForFrameLoad(30);
                string notes = "";
                for (int i = 1; i <= 1250; i++)
                {
                    notes = notes + Descriptions[4];
                }
                conffolder.ModifyConferenceStudyNotes(notes);
                String StudyNotes_48 = conffolder.GetConferenceStudyNotes();
                if (StudyNotes_48.Equals(notes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 49 - Review the notes from beginning to the end.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step 50 - Select a sub-folder that contains study folder, attempt to click the Edit Study Notes button.
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(50);
                bool IsEditNotesBtnEnabled_50 = conffolder.Btn_EditStudyNotes().Enabled;
                if (!IsEditNotesBtnEnabled_50)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 51 - Login as a conference user, navigate to the Conference Folders, attempt to edit a conference notes of a study.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid2, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(50);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                bool IsEditNoteBtnEnabled = conffolder.Btn_EditStudyNotes().Enabled;
                if (!IsEditNoteBtnEnabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 52 -  login as a Conference User, navigate to the Conference Folders tab, browse to the folder and load the conference study that has conference notes into study viewer. Open the History fly-out.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid2, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(50);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                studyviewer = LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabEnabled52 = conffolder.Btn_StudyNotes_HistoryPanel().Enabled;
                studyviewer.NavigateTabInHistoryPanel("StudyNotes");
                bool IsStudyNotesExist52 = studyviewer.StudyNotesSection().Text.Equals(notes);
                if (IsStudyNotesTabEnabled52 && IsStudyNotesExist52)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Logout();

                //Step 53 - Login iCA as a Conference User, navigate to the Conference Folders tab, browse to the study folder contains conference studies are priors and having conference notes. Load a study. From the study viewer, open History tab.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid2, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath5_4);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[1]); //TODO
                studyviewer = LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabEnabled_53 = conffolder.Btn_StudyNotes_HistoryPanel().Enabled;
                studyviewer.NavigateTabInHistoryPanel("StudyNotes");
                bool IsStudyNotesExist_53 = studyviewer.StudyNotesSection().Text.Equals(StudyNotes_5);
                if (IsStudyNotesTabEnabled_53 && IsStudyNotesExist_53)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 54 - Select the prior which is a conference study with conference notes in the History fly-out priors list.
                studyviewer.ChooseColumns(new string[] { GetStudyGridColName("Accession") });
                studyviewer.SelectStudy(GetStudyGridColName("Accession"), Accessions[2]);
                studyviewer.NavigateTabInHistoryPanel("StudyNotes");
                bool IsStudyNotesExist_54 = studyviewer.StudyNotesSection().Text.Equals(StudyNotes_5 + "Test");
                if (IsStudyNotesExist_54)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();

                //Step 55 - Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step 56 - Navigate to Studies tab, load a study that was added to the conference list. Open the History fly-out, verify the Study Notes button.
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                studyviewer = studies.LaunchStudy();
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabExist = conffolder.IsElementVisible(conffolder.By_Btn_StudyNotes_HistoryPanel());
                if (!IsStudyNotesTabExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Logout();

                //Step 57 - Login as a non-conference user. From Studies tab, load a study into study viewer, open History fly-out, verify the Study Notes button.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid3, Config.LdapUserPassword);
                studies = (Studies)login.Navigate("Studies", 1, "Studies");
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy(GetStudyGridColName("Accession"), Accessions[2]);
                studyviewer = studies.LaunchStudy();
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabExist_57 = conffolder.IsElementVisible(conffolder.By_Btn_StudyNotes_HistoryPanel());
                if (!IsStudyNotesTabExist_57)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Logout();

                //Step 58 - Login as a Conference user, navigate to the Conference Folders tab. Browse folders and select a study folder contains multiple studies.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid2, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath5_3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                Dictionary<string, string> Studylist58_1 = conffolder.GetMatchingRow("Accession", Accessions[1]);
                Dictionary<string, string> Studylist58_2 = conffolder.GetMatchingRow("Accession", Accessions[2]);
                if (Studylist58_1 != null && Studylist58_2 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 59 - Verify the conference studies list display area.
                bool IsGroupByExist_59 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsColumnHeadersExist_59 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_59 = conffolder.IsElementPresent(conffolder.By_ChooseColumns());
                bool IsResetExist_59 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist_59 = conffolder.IsElementVisible(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist_59 = conffolder.IsElementVisible(conffolder.By_ViewStudyBtn());
                bool IsRecordSummaryExist_59 = conffolder.RecordSummaryText().Contains(GetVariableValueFromJSFile(Localization.GridLocaleJSFile, "data", "recordtext").Split('{')[0]);

                if (IsGroupByExist_59 && IsColumnHeadersExist_59 && IsChooseColumnExist_59 && IsResetExist_59
                    && IsRecordSummaryExist_59 && IsViewBtnExist_59 && !IsDeleteBtnExist_59)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 60 - Select each filter in the Group By dropdown.
                conffolder.SelectGroupByInStudiesTab(GetStudyGridColName("Patient DOB"), 1);
                PageLoadWait.WaitForPageLoad(5);
                bool step60_1 = conffolder.IsGroupedBy(GetStudyGridColName("Patient DOB"), 1);
                bool step60_2 = BasePage.GetColumnValues("Patient ID").All<String>(columnvalue => columnvalue.Equals(PatientID));
                conffolder.SelectGroupByInStudiesTab(GetStudyGridColName("Accession"), 1);
                PageLoadWait.WaitForPageLoad(5);
                bool step60_3 = conffolder.IsGroupedBy(GetStudyGridColName("Accession"), 1);
                if (step60_1 && step60_2 && step60_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 61 - Click Choose Columns button
                conffolder.ClickChooseColumns("Others", 1);
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.By_ChooseColumnDialog()));
                if (conffolder.ChooseColumnDialog().Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 62 - Add and remove columns, click Cancel button
                conffolder.SelectColumns(new string[] { GetStudyGridColName("Patient Name") }, "Add", isConferenceTab: true, isRerarrange: false);
                conffolder.SelectColumns(new string[] { GetStudyGridColName("Patient Name") }, "Remove", isConferenceTab: true, isRerarrange: false);
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.CancelButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsPatientNameExist62 = BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Patient Name")));
                if (!IsPatientNameExist62)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 63 - Click Choose Columns button, Add and remove columns, click Ok button
                conffolder.ClickChooseColumns("Others", 1);
                conffolder.SelectColumns(new string[] { GetStudyGridColName("Patient Name"), GetStudyGridColName("Gender") },
                                                        "Add", isConferenceTab: true, isRerarrange: false);
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.OKButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsGenderExist1 = BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Gender")));
                conffolder.ClickChooseColumns("Others", 1);
                conffolder.SelectColumns(new string[] { GetStudyGridColName("Gender") }, "Remove", isConferenceTab: true, isRerarrange: false);
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.OKButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsPatientNameExist63 = BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Patient Name")));
                bool IsGenderExist63 = BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Gender")));
                if (IsPatientNameExist63 && IsGenderExist1 && !IsGenderExist63)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 64 - Click Reset button
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.ResetColumns();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsPatientNameExist_64 = BasePage.GetColumnNames().Any(columnname => columnname.Equals(GetStudyGridColName("Patient Name")));
                if (!IsPatientNameExist_64)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 65 - Select/de-select studies in the Conference studies list, verify the View button
                conffolder.ExpandAndSelectFolder(folderpath5_3);
                bool IsViewBtnEnabled_65_1 = conffolder.ViewStudyBtn().Enabled;
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[2]);
                bool IsViewBtnEnabled_65_2 = conffolder.ViewStudyBtn().Enabled;
                if (!IsViewBtnEnabled_65_1 && IsViewBtnEnabled_65_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 66 - Select a study and click View button.
                studyviewer = conffolder.LaunchStudy(isConferenceTab: true);
                String Patientinfo = studyviewer.PatientInfoTab(1);
                String Studyinfo = studyviewer.StudyInfo(1);
                if (Patientinfo.Contains(PatientID) && Studyinfo.Contains(Accessions[2]))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 67 - Login as a Folder Manager, navigate the Conference Folders tab, select a study folder that is under a top level folder managed by the user.
                login.DriverGoTo(login.url);
                login.PreferredLanguageSelectList().SelectByText(Langs[1]);
                login.LoginIConnect(userid, Config.LdapUserPassword);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders", 1, "ConferenceStudies");
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                bool IsDeletestudyBtnExists_67 = conffolder.IsElementVisible(conffolder.Btn_DeleteStudyBy());
                if (IsDeletestudyBtnExists_67)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 68 - Select/de-select studies in the Conference studies list, verify the Delete button
                bool IsDeletestudyBtnEnabled68_1 = conffolder.DeleteStudyBtn().Enabled;
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                bool IsDeletestudyBtnEnabled68_2 = conffolder.DeleteStudyBtn().Enabled;
                if (!IsDeletestudyBtnEnabled68_1 && IsDeletestudyBtnEnabled68_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 69 - Without select any conference study, attempt to click Delete button to select studies.
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                bool IsDeletestudyBtnEnabled_69 = conffolder.DeleteStudyBtn().Enabled;
                if (!IsDeletestudyBtnEnabled_69)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 70 - Select a study, click Delete.
                conffolder.SelectStudy(GetStudyGridColName("Accession"), Accessions[0]);
                conffolder.DeleteStudyBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool CaptionInDialog = conffolder.DeleteStudies_Caption().Equals(ReadDataFromResourceFile(Localization.ConferenceStudyList, "data", "ConfirmationBox_DeleteStudies"));
                if (CaptionInDialog)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 71 - Click Cancel in the dialog
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                Dictionary<string, string> Studylist_71 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[0]);
                if (Studylist_71 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 72 - Select a study, click Delete, this time click OK in the dialog.
                conffolder.DeleteStudy(GetStudyGridColName("Accession"), Accessions[0]);
                Dictionary<string, string> Studylist_72 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[0]);
                if (Studylist_72 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 73 - Repeat above steps Delete/Cancel and Delete/OK, this time by selecting more than 1 studies.
                conffolder.SelectStudy1(GetStudyGridColName("Accession"), Accessions[3], true);
                conffolder.SelectStudy1(GetStudyGridColName("Accession"), Accessions[4], true);
                conffolder.DeleteStudyBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                Dictionary<string, string> Studylist73_1 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[3]);
                Dictionary<string, string> Studylist73_2 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[4]);
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.DeleteStudy(GetStudyGridColName("Accession"), ctrlclick: true, values: new string[] { Accessions[3], Accessions[4] });
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                Dictionary<string, string> Studylist1_73 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[3]);
                Dictionary<string, string> Studylist2_73 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[4]);
                if (Studylist73_1 != null && Studylist73_2 != null && Studylist1_73 == null && Studylist2_73 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 74 - Repeat above steps Delete/Cancel and Delete/OK, this time by selecting all studies in the conference studies list.
                conffolder.SelectStudy1(GetStudyGridColName("Accession"), Accessions[5], true);
                conffolder.SelectStudy1(GetStudyGridColName("Accession"), Accessions[6], true);
                conffolder.SelectStudy1(GetStudyGridColName("Accession"), Accessions[7], true);
                conffolder.DeleteStudyBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                Dictionary<string, string> Studylist74_1 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[5]);
                Dictionary<string, string> Studylist74_2 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[6]);
                Dictionary<string, string> Studylist74_3 = conffolder.GetMatchingRow(GetStudyGridColName("Accession"), Accessions[7]);
                conffolder.ExpandAndSelectFolder(folderpath5_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.DeleteStudy(GetStudyGridColName("Accession"), ctrlclick: true, values: new string[] { Accessions[5], Accessions[6], Accessions[7] });
                int studycount = BasePage.GetSearchResults().Count;
                if (Studylist74_1 != null && Studylist74_2 != null && Studylist74_3 != null && studycount == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }



    }
}
