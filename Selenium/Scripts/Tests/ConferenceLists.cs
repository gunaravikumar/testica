using System;
using System.Globalization;
using System.Drawing;
using System.Threading;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Selenium.Scripts.Pages;
using Selenium.Scripts.Reusable.Generic;
using System.IO;
using OpenQA.Selenium;
using OpenQA.Selenium.Interactions;
using OpenQA.Selenium.Internal;
using OpenQA.Selenium.Support.UI;
using Selenium.Scripts.Pages.HoldingPen;
using Selenium.Scripts.Pages.iConnect;
using Selenium.Scripts.Pages.MPAC;
using Selenium.Scripts.Pages.Putty;
using Selenium.Scripts.Pages.MergeServiceTool;
using TestStack.White.Configuration;
using TestStack.White.Factory;
using TestStack.White.UIItems;
using TestStack.White.UIItems.Finders;
using TestStack.White.UIItems.TabItems;
using TestStack.White.UIItems.TableItems;
using TestStack.White.InputDevices;
using TestStack.White.WindowsAPI;
using Application = TestStack.White.Application;
using System.Diagnostics;
using System.Xml.Serialization;
using OpenQA.Selenium.Remote;
using System.Text.RegularExpressions;

namespace Selenium.Scripts.Tests
{
    class ConferenceLists : BasePage
    {
        public Login login { get; set; }
        public string filepath { get; set; }
        public ExamImporter ei { get; set; }
        public MpacLogin mpaclogin { get; set; }
        public HPHomePage hphomepage { get; set; }
        public HPLogin hplogin { get; set; }
        public ServiceTool servicetool { get; set; }        


        /// <summary>
        /// Constructor - Test Suite
        /// </summary>
        /// <param name="classname"></param>
        public ConferenceLists(String classname)
        {
            login = new Login();
            login.DriverGoTo(login.url);
            filepath = Config.TestSuitePath + Path.DirectorySeparatorChar + classname + ".xls";
            ei = new ExamImporter();
            mpaclogin = new MpacLogin();
            wpfobject = new WpfObjects();
            
        }

        /// <summary>
        /// Conference Lists - Conference Lists feature configurable at System Level
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94283(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PateintID");
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String datasource = login.GetHostName(Config.SanityPACS);
                String Testdomain = "Test83_DomainA" + new Random().Next(1, 1000);
                String TestdomainAdmin = "Test83_DomainAdminA" + new Random().Next(1, 1000);
                String Testrole1 = "Test83_Role1A" + new Random().Next(1, 1000);
                String Testrole2 = "Test83_Role2A" + new Random().Next(1, 1000);
                String Testuser1 = "Test83_User1A" + new Random().Next(1, 1000);
                String Testuser2 = "Test83_User2A" + new Random().Next(1, 1000);


                //Step-1:[Pre-conditions-]--1. iCA build under testing is a fresh installation on iCA server--2. at least a data source is configured in Server Tool and connected to the domain used--3. IPad is available for the testing
                Executedsteps++;

                //Step-2:Enable Conference Lists checkbox is OFF in Server Tool
                taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                CheckBox ConferenceLists = wpfobject.GetAnyUIItem<Panel, CheckBox>(wpfobject.GetCurrentPane(), "Enable Conference Lists", 1);
                if (ConferenceLists.Checked) { ConferenceLists.Checked = false; }
                bool IsConferenceChecked = ConferenceLists.Checked;
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                if (IsConferenceChecked == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                    throw new Exception("Conference Lists feature is enabled is Service tool"); 
                }


                //Step-3:Login iCA website as Superadmin in a web browser, verify the visibility of Conference tab
                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                Boolean istabpresent = login.IsTabPresent("Conference Folders");
                if (!istabpresent)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-4:Navigate to Domain Management page, click New Domain button, in the Domain Management - New Domain page, verify the visibility of Enable Conference Lists option
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.ClickNewDomainBtn();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferencelistcb4 = domainmanagement.IsElementVisible(domainmanagement.By_ConferenceListsCB());

                if (Conferencelistcb4 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                domainmanagement.ClickCloseEditDomain();

                //Step-5:Create new domain e.g. Domain Name- DomainA, Domain Admin- daA, Role- roleA1, User- userA1 and Role- roleA2, User- userA2; Logout Superadmin. Login iCA website as the Domain Admin (daA) verify the visibility of Conference tab.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(Testdomain, TestdomainAdmin, datasource);
                domainmanagement.ClickSaveNewDomain();
                bool domainA = domainmanagement.DomainExists(Testdomain);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(Testdomain, Testrole1, "any");
                rolemanagement.CreateRole(Testdomain, Testrole2, "any");
                bool role1 = rolemanagement.RoleExists(Testrole1);
                bool role2 = rolemanagement.RoleExists(Testrole1);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(Testuser1, Testdomain, Testrole1);
                usermanagement.CreateUser(Testuser2, Testdomain, Testrole2);
                bool userA1 = usermanagement.SearchUser(Testuser1, Testdomain);
                bool userA2 = usermanagement.SearchUser(Testuser2, Testdomain);
                login.Logout();

                login.LoginIConnect(Testdomain, Testdomain);
                Boolean istabpresent5 = login.IsTabPresent("Conference Folders");
                if (!istabpresent5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6:As the Domain Admin logged in, navigate to Domain Management page, verify the visibility of Enable Conference Lists option in the Enter Domain Information page
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferencelistcb6 = domainmanagement.IsElementVisible(domainmanagement.By_ConferenceListsCB());
                if (Conferencelistcb6 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7:Navigate to Role Management page, click New Role button, verify the visibility of Enable Conference User option in the Role Management - New Role page
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.ClickNewRoleBtn();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferenceusercb7 = rolemanagement.IsElementVisible(rolemanagement.By_ConferenceUserCB());

                if (Conferenceusercb7 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();

                //Step-8:Back to Role Management page, select a newly added role (e.g. roleA1), click Edit, verify the visibility of Conference Users option in the Role Management - Edit Role page
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(Testrole1);
                rolemanagement.SelectRole(Testrole1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferenceusercb8 = rolemanagement.IsElementVisible(rolemanagement.By_ConferenceUserCB());
                if (Conferenceusercb8 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();

                //Step-9:Logout iCA from the domain admin; From a desktop client system login iCA as the user (e.g. userA1 or userA2), and verify visibility of the Conference tab
                login.Logout();
                login.LoginIConnect(Testuser1, Testuser1);
                Boolean istabpresent9 = login.IsTabPresent("Conference Folders");
                if (!istabpresent9)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-10,11,12:Check from iPad(Not applicable)
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-13:Enable Conference Lists is turned ON in Server Tool
                taskbar = new Taskbar();
                taskbar.Hide();
                servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableConferenceLists(0);
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                Executedsteps++;

                //Step-14:Login iCA website as Superadmin verify the visibility of Conference tab.
                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                Boolean istabpresent14 = login.IsTabPresent("Conference Folders");
                if (!istabpresent14)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-15:Navigate to Domain Management page, click New Domain button, verify the visibility of Enable Conference Lists option in Domain Management - New Domain page.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.ClickNewDomainBtn();
                if (domainmanagement.ConferenceListsCB().Selected == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                domainmanagement.ClickCloseEditDomain();


                //Step-16:Back to Domain Management page, select SuperadminGroup domain, click Edit button, verify the visibility of Enable Conference Lists option in Domain Management - Edit Domain page.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(DefaultDomain);
                domainmanagement.SelectDomain(DefaultDomain);
                domainmanagement.ClickEditDomain();
                if (domainmanagement.ConferenceListsCB().Selected == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                domainmanagement.ClickCloseEditDomain();

                //Step-17:Back to Domain Management page, select the created domain (DomainA), click Edit button, verify the visibility of Enable Conference Lists option in Domain Management - Edit Domain page.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Testdomain);
                domainmanagement.SelectDomain(Testdomain);
                domainmanagement.ClickEditDomain();
                if (domainmanagement.ConferenceListsCB().Selected == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                domainmanagement.ClickCloseEditDomain();

                //Step-18:Navigate to the Role Management tab, select the SuperAdminGroup role, verify the visibility of the Conference User option in the role.
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(DefaultRole, DefaultDomain);
                rolemanagement.SelectRole(DefaultRole);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferenceusercb18 = rolemanagement.IsElementVisible(rolemanagement.By_ConferenceUserCB());

                if (Conferenceusercb18 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();

                //Step-19:Navigate to the Role Management tab, select newly created roles (e.g. daA, roleA1 or roleA2), verify the visibility of the Conference User option in roles.
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(Testrole1, Testdomain);
                rolemanagement.SelectRole(Testrole1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferenceusercb19 = rolemanagement.IsElementVisible(rolemanagement.By_ConferenceUserCB());
                if (Conferenceusercb19 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();
                login.Logout();


                //Step-20:Login iCA website as domain admin, verify the visibility of Conference tab.
                login.LoginIConnect(Testdomain, Testdomain);
                Boolean istabpresent20 = login.IsTabPresent("Conference Folders");
                if (!istabpresent20)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-21:Navigate to Domain Management page, verify the visibility of Enable Conference Lists option in Enter Domain Information page.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                if (domainmanagement.ConferenceListsCB().Selected == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-22:Navigate to Role Management page, click New Role button, verify the visibility of Conference User option in the Role Management - New Role page
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.ClickNewRoleBtn();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                if (rolemanagement.ConferenceUserCB().Displayed == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();

                //Step-23:Back to Role Management page, select newly added roles (e.g. daA, roleA1, roleA2), click Edit, verify the visibility of Conference User option in the Role Management - Edit Role page
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(TestdomainAdmin);
                rolemanagement.SelectRole(TestdomainAdmin);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferenceusercb23 = rolemanagement.IsElementVisible(rolemanagement.By_ConferenceUserCB());
                if (Conferenceusercb23 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();
                login.Logout();

                //Step-24:Login as a non-conference user (e.g. userA1 or userA2 with a role does not have Conference User option enabled), verify the visibility of Conference tab
                login.LoginIConnect(Testuser2, Testuser2);
                Boolean istabpresent24 = login.IsTabPresent("Conference Folders");
                if (!istabpresent24)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-25,26,27:Check using iPad(Not Applicable)
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-28:Enable Conference Lists is turned OFF in Server Tool
                taskbar = new Taskbar();
                taskbar.Hide();
                servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableConferenceLists(1);
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                Executedsteps++;

                //Step-29:Login iCA as Superadmin user verify the visibility of Conference tab; repeat this step by login iCA as Domain Admin, and then as a user (e.g. userA1 or userA2)
                login.LoginIConnect(adminusername, adminpassword);
                Boolean istabpresent29_1 = login.IsTabPresent("Conference Folders");
                login.Logout();
                login.LoginIConnect(Testdomain, Testdomain);
                Boolean istabpresent29_2 = login.IsTabPresent("Conference Folders");
                login.Logout();
                login.LoginIConnect(Testuser2, Testuser2);
                Boolean istabpresent29_3 = login.IsTabPresent("Conference Folders");

                if (!istabpresent29_1 && !istabpresent29_2 && !istabpresent29_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-30:Login iCA as Superadmin user verify the visibility of Enable Conference Lists option in Domain Management -> New Domain
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.ClickNewDomainBtn();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferencelistcb30 = domainmanagement.IsElementVisible(domainmanagement.By_ConferenceListsCB());
                if (Conferencelistcb30 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                domainmanagement.ClickCloseEditDomain();

                //Step-31:Verify the visibility of Enable Conference Lists in Domain Management -> Edit Domain page.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Testdomain);
                domainmanagement.SelectDomain(Testdomain);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(20);
                bool Conferencelistcb31 = domainmanagement.IsElementVisible(domainmanagement.By_ConferenceListsCB());

                if (Conferencelistcb31 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                domainmanagement.ClickCloseEditDomain();
                login.Logout();

                //Step-32:Login iCA as the domain admin, verify the visibility of Enable Conference Lists in Enter Domain Information page.
                login.LoginIConnect(Testdomain, Testdomain);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                bool Conferencelistcb32 = domainmanagement.IsElementVisible(domainmanagement.By_ConferenceListsCB());

                if (Conferencelistcb32 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Setting the feature in ServiceTool
                taskbar = new Taskbar();
                taskbar.Hide();
                servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableConferenceLists(0);
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
            finally
            {
                //Setting the feature in ServiceTool
                taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableConferenceLists(0);
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();

            }
        }

        /// <summary>
        /// Conference Lists - Domain and Role Permissions for View Conference Studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94285(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PateintID");
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String datasource = login.GetHostName(Config.SanityPACS);
                //DomainA
                String TestdomainA = "Test85_DomainA" + new Random().Next(1, 1000);
                String TestdomainAdminA = "Test85_DomainAdminA" + new Random().Next(1, 1000);
                String TestroleA1 = "Test85_Role1A" + new Random().Next(1, 1000);
                String TestroleA2 = "Test85_Role2A" + new Random().Next(1, 1000);
                String TestuserA1 = "Test85_User1A" + new Random().Next(1, 1000);
                String TestuserA2 = "Test85_User2A" + new Random().Next(1, 1000);
                //DomainB
                String TestdomainB = "Test85_DomainB" + new Random().Next(1, 1000);
                String TestdomainAdminB = "Test85_DomainAdminB" + new Random().Next(1, 1000);
                String TestroleB1 = "Test85_Role1B" + new Random().Next(1, 1000);
                //DomainC
                String TestdomainC = "Test85_DomainC" + new Random().Next(1, 1000);
                String TestdomainAdminC = "Test85_DomainAdminC" + new Random().Next(1, 1000);
                String TestroleC1 = "Test85_Role1C" + new Random().Next(1, 1000);
                String TestroleC2 = "Test85_Role2C" + new Random().Next(1, 1000);
                String TestuserC2 = "Test85_User2C" + new Random().Next(1, 1000);

                //Step-1:[Pre-conditions-]--1. iCA build under testing is a fresh installation on iCA server--2. at least a data source is configured in Server Tool and connected to the domain used--3. IPad is available for the testing
                //Enable Conference Lists checkbox is ON in Server Tool               
                Executedsteps++;



                //Step-2:Create new domain e.g. Domain Name- DomainA, Domain Admin- daA, Role- roleA1, User- userA1 and Role- roleA2, User- userA2; Logout Superadmin. Login iCA website as the Domain Admin (daA) verify the visibility of Conference tab.
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(TestdomainA, TestdomainAdminA, datasource);
                domainmanagement.ClickSaveNewDomain();
                bool domainA = domainmanagement.SearchDomain(TestdomainA);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainA, TestroleA1, "any");
                rolemanagement.CreateRole(TestdomainA, TestroleA2, "any");
                bool role1 = rolemanagement.RoleExists(TestroleA1);
                bool role2 = rolemanagement.RoleExists(TestroleA1);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserA1, TestdomainA, TestroleA1);
                usermanagement.CreateUser(TestuserA2, TestdomainA, TestroleA2);
                bool userA1 = usermanagement.SearchUser(TestuserA1, TestdomainA);
                bool userA2 = usermanagement.SearchUser(TestuserA2, TestdomainA);

                if (domainA && role1 && role2 && userA1 && userA2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3:Superadmin enables or disables the Conference Lists permission at Domain Level
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(TestdomainA);
                domainmanagement.SelectDomain(TestdomainA);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB3 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                if (CB3)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-4:Verify the visibility of the Conference Folders tab.
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists4 = login.IsTabPresent("Conference Folders");
                if (tabexists4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-5:Create a new domain (DomainB, domain admin- daB) and enable the Conference Lists permission in Domain Information section of the domain.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(TestdomainB, TestdomainAdminB, datasource);
                domainmanagement.ClickSaveNewDomain();
                domainmanagement.SearchDomain(TestdomainB);
                domainmanagement.SelectDomain(TestdomainB);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB5 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                if (CB5)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-6:Create a new domain (DomainC, domain admin- daC) and disable the Conference Lists permission in Domain Information section of the domain.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(TestdomainC, TestdomainAdminC, datasource);
                domainmanagement.ClickSaveNewDomain();
                domainmanagement.SearchDomain(TestdomainC);
                domainmanagement.SelectDomain(TestdomainC);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 1);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB6 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                if (!CB6)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-7: Domain Admin enables or disables the Conference Lists permission at Domain Level
                login.LoginIConnect(TestdomainC, TestdomainC);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB7 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                domainmanagement.ClickCloseEditDomain();
                if (CB7)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Verify the visibility of the Conference Folders tab.
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists8 = login.IsTabPresent("Conference Folders");
                if (tabexists8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-9:Login iCA as a domain admin of a domain that has enabled Conference Lists Permission at domain level (e.g. daB from DomainB), verify the visibility of the Conference Folders tab.
                login.LoginIConnect(TestdomainB, TestdomainB);
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists9 = login.IsTabPresent("Conference Folders");
                if (tabexists9)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-10:Navigate to Domain Management tab, disable the Conference Lists permission in the Domain Information section.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 1);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB10 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                domainmanagement.ClickCloseEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists10 = login.IsTabPresent("Conference Folders");
                if (!CB10 && !tabexists10)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-11:Superadmin enables or disables the Conference User permission at Role Level
                login.LoginIConnect(adminusername, adminpassword);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(TestroleA1, TestdomainA);
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB11 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                if (CB11)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12:From Role Management tab, select an existing domain that has enabled the Conference Lists permission at domain level (e.g. DomainC), create a new user role (e.g. roleC1) with the Conference User permission enabled.
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainC, TestroleC1, "any");
                rolemanagement.SearchRole(TestroleC1, TestdomainC);
                rolemanagement.SelectRole(TestroleC1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB12 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                if (CB12)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13:From Role Management tab, select an existing domain that has disabled Conference Lists permission at domain level (e.g. DomainB), create a user role (e.g. roleB) with the Conference User permission disabled.
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainB, TestroleB1, "any");
                rolemanagement.SearchRole(TestroleB1, TestdomainB);
                rolemanagement.SelectRole(TestroleB1);
                rolemanagement.ClickEditRole();
                bool Conferenceusercb13 = rolemanagement.IsElementPresent(rolemanagement.By_ConferenceUserCB());
                if (Conferenceusercb13 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();
                login.Logout();

                //Step-14:Domain Admin enable or disable the Conference User permission at Role Level
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(TestroleA2);
                rolemanagement.SelectRole(TestroleA2);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 1);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB14 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                if (!CB14)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-15:Login iCA as a domain admin (daB) of a domain that has disabled Conference Lists permission at domain level (DomainB), navigate to Role Management tab, select an existing role (roleB) that has no Conference Lists permission at domain level, edit the role and attempt to enable the Conference user permission at the role level.
                login.LoginIConnect(TestdomainB, TestdomainB);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SearchRole(TestroleB1);
                rolemanagement.SelectRole(TestroleB1);
                rolemanagement.ClickEditRole();
                bool Conferenceusercb15 = rolemanagement.IsElementPresent(rolemanagement.By_ConferenceUserCB());
                if (Conferenceusercb15 == false)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                rolemanagement.ClickCloseButton();
                login.Logout();

                //Step-16:Login iCA as a domain admin (daC) of a domain that has enabled Conference Lists permission at domain level (DomainC), navigate to Role Management tac, create a new role (roleC2) with the Conference User permission enabled.
                login.LoginIConnect(TestdomainC, TestdomainC);
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainC, TestroleC2, "any");
                rolemanagement.SearchRole(TestroleC2);
                rolemanagement.SelectRole(TestroleC2);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB16 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                if (CB16)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-17:Add a conference user (userC2) using the newly created role (roleC2) with the Conference User permission enabled.
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserC2, TestdomainC, TestroleC2);
                bool userC2 = usermanagement.SearchUser(TestuserC2, TestdomainC);
                if (userC2)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-18:From desktop client system login iCA as the newly created conference user (userC2), verify the visibility of Conference Tab.
                login.LoginIConnect(TestuserC2, TestuserC2);
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists18 = login.IsTabPresent("Conference Folders");
                if (tabexists18)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-19:From desktop client system login iCA as the non-conference user (userA2), verify the visibility of Conference Tab.
                login.LoginIConnect(TestuserA2, TestuserA2);
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists19 = login.IsTabPresent("Conference Folders");
                if (!tabexists19)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-20,21:Check from iPad(Not applicable)
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-22:From desktop client system, login iCA as the domain admin (daC in DomainC), disable the Conference List permission at domain level. Logout and then login iCA as the user who used to have permission to view conference studies (userC2), attempt to go to the Conference tab.
                login.LoginIConnect(TestdomainC, TestdomainC);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 1);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB22 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                domainmanagement.ClickCloseEditDomain();
                login.Logout();

                login.LoginIConnect(TestuserC2, TestuserC2);
                PageLoadWait.WaitForFrameLoad(5);
                bool tabexists22 = login.IsTabPresent("Conference Folders");
                if (!CB22 && !tabexists22)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-23:Check from iPad(not applicable)
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-24:Post Test Condition---From desktop client system, login iCA as the domain admin (daC in DomainC), enable the Conference List permission at domain level
                login.LoginIConnect(TestdomainC, TestdomainC);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB24 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                domainmanagement.ClickCloseEditDomain();
                login.Logout();
                if (CB24)
                {

                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Create Folders and Add Folder Descriptions
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94426(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String datasource = login.GetHostName(Config.SanityPACS);
                //DomainA
                String TestdomainA = "94426_DomainA" + new Random().Next(1, 1000);
                String TestdomainRoleA = "94426_DomainRoleA" + new Random().Next(1, 1000);
                String TestroleA1 = "94426_Role1A" + new Random().Next(1, 1000);
                String TestroleA2 = "94426_Role2A" + new Random().Next(1, 1000);
                String TestuserA1 = "94426_User1A" + new Random().Next(1, 1000);
                String TestuserA2 = "94426_User2A" + new Random().Next(1, 1000);
                String TestuserA3 = "94426_User3A" + new Random().Next(1, 1000);
                String TestuserA4 = "94426_User4A" + new Random().Next(1, 1000);
                //DomainC
                String TestdomainC = "94426_DomainC" + new Random().Next(1, 1000);
                String TestdomainRoleC = "94426_DomainRoleC" + new Random().Next(1, 1000);
                String TestroleC2 = "94426_Role2C" + new Random().Next(1, 1000);
                String TestuserC2 = "94426_User2C" + new Random().Next(1, 1000);

                //FolderNames for DomainA
                //Set1:
                String TopFolderA1 = "Top level folder 1 in DomainA_" + new Random().Next(1, 1000);//userA1 as FolderManager
                String SubFolderA1_1_Level2_1 = "October 6_" + new Random().Next(1, 1000);//with no description
                String SubFolderA1_1_Level2_2 = "October 13_" + new Random().Next(1, 1000);
                String SubFolderA1_1_Level3 = "October 16_" + new Random().Next(1, 1000);
                String Desc_A1_Level = "Description for top level folder 1 in DomainA";
                String Desc_A2_Level = "Description for top level folder 2 in DomainA";
                String Desc_A1_Level2 = "Meeting 10.06.2016";
                String SubFolderA1_2_Level2 = "October 13, 2016_" + new Random().Next(1, 1000);
                String SubFolderA1_2_Level3_3 = "October 20_" + new Random().Next(1, 1000);
                String SubFolderA1_2_Level3_4 = "October 23_" + new Random().Next(1, 1000);
                String Desc_A1_Level3_2 = "Meeting 10.20.2016_" + new Random().Next(1, 1000);
                String SubFolderA1_2_Level4 = "SubLevel 3_" + new Random().Next(1, 1000);

                //Set2:
                String TopFolderA2 = "Top level folder 2 in DomainA_" + new Random().Next(1, 1000);//No FolderManager,no subfolders

                //Set4:
                String TopFolderA4 = "Top folder 4 in DomainA_" + new Random().Next(1, 1000);//userA2 as FolderManager
                String SubFolderA4_1_Level2 = "Level2_A4_" + new Random().Next(1, 1000);
                String Desc_A4_Level = "Description for top folder 4 in DomainA";
                String Subfolder_Desc_A4_Level = "Description for Subfolder 4 in DomainA";

                //Set5:
                String TopFolderA5 = "Top folder 5 in DomainA_" + new Random().Next(1, 1000);//userA1 as FolderManager
                String SubFolderA5_1_Level2 = "Level2_A5_" + new Random().Next(1, 1000);
                String Desc_A5_Level2 = "Description for A5 Level 2_" + new Random().Next(1, 1000);

                //FolderNames for DomainC
                //Set3:
                String TopFolderC1 = "Top level folder 3 in DomainC_" + new Random().Next(1, 1000);//no FolderManager
                String SubFolderC3_1_Level2 = "Level2_C3_" + new Random().Next(1, 1000);
                String Desc_C3_Level2 = SubFolderC3_1_Level2 + "_Description";


                //Step-1:[Pre-conditions-]--1. iCA build under testing is a fresh installation on iCA server--2. at least a data source is configured in Server Tool and connected to the domain used--3. IPad is available for the testing
                //Enable Conference Lists checkbox is ON in Server Tool
                //Service tool steps already performed in earlier cases, hence not repeating the steps
                Executedsteps++;


                //Step-2:Pre-conditions-Define domains, roles, users and Conference User settings (if have not done yet)
                //--> DomainA (Conference User enabled)-Domain Admin daA (Conference User enabled);-Role roleA1 (Conference User enabled);-User in roleA1 userA1(Folder Manager), userA3 (conference user);-Role roleA2 (Conference User disabled);-User in roleA2 userA2 (non-conference user, Folder Manager), userA4 (non-conference user);-- DomainC (Conference User enabled) -Domain Admin daC (Conference User enabled);-Role roleC1 (Conference User enabled);-Role roleC2 (Conference User enabled);-User in roleC2 userC2 (Conference user)

                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                //DomainA and DomainC with Conf. enabled
                domainmanagement.CreateDomain(TestdomainA, TestdomainRoleA, datasource);
                domainmanagement.ClickSaveNewDomain();
                domainmanagement.CreateDomain(TestdomainC, TestdomainRoleC, datasource);
                domainmanagement.ClickSaveNewDomain();
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(TestdomainA);
                domainmanagement.SelectDomain(TestdomainA);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_1 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(TestdomainC);
                domainmanagement.SelectDomain(TestdomainC);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_2 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();


                //2 Roles for each domain
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainA, TestroleA1, "any");
                rolemanagement.CreateRole(TestdomainA, TestroleA2, "any");
                rolemanagement.CreateRole(TestdomainC, TestroleC2, "any");

                //RoleA1 with enabled feature
                rolemanagement.SearchRole(TestroleA1, TestdomainA);
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_3 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //RoleA2 with disabled feature
                rolemanagement.SearchRole(TestroleA2, TestdomainA);
                rolemanagement.SelectRole(TestroleA2);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 1);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_4 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //RoleC2 with enabled feature
                rolemanagement.SearchRole(TestroleC2, TestdomainC);
                rolemanagement.SelectRole(TestroleC2);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_6 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //2 users for each roles of DoaminA
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserA1, TestdomainA, TestroleA1);//Conference User
                usermanagement.CreateUser(TestuserA2, TestdomainA, TestroleA2);//Non-Conference User

                bool userA1 = usermanagement.SearchUser(TestuserA1, TestdomainA);
                bool userA2 = usermanagement.SearchUser(TestuserA2, TestdomainA);

                //1 user for RoleC2 of DomainC
                usermanagement.CreateUser(TestuserC2, TestdomainC, TestroleC2);//Conference User
                bool userC2 = usermanagement.SearchUser(TestuserC2, TestdomainC);

                if (CB2_1 && CB2_2 && CB2_3 && !CB2_4 && CB2_6 && userA1 && userA2 && userC2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3,4,5 :Create Top Level Folder, - DomainA -1) Top Level Folder Folder Managers userA1
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                bool step5 = conferencefolders.CreateToplevelFolder(TopFolderA1, TestuserA1); //First Top Folder
                //conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1_1_Level2);
                Executedsteps++;
                Executedsteps++;
                if (step5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6: Create top level folder without foler manager
                bool step6_1 = conferencefolders.CreateToplevelFolder(TopFolderA2); //Second Top folder
                //bool step6_2 = conferencefolders.ActiveFolder().Text.Equals(TopFolderA2);
                if (step6_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7: Create top level folder in Domain C
                conferencefolders.DomainSelector().SelectByText(TestdomainC);
                bool step7_1 = conferencefolders.CreateToplevelFolder(TopFolderC1); //First Top Folder
                //bool step7_2 = conferencefolders.ActiveFolder().Text.Equals(TopFolderC1);
                if (step7_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8: Create top level folder without name
                //Get number of folders before creating top level folder
                int step8_1 = conferencefolders.GetToplevelFolders().Count;
                try { conferencefolders.CreateToplevelFolder(""); }
                catch (Exception ex) { }
                //Validating if count equal to previous
                int step8_2 = conferencefolders.GetToplevelFolders().Count;
                if (step8_1 == step8_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.TopLevelFolderCancelButton().Click();
                //Step 9: Create top level folder without name but having folder manager
                //Get number of folders before creating top level folder
                int step9_1 = conferencefolders.GetToplevelFolders().Count; 
                try { conferencefolders.CreateToplevelFolder(""); }
                catch (Exception ex) { }
                //Checking if Domain Admin text box is disabled
                bool step9_2 = conferencefolders.FolderManagerTextBox().Enabled;
                //Validating if error message to enter folder name appears
                //Validating if count equal to previous
                int step9_3 = conferencefolders.GetToplevelFolders().Count;
                if ((step9_1 == step9_3) && !step9_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.TopLevelFolderCancelButton().Click();
                login.Logout();

                //Step 10,11 : Select top level folder, select and edit top level domain description
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                conferencefolders.ExpandAndSelectFolder(TopFolderA1);
                conferencefolders.EditDescription(Desc_A1_Level);
                Executedsteps++;
                if (conferencefolders.EditDesc_CurrentDesc().Text == Desc_A1_Level)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12 : Select different top level folder, select and edit top level domain description
                conferencefolders.ExpandAndSelectFolder(TopFolderA2);
                conferencefolders.EditDescription(Desc_A2_Level);
                if (conferencefolders.EditDesc_CurrentDesc().Text == Desc_A2_Level)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 13,14 : Domain admin logs in and creates top level domain
                login.LoginIConnect(TestdomainA, TestdomainA);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                //conferencefolders.DomainSelector().SelectByText(TestdomainA);
                bool step14_1 = conferencefolders.CreateToplevelFolder(TopFolderA4, TestuserA2); //First Top Folder
                //bool step14_2 = conferencefolders.ActiveFolder().Text.Equals(TopFolderA4);
                Executedsteps++;
                if (step14_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15, 16: Edit description of folder created by domain admin
                conferencefolders.ExpandAndSelectFolder(TopFolderA4);
                conferencefolders.EditDescription(Desc_A4_Level);
                Executedsteps++;
                if (conferencefolders.EditDesc_CurrentDesc().Text == Desc_A4_Level)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17: Create another top level folder
                bool step17_1 = conferencefolders.CreateToplevelFolder(TopFolderA5); //First Top Folder
                //bool step17_2 = conferencefolders.ActiveFolder().Text.Equals(TopFolderA5);
                if (step17_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 18: Create top level folder without name
                //Get number of folders before creating top level folder
                int step18_1 = conferencefolders.GetToplevelFolders().Count;
                try { conferencefolders.CreateToplevelFolder(""); }
                catch (Exception ex) { }
                //Validating if error message to enter folder name appears
                //Validating if count equal to previous
                int step18_2 = conferencefolders.GetToplevelFolders().Count;
                //Validating if error message to enter folder name appears
                if (step18_1 == step18_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.TopLevelFolderCancelButton().Click();


                //Step 19: Create top level folder without name but having folder manager
                //Get number of folders before creating top level folder
                int step19_1 = conferencefolders.GetToplevelFolders().Count;
                try { conferencefolders.CreateToplevelFolder(""); }
                catch (Exception ex) { }
                //Checking if Domain Admin text box is disabled
                bool step19_2 = conferencefolders.FolderManagerTextBox().Enabled;
                //Validating if error message to enter folder name appears
                //Validating if count equal to previous
                int step19_3 = conferencefolders.GetToplevelFolders().Count;
                //Validating if error message to enter folder name appears
                if ((step19_1 == step19_3) && !step19_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.TopLevelFolderCancelButton().Click();

                //Step 20: Domain admin should not be able to create top level folder for other domains - Check if the domain dropdown exists (should not be visible for domain admin to select another domain)
                bool step20 = conferencefolders.IsElementVisible(By.CssSelector("#m_resultsSelectorControl_m_selectorList"));
                if (!step20)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 21: Login as Folder manager and check if folder manager can create top level folder
                login.LoginIConnect(TestuserA1, TestuserA1);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                //If the create top level folder button appears, folder manager can create folder. Should not be visible for Folder Manager
                bool step21_final = conferencefolders.IsElementVisible(By.CssSelector("input[id='FolderManagementButton']"));
                if (!step21_final)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 22: Login as domain admin and create a conference user. Try to create top lvel folder with that user
                login.LoginIConnect(TestdomainA, TestdomainA);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserA3, TestdomainA, TestroleA1);//Conference User
                login.Logout();
                login.LoginIConnect(TestuserA3, TestuserA3);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                //If the create top level folder button appears, user can create folder. Should not be visible for user
                bool step22_final = conferencefolders.IsElementVisible(By.CssSelector("input[id='FolderManagementButton']"));
                if (!step22_final)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 23: Login as domain admin and create a non-conference user. Try to create top lvel folder with that user
                login.LoginIConnect(TestdomainA, TestdomainA);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserA4, TestdomainA, TestroleA2);//Conference User
                login.Logout();
                login.LoginIConnect(TestuserA4, TestuserA4);
                string[] Tabs = login.GetAvailableTabs();
                bool step23 = login.CheckStringinStringArray(Tabs, "Conference Folders");
                //If the create top level folder button appears, user can create folder. Should not be visible for user
                if (!step23)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 24, 25: Login as Folder manager and create sub folder
                login.LoginIConnect(TestuserA1, TestuserA1);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderA1);
                bool step25 = conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1_1_Level2_1);
                Executedsteps++;
                if (step25)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 26,27: Select folder and edit description
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2_1);
                conferencefolders.EditDescription(Desc_A1_Level2);
                Executedsteps++;
                if (conferencefolders.EditDesc_CurrentDesc().Text == Desc_A1_Level2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 28: Create another Level 2 Subfolder
                conferencefolders.ExpandAndSelectFolder(TopFolderA1);
                bool step28 = conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1_1_Level2_2);
                if (step28)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 29: Add another sub level 3 folder under sub level 2 folder
                bool step29 = conferencefolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2_2, SubFolderA1_1_Level3);
                if (step29)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 30: Select top level folder and add a folder without name
                conferencefolders.ExpandAndSelectFolder(TopFolderA1);
                bool step30 = conferencefolders.CreateSubFolder(TopFolderA1, "");
                if (!step30)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 31: Create subfolder without name in subfolder
                bool step31 = conferencefolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2_2, "");
                if (!step31)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 32: Select top level folder 2 and try to create a subfolder
                conferencefolders.ExpandAndSelectFolder(TopFolderA2);
                //Button should not be enabled as user is not folder manager for this folder
                bool step32 = conferencefolders.CreateFolderButton().Enabled;
                if (!step32)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 33: Select top level folder 4 and try to create a subfolder
                conferencefolders.ExpandAndSelectFolder(TopFolderA4);
                //Button should not be enabled as user is not folder manager for this folder
                bool step33 = conferencefolders.CreateFolderButton().Enabled;
                if (!step33)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 34: Select top level folder 4 and try to create a subfolder
                login.LoginIConnect(TestuserA2, TestuserA2);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderA4);
                bool step34 = conferencefolders.CreateSubFolder(TopFolderA4, SubFolderA4_1_Level2, null, Subfolder_Desc_A4_Level);
                if (step34)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 35: Login with User A3 and try to create a subfolder
                login.LoginIConnect(TestuserA3, TestuserA3);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                //If the create sub folder button appears, user can create folder. Should not be visible for user
                bool step35 = conferencefolders.IsElementVisible(By.CssSelector("#CreateFolderButton"));
                if (!step35)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 36,37: Domain admin to create subfolder and description
                login.LoginIConnect(TestdomainA, TestdomainA);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step37 = conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1_2_Level3_3);
                Executedsteps++;
                if (step37)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 38: Edit description
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1_2_Level3_3);
                conferencefolders.EditDescription(Desc_A1_Level3_2);
                if (conferencefolders.EditDesc_CurrentDesc().Text == Desc_A1_Level3_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 39: Domain admin to create subfolder in another top level folder
                bool step39 = conferencefolders.CreateSubFolder(TopFolderA4, SubFolderA1_2_Level3_4);
                if (step39)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 40: Create Sub lvel 3 folder 
                bool step40 = conferencefolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2_1, SubFolderA1_2_Level4);
                if (step40)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 41: Switch between folder and verify description:
                conferencefolders.ExpandAndSelectFolder(TopFolderA1);
                bool step41_1 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A1_Level);
                conferencefolders.ExpandAndSelectFolder(TopFolderA2);
                bool step41_2 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A2_Level);
                conferencefolders.ExpandAndSelectFolder(TopFolderA4);
                bool step41_3 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A4_Level);
                if (step41_1 && step41_2 && step41_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 42, 43: Super Admin creates subfolder and description
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                Executedsteps++;
                bool step43 = conferencefolders.CreateSubFolder(TopFolderA5, SubFolderA5_1_Level2);
                if (step43)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 44: Add folder description
                conferencefolders.ExpandAndSelectFolder(TopFolderA5 + "/" + SubFolderA5_1_Level2);
                conferencefolders.EditDescription(Desc_A5_Level2);
                bool step44 = conferencefolders.ActiveFolder().Text.Equals(SubFolderA5_1_Level2);
                if (step44 && conferencefolders.EditDesc_CurrentDesc().Text == Desc_A5_Level2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 45: Select a top level folder in domain C and create sub folder
                conferencefolders.DomainSelector().SelectByText(TestdomainC);
                bool step45 = conferencefolders.CreateSubFolder(TopFolderC1, SubFolderC3_1_Level2);
                if (step45)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 46: Add folder description to the subfolder
                conferencefolders.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC3_1_Level2);
                conferencefolders.EditDescription(Desc_C3_Level2);
                bool step46 = conferencefolders.ActiveFolder().Text.Equals(SubFolderC3_1_Level2);
                if (step46 && conferencefolders.EditDesc_CurrentDesc().Text == Desc_C3_Level2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 47: Check folder descriptions for Domains A & C:
                //Validate for Domain A
                //Validate descriptions of top level folders
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                conferencefolders.ExpandAndSelectFolder(TopFolderA1);
                bool step47_1 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A1_Level);
                conferencefolders.ExpandAndSelectFolder(TopFolderA2);
                bool step47_2 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A2_Level);
                conferencefolders.ExpandAndSelectFolder(TopFolderA4);
                bool step47_3 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A4_Level);
                //Validate descriptions of sub folders
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2_1);
                bool step47_4 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A1_Level2);
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1_2_Level3_3);
                bool step47_5 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A1_Level3_2);
                conferencefolders.ExpandAndSelectFolder(TopFolderA4 + "/" + SubFolderA4_1_Level2);
                bool step47_6 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Subfolder_Desc_A4_Level);
                conferencefolders.ExpandAndSelectFolder(TopFolderA5 + "/" + SubFolderA5_1_Level2);
                bool step47_7 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_A5_Level2);
                //Validate for Domain C
                //Validate descriptions of Domain C sub folder
                conferencefolders.DomainSelector().SelectByText(TestdomainC);
                conferencefolders.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC3_1_Level2);
                bool step47_8 = conferencefolders.EditDesc_CurrentDesc().Text.Equals(Desc_C3_Level2);

                if (step47_1 && step47_2 && step47_3 && step47_4 && step47_5 && step47_6 && step47_7 && step47_8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Modify Folder Names and Descriptions
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94428(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferenceFolders;

            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;

                //Domains
                String DomainA = "DomainA_94428_" + new Random().Next(1, 1000);
                String DomainC = "DomainC_94428_" + new Random().Next(1, 1000);

                //Domain Admin
                String daA = "daA_94428_" + new Random().Next(1, 1000);
                String daC = "daC_94428_" + new Random().Next(1, 1000);

                //Roles                
                String roleA1 = "roleA1_94428_" + new Random().Next(1, 1000);
                String roleA2 = "roleA2_94428_" + new Random().Next(1, 1000);
                String roleC1 = "roleC1_94428_" + new Random().Next(1, 1000);
                String roleC2 = "roleC2_94428_" + new Random().Next(1, 1000);

                //Users
                String userA1 = "userA1_94428_" + new Random().Next(1, 1000);
                String userA2 = "userA2_94428_" + new Random().Next(1, 1000);
                String userA3 = "userA3_94428_" + new Random().Next(1, 1000);
                String userA4 = "userA4_94428_" + new Random().Next(1, 1000);
                String userC2 = "userC2_94428_" + new Random().Next(1, 1000);

                //Folders
                String TopFolderA1 = "TopFolderA1_94428";
                String SubFolderA1_1_Level2 = "October06_94428_" + new Random().Next(1, 1000);//with no description
                String SubFolderA1_2_Level2 = "October13_94428_" + new Random().Next(1, 1000);
                String SubFolderA1_3_Level2 = "October20_94428_" + new Random().Next(1, 1000);
                String SubFolderA1_1_Level3 = "Level3_94428_" + new Random().Next(1, 1000);
                String TopLevelFolder2 = "TopLevelFolder2_94428_" + new Random().Next(1, 1000);
                String TopFolderA3 = "TopFolderA3_94428_" + new Random().Next(1, 1000);
                String TopLevelFolder3 = "TopLevelFolder3_94428_" + new Random().Next(1, 1000);
                String TopFolderA4 = "TopFolderA4_94428_" + new Random().Next(1, 1000);
                String SubFolderA4_1_Level2 = "A4Level2_94428_" + new Random().Next(1, 1000);
                String TopFolderA5 = "TopFolderA5_94428_" + new Random().Next(1, 1000);
                String SubFolderA5_1_Level2 = "A5Level2_94428_" + new Random().Next(1, 1000);

                //Step 1 - Precondition
                Executedsteps++;

                //Step 2 - Precondition
                login.LoginIConnect(adminUserName, adminPassword);

                //2.1 DomainA - Conference Lists enabled, DomainC - Conference Lists enabled
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                if (!domainmanagement.IsDomainExist(DomainA)) domainmanagement.CreateConfUsrDomain(DomainA);
                else domainmanagement.SetConfListFeatureForDomain(DomainA);
                if (!domainmanagement.IsDomainExist(DomainC)) domainmanagement.CreateConfUsrDomain(DomainC);
                else domainmanagement.SetConfListFeatureForDomain(DomainC);                

                //2.2 - daA - Conference User enabled, daC - Conference User enabled
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(daA, DomainA)) usermanagement.CreateDomainAdminUser(daA, DomainA, 0, "", 0, "", 1);
                if (!usermanagement.SearchUser(daC, DomainC)) usermanagement.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);

                //2.3 - roleA1 - Conference User enabled, roleC2 - Conference User enabled
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                if (!rolemanagement.RoleExists(roleA1, DomainA)) rolemanagement.CreateConfListRole(DomainA, roleA1);
                if (!rolemanagement.RoleExists(roleA2, DomainA)) { rolemanagement.ClickNewRoleBtn(); rolemanagement.CreateRole(DomainA, roleA2); }
                if (!rolemanagement.RoleExists(roleC1, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC1);
                if (!rolemanagement.RoleExists(roleC2, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC2);

                //2.4 - userA1 - Folder Manager, userA3 - conference user
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userA1, DomainA)) usermanagement.CreateUser(userA1, DomainA, roleA1); //Folder Manager
                if (!usermanagement.SearchUser(userA3, DomainA)) usermanagement.CreateUser(userA3, DomainA, roleA1); //Conference User
                if (!usermanagement.SearchUser(userA2, DomainA)) usermanagement.CreateUser(userA2, DomainA, roleA2); //Non-Conference User
                if (!usermanagement.SearchUser(userA4, DomainA)) usermanagement.CreateUser(userA4, DomainA, roleA2); //Non-Conference User                      
                if (!usermanagement.SearchUser(userC2, DomainC)) usermanagement.CreateUser(userC2, DomainC, roleC2); //Conference User
                             
                login.Logout();
                Executedsteps++;              

                //Step 3 - Create Top Level Folders, Sub-Folders and Level3 Sub-Folders (if not done yet) ---- in DomainA
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainA, TopFolderA1))
                    conferenceFolders.CreateToplevelFolder(TopFolderA1, userA1, DomainA, TopFolderA1 + " Description");
                conferenceFolders.CreateSubFolder(TopFolderA1, SubFolderA1_1_Level2, DomainA, "Meeting 10.06.2016");
                conferenceFolders.CreateSubFolder(TopFolderA1, SubFolderA1_2_Level2, DomainA, "October 13");
                conferenceFolders.CreateSubFolder(TopFolderA1, SubFolderA1_3_Level2, DomainA, "October 20");
                conferenceFolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2,
                                                  SubFolderA1_1_Level3, DomainA,
                                                  SubFolderA1_1_Level3 + " Description");

                if (!conferenceFolders.IsTopLevelFolderExist(DomainA, TopLevelFolder2)) conferenceFolders.CreateToplevelFolder(TopLevelFolder2, null, null, TopLevelFolder2 + " Description");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopLevelFolder3)) conferenceFolders.CreateToplevelFolder(TopLevelFolder3, null, null, TopLevelFolder3 + " Description");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainA, TopFolderA4)) conferenceFolders.CreateToplevelFolder(TopFolderA4, userA2, null, TopFolderA4 + " Description");
                conferenceFolders.CreateSubFolder(TopFolderA4, SubFolderA4_1_Level2, DomainA, SubFolderA4_1_Level2);
                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopFolderA5)) conferenceFolders.CreateToplevelFolder(TopFolderA5, null, null, TopFolderA5 + " Description");
                conferenceFolders.CreateSubFolder(TopFolderA5, SubFolderA5_1_Level2, DomainC, SubFolderA5_1_Level2);
                login.Logout();
                Executedsteps++;

                //Step 4     
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                conferenceFolders.SelectFolder(TopFolderA1, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopFolderA1, 1);
                if (conferenceFolders.TopLevelEditBox().GetAttribute("value").Equals(TopFolderA1))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                //login.Logout();

                //Step 5   
                //login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                string TopFolderA1_Edit = "Adult Bone Marrow Transplant";
                conferenceFolders.RenameFolder(TopFolderA1, TopFolderA1_Edit);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfTopLevelFolder(TopFolderA1_Edit))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6                
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                conferenceFolders.ExpandAndSelectFolder(TopFolderA1_Edit);
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.EditDesc_Button().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(TopFolderA1 + " Description"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7
                conferenceFolders.EditDesc_TextArea().Clear();
                conferenceFolders.EditDesc_TextArea().SendKeys(TopFolderA1 + " in " + DomainA);
                conferenceFolders.EditDesc_OKbutton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.By_EditDesc_Button()));
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(TopFolderA1 + " in " + DomainA))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                //login.Logout();

                //Step 8         
                //login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                string TopLevelFolder3_Edit = "Breast Care Center";
                conferenceFolders.RenameFolder(TopLevelFolder3, TopLevelFolder3_Edit);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfTopLevelFolder(TopLevelFolder3_Edit))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 9
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                conferenceFolders.SelectFolder(TopLevelFolder3_Edit, 1);
                conferenceFolders.EditDesc_Button().Click();
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(TopLevelFolder3 + " Description"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10           
                conferenceFolders.EditDesc_TextArea().SendKeys(TopLevelFolder3 + " in " + DomainC);
                conferenceFolders.EditDesc_OKbutton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_CurrentDesc()));
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(TopLevelFolder3 + " in " + DomainC))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 11
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopLevelFolder2);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfTopLevelFolder(TopLevelFolder2))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12       
                string TopLevelFolder2_Edit = "Brain Tumor (Neurologic Oncology)_94428_" + new Random().Next(1, 1000);
                conferenceFolders.RenameFolder(TopLevelFolder2, TopLevelFolder2_Edit);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfTopLevelFolder(TopLevelFolder2_Edit))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13                
                conferenceFolders.ExpandAndSelectFolder(TopLevelFolder2);
                conferenceFolders.EditDesc_Button().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_TextArea()));
                Thread.Sleep(3000);
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals(TopLevelFolder2 + " Description"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.EditDesc_TextArea().Clear();
                conferenceFolders.EditDesc_TextArea().SendKeys(TopLevelFolder2 + " in " + DomainA);
                conferenceFolders.EditDesc_OKbutton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_CurrentDesc()));
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(TopLevelFolder2 + " in " + DomainA))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 15
                login.LoginIConnect(daC, daC);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                string TopLevelFolder3_Edit_2 = "Cutaneous T-cell Lymphoma_94428_" + new Random().Next(1, 1000);
                conferenceFolders.RenameFolder(TopLevelFolder3_Edit, TopLevelFolder3_Edit_2);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfTopLevelFolder(TopLevelFolder3_Edit_2))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 16
                conferenceFolders.EditDesc_Button().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.EditDesc_TextArea().Clear();
                conferenceFolders.EditDesc_TextArea().SendKeys(TopLevelFolder3 + " in " + DomainC);
                conferenceFolders.EditDesc_OKbutton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_CurrentDesc()));
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals(TopLevelFolder3 + " in " + DomainC))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17
                conferenceFolders.SwitchtoConferenceFrame();
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 18
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.SelectFolder(TopLevelFolder2_Edit, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopLevelFolder2_Edit, 1);
                Thread.Sleep(1000);
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 19
                login.LoginIConnect(userA3, userA3);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.SelectFolder(TopLevelFolder2_Edit, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopLevelFolder2_Edit, 1);
                Thread.Sleep(1000);
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 20                
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ClickTopLevelFolderExpander(TopFolderA1_Edit);
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.IsSubLevel2FolderExist(TopFolderA1_Edit, SubFolderA1_1_Level2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21
                conferenceFolders.RenameFolder(TopFolderA1_Edit + "/" + SubFolderA1_1_Level2, "October 6, 2016");
                Thread.Sleep(2000);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfSubLevel2Folder(TopFolderA1_Edit, "October 6, 2016"))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 22
                conferenceFolders.EditDesc_Button().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals("Meeting 10.06.2016"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 23
                conferenceFolders.EditDesc_TextArea().Clear();
                conferenceFolders.EditDesc_TextArea().SendKeys("Meeting - October 6, 2016");
                conferenceFolders.EditDesc_OKbutton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("a#EditFolderDescriptionButton")));
                conferenceFolders.EditDesc_Button().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals("Meeting - October 6, 2016"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferenceFolders.EditDesc_CANCELbutton().Click();

                //Step 24
                conferenceFolders.ExpandAndSelectFolder("Adult Bone Marrow Transplant" + "/" + "October 6, 2016" + "/" + "Level3_94428");
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfSubLevel3Folder(TopFolderA1, SubFolderA1_1_Level3))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 25                
                conferenceFolders.SelectFolder(TopFolderA4, 1);
                Thread.Sleep(3000);
                conferenceFolders.SelectFolder(TopFolderA4, 1);
                Thread.Sleep(1000);
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 26
                login.LoginIConnect(userA3, userA3);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                PageLoadWait.WaitForFrameLoad(10);
                conferenceFolders.ExpandAndSelectFolder(TopFolderA1_Edit + "/" + "October 6, 2016");
                conferenceFolders.ActiveFolder().Click();
                if (!IsElementPresent(By.CssSelector(".fancytree-edit-input")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 27
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ClickTopLevelFolderExpander(TopFolderA1_Edit);//
                conferenceFolders.ClickSubLevelFolderExpander(2, TopFolderA1_Edit, "October 6, 2016");//
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfSubLevel3Folder(TopFolderA1_Edit, SubFolderA1_1_Level3))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 28
                conferenceFolders.RenameFolder(TopFolderA1_Edit + "/" + SubFolderA1_2_Level2, "October 13, 2016");
                Thread.Sleep(2000);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfSubLevel2Folder(TopFolderA1_Edit, "October 13, 2016"))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 29
                conferenceFolders.EditDesc_Button().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.EditDesc_TextArea().GetAttribute("value").Equals("October 13"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 30
                conferenceFolders.EditDesc_TextArea().Clear();
                conferenceFolders.EditDesc_TextArea().SendKeys("daA modified: Meeting - October 13, 20YY");
                conferenceFolders.EditDesc_OKbutton().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.EditDesc_CurrentDesc()));
                if (conferenceFolders.EditDesc_CurrentDesc().Text.Equals("daA modified: Meeting - October 13, 20YY"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 31
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 32
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                conferenceFolders.ExpandAndSelectFolder(TopFolderA4 + "/" + SubFolderA4_1_Level2);
                conferenceFolders.SwitchtoConferenceFrame();
                if (conferenceFolders.IsSubLevel2FolderExist(TopFolderA4, SubFolderA4_1_Level2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 33
                conferenceFolders.RenameFolder(TopFolderA4 + "/" + SubFolderA4_1_Level2, "A4Level2");
                Thread.Sleep(2000);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfSubLevel2Folder(TopFolderA4, "A4Level2"))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 34
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                Thread.Sleep(5000);
                conferenceFolders.ClickTopLevelFolderExpander(TopFolderA5);
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.RenameFolder(TopFolderA5 + "/" + SubFolderA5_1_Level2, "A5Level2");
                Thread.Sleep(2000);
                if (IsElementPresent(By.XPath(conferenceFolders.GetXPathOfSubLevel2Folder(TopFolderA5, "A5Level2"))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                Logger.Instance.InfoLog("Executed Steps" + Executedsteps);
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Add conference study and notes to a Sub-Folder in Study Viewer (XDS)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96212(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            Studies studies;
            StudyViewer viewer;
            Patients patient;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String DescriptionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String SuperAdminGroup = Config.adminGroupName;
                String[] Patientname = PatientName.Split('>');
                String[] AccessionID = AccessionIDList.Split(':');
                String[] Description = DescriptionList.Split(':');
                String[] PatientIDS = PatientID.Split(':');
                String XDSOnlyDS = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                String[] datasources = XDSOnlyDS.Split('=');

                //DomainB
                String TestdomainB = "96212_DomainB" + new Random().Next(1, 1000);
                String TestdomainRoleB = "96212_DomainRoleB" + new Random().Next(1, 1000);
                String TestroleB1 = "96212_Role1B" + new Random().Next(1, 1000);
                String TestuserB1 = "96212_User1B" + new Random().Next(1, 1000);

                //FolderNames for DomainB
                //Set1:
                String TopFolderB1 = "Monthly Oncology Tumor Boards_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_1 = "Hybrid, XDS only and DICOM only_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_XDS = "From Patient Record\\XDS sub-tab_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_MIME = "MIME types_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_Subfolder = "Conference notes for Sub folder Hybrid xds studies_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_Study1 = "Conference notes for Study1_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_Prior1 = "Conference notes for Prior1_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_Prior2 = "Conference notes for Prior2_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_XDS1 = "Conference notes for XDS1_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_XDS2 = "Conference notes for XDS2_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_XDS_Prior1 = "Conference notes for XDS Prior1_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_XDS3 = "Conference study notes for XDS3_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_MIME_1 = "Conference notes for MIME_1_" + new Random().Next(1, 1000);

                //Set 2:
                String TopFolderSupAdmin1 = "Top Level Admin Folder_" + new Random().Next(1, 1000);
                String SubFolderSupAdmin1_Level2 = "Sub Level 2 folder for Super Admin_" + new Random().Next(1, 1000);
                String StudyNotes_Level2_SuperAdmin_XDS = "Notes for Super Admin XDS_" + new Random().Next(1, 1000);

                //Step-1:[Pre-conditions-]--1. iCA build under testing is a fresh installation on iCA server--2. at least a data source is configured in Server Tool and connected to the domain used--3. IPad is available for the testing
                //Enable Conference Lists checkbox is ON in Server Tool
                //Service tool steps already performed in earlier cases, hence not repeating the steps
                //Enable Patients tab and configure XDS
                //TO be checked if XDS already configured in some test case
                Executedsteps++;


                //Step-2:Pre-conditions-Define domains, roles, users and Conference User settings (if have not done yet)
                //--> DomainB (Conference User enabled)-Domain Admin daB (Conference User enabled);-Role roleB1 (Conference User enabled);-User in roleB1 userB1(Folder Manager)

                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                //DomainB 
                domainmanagement.CreateDomain(TestdomainB, TestdomainRoleB, datasources);
                domainmanagement.ClickSaveNewDomain();
                bool step2 = domainmanagement.SearchDomain(TestdomainB); 
                domainmanagement.SetConfListFeatureForDomain(TestdomainB);

                //1 Role to be created
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainB, TestroleB1, "any");

                //Enable conference list in RoleB1 
                rolemanagement.SearchRole(TestroleB1, TestdomainB);
                rolemanagement.SelectRole(TestroleB1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_2 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();


                //User B1 in Role B1
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserB1, TestdomainB, TestroleB1);//Conference User

                bool userB1 = usermanagement.SearchUser(TestuserB1, TestdomainB);

                if (step2 && userB1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3 :Create Top Level Folder, - DomainB with folder manager and also create a subfolder
                login.LoginIConnect(TestdomainB, TestdomainB);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step3_1 = conferencefolders.CreateToplevelFolder(TopFolderB1, TestuserB1); //First Top Folder
                bool step3_2 = conferencefolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_1);
                if (step3_1 && step3_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 4: Search and load hybrid study with dicom and xds document
                login.LoginIConnect(TestuserB1, TestuserB1);
                studies = (Studies)login.Navigate("Studies");
                studies.ClearFields();
                studies.SearchStudy(FirstName: Patientname[0].Split(',')[1].ToLower().Trim());
                conferencefolders.ChooseColumns(new string[1] { "Patient Name" });
                studies.SelectStudy("Patient Name", Patientname[0]);
                viewer = studies.LaunchStudy();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                bool step4 = studies.CompareImage(result.steps[Executedsteps], viewport);

                if (step4)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5: Add study to conference folder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, null, StudyNotes_Level2_Subfolder);
                Executedsteps++;

                //Step 6: Close study and validate the same in conference tab
                viewer.CloseStudy();
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1);
                string[] ColumnNames = new string[] { "Patient Name", "Study Notes" };
                conferencefolders.ChooseColumns(ColumnNames);
                string step6_1, step6_2;
                conferencefolders.GetMatchingRow("Patient Name", Patientname[0]).TryGetValue("Patient Name", out step6_1);
                //Verify Study notes
                conferencefolders.GetMatchingRow("Patient Name", Patientname[0]).TryGetValue("Study Notes", out step6_2);
                //step6_2 = Regex.Replace(step6_2, "<.*?>", String.Empty);
                if (step6_1 == Patientname[0] && step6_2 == StudyNotes_Level2_Subfolder)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7: Launch study in viewer
                studies.SelectStudy("Patient Name", Patientname[0]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                bool step7 = studies.CompareImage(result.steps[Executedsteps], viewport);

                if (step7)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8: Launch another study which has related XDS documents and load the XDS document from history panel
                viewer.CloseStudy();
                //Search and Launch study
                studies = (Studies)login.Navigate("Studies");
                studies.ClearFields();
                studies.SearchStudy(LastName: Patientname[1].Split(',')[0].ToLower().Trim(), FirstName: Patientname[1].Split(',')[1].ToLower().Trim());
                conferencefolders.ChooseColumns(new string[1] { "Accession" });
                studies.SelectStudy("Accession", AccessionID[0]);
                viewer = studies.LaunchStudy();
                //Open XDS document from Priors
                studies.NavigateToHistoryPanel();
                studies.ChooseColumns(new string[] { "Accession" });
                studies.OpenPriors(new string[] { "Accession" }, new string[] { AccessionID[1] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForThumbnailsToLoad(30);
                //Select the related view
                viewer.SeriesViewer_1X1(2).Click();
                PageLoadWait.WaitForFrameLoad(5);
                //Add study to same subfolder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, null, StudyNotes_Level2_Prior1);
                Executedsteps++;

                //Step 9: From History panel load Other patient documents study and add to folder
                //Open XDS document from Priors
                studies.NavigateToHistoryPanel();
                studies.OpenPriors(new string[] { "Study Description" }, new string[] { Description[0] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                //Select the related view
                viewer.SeriesViewer_1X1(3).Click();
                PageLoadWait.WaitForFrameLoad(5);
                //Add study to same subfolder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, null, StudyNotes_Level2_Prior2);
                Executedsteps++;

                //Step 10: Close study and validate the same in conference tab
                viewer.CloseStudy();
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1);
                conferencefolders.ChooseColumns(ColumnNames);
                string step10_notes1, step10_notes2, step10_description1;

                //if description found, then get study notes
                conferencefolders.GetMatchingRow("Accession", AccessionID[1]).TryGetValue("Study Notes", out step10_notes1);
                //Bug in functionality where the description doesn't appear in conference folder for few studies
                //conferencefolders.GetMatchingRow("Study Notes", "<span>" + StudyNotes_Level2_Prior2 + "</span>").TryGetValue("Study Notes", out step10_notes2);
                //conferencefolders.GetMatchingRow("Study Notes", "<span>" + StudyNotes_Level2_Prior2 + "</span>").TryGetValue("Description", out step10_description1);
                conferencefolders.GetMatchingRow("Study Notes", StudyNotes_Level2_Prior2).TryGetValue("Study Notes", out step10_notes2);
                conferencefolders.GetMatchingRow("Study Notes", StudyNotes_Level2_Prior2).TryGetValue("Description", out step10_description1);
                //Verify Study notes
                //step10_notes1 = Regex.Replace(step10_notes1, "<.*?>", String.Empty);
                //step10_notes2 = Regex.Replace(step10_notes2, "<.*?>", String.Empty);
                if (step10_notes1 == StudyNotes_Level2_Prior1 && step10_notes2 == StudyNotes_Level2_Prior2 && step10_description1 == Description[0])
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11: Launch studies from conference folders
                //Test 1st prior study
                //studies.SelectStudy("Study Notes", "<span>" + StudyNotes_Level2_Prior1 + "</span>");
                studies.SelectStudy("Study Notes", StudyNotes_Level2_Prior1);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                bool step11_1 = studies.CompareImage(result.steps[Executedsteps], viewport);
                studies.CloseStudy();
                //Test 2nd Prior study
                conferencefolders.ChooseColumns(ColumnNames);
                //studies.SelectStudy("Study Notes", "<span>" + StudyNotes_Level2_Prior2 + "</span>");
                studies.SelectStudy("Study Notes", StudyNotes_Level2_Prior2);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 2);
                bool step11_2 = studies.CompareImage(result.steps[Executedsteps], viewport, 2, 1);

                if (step11_1 && step11_2)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studies.CloseStudy();

                //Step 12: Navigate to Patients tab and load hybrid study
                patient = (Patients)login.Navigate("Patients");
                patient.InputData(Patientname[4].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientIDS[0]);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1);
                viewer.CloseStudy();
                patient.ClosePatientRecord();
                //Verify if study appears in conference tab
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1);
                conferencefolders.ChooseColumns(ColumnNames);
                string step12_name;

                conferencefolders.GetMatchingRow("Patient Name", Patientname[3]).TryGetValue("Patient Name", out step12_name);

                //Verify Study name
                if (step12_name == Patientname[3])
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13: Launch study 
                studies.SelectStudy("Patient Name", Patientname[3]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                bool step13 = studies.CompareImage(result.steps[Executedsteps], viewport);

                if (step13)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step 14: Add XDS only document with notes to sub folder
                patient = (Patients)login.Navigate("Patients");
                patient.InputData(Patientname[4].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                //viewer = patient.LaunchStudy(Patients.PatientColumns.DataSource, "XDS_DS");
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[2]);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, null, StudyNotes_Level2_XDS1);
                viewer.CloseStudy();
                patient.ClosePatientRecord();
                //Verify if study appears in conference tab
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1);
                conferencefolders.ChooseColumns(ColumnNames);
                string step14_notes;

                conferencefolders.GetMatchingRow("Accession", AccessionID[2]).TryGetValue("Study Notes", out step14_notes);
                //step14_notes = Regex.Replace(step14_notes, "<.*?>", String.Empty);

                //Verify Study notes
                if (step14_notes == StudyNotes_Level2_XDS1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15: Launch study 
                studies.SelectStudy("Accession", AccessionID[2]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                bool step15 = studies.CompareImage(result.steps[Executedsteps], viewport);

                if (step15)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step 16: Create another Sub Level folder
                bool step16 = conferencefolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_XDS);
                if (step16)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17: Navigate to Patients tab
                patient = (Patients)login.Navigate("Patients");
                patient.InputData(Patientname[5].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(Patientname[5].Trim());
                //viewer = patient.LaunchStudy(Patients.PatientColumns.DataSource, "XDS_DS");
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[3]);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS);
                Executedsteps++;


                //Step 18: Load 2 Priors
                //Load Dicom Only Prior
                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[2] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                //Load XDS Only Prior
                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[0] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                //Select 2nd view
                viewer.SeriesViewer_1X1(2).Click();
                PageLoadWait.WaitForFrameLoad(5);
                //Add study to same subfolder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS);
                Executedsteps++;

                //Step 19: Select 3rd related study view and add to conference folder
                viewer.SeriesViewer_1X1(3).Click();
                PageLoadWait.WaitForFrameLoad(5);
                //Add study to same subfolder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS, null, StudyNotes_Level2_XDS_Prior1);
                Executedsteps++;

                //Step 20: Verify the studies added to conference folder
                viewer.CloseStudy();
                patient.ClosePatientRecord();
                //Verify if study appears in conference tab
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS);
                conferencefolders.ChooseColumns(ColumnNames);
                string step20_name1, step20_name2, step20_notes;

                //XDS Only document
                conferencefolders.GetMatchingRow("Accession", AccessionID[3]).TryGetValue("Patient Name", out step20_name1);
                //DICOM only prior study
                conferencefolders.GetMatchingRow("Description", Description[2]).TryGetValue("Patient Name", out step20_name2);
                //XDS only prior study
                //conferencefolders.GetMatchingRow("Study Notes", "<span>" + StudyNotes_Level2_XDS_Prior1 + "</span>").TryGetValue("Study Notes", out step20_notes);
                conferencefolders.GetMatchingRow("Study Notes", StudyNotes_Level2_XDS_Prior1).TryGetValue("Study Notes", out step20_notes);
                //step20_notes = Regex.Replace(step20_notes, "<.*?>", String.Empty);

                //Verify Study name
                //if (step20_name1 == Patientname[5] && step20_name2 == Patientname[6] && step20_notes == StudyNotes_Level2_XDS_Prior1)
                if (step20_name1 == Patientname[5] && step20_name2 == Patientname[10] && step20_notes == StudyNotes_Level2_XDS_Prior1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21: Load each study and check if loads correctly
                studies.SelectStudy("Patient Name", Patientname[5]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                bool step21_1 = studies.CompareImage(result.steps[Executedsteps], viewport);
                studies.CloseStudy();

                conferencefolders.ChooseColumns(ColumnNames);
                studies.SelectStudy("Patient Name", Patientname[10]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 2);
                bool step21_2 = studies.CompareImage(result.steps[Executedsteps], viewport, 2);
                studies.CloseStudy();

                conferencefolders.ChooseColumns(ColumnNames);
                //studies.SelectStudy("Study Notes", "<span>" + StudyNotes_Level2_XDS_Prior1 + "</span>");
                studies.SelectStudy("Study Notes", StudyNotes_Level2_XDS_Prior1);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 3);
                bool step21_3 = studies.CompareImage(result.steps[Executedsteps], viewport, 3, 1);

                if (step21_1 && step21_2 && step21_3)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                viewer.CloseStudy();

                //Step 22: Add new sub level 2 folder
                bool step22 = conferencefolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_MIME);
                if (step22)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 23: Load studies with MIME types
                //To DO  - Data and studies to be changed
                result.steps[++Executedsteps].status = "Not Automated";
                //patient = (Patients)login.Navigate("Patients");
                //patient.InputData(Patientname[4].Split(',')[0].ToLower().Trim());
                //patient.ClickPatientSearch();
                //PageLoadWait.WaitForPatientsLoadingMsg(15);
                //patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                //viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[2]);
                //viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                ////With Study notes
                //viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_MIME, null, StudyNotes_Level2_MIME_1);
                //viewer.CloseStudy();
                //patient.ClosePatientRecord();
                ////Without study notes
                //patient.InputData(Patientname[4].Split(',')[0].ToLower().Trim());
                //patient.ClickPatientSearch();
                //PageLoadWait.WaitForPatientsLoadingMsg(15);
                //patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                //viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[2]);
                //viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                ////With Study notes
                //viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_MIME);
                //viewer.CloseStudy();
                //patient.ClosePatientRecord();
                //Executedsteps++;

                //Step 24: Verify the newly added conference study from conference tab
                //Verify if study appears in conference tab
                result.steps[++Executedsteps].status = "Not Automated";
                //conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                //conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_MIME);
                //conferencefolders.ChooseColumns(ColumnNames);
                //string step24_name, step24_notes;

                //conferencefolders.GetMatchingRow("Patient Name", Patientname[4]).TryGetValue("Study Notes", out step24_notes);
                //conferencefolders.GetMatchingRow("Patient Name", Patientname[4]).TryGetValue("Patient Name", out step24_name);

                ////Verify Study name
                //if (step24_name == Patientname[4] && step24_notes == StudyNotes_Level2_MIME_1)
                //{
                //    result.steps[++Executedsteps].status = "Pass";
                //    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                //}
                //else
                //{
                //    result.steps[++Executedsteps].status = "Fail";
                //    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                //    result.steps[Executedsteps].SetLogs();
                //}

                //Step 25: Load each study
                //To do - Put a For loop
                result.steps[++Executedsteps].status = "Not Automated";
                //studies.SelectStudy("Patient Name", Patientname[4]);
                //viewer = studies.LaunchStudy(isConferenceTab: true);
                //BasePage.Driver.SwitchTo().DefaultContent();
                //BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                //viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                //result.steps[++Executedsteps].SetPath(testid, Executedsteps, 0);
                //bool step25_1 = studies.CompareImage(result.steps[Executedsteps], viewport);
                //studies.CloseStudy();

                login.Logout();

                //Step 26: Domain adming adds stufy to conference folder from Patients tab
                login.LoginIConnect(TestdomainB, TestdomainB);
                patient = (Patients)login.Navigate("Patients");
                //Search PQA
                patient.InputData(Patientname[7].Split(',')[1].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                //Launch study
                patient.LoadStudyInPatientRecord(Patientname[7].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientIDS[1]);
                //Add study to conf folder Without Study notes
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS);
                Executedsteps++;

                //Step 27: Load XDS only study and add to conference folder with notes
                viewer.CloseStudy();
                patient.ClosePatientRecord();
                //Search PQA
                patient.InputData(Patientname[7].Split(',')[1].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                //Launch study
                patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[5]);
                //Add study to conf folder with Study notes
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS, null, StudyNotes_Level2_XDS3);
                Executedsteps++;

                //Step 28: Verify newly added conference studies from conference folder
                viewer.CloseStudy();
                patient.ClosePatientRecord();
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_XDS);
                conferencefolders.ChooseColumns(ColumnNames);
                string step28_name, step28_notes;

                conferencefolders.GetMatchingRow("Patient Name", Patientname[7]).TryGetValue("Patient Name", out step28_name);
                conferencefolders.GetMatchingRow("Accession", AccessionID[5]).TryGetValue("Study Notes", out step28_notes);

                //step28_notes = Regex.Replace(step28_notes, "<.*?>", String.Empty);
                //Verify Study name
                if (step28_name == Patientname[7] && step28_notes == StudyNotes_Level2_XDS3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 29: Load each study and check if loads properly
                conferencefolders.ChooseColumns(ColumnNames);
                studies.SelectStudy("Patient Name", Patientname[7]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                bool step29_1 = studies.CompareImage(result.steps[Executedsteps], viewport);
                studies.CloseStudy();

                //Close study and load next xds only study
                studies.SelectStudy("Accession", AccessionID[5]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 2);
                bool step29_2 = studies.CompareImage(result.steps[Executedsteps], viewport, 2, 1);
                studies.CloseStudy();

                if (step29_1 && step29_2)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 30: SuperAdmin logs in and creates new folder and sub folder
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                PageLoadWait.WaitForElement(conferencefolders.By_DomainSelector(), WaitTypes.Visible, 30);
                conferencefolders.DomainSelector().SelectByText(SuperAdminGroup);
                bool step30_1 = conferencefolders.CreateToplevelFolder(TopFolderSupAdmin1); //First Top Folder
                bool step30_2 = conferencefolders.CreateSubFolder(TopFolderSupAdmin1, SubFolderSupAdmin1_Level2);
                if (step30_1 && step30_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 31: Navigate to Patients tab and add a hybrid study to conference folder
                patient = (Patients)login.Navigate("Patients");
                //Search PQA
                patient.InputData(Patientname[4].Split(',')[1].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                //Launch study
                patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientIDS[0]);
                //Add study to conf folder Without Study notes
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderSupAdmin1 + "/" + SubFolderSupAdmin1_Level2);
                Executedsteps++;

                //Step 32: Load XDS only study and add to conference folder with notes
                viewer.CloseStudy();
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[6]);
                //Add study to conf folder with Study notes
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderSupAdmin1 + "/" + SubFolderSupAdmin1_Level2, null, StudyNotes_Level2_SuperAdmin_XDS);
                Executedsteps++;

                //Step 33: Verify newly added conference studies from conference folder
                viewer.CloseStudy();
                patient.ClosePatientRecord();
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(SuperAdminGroup);
                conferencefolders.ExpandAndSelectFolder(TopFolderSupAdmin1 + "/" + SubFolderSupAdmin1_Level2);
                conferencefolders.ChooseColumns(ColumnNames);
                string step33_name, step33_notes;

                conferencefolders.GetMatchingRow("Patient Name", Patientname[3]).TryGetValue("Patient Name", out step33_name);
                conferencefolders.GetMatchingRow("Accession", AccessionID[6]).TryGetValue("Study Notes", out step33_notes);

                //step33_notes = Regex.Replace(step33_notes, "<.*?>", String.Empty);
                //Verify Study name
                if (step33_name == Patientname[3] && step33_notes == StudyNotes_Level2_SuperAdmin_XDS)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - View Conference Study Notes for a Conference Study (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96217(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            Studies studies;
            StudyViewer viewer;
            Patients patient;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] Patientname = PatientName.Split('>');
                String[] AccessionID = AccessionIDList.Split(':');
                String[] PatientIDS = PatientID.Split(':');
                String XDSPlusOneDS = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                String[] datasources = XDSPlusOneDS.Split('=');
                String XDSOnlyDS = datasources[0] + "=" + datasources[1] + "=" + datasources[2];
                string[] ColumnNames = new string[] { "Patient Name", "Study Notes" };


                //FolderNames for DomainB
                //Set1:
                String TopFolderB1 = "ONCOLOGY_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_1 = "Head_" + new Random().Next(1, 1000);
                //String SubFolderB1_Level3_1 = DateTime.Now.AddDays(5).ToShortDateString() + " - " + DateTime.Now.AddDays(10).ToShortDateString() + " _ " + new Random().Next(1, 1000);
                //String SubFolderB1_Level3_2 = DateTime.Now.AddDays(13).ToShortDateString() + " - " + DateTime.Now.AddDays(18).ToShortDateString() + " _ " + new Random().Next(1, 1000);
                String SubFolderB1_Level3_1 = "8-1-16 - 8-5-16_" + new Random().Next(1, 1000);
                String SubFolderB1_Level3_2 = "8-8-16 - 8-12-16_" + new Random().Next(1, 1000);
                String SubFolderB1_Level4_1 = "8:00-9:00am conference meeting " + DateTime.Now.AddDays(13).ToString("MMM") + DateTime.Now.AddDays(13).Day + "_" + new Random().Next(1, 1000);
                String SubFolderB1_Level4_2 = "Noon-1pm conference meeting " + DateTime.Now.AddDays(15).ToString("MMM") + DateTime.Now.AddDays(15).Day + "_" + new Random().Next(1, 1000);
                String SubFolderB1_Level4_3 = "9:00-4:30pm conference meeting " + DateTime.Now.AddDays(17).ToString("MMM") + DateTime.Now.AddDays(17).Day + "_" + new Random().Next(1, 1000);
                //String SubFolderB1_Level3_3 = DateTime.Now.AddDays(21).ToShortDateString() + " - " + DateTime.Now.AddDays(25).ToShortDateString() + " _ " + new Random().Next(1, 1000);
                String SubFolderB1_Level3_3 = "8-15-16 - 8-19-16_" + new Random().Next(1, 1000);

                String StudyNotes_Level3_1 = "Conference Study Notes is Optional plain text notes for a Conference Study._" + new Random().Next(1, 1000);
                String StudyNotes_Level4_1 = "A Conference User wishes to view Conference Study Notes from the Conference Tab_" + new Random().Next(1, 1000);


                //Step-1:[Pre-conditions-]--1. iCA build under testing is a fresh installation on iCA server--2. at least a data source is configured in Server Tool and connected to the domain used--3. IPad is available for the testing
                //Enable Conference Lists checkbox is ON in Server Tool
                //Service tool steps already performed in earlier cases, hence not repeating the steps
                //Enable Patients tab and configure XDS
                //TO be checked if XDS already configured in some test case
                Executedsteps++;

                //Step-2:Pre-conditions-Define domains, roles, users and Conference User settings 
                //--> DomainB (Conference User enabled)-Domain Admin daB (Conference User enabled);-Role roleB1 (Conference User enabled);-User in roleB1 userB1(Folder Manager)

                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                //DomainB 
                var domainattr1 = domainmanagement.CreateDomainAttr();

                //DomainB

                String TestdomainB = domainattr1[DomainManagement.DomainAttr.DomainName];
                String TestdomainAdminB = domainattr1[DomainManagement.DomainAttr.UserID];
                String TestdomainAdminB_Pwd = domainattr1[DomainManagement.DomainAttr.Password];
                String TestroleB1 = "96217_Role1B" + new Random().Next(1, 1000);
                String TestrolePhysician = "96217_Physician" + new Random().Next(1, 1000);
                String TestuserB1 = "96217_User1B" + new Random().Next(1, 1000);
                String TestuserDoctor = "96217_User_Doctor" + new Random().Next(1, 1000);

                domainmanagement.CreateDomain(domainattr1, datasources, true);

                //2 Roles to be created
                //Role B
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainB, TestroleB1, "any", XDSOnlyDS);

                //Role Physician
                rolemanagement.CreateRole(TestdomainB, TestrolePhysician, "physician", datasources[3]);

                //Enable conference list in RoleB and Physiciain
                rolemanagement.SearchRole(TestroleB1, TestdomainB);
                rolemanagement.SelectRole(TestroleB1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_1 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //In Role Physician
                rolemanagement.SearchRole(TestrolePhysician, TestdomainB);
                rolemanagement.SelectRole(TestrolePhysician);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_2 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //User B1 in Role B
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserB1, TestdomainB, TestroleB1);//Conference User

                //User Doctor in ROle B
                usermanagement.CreateUser(TestuserDoctor, TestdomainB, TestrolePhysician);//Conference User

                bool userB1 = usermanagement.SearchUser(TestuserB1, TestdomainB);
                bool userDoctor = usermanagement.SearchUser(TestuserDoctor, TestdomainB);

                if (CB2_1 && CB2_2 && userB1 && userDoctor)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3 :Create Top Level Folder and create a subfolder
                login.LoginIConnect(TestdomainAdminB, TestdomainAdminB_Pwd);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step3_1 = conferencefolders.CreateToplevelFolder(TopFolderB1, TestuserB1); //First Top Folder
                bool step3_2 = conferencefolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_1);
                if (step3_1 && step3_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 4: Login as Folder manager and create Level 3 and 4 subfolders
                login.LoginIConnect(TestuserB1, TestuserB1);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step4_1 = conferencefolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, SubFolderB1_Level3_1);
                bool step4_2 = conferencefolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, SubFolderB1_Level3_2);
                bool step4_3 = conferencefolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2, SubFolderB1_Level4_1);
                bool step4_4 = conferencefolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2, SubFolderB1_Level4_2);
                bool step4_5 = conferencefolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2, SubFolderB1_Level4_3);
                bool step4_6 = conferencefolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1, SubFolderB1_Level3_3);

                if (step4_1 && step4_2 && step4_3 && step4_4 && step4_5 && step4_6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5: Load a study and add to L3 conference folder with Study notes
                studies = (Studies)login.Navigate("Studies");
                studies.ClearFields();
                studies.SearchStudy(LastName: Patientname[0].Split(',')[0].ToLower().Trim(), FirstName: Patientname[0].Split(',')[1].ToLower().Trim());
                conferencefolders.ChooseColumns(new string[1] { "Patient Name" });
                studies.SelectStudy("Patient Name", Patientname[0]);
                viewer = studies.LaunchStudy();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_1, null, StudyNotes_Level3_1);
                Executedsteps++;

                //Step 6: Load a study and add to L3 conference folder without Study notes 
                viewer.CloseStudy();
                studies.SearchStudy(LastName: Patientname[1].Split(',')[0].ToLower().Trim(), FirstName: Patientname[1].Split(',')[1].ToLower().Trim());
                conferencefolders.ChooseColumns(new string[1] { "Patient Name" });
                studies.SelectStudy("Accession", AccessionID[2]);
                viewer = studies.LaunchStudy();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_1);
                Executedsteps++;

                //Step 7: Load a study from patients tab, add to conference folder and verify in conference tab
                viewer.CloseStudy();
                patient = (Patients)login.Navigate("Patients");
                patient.InputData(Patientname[4].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(Patientname[4].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientIDS[0]);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3, null, StudyNotes_Level4_1);
                viewer.CloseStudy();
                patient.ClosePatientRecord();

                //Validate in conference tab
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3);
                conferencefolders.ChooseColumns(ColumnNames);
                conferencefolders.SelectStudy("Accession", AccessionID[0]);
                string step7_notes = conferencefolders.GetStudyNotesFromTextArea();

                //Verify Study notes
                if (step7_notes == StudyNotes_Level4_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8: Repeat the above step with another XDS study and without notes
                patient = (Patients)login.Navigate("Patients");
                patient.InputData(Patientname[5].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(Patientname[5].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, AccessionID[1]);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3);
                viewer.CloseStudy();
                patient.ClosePatientRecord();

                //Validate in conference tab
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3);
                conferencefolders.ChooseColumns(ColumnNames);
                conferencefolders.SelectStudy("Accession", AccessionID[1]);
                string step8_notes = conferencefolders.GetStudyNotesFromTextArea();

                //Verify Study notes
                if (step8_notes.Equals(" "))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 9: Loging as doctor and check level 3 folder should list 2 studies
                login.LoginIConnect(TestuserDoctor, TestuserDoctor);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_1);
                bool step9_1 = conferencefolders.ActiveFolder().Text.Equals(SubFolderB1_Level3_1);
                int step9_2 = BasePage.GetSearchResults().Count;
                if (step9_1 && step9_2 == 2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10: Select a study with conference notes
                conferencefolders.ChooseColumns(ColumnNames);
                //conferencefolders.SelectStudy("Study Notes", "<span>" + StudyNotes_Level3_1 + "</span>");
                conferencefolders.SelectStudy("Study Notes", StudyNotes_Level3_1);
                string step10_notes = conferencefolders.GetStudyNotesFromTextArea();

                //Verify Study notes
                if (step10_notes == StudyNotes_Level3_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11: Select study without conference notes
                conferencefolders.SelectStudy("Accession", AccessionID[2]);
                string step11_notes = conferencefolders.GetStudyNotesFromTextArea();

                //Verify Study notes
                if (step11_notes.Equals(" "))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12: Switch in between these 2 studies and verify if notes are getting correctly displayed
                //conferencefolders.SelectStudy("Study Notes", "<span>" + StudyNotes_Level3_1 + "</span>");
                conferencefolders.SelectStudy("Study Notes", StudyNotes_Level3_1);
                string step12_notes_1 = conferencefolders.GetStudyNotesFromTextArea();
                conferencefolders.SelectStudy("Accession", AccessionID[2]);
                string step12_notes_2 = conferencefolders.GetStudyNotesFromTextArea();

                //Verify Study notes
                if (step12_notes_1 == StudyNotes_Level3_1 && step12_notes_2.Equals(" "))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13: Select a study in level 4 that has Conference study notes in the conference studies list.
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3);
                //conferencefolders.SelectStudy("Study Notes", "<span>" + StudyNotes_Level4_1 + "</span>");
                conferencefolders.SelectStudy("Study Notes", StudyNotes_Level4_1);
                string step13_notes = conferencefolders.GetStudyNotesFromTextArea();
                if (step13_notes == StudyNotes_Level4_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14: Select study without conference notes in same subfolder
                conferencefolders.SelectStudy("Accession", AccessionID[1]);
                string step14_notes = conferencefolders.GetStudyNotesFromTextArea();
                if (step14_notes.Equals(" "))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15: Switch in between these 2 studies and verify if notes are getting correctly displayed
                //conferencefolders.SelectStudy("Study Notes", "<span>" + StudyNotes_Level4_1 + "</span>");
                conferencefolders.SelectStudy("Study Notes", StudyNotes_Level4_1);
                string step15_notes_1 = conferencefolders.GetStudyNotesFromTextArea();
                conferencefolders.SelectStudy("Accession", AccessionID[1]);
                string step15_notes_2 = conferencefolders.GetStudyNotesFromTextArea();
                //Verify Study notes
                if (step15_notes_1 == StudyNotes_Level4_1 && step15_notes_2.Equals(" "))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 16: Login as conference user 
                login.LoginIConnect(TestuserDoctor, TestuserDoctor);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_1);
                int step16 = BasePage.GetSearchResults().Count;
                if (step16 == 2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17: Launch study with notes
                conferencefolders.ChooseColumns(ColumnNames);
                //conferencefolders.SelectStudy("Study Notes", "<span>" + StudyNotes_Level3_1 + "</span>");
                conferencefolders.SelectStudy("Study Notes", StudyNotes_Level3_1);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForFrameLoad(15);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                bool step17 = studies.CompareImage(result.steps[Executedsteps], viewer.studyPanel());

                if (step17)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 18: Open the Patient History fly-out
                viewer.NavigateToHistoryPanel();
                //Check if Conference study notes button is available and displayed on the history panel
                bool step18_1 = IsElementVisible(conferencefolders.By_Btn_StudyNotes_HistoryPanel());
                bool step18_2 = conferencefolders.Btn_StudyNotes_HistoryPanel().Enabled;

                if (step18_1 && step18_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 19: Click study notes button
                conferencefolders.Btn_StudyNotes_HistoryPanel().Click();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                string step19_notes = conferencefolders.Div_StudyNotes_HistoryPanel().Text;
                //Verify Study notes
                if (step19_notes == StudyNotes_Level3_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 20: Close study and open study without study notes from same folder
                viewer.CloseHistoryPanel();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                viewer.CloseStudy();
                conferencefolders.ChooseColumns(ColumnNames);
                conferencefolders.SelectStudy("Accession", AccessionID[2]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForFrameLoad(15);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                bool step20 = studies.CompareImage(result.steps[Executedsteps], viewer.studyPanel());
                if (step20)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21: Open the Patient History fly-out and check study notes button
                viewer.NavigateToHistoryPanel();
                //Check if Conference study notes button is available and displayed on the history panel
                bool step20_1 = IsElementVisible(conferencefolders.By_Btn_StudyNotes_HistoryPanel());
                bool step20_2 = conferencefolders.Btn_StudyNotes_HistoryPanel().Enabled;

                if (step20_1 && !step20_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 22: Close study and launch study from another folder with notes
                viewer.CloseHistoryPanel();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                viewer.CloseStudy();
                //Select and launch study
                conferencefolders.ChooseColumns(ColumnNames);
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3);
                //conferencefolders.SelectStudy("Study Notes", "<span>" + StudyNotes_Level4_1 + "</span>");
                conferencefolders.SelectStudy("Study Notes", StudyNotes_Level4_1);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForFrameLoad(15);
                //Open history panel
                viewer.NavigateToHistoryPanel();
                //click study notes button in the history panel
                conferencefolders.Btn_StudyNotes_HistoryPanel().Click();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                string step22_notes = conferencefolders.Div_StudyNotes_HistoryPanel().Text;
                //Verify Study notes
                if (step22_notes == StudyNotes_Level4_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 23: Close study and launch study without conference study notes
                viewer.CloseHistoryPanel();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                viewer.CloseStudy();
                //Select and launch study
                conferencefolders.ChooseColumns(ColumnNames);
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3_2 + "/" + SubFolderB1_Level4_3);
                conferencefolders.SelectStudy("Accession", AccessionID[1]);
                viewer = studies.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForFrameLoad(15);
                //Open history panel
                viewer.NavigateToHistoryPanel();
                //Check if Conference study notes button is available and displayed on the history panel
                bool step23_1 = IsElementVisible(conferencefolders.By_Btn_StudyNotes_HistoryPanel());
                bool step23_2 = conferencefolders.Btn_StudyNotes_HistoryPanel().Enabled;

                if (step23_1 && !step23_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                viewer.CloseHistoryPanel();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                viewer.CloseStudy();


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Studies always launch in HTML4 viewer-Conference Users
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96227(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            String topfoldername = "Top" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername = "Sub" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath = topfoldername + "/" + subfoldername;
            String rolename = "Role" + +new System.DateTime().Millisecond + random.Next(100, 1000);
            String userid = "User" + +new System.DateTime().Millisecond + random.Next(100, 1000);
            String password = userid;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");

            try
            {
                //Step-1-Precondition       
                //Create a Domain/Role and User.
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                String domainname = domainattr[DomainManagement.DomainAttr.DomainName];
                String foldermanager = domainattr[DomainManagement.DomainAttr.FirstName];
                domain.CreateDomain(domainattr, isconferenceneeded: true);
                var role = login.Navigate<RoleManagement>();
                role.CreateRole(domainname, rolename, "Conference");
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userid, domainname, rolename, 1, Config.emailid, 1, userid);

                //Create Top Level and Sub level folder
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, foldermanager, domainname);
                conffolder.CreateSubFolder(topfoldername, subfoldername, domainname);
                login.Logout();

                //Add a study to Study Folder
                login.LoginIConnect(domainattr[DomainManagement.DomainAttr.UserID], domainattr[DomainManagement.DomainAttr.Password]);
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", accession);
                studies.SelectStudy("Accession", accession);
                StudyViewer studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath);
                studyViewer.CloseStudy();
                login.Logout();
                executedsteps++;


                //Step-2 - Login as Conference User - Navigate to Conference Study  
                login.LoginIConnect(userid, userid);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                executedsteps++;

                //Step-3 - Launch Study in viewer
                conffolder.SelectStudy("Accession", accession);
                conffolder.LaunchStudy(isConferenceTab: true);
                //Validate Launched in HTML4
                if (BasePage.Driver.FindElement(By.CssSelector("div#viewerImgDiv>img#m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_viewerImg")).Displayed)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-4
                bool isHtml5;
                try { isHtml5 = BasePage.Driver.FindElement(By.CssSelector("#m_html5ViewStudyButton")).Displayed; }
                catch { isHtml5 = false; }
                if (!isHtml5)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-5
                studies.CloseStudy();
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", accession);
                studies.SelectStudy("Accession", accession);
                studies.LaunchStudyHTML5();
                studies.CloseStudy();
                executedsteps++;

                //Step-6--Repeat above steps for Folder Manager
                login.Logout();
                login.LoginIConnect(domainattr[DomainManagement.DomainAttr.UserID], domainattr[DomainManagement.DomainAttr.Password]);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath);
                conffolder.SelectStudy("Accession", accession);
                conffolder.LaunchStudy(isConferenceTab: true);
                //Validate Launched in HTML4
                if (BasePage.Driver.FindElement(By.CssSelector("div#viewerImgDiv>img#m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_viewerImg")).Displayed)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                studies.CloseStudy();
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Domain Selector (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96228(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            Studies studies;
            StudyViewer viewer;
            Patients patient;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] Patientname = PatientName.Split('>');
                string[] ColumnNames = new string[] { "Patient Name", "Study Notes" };

                //FolderNames for Domain A, B and C
                //Set A:
                String TopFolderA1 = "TOP A1_" + new Random().Next(1, 1000);
                String TopFolderA2 = "TOP A2_" + new Random().Next(1, 1000);
                String SubFolderA1 = "SubFolder A1_" + new Random().Next(1, 1000);
                String TopFolderA3 = "TOP A3_" + new Random().Next(1, 1000);
                //Set B:
                String TopFolderB1 = "TOP B1_" + new Random().Next(1, 1000);
                String SubFolderB1 = "SubFolder B1_" + new Random().Next(1, 1000);
                //Set C:
                String TopFolderC1 = "TOP C1_" + new Random().Next(1, 1000);
                String SubFolderC1 = "SubFolder C1_" + new Random().Next(1, 1000);

                //Creating Folder List for validation
                string[] TopFolders_DomainA = new string[] { TopFolderA1, TopFolderA2 };

                //Step-1:[Pre-conditions-]--A. Enable Conference list in service tool--B. Create 3 domains A,B and C with roles and Users. --
                //A - Enable Conference Lists checkbox is ON in Server Tool
                //Service tool steps already performed in earlier cases, hence not repeating the steps

                //B - Create 3 domains A,B and C, Roles and Users

                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");

                //DomainA
                var domainattrA = domainmanagement.CreateDomainAttr();
                String TestdomainA = domainattrA[DomainManagement.DomainAttr.DomainName];
                String TestdomainAdminA = domainattrA[DomainManagement.DomainAttr.UserID];
                String TestdomainAdminA_Pwd = domainattrA[DomainManagement.DomainAttr.Password];
                String TestdomainAdminA_FirstName = domainattrA[DomainManagement.DomainAttr.FirstName];
                String TestroleA_Conf = "96228_RoleA_Conf" + new Random().Next(1, 1000);
                String TestroleA_NonConf = "96228_RoleA_NonConf" + new Random().Next(1, 1000);
                String TestuserA_Conf = "96228_UserA_Conf" + new Random().Next(1, 1000);
                String TestuserA2_Conf = "96228_UserA2_Conf" + new Random().Next(1, 1000);
                String TestuserA_NonConf = "96228_UserA_NonConf" + new Random().Next(1, 1000);
                domainmanagement.CreateDomain(domainattrA, null, true);

                //DomainB
                var domainattrB = domainmanagement.CreateDomainAttr();
                String TestdomainB = domainattrB[DomainManagement.DomainAttr.DomainName];
                String TestdomainAdminB = domainattrB[DomainManagement.DomainAttr.UserID];
                String TestdomainAdminB_Pwd = domainattrB[DomainManagement.DomainAttr.Password];
                String TestdomainAdminB_FirstName = domainattrB[DomainManagement.DomainAttr.FirstName];
                String TestroleB_Conf = "96228_RoleB_Conf" + new Random().Next(1, 1000);
                String TestroleB_NonConf = "96228_RoleB_NonConf" + new Random().Next(1, 1000);
                String TestuserB_Conf = "96228_UserB_Conf" + new Random().Next(1, 1000);
                String TestuserB_NonConf = "96228_UserB_NonConf" + new Random().Next(1, 1000);
                domainmanagement.CreateDomain(domainattrB, null, true);

                //DomainC
                var domainattrC = domainmanagement.CreateDomainAttr();
                String TestdomainC = domainattrC[DomainManagement.DomainAttr.DomainName];
                String TestdomainAdminC = domainattrC[DomainManagement.DomainAttr.UserID];
                String TestdomainAdminC_Pwd = domainattrC[DomainManagement.DomainAttr.Password];
                String TestdomainAdminC_FirstName = domainattrC[DomainManagement.DomainAttr.FirstName];
                String TestroleC_Conf = "96228_RoleC_Conf" + new Random().Next(1, 1000);
                String TestroleC_NonConf = "96228_RoleC_NonConf" + new Random().Next(1, 1000);
                String TestuserC_Conf = "96228_UserC_Conf" + new Random().Next(1, 1000);
                String TestuserC_NonConf = "96228_UserC_NonConf" + new Random().Next(1, 1000);
                domainmanagement.CreateDomain(domainattrC, null, true);

                //2 Roles to be created for each domains
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                //Role for Dommain A
                //Conf Role
                rolemanagement.CreateRole(TestdomainA, TestroleA_Conf, "any");
                //Non Conf Role
                rolemanagement.CreateRole(TestdomainA, TestroleA_NonConf, "any");

                //Role for Dommain B
                //Conf Role
                rolemanagement.CreateRole(TestdomainB, TestroleB_Conf, "any");
                //Non Conf Role
                rolemanagement.CreateRole(TestdomainB, TestroleB_NonConf, "any");

                //Role for Dommain C
                //Conf Role
                rolemanagement.CreateRole(TestdomainC, TestroleC_Conf, "any");
                //Non Conf Role
                rolemanagement.CreateRole(TestdomainC, TestroleC_NonConf, "any");

                //Enable conference list in Conf Role for Domain A
                rolemanagement.SearchRole(TestroleA_Conf, TestdomainA);
                rolemanagement.SelectRole(TestroleA_Conf);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB1_1 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //Enable conference list in Conf Role for Domain B
                rolemanagement.SearchRole(TestroleB_Conf, TestdomainB);
                rolemanagement.SelectRole(TestroleB_Conf);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB1_2 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //Enable conference list in Conf Role for Domain C
                rolemanagement.SearchRole(TestroleC_Conf, TestdomainC);
                rolemanagement.SelectRole(TestroleC_Conf);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB1_3 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //Create Conf and Non conference users for Domain A, B and C
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                //Domain A - Conference User
                usermanagement.CreateUser(TestuserA_Conf, TestdomainA, TestroleA_Conf);//Conference User
                usermanagement.CreateUser(TestuserA2_Conf, TestdomainA, TestroleA_Conf);//Conference User
                //Domain A - Non Conference User
                usermanagement.CreateUser(TestuserA_NonConf, TestdomainA, TestroleA_NonConf);//Conference User

                //Domain B - Conference User
                usermanagement.CreateUser(TestuserB_Conf, TestdomainB, TestroleB_Conf);//Conference User
                //Domain B - Non Conference User
                usermanagement.CreateUser(TestuserB_NonConf, TestdomainB, TestroleB_NonConf);//Conference User

                //Domain C - Conference User
                usermanagement.CreateUser(TestuserC_Conf, TestdomainC, TestroleC_Conf);//Conference User
                //Domain C - Non Conference User
                usermanagement.CreateUser(TestuserC_NonConf, TestdomainC, TestroleC_NonConf);//Conference User


                bool userA1 = usermanagement.SearchUser(TestuserA_Conf, TestdomainA);
                bool userA2 = usermanagement.SearchUser(TestuserA_NonConf, TestdomainA);
                bool userB1 = usermanagement.SearchUser(TestuserB_Conf, TestdomainB);
                bool userB2 = usermanagement.SearchUser(TestuserB_NonConf, TestdomainB);
                bool userC1 = usermanagement.SearchUser(TestuserC_Conf, TestdomainC);
                bool userC2 = usermanagement.SearchUser(TestuserC_NonConf, TestdomainC);

                //Create Top Level and SubFolder for Domain A
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                bool step1_1 = conferencefolders.CreateToplevelFolder(TopFolderA1, TestuserA_Conf);
                bool step1_2 = conferencefolders.CreateToplevelFolder(TopFolderA2, TestuserA_Conf);
                bool step1_3 = conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1);

                //Create Top Level and SubFolder for Domain B
                conferencefolders.DomainSelector().SelectByText(TestdomainB);
                bool step1_4 = conferencefolders.CreateToplevelFolder(TopFolderB1, TestuserB_Conf);
                bool step1_5 = conferencefolders.CreateSubFolder(TopFolderB1, SubFolderB1);

                //Create Top Level and SubFolder for Domain C
                conferencefolders.DomainSelector().SelectByText(TestdomainC);
                bool step1_6 = conferencefolders.CreateToplevelFolder(TopFolderC1, TestuserC_Conf);
                bool step1_7 = conferencefolders.CreateSubFolder(TopFolderC1, SubFolderC1);
                login.Logout();

                // Adding 1 Study to Domain A subfolder since we need a study folder
                login.LoginIConnect(TestdomainAdminA, TestdomainAdminA_Pwd);
                studies = (Studies)login.Navigate("Studies");
                studies.ClearFields();
                studies.SearchStudy(LastName: Patientname[0].Split(',')[0].Trim());
                studies.SelectStudy("Patient Name", Patientname[0]);
                viewer = studies.LaunchStudy();
                //Add study to subfolder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderA1 + "/" + SubFolderA1);
                if (CB1_1 && CB1_2 && CB1_3 && userA1 && userA2 && userB1 && userB2 && userC1 && userC2 && step1_1 && step1_2 && step1_3 && step1_4 && step1_5 && step1_6 && step1_7)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step 2: Login as Super Admin and create Level 3 and 4 subfolders
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                PageLoadWait.WaitForElement(conferencefolders.By_ManageTopLevelFolders(), WaitTypes.Visible, 15).Click();
                bool step2 = PageLoadWait.WaitForElement(conferencefolders.By_FolderConfigurationdiv(), WaitTypes.Visible, 15).Displayed;
                if (step2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 3: Exam top level folders listed in the Manage Folder Categories
                List<IWebElement> TopFolders = conferencefolders.AllTopLevelfolders().ToList();
                String[] topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                //bool step7result = (step7 == null || step7.Length == 0) ? false : step7.Where(q => q.ToLower().Contains(RefPhysician.ToLower())).Count() == step7.Length;
                bool step3_res = (topfolderstring == null || topfolderstring.Length == 0) ? false : TopFolders_DomainA.Where(z => topfolderstring.Any(q => q.ToLower().Contains(z.ToLower()))).Count() == TopFolders_DomainA.Length && topfolderstring.Where(z => TopFolders_DomainA.Any(q => z.ToLower().Contains(q.ToLower()))).Count() == topfolderstring.Length;
                if (step3_res)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 4: Exam the Add Folder Managers list.
                conferencefolders.SwitchtoConferenceFrame();
                TopFolders = conferencefolders.GetToplevelFolders().ToList();
                bool[] step4 = new bool[TopFolders.Capacity];
                //Checking if folder manager belonging to the current domain are listed
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    TopFolders[i].Click();
                    string FolderMgrName = PageLoadWait.WaitForElement(conferencefolders.By_FolderManagerList(), WaitTypes.Clickable, 15).Text;
                    if (FolderMgrName.Split(' ')[0] == TestuserA_Conf)
                    {
                        step4[i] = true;
                    }
                }
                bool step4_res = conferencefolders.ValidateBoolArray(step4);
                if (step4_res)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5: Search all users in the Add Folder Managers
                conferencefolders.SwitchtoConferenceFrame();
                conferencefolders.SelectTopFolderInConfigDiv(TopFolderA1);
                new Actions(BasePage.Driver).Click(conferencefolders.FolderManagerTextBox()).SendKeys("*").Build().Perform();
                PageLoadWait.WaitForFrameLoad(30);
                PageLoadWait.WaitForSuggestionToLoad();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.FolderManager_Suggestion()));
                IList<IWebElement> AutoCompleteDiv = Driver.FindElements(By.CssSelector("#AutoCompleteDiv div"));

                String[] list1 = new String[] { TestdomainAdminA_FirstName, TestuserA_Conf, TestuserA2_Conf, TestuserA_NonConf };
                String[] list2 = new String[AutoCompleteDiv.Count];

                int counter = 0;
                foreach (IWebElement FManager in AutoCompleteDiv)
                {
                    string[] FManagerArr = FManager.Text.Split(' ');
                    list2[counter++] = FManagerArr[0];
                }
                bool step5 = (list2 == null || list2.Length == 0) ? false : list1.Where(z => list2.Any(q => q.ToLower().Equals(z.ToLower()))).Count() == list1.Length && list2.Where(z => list1.Any(q => z.ToLower().Equals(q.ToLower()))).Count() == list2.Length;
                if (step5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6: Add a new top level folder. Exam the added folder in the Folder Browser.
                conferencefolders.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#newFolder")));
                conferencefolders.InputFolder().Click();
                conferencefolders.InputFolder().SendKeys(TopFolderA3);
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                Thread.Sleep(3000);
                conferencefolders.AddFolderManager(TopFolderA3, TestuserA_Conf);
                PageLoadWait.WaitForFrameLoad(20);
                conferencefolders.SwitchtoConferenceFrame();
                conferencefolders.SaveFolderBtn().Click();
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                conferencefolders.SwitchtoConferenceFrame();
                wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conferencefolders.ManageFolderOkBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);

                //Verify if folder created or not in folder browser
                TopFolders = conferencefolders.AllTopLevelfolders().ToList();
                bool step6 = false;
                foreach (IWebElement Topfolder in TopFolders)
                {
                    if (Topfolder.Text.Equals(TopFolderA3))
                    {
                        step6 = true;
                    }

                }
                if (step6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7: Exam folders listed in the Folder Browser.
                TopFolders_DomainA = new string[] { TopFolderA1, TopFolderA2, TopFolderA3 };
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step7_1 = (topfolderstring == null || topfolderstring.Length == 0) ? false : TopFolders_DomainA.Where(z => topfolderstring.Any(q => q.ToLower().Contains(z.ToLower()))).Count() == TopFolders_DomainA.Length && topfolderstring.Where(z => TopFolders_DomainA.Any(q => z.ToLower().Contains(q.ToLower()))).Count() == topfolderstring.Length;
                //Validate SubFolders
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1);
                List<IWebElement> SubFolders_DomainA = conferencefolders.AllSubfolders().ToList();
                string[] subfolderstring = new string[SubFolders_DomainA.Capacity];
                for (int i = 0; i < SubFolders_DomainA.Capacity; i++)
                {
                    subfolderstring[i] = SubFolders_DomainA[i].Text;
                }
                bool step7_2 = (subfolderstring == null || subfolderstring.Length == 0) ? false : subfolderstring.Where(q => q.ToLower().Contains(SubFolderA1.ToLower())).Count() == subfolderstring.Length;
                if (step7_1 && step7_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8: Select a different domain(DomainB), exam the folders listed in the Folder Browser
                conferencefolders.DomainSelector().SelectByText(TestdomainB);
                PageLoadWait.WaitForFrameLoad(20);
                TopFolders = conferencefolders.AllTopLevelfolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step8_1 = (topfolderstring == null || topfolderstring.Length == 0) ? false : topfolderstring.Where(q => q.ToLower().Contains(TopFolderB1.ToLower())).Count() == topfolderstring.Length;
                //Validate SubFolders
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1);
                List<IWebElement> SubFolders_DomainB = conferencefolders.AllSubfolders().ToList();
                subfolderstring = new string[SubFolders_DomainB.Capacity];
                for (int i = 0; i < SubFolders_DomainB.Capacity; i++)
                {
                    subfolderstring[i] = SubFolders_DomainB[i].Text;
                }
                bool step8_2 = (subfolderstring == null || subfolderstring.Length == 0) ? false : subfolderstring.Where(q => q.ToLower().Contains(SubFolderB1.ToLower())).Count() == subfolderstring.Length;
                if (step8_1 && step8_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 9: Open Manage Top Level Folders dialog. Exam the top level folder and users in the dialog
                PageLoadWait.WaitForElement(conferencefolders.By_ManageTopLevelFolders(), WaitTypes.Visible, 15).Click();
                PageLoadWait.WaitForElement(conferencefolders.By_FolderConfigurationdiv(), WaitTypes.Visible, 15);
                PageLoadWait.WaitForFrameLoad(20);
                //Checking if Top level folders created earlier are being displayed 
                TopFolders = conferencefolders.GetToplevelFolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step9_1 = (topfolderstring == null || topfolderstring.Length == 0) ? false : topfolderstring.Where(q => q.ToLower().Contains(TopFolderB1.ToLower())).Count() == topfolderstring.Length;
                //Verifying if Folder manager is as assigned
                conferencefolders.SwitchtoConferenceFrame();
                bool[] step9 = new bool[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    TopFolders[i].Click();
                    string FolderMgrName = PageLoadWait.WaitForElement(conferencefolders.By_FolderManagerList(), WaitTypes.Clickable, 15).Text;
                    if (FolderMgrName.Split(' ')[0] == TestuserB_Conf)
                    {
                        step9[i] = true;
                    }
                }
                bool step9_2 = conferencefolders.ValidateBoolArray(step9);
                //Verifying if Users belonging to same domain are present
                conferencefolders.SwitchtoConferenceFrame();
                conferencefolders.SelectTopFolderInConfigDiv(TopFolderB1);
                new Actions(BasePage.Driver).Click(conferencefolders.FolderManagerTextBox()).SendKeys("*").Build().Perform();
                PageLoadWait.WaitForFrameLoad(30);
                PageLoadWait.WaitForSuggestionToLoad();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.FolderManager_Suggestion()));
                AutoCompleteDiv = Driver.FindElements(By.CssSelector("#AutoCompleteDiv div"));

                list1 = new String[] { TestdomainAdminB_FirstName, TestuserB_Conf, TestuserB_NonConf };
                list2 = new String[AutoCompleteDiv.Count];

                counter = 0;
                foreach (IWebElement FManager in AutoCompleteDiv)
                {
                    string[] FManagerArr = FManager.Text.Split(' ');
                    list2[counter++] = FManagerArr[0];
                }
                bool step9_3 = (list2 == null || list2.Length == 0) ? false : list1.Where(z => list2.Any(q => q.ToLower().Equals(z.ToLower()))).Count() == list1.Length && list2.Where(z => list1.Any(q => z.ToLower().Equals(q.ToLower()))).Count() == list2.Length;
                if (step9_1 && step9_2 && step9_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                //Close dialog
                conferencefolders.CloseManageTopLevelFolder();

                //Step 10: Switch domains on the Conference Tab via a Domain selector that is visible to Super Admin users only. (e.g. DomainC, DomainB, DomainA), Exam Folders, Study Folders, conference studies and users
                conferencefolders.DomainSelector().SelectByText(TestdomainC);
                PageLoadWait.WaitForFrameLoad(20);
                //Top folders -Domain C
                TopFolders = conferencefolders.AllTopLevelfolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step10_1 = (topfolderstring == null || topfolderstring.Length == 0) ? false : topfolderstring.Where(q => q.ToLower().Contains(TopFolderC1.ToLower())).Count() == topfolderstring.Length;
                //Subfolders -Domain C
                conferencefolders.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1);
                List<IWebElement> SubFolders_DomainC = conferencefolders.AllSubfolders().ToList();
                subfolderstring = new string[SubFolders_DomainC.Capacity];
                for (int i = 0; i < SubFolders_DomainC.Capacity; i++)
                {
                    subfolderstring[i] = SubFolders_DomainC[i].Text;
                }
                bool step10_2 = (subfolderstring == null || subfolderstring.Length == 0) ? false : subfolderstring.Where(q => q.ToLower().Contains(SubFolderC1.ToLower())).Count() == subfolderstring.Length;
                //Validate Top level in Add top level folder dialog -Domain C
                PageLoadWait.WaitForElement(conferencefolders.By_ManageTopLevelFolders(), WaitTypes.Visible, 15).Click();
                PageLoadWait.WaitForElement(conferencefolders.By_FolderConfigurationdiv(), WaitTypes.Visible, 15);
                PageLoadWait.WaitForFrameLoad(20);
                TopFolders = conferencefolders.GetToplevelFolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step10_3 = (topfolderstring == null || topfolderstring.Length == 0) ? false : topfolderstring.Where(q => q.ToLower().Contains(TopFolderC1.ToLower())).Count() == topfolderstring.Length;
                //Validate Folder manager user - Domain C
                conferencefolders.SwitchtoConferenceFrame();
                bool[] step10 = new bool[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    TopFolders[i].Click();
                    string FolderMgrName = PageLoadWait.WaitForElement(conferencefolders.By_FolderManagerList(), WaitTypes.Clickable, 15).Text;
                    if (FolderMgrName.Split(' ')[0] == TestuserC_Conf)
                    {
                        step10[i] = true;
                    }
                }
                bool step10_4 = conferencefolders.ValidateBoolArray(step10);
                //Close dialog
                conferencefolders.CloseManageTopLevelFolder();
                //Validate studies in folder - Should not have any studies in study folder 
                conferencefolders.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1);
                int step10_5 = BasePage.GetSearchResults().Count;

                //Switch to Domain B
                conferencefolders.DomainSelector().SelectByText(TestdomainB);
                PageLoadWait.WaitForFrameLoad(20);
                //Top folders -Domain B
                TopFolders = conferencefolders.AllTopLevelfolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step10_6 = (topfolderstring == null || topfolderstring.Length == 0) ? false : topfolderstring.Where(q => q.ToLower().Contains(TopFolderB1.ToLower())).Count() == topfolderstring.Length;
                //Subfolders -Domain B
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1);
                SubFolders_DomainB = conferencefolders.AllSubfolders().ToList();
                subfolderstring = new string[SubFolders_DomainB.Capacity];
                for (int i = 0; i < SubFolders_DomainB.Capacity; i++)
                {
                    subfolderstring[i] = SubFolders_DomainB[i].Text;
                }
                bool step10_7 = (subfolderstring == null || subfolderstring.Length == 0) ? false : subfolderstring.Where(q => q.ToLower().Contains(SubFolderB1.ToLower())).Count() == subfolderstring.Length;
                //Validate Top level in Add top level folder dialog -Domain B
                PageLoadWait.WaitForElement(conferencefolders.By_ManageTopLevelFolders(), WaitTypes.Visible, 15).Click();
                PageLoadWait.WaitForElement(conferencefolders.By_FolderConfigurationdiv(), WaitTypes.Visible, 15);
                PageLoadWait.WaitForFrameLoad(20);
                TopFolders = conferencefolders.GetToplevelFolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step10_8 = (topfolderstring == null || topfolderstring.Length == 0) ? false : topfolderstring.Where(q => q.ToLower().Contains(TopFolderB1.ToLower())).Count() == topfolderstring.Length;
                //Validate Folder manager user - Domain B
                conferencefolders.SwitchtoConferenceFrame();
                step10 = new bool[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    TopFolders[i].Click();
                    string FolderMgrName = PageLoadWait.WaitForElement(conferencefolders.By_FolderManagerList(), WaitTypes.Clickable, 15).Text;
                    if (FolderMgrName.Split(' ')[0] == TestuserB_Conf)
                    {
                        step10[i] = true;
                    }
                }
                bool step10_9 = conferencefolders.ValidateBoolArray(step10);
                //Close dialog
                conferencefolders.CloseManageTopLevelFolder();
                //Validate studies in folder - Should not have any studies in study folder 
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1);
                int step10_10 = BasePage.GetSearchResults().Count;

                //Switch to Domain A
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                PageLoadWait.WaitForFrameLoad(20);
                //Top folders -Domain A
                TopFolders = conferencefolders.AllTopLevelfolders().ToList();
                TopFolders_DomainA = new string[] { TopFolderA1, TopFolderA2, TopFolderA3 };
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step10_11 = (topfolderstring == null || topfolderstring.Length == 0) ? false : TopFolders_DomainA.Where(z => topfolderstring.Any(q => q.ToLower().Contains(z.ToLower()))).Count() == TopFolders_DomainA.Length && topfolderstring.Where(z => TopFolders_DomainA.Any(q => z.ToLower().Contains(q.ToLower()))).Count() == topfolderstring.Length;
                //Validate SubFolders -Domain A
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1);
                SubFolders_DomainA = conferencefolders.AllSubfolders().ToList();
                subfolderstring = new string[SubFolders_DomainA.Capacity];
                for (int i = 0; i < SubFolders_DomainA.Capacity; i++)
                {
                    subfolderstring[i] = SubFolders_DomainA[i].Text;
                }
                bool step10_12 = (subfolderstring == null || subfolderstring.Length == 0) ? false : subfolderstring.Where(q => q.ToLower().Contains(SubFolderA1.ToLower())).Count() == subfolderstring.Length;
                //Validate Top level in Add top level folder dialog -Domain A
                PageLoadWait.WaitForElement(conferencefolders.By_ManageTopLevelFolders(), WaitTypes.Visible, 15).Click();
                PageLoadWait.WaitForElement(conferencefolders.By_FolderConfigurationdiv(), WaitTypes.Visible, 15);
                PageLoadWait.WaitForFrameLoad(20);
                TopFolders = conferencefolders.GetToplevelFolders().ToList();
                topfolderstring = new String[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    topfolderstring[i] = TopFolders[i].Text;
                }
                bool step10_13 = (topfolderstring == null || topfolderstring.Length == 0) ? false : TopFolders_DomainA.Where(z => topfolderstring.Any(q => q.ToLower().Contains(z.ToLower()))).Count() == TopFolders_DomainA.Length && topfolderstring.Where(z => TopFolders_DomainA.Any(q => z.ToLower().Contains(q.ToLower()))).Count() == topfolderstring.Length;
                //Validate Folder manager user - Domain A
                conferencefolders.SwitchtoConferenceFrame();
                step10 = new bool[TopFolders.Capacity];
                for (int i = 0; i < TopFolders.Capacity; i++)
                {
                    TopFolders[i].Click();
                    string FolderMgrName = PageLoadWait.WaitForElement(conferencefolders.By_FolderManagerList(), WaitTypes.Clickable, 15).Text;
                    if (FolderMgrName.Split(' ')[0] == TestuserA_Conf)
                    {
                        step10[i] = true;
                    }
                }
                bool step10_14 = conferencefolders.ValidateBoolArray(step10);
                //Close dialog
                conferencefolders.CloseManageTopLevelFolder();
                //Validate studies in folder - Should not have any studies in study folder 
                conferencefolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1);
                int step10_15 = BasePage.GetSearchResults().Count;

                if (step10_1 && step10_2 && step10_3 && step10_4 && step10_5 == 0 && step10_6 && step10_7 && step10_8 && step10_9 && step10_10 == 0 && step10_11 && step10_12 && step10_13 && step10_14 && step10_15 == 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 11: Login as Domain Admin and check if domain selector is visible
                login.LoginIConnect(TestdomainAdminA, TestdomainAdminA_Pwd);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step11 = conferencefolders.IsElementVisible(By.CssSelector("#m_resultsSelectorControl_m_selectorList"));
                if (!step11)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 12: Login as Folder Manager and check if domain selector is visible
                login.LoginIConnect(TestuserA_Conf, TestuserA_Conf);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step12 = conferencefolders.IsElementVisible(By.CssSelector("#m_resultsSelectorControl_m_selectorList"));
                if (!step12)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 13: Login as Conference user and check if domain selector is visible
                login.LoginIConnect(TestuserA2_Conf, TestuserA2_Conf);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool step13 = conferencefolders.IsElementVisible(By.CssSelector("#m_resultsSelectorControl_m_selectorList"));
                if (!step13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Delete Folder descriptions
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94430(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domain;
            RoleManagement role;
            UserManagement user;
            ConferenceFolders conference;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;

                String[] datasource = null;


                //Step-1:[Pre-conditions-]

                //Pre-conditions: -1. iCA build under testing has been installed 
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab
                //\General sub tab on iCA server under testing 
                //3. At least one data source is available 
                //4. Explanation: Conference User is a user with permission to view all Conference Studies 
                //within their domain


                taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();

                //**##- uncomment
                //servicetool.LaunchServiceTool();
                //servicetool.NavigateToEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.ModifyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.EnableConferenceLists(0);
                //wpfobject.WaitTillLoad();
                //servicetool.ApplyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //wpfobject.ClickOkPopUp();
                //wpfobject.WaitTillLoad();
                //servicetool.RestartService();
                //wpfobject.WaitTillLoad();
                //servicetool.CloseServiceTool();
                taskbar.Show();



                //Enable ConferenceLists Check Box in Super Admin Domain
                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();

                if (domain.ConferenceListsCB().Selected == false)
                {
                    domain.ConferenceListsCB().Click();
                    Logger.Instance.InfoLog("ConferenceLists Check Box Selected successfully");
                }
                else
                {
                    Logger.Instance.InfoLog("ConferenceLists Check Box already selected");
                }
                domain.ClickSaveNewDomain();
                login.Logout();

                Executedsteps++;


                //Step-2
                //Pre-conditions:
                //Define domains, roles, users and Conference User settings (if have not done yet)
                //Domain-  DomainA (Conference User enabled) -Domain Admin-  daA (Conference User enabled) 
                //Role-  roleA1 (Conference User enabled) 
                //User in roleA1-  userA1 (Folder Manager); userA3 (conference user); 
                //Role-  roleA2 (Conference User disabled)
                //User in roleA2-  userA2 (non-conference user, Folder Manager); userA4 (non-conference user)
                //Domain-  DomainC (Conference User enabled) -Domain Admin-  daC (Conference User enabled) 
                //Role-  roleC1 (Conference User enabled) 
                //Role-  roleC2 (Conference User enabled)
                //User in roleC2-  userC2 (conference user)

                String DomainA = "DomainA_94430_" + new Random().Next(1000);
                String daA = "daA_94430_" + new Random().Next(1000);
                String userA1 = "userA1_94430_" + new Random().Next(1000);//Folder Manager
                String userA3 = "userA3_94430_" + new Random().Next(1000);//conference user

                String roleA1 = "roleA1_94430_" + new Random().Next(1000);

                String roleA2 = "roleA2_94430_" + new Random().Next(1000); String userA2 = "userA2_94430_" + new Random().Next(1000); //non-conference user, Folder Manager
                String userA4 = "userA4_94430_" + new Random().Next(1000); //non-conference user
                String DomainC = "DomainC_94430_" + new Random().Next(1000);
                String daC = "daC_94430_" + new Random().Next(1000);

                String roleC1 = "roleC1_94430_" + new Random().Next(1000);
                String roleC2 = "roleC2_94430_" + new Random().Next(1000);
                String userC2 = "userC2_94430_" + new Random().Next(1000);
                String TopFolder_1 = "Adult Bone Marrow Transplant_94430_" + new Random().Next(1000);//userA1 as FolderManager
                String TopFolder_1_Desc = "sa modified description for top level folder 1 in DomainA_94430_" + new Random().Next(1000);//userA1 as FolderManager
                String TopFolder_1_Manager = userA1 + new Random().Next(1000);

                String SubFolder_1_Level_2 = "October 6, 2016_94430_" + new Random().Next(1000);
                String SubFolder_1_Desc = "userA1 modified Meeting: October 6.2016_94430_" + new Random().Next(1000);
                String SubFolder_1_Level_3 = "Level_3_94430_" + new Random().Next(1000);
                String SubFolder_1_Desc_Level_3 = "Level_3_Description_94430_" + new Random().Next(1000);

                String SubFolder_2_Level_2 = "October 13, 2016_94430_" + new Random().Next(1000);
                String SubFolder_2_Desc = "daA modified: Meeting - October 13, 20YY_94430_" + new Random().Next(1000);
                String SubFolder_2_Level_3 = "Level_3_94430_" + new Random().Next(1000);
                String SubFolder_2_Desc_Level_3 = "Description of_Level_3_94430_" + new Random().Next(1000);
                String SubFolder_3_Level2 = "October 20_94430_" + new Random().Next(1000);
                String SubFolder_3_Desc = "Meeting 10.20.2016_94430_" + new Random().Next(1000);
                String TopFolder_2 = "Brain Tumor (Neurologic Oncology)_94430_" + new Random().Next(1000); //userA1 as FolderManager
                String TopFolder_2_Desc = "daA modified description: top level folder 2 in DomainA_94430_" + new Random().Next(1000);


                String TopFolder_4 = "top folder 4 in DomainA_94430_" + new Random().Next(1000);
                String TopFolder_4_Desc = "top folder 4 in DomainA_94430_" + new Random().Next(1000);
                String TopFolder_4_Manager = userA2 + new Random().Next(1000);
                String SubFolder_4_Level_2 = "Level_2_94430_" + new Random().Next(1000);
                String SubFolder_4_Desc_Level_2 = "Description of Level_2_94430_" + new Random().Next(1000);
                String TopFolder_5 = "top folder 5 in DomainA_94430_" + new Random().Next(1000);
                //String TopFolder_5_Desc = "Blank Description of _Top Folder_5_94430_"+ new Random().Next(1000);
                String SubFolder_5_Level_2 = "Level_2_94430_" + new Random().Next(1000);
                String SubFolder_5_Desc_Level_2 = "Description of _Level_2_94430_" + new Random().Next(1000);
                String TopFolder_3 = "Cutaneous T-cell Lymphoma_94430_" + new Random().Next(1000);
                String TopFolder_3_Desc = "daC modified description top level folder 3 in DomainC_94430_" + new Random().Next(1000);
                String SubFolder_3_Level_2 = "Level_2_94430_" + new Random().Next(1000);
                String SubFolder_3_Desc_Level_2 = "Description of Level_2_94430_" + new Random().Next(1000);
                //Domain: DomainA (Conference User enabled) -Domain Admin-  daA (Conference User enabled) 


                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainA, DomainA, datasources: datasource);
                domain.ConferenceListsCB().Click();
                domain.ClickSaveNewDomain();


                user = (UserManagement)login.Navigate("UserManagement");
                user.NewDomainAdminBtn().Click();
                PageLoadWait.WaitForPageLoad(20);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                user.DomainAdmin_DomainName_Dropdown().SelectByText(DomainA);
                PageLoadWait.WaitForPageLoad(20);
                user.UserIdTxtBox().SendKeys(daA);
                user.LastNameTxtBox().SendKeys(daA);
                user.FirstNameTxtBox().SendKeys(daA);
                user.PasswordTxtBox().SendKeys(daA);
                user.ConfirmPwdTxtBox().SendKeys(daA);
                //Enable Conference List
                user.ConferenceUserCB().Click();
                user.SaveBtn().Click();
                PageLoadWait.WaitForPageLoad(20);


                //roleA1 (Conference User enabled) 


                role = (RoleManagement)login.Navigate("RoleManagement");
                role.CreateRole(DomainA, roleA1, "conference");
                
                //Users in roleA1 

                user = (UserManagement)login.Navigate("UserManagement");
                user.CreateUser(userA1, DomainA, roleA1);//Folder Manager
                user.CreateUser(userA3, DomainA, roleA1);//Conference User

                //roleA2: (Conference User disabled) 

                role = (RoleManagement)login.Navigate("RoleManagement");
                role.CreateRole(DomainA, roleA2, "any");

                //User in roleA2 

                user = (UserManagement)login.Navigate("UserManagement");
                user.CreateUser(userA2, DomainA, roleA2);//Non-Conference User
                user.CreateUser(userA4, DomainA, roleA2);//Non-Conference User

                //DomainC  DomainC (Conference User enabled) -Domain Admin-  daC (Conference User enabled)

                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainC, DomainC, datasources: datasource);
                domain.ConferenceListsCB().Click();
                domain.ClickSaveNewDomain();

                user = (UserManagement)login.Navigate("UserManagement");
                user.NewDomainAdminBtn().Click();
                PageLoadWait.WaitForPageLoad(20);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                user.DomainAdmin_DomainName_Dropdown().SelectByText(DomainC);
                PageLoadWait.WaitForPageLoad(20);
                user.UserIdTxtBox().SendKeys(daC);
                user.LastNameTxtBox().SendKeys(daC);
                user.FirstNameTxtBox().SendKeys(daC);
                user.PasswordTxtBox().SendKeys(daC);
                user.ConfirmPwdTxtBox().SendKeys(daC);
                user.ConferenceUserCB().Click();      //Enable Conference List
                user.SaveBtn().Click();

                //roleC1 (Conference User enabled)

                role = (RoleManagement)login.Navigate("RoleManagement");
                role.CreateRole(DomainC, roleC1, "conference");

                //roleC2 (Conference User enabled)

                role = (RoleManagement)login.Navigate("RoleManagement");
                role.CreateRole(DomainC, roleC2, "conference");

                //User in roleC2-  userC2 (conference user)

                user = (UserManagement)login.Navigate("UserManagement");
                user.CreateUser(userC2, DomainC, roleC2);//Folder Manager

                bool uA1 = user.SearchUser(userA1, DomainA);
                bool uA2 = user.SearchUser(userA2, DomainA);
                bool uA3 = user.SearchUser(userA3, DomainA);
                bool uA4 = user.SearchUser(userA4, DomainA);
                bool uC2 = user.SearchUser(userC2, DomainC);

                if (uA1 && uA2 && uA3 && uA4 && uC2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3
                //Pre-conditions: Create Top Level Folders, Sub-Folders & Level3 Sub-Folders
                //-----------in DomainA------------------
                //1) Folder Name: Adult Bone Marrow Transplant;  -----top
                //Folder Description: sa modified description for top level folder 1 in DomainA,
                //Folder Managers: userA1

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.CreateToplevelFolder(TopFolder_1, userA1, DomainA, TopFolder_1_Desc); //Adult Bone Marrow Transplant

                //Three Level 2 Sub-folders under it:
                //--Sub-Folder Name: October 6, 2016;---------------------------------------------------------1
                //Folder Description: userA1 modified Meeting: October 6.2016
                //Has a level 3 sub-folder under it.

                bool step3_1 = conference.CreateSubFolder(TopFolder_1, SubFolder_1_Level_2, DomainA, SubFolder_1_Desc);
                bool step3_2 = conference.CreateSubFolder(TopFolder_1 + "/" + SubFolder_1_Level_2, SubFolder_1_Level_3, DomainA, SubFolder_1_Desc_Level_3);

                //--Sub-Folder Name: October 13, 2016;---------------------------------------------------------2
                //Folder Description: daA modified: Meeting - October 13, 20YY
                //Has a level 3 sub-folder under it.

                bool step3_3 = conference.CreateSubFolder(TopFolder_1, SubFolder_2_Level_2, DomainA, SubFolder_2_Desc);
                bool step3_4 = conference.CreateSubFolder(TopFolder_1 + "/" + SubFolder_2_Level_2, SubFolder_2_Level_3, DomainA, SubFolder_2_Desc_Level_3);

                login.Logout();

                //--Sub-Folder Name: October 20;     ---------------------------------------------------------3
                //Folder Description: Meeting 10.20.2016;
                //Created by Domain Admin (daA)
                //No level 3 sub-folder under it.

                //Domain Admin (daA) ##**
                login.DriverGoTo(login.url);
                login.LoginIConnect(daA, daA);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                bool step3_5 = conference.CreateSubFolder(TopFolder_1, SubFolder_3_Level2, Description: SubFolder_3_Desc);
                login.Logout();

                //2) Folder Name: Brain Tumor (Neurologic Oncology);-----top
                //Folder Description: daA modified description: top level folder 2 in DomainA;
                //Folder Managers: not assigned
                //No sub-folders

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.CreateToplevelFolder(TopFolder_2, domain: DomainA, description: TopFolder_2_Desc);

                //4)Folder Name: top folder 4 in DomainA;   -----top
                //Folder Description: top folder 4 in DomainA;
                //Folder Manager: userA2;
                //Has a level 2 sub-folder under it----------------------------------------------1(any name)

                conference.CreateToplevelFolder(TopFolder_4, userA2, DomainA, TopFolder_4_Desc);
                bool step3_6 = conference.CreateSubFolder(TopFolder_4, SubFolder_4_Level_2, Description: SubFolder_4_Desc_Level_2);

                //5)Folder Name: top folder 5 in DomainA;-----top
                //Folder Description: blank;
                //Folder Manager: not assigned;
                //Has a level 2 sub-folder under it.----------------------------------------------1(any name)

                conference.CreateToplevelFolder(TopFolder_5, domain: DomainA);
                bool step3_7 = conference.CreateSubFolder(TopFolder_5, SubFolder_5_Level_2, Description: SubFolder_5_Desc_Level_2);

                //----- DomainC
                //3) Folder Name: Cutaneous T-cell Lymphoma;-----top
                //Folder Description: daC modified description top level folder 3 in DomainC;
                //Folder Manager: not assigned
                //Has a level 2 sub-folder under it----------------------------------------------1(any name)

                conference.CreateToplevelFolder(TopFolder_3, domain: DomainC, description: TopFolder_3_Desc);
                bool step3_8 = conference.CreateSubFolder(TopFolder_3, SubFolder_3_Level_2, Domain_Name: DomainC, Description: SubFolder_3_Desc_Level_2);

                if (step3_1 && step3_2 && step3_3 && step3_4 && step3_5 && step3_6 && step3_7 && step3_8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    Logger.Instance.ErrorLog("Active Folder " + step3_1 + "-" + step3_2 + "-" + step3_3 + "-" + step3_4 + "-" + step3_5 + "-" + step3_6 + "-" + step3_7 + "-" + step3_8);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-4
                //[Super Admin deletes Top Level Folder description]-Login iCA as Super Admin (Administrator),
                //navigate to the Conference Tab and select a domain (DomainA), 
                //select the Top Level Folder named 'Adult Bone Marrow Transplant', 
                //click EDIT Folder Description button.

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.ExpandAndSelectFolder(TopFolder_1, DomainA);

                //User is presented with a text area that contains the current 
                //description (sa modified description for top level folder 1 in DomainA).

                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));

                //BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div#FolderDescriptionText")));

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_1_Desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5
                //Delete the folder description text, click OK.

                conference.DeleteDescription();



                //Super Admin is able to delete Top Level Folder description in the domain selected. 
                //The top level folder no longer has a description.

                if (conference.DescriptionText().Equals("") &&
                   conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6
                //From Conference Tab select a different domain (DomainC), 
                //select a Top Level Folder named '-east Care Center', 
                //delete the folder description text 'daC modified description top level folder 3 in DomainC'

                conference.SwitchtoConferenceFrame();
                conference.DomainSelector().SelectByText(DomainC);
                conference.ExpandAndSelectFolder(TopFolder_3, DomainC);

                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                Boolean step_6 = conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_3_Desc);

                conference.DeleteDescription();

                //Super Admin is able to delete Top Level Folder description in the domain selected. 
                //The top level folder no longer has a description.

                if (step_6 &&
                   conference.DescriptionText().Equals("") &&
                   conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7
                //[Super Admin deletes Sub-Folder's description]
                //--/-From Conference Tab select a Domain (DomainA), 
                //select a sub-folder wishes to modify, 
                //e.g. from top level folder named 'Adult Bone Marrow Transplant' 
                //select a level 2 sub-folder (October 6, 2016), click EDIT Folder Description button.

                conference.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_1_Level_2, DomainA);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                //User is presented with a text area that contains the 
                //current description (userA1 modified Meeting- October 6, 2016)

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_1_Desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8
                //Delete the level 2 sub-folder description text, click OK.

                conference.DeleteDescription();

                //Super Admin is able to delete sub-folder description in the domain selected. 
                //The sub-folder no longer has a description.

                if (conference.DescriptionText().Equals("") &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9
                //Select a level 3 sub-folder under the level 2 sub-folder. 
                //Delete the description of the level 3 sub-folders.

                conference.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_1_Level_2 + "/" + SubFolder_1_Level_3, DomainA);

                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                Boolean step_9 = conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_1_Desc_Level_3);

                conference.DeleteDescription();

                //Super Admin is able to delete sub-folder description
                //in the domain selected. The sub-folder no longer has a description.

                if (step_9 &&
                   conference.DescriptionText().Equals("") &&
                   conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-10
                //[Domain Admin deletes Top Level Folder descriptions]
                //Login iCA as a Domain Admin (daA in DomainA), 
                //navigate to the Conference Tab, select a Top Level Folder 
                //e.g. 'top folder 4 in DomainA', click EDIT Folder Description button.

                login.DriverGoTo(login.url);
                login.LoginIConnect(daA, daA);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.ExpandAndSelectFolder(TopFolder_4);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                //User is presented with a text area that contains 
                //the current description (daA modified top level folder 4 in DomainA)

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_4_Desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-11
                //Delete the folder description text of the top level folder, click OK.

                conference.DeleteDescription();

                //Domain Admin is able to delete the selected Top Level Folder description in the domain
                //the user is an administrator of. The top level folder no longer has a description.

                if (conference.DescriptionText().Equals("") &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12
                //Select a top level folder that has a folder description 
                //(e.g. top level folder -Brain Tumor (Neurologic Oncology), click EDIT Folder Description button

                conference.ExpandAndSelectFolder(TopFolder_2);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                //User is presented with a text area that contains the current description
                // (daA modified description- top level folder 2 in DomainA)

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_2_Desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13
                //Without delete any folder description text, click OK.             

                conference.EditDesc_TextArea().Click();
                conference.EditDesc_OKbutton().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_CurrentDesc()));

                //The folder description remains the same.

                if (conference.DescriptionText().Equals(TopFolder_2_Desc) &&
                    conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(TopFolder_2_Desc) &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: none;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-14
                //[Domain Admin deletes Sub-Folder descriptions]
                //Select a level 2 sub-folder under the same top level folder 
                //(e.g. top folder 4 in DomainA), click EDIT Folder Description button,

                conference.ExpandAndSelectFolder(TopFolder_4 + "/" + SubFolder_4_Level_2);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                //User is presented with a text area that contains the current description

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_4_Desc_Level_2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-15
                //Delete the folder description text of the selected level 2 sub-folder.

                conference.DeleteDescription();

                //Domain Admin is able to delete the selected sub-folder description in the domain
                //the user is an administrator of. The sub-folder no longer has a description.

                if (conference.DescriptionText().Equals("") &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-16
                //Select a top level folder that has a level 3 sub-folder under it 
                //(e.g. Adult Bone Marrow Transplant), 
                //select the level 3 sub-folder under a level 2 sub-folder (October 13, 2016),
                //click EDIT Folder Description button.

                conference.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_2_Level_2 + "/" + SubFolder_2_Level_3);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                //User is presented with a text area that contains the current description

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_2_Desc_Level_3))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    //**##
                    Logger.Instance.ErrorLog("conference.EditDesc_CurrentDesc().GetAttribute(innerHTML)" + conference.EditDesc_CurrentDesc().GetAttribute("innerHTML"));
                    Logger.Instance.ErrorLog("SubFolder_2_Desc_Level_3" + SubFolder_2_Desc_Level_3);

                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-17
                //Delete the folder description text of the selected level 3 sub-folder.
                conference.DeleteDescription();

                //Domain Admin is able to delete the selected sub-folder description 
                //in the domain the user is an administrator of. The sub-folder no longer has a description.

                if (conference.DescriptionText().Equals("") &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-18

                //[Folder Manager deletes Sub-Folder descriptions]
                //-Login iCA as a Folder Manger (userA1), 
                //select a top level folder that contains 
                //sub-folder has a folder description from a top level folder 
                //(Adult Bone Marrow Transplant), select a sub-folder 
                //(e.g. October 13, 2016), click EDIT Folder Description button.

                login.DriverGoTo(login.url);
                login.LoginIConnect(userA1, userA1);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.ExpandAndSelectFolder(TopFolder_1 + "/" + SubFolder_2_Level_2);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                //User is presented with a text area that contains the current description

                if (conference.EditDesc_CurrentDesc().GetAttribute("innerHTML").Equals(SubFolder_2_Desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19
                //Delete the folder description text of the selected sub-folder, click OK.

                conference.DeleteDescription();

                //Folder Manager is able to delete the selected Sub-Folder description in the top level folder
                //the user is an administrator of. The sub-folder no longer has a description.

                if (conference.DescriptionText().Equals("") &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-20
                //[Folder Manager attempts to delete Sub-Folder description under top level folder the user is not an administrator of]
                //-As the Folder Manager (userA1) logged in iCA, 
                //select a top level folder has a sub-folder with description 
                //and the Folder Manager is not an administrator of the top level folder, 
                //attempt to delete the sub-folder descriptions text. 
                //(e.g. top level folder- top folder 5 in DomainA)

                conference.ExpandAndSelectFolder(TopFolder_5 + "/" + SubFolder_5_Level_2);

                //Folder Manager has no permission to delete Sub-Folder description in a top level folder
                //the user is not an administrator of. The description of the sub-folder remain unchanged.

                if (conference.EditDesc_Button().Displayed == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-21

                //Login ICA as a Domain Admin (daA) assign the user (userA1) 
                //as a Folder Manage of that top level folder
                //(e.g. top level folder- top folder 5 in DomainA), 
                //log out from the domain admin.
                //Login iCA as the folder manager (userA1), 
                //select a sub-folder from this top level folder that user is a Folder Manager,
                //delete the sub-folder description text

                login.DriverGoTo(login.url);
                login.LoginIConnect(daA, daA);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.SwitchtoConferenceFrame();
                conference.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='divFolderManagement'] input[id='ConferenceFolderManagementControl_AddFolderButton']")));
                conference.SwitchtoConferenceFrame();
                Thread.Sleep(3000);
                Boolean Foldermanager5 = conference.AddFolderManager(TopFolder_5, userA1);

                conference.SaveFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conference.ManageFolderOkBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                login.Logout();

                login.DriverGoTo(login.url);
                login.LoginIConnect(userA1, userA1);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.ExpandAndSelectFolder(TopFolder_5 + "/" + SubFolder_5_Level_2);
                conference.EditDesc_Button().Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conference.EditDesc_TextArea()));


                conference.DeleteDescription();

                //Folder Manager now has permission to delete Sub-Folder description in the folder 
                //the user is an administrator of. The description of the sub-folder is updated with new values.

                if (conference.DescriptionText().Equals("") &&
                    conference.EditDesc_Emptydesc().GetAttribute("style").Contains("display: inline;"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-22
                //[Folder Manage attempts to delete Top Level Folder description]
                //-Login iCA as the Folder Manager (userA1 or userA2), 
                //select the top level folder the user is an administrator of, 
                //attempt to delete the top level folder description text.

                //Pre-condition -- deleted this Description (Creating again)
                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.ExpandAndSelectFolder(TopFolder_1, DomainA);
                String New_Description = "Description of Top level Folder To test the userA1_94430_";
                conference.EditDescription(New_Description);
                login.Logout();


                //actual step--
                login.DriverGoTo(login.url);
                login.LoginIConnect(userA1, userA1);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");


                conference.ExpandAndSelectFolder(TopFolder_1);


                //Folder Manager has no permission to delete top level folder description
                //in the folder the user is an administrator of. 
                //The description of the top level folder remains unchanged.

                if (conference.DescriptionText().Equals(New_Description) &&
                    conference.EditDesc_Button().Displayed == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-23
                //[Conference User attempts to delete folder descriptions]
                //Login iCA as a conference user (userA3 in DomainA), 
                //attempt to delete any folder descriptions.

                login.DriverGoTo(login.url);
                login.LoginIConnect(userA3, userA3);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.ExpandAndSelectFolder(TopFolder_1);

                //Conference User has no permission to delete any folder description. 
                //Folder descriptions remains unchanged.

                //have to verify Error message
                if (conference.DescriptionText().Equals(New_Description) &&
                    conference.EditDesc_Button().Displayed == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Add Folder Manager to Top Level Folder
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94431(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PateintID");
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String datasource = login.GetHostName(Config.SanityPACS);
                //DomainA
                String TestdomainA = "Test31_DomainA" + new Random().Next(1, 1000);
                String TestdomainAdminA = "Test31_DomainAdminA" + new Random().Next(1, 1000);
                String TestroleA1 = "Test31_Role1A" + new Random().Next(1, 1000);
                String TestroleA2 = "Test31_Role2A" + new Random().Next(1, 1000);
                String TestuserA1 = "Test31_User1A" + new Random().Next(1, 1000);
                String TestuserA2 = "Test31_User2A" + new Random().Next(1, 1000);
                String TestuserA3 = "Test31_User3A" + new Random().Next(1, 1000);
                String TestuserA4 = "Test31_User4A" + new Random().Next(1, 1000);

                String TestuserA5 = "Test31_User5A" + new Random().Next(1, 1000);
                String TestuserA6 = "Test31_User6A" + new Random().Next(1, 1000);

                //DomainC
                String TestdomainC = "Test31_DomainC" + new Random().Next(1, 1000);
                String TestdomainAdminC = "Test31_DomainAdminC" + new Random().Next(1, 1000);
                String TestroleC1 = "Test31_Role1C" + new Random().Next(1, 1000);
                String TestroleC2 = "Test31_Role2C" + new Random().Next(1, 1000);
                String TestuserC2 = "Test31_User2C" + new Random().Next(1, 1000);

                String TestuserC1 = "GUserC1" + new Random().Next(1, 1000);

                //FolderNames for DomainA
                //Set1:
                String TopFolderA1 = "Adult Bone Marrow_" + new Random().Next(1, 1000);//userA1 as FolderManager
                String SubFolderA1_1_Level2 = "October 6, 2016_" + new Random().Next(1, 1000);//with no description
                String SubFolderA1_1_Level3 = "Level3_A1_1" + new Random().Next(1, 1000);
                String Desc_A1_Level3 = SubFolderA1_1_Level3 + "_Description";
                String SubFolderA1_2_Level2 = "October 13, 2016_" + new Random().Next(1, 1000);
                String SubFolderA1_2_Level3_1 = "Level3_A1_2_1" + new Random().Next(1, 1000);//with no desc
                String SubFolderA1_2_Level3_2 = "October 20_" + new Random().Next(1, 1000);
                String Desc_A1_Level3_2 = "Meeting 10.20.2016_" + new Random().Next(1, 1000);

                //Set2:
                String TopFolderA2 = "Brain Tumor_" + new Random().Next(1, 1000);//No FolderManager,no subfolders

                //Set4:
                String TopFolderA4 = "top folder 4 in DomainA_" + new Random().Next(1, 1000);//userA2 as FolderManager
                String SubFolderA4_1_Level2 = "Level2_A4_" + new Random().Next(1, 1000);

                //Set5:
                String TopFolderA5 = "top folder 5 in DomainA_" + new Random().Next(1, 1000);//userA1 as FolderManager
                String SubFolderA5_1_Level2 = "Level2_A5_" + new Random().Next(1, 1000);

                //FolderNames for DomainC
                //Set3:
                String TopFolderC3 = "Cutaneous T-cell Lymphoma_" + new Random().Next(1, 1000);//no FolderManager
                String SubFolderC3_1_Level2 = "Level2_C3_" + new Random().Next(1, 1000);
                String Desc_C3_Level2 = SubFolderC3_1_Level2 + "_Description";

                String TopFolderC1 = "Folder Name Head and Neck_" + new Random().Next(1, 1000);
                String Desc_TopFolderC1 = "Head_Neck in DomainC_" + new Random().Next(1, 1000);


                //Step-1:[Pre-conditions-]--1. iCA build under testing is a fresh installation on iCA server--2. at least a data source is configured in Server Tool and connected to the domain used--3. IPad is available for the testing
                //Enable Conference Lists checkbox is ON in Server Tool                
                Executedsteps++;


                //Step-2:Pre-conditions-Define domains, roles, users and Conference User settings (if have not done yet)
                //--> DomainA (Conference User enabled)-Domain Admin daA (Conference User enabled);-Role roleA1 (Conference User enabled);-User in roleA1 userA1(Folder Manager), userA3 (conference user);-Role roleA2 (Conference User disabled);-User in roleA2 userA2 (non-conference user, Folder Manager), userA4 (non-conference user);-- DomainC (Conference User enabled) -Domain Admin daC (Conference User enabled);-Role roleC1 (Conference User enabled);-Role roleC2 (Conference User enabled);-User in roleC2 userC2 (Conference user)

                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                //DomainA and DomainC with Conf. enabled
                domainmanagement.CreateDomain(TestdomainA, TestdomainA, datasource);
                domainmanagement.ClickSaveNewDomain();
                PageLoadWait.WaitForFrameLoad(20);
                domainmanagement.CreateDomain(TestdomainC, TestdomainC, datasource);
                domainmanagement.ClickSaveNewDomain();
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(TestdomainA);
                domainmanagement.SelectDomain(TestdomainA);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_1 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(TestdomainC);
                domainmanagement.SelectDomain(TestdomainC);
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_2 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();

                //DomainAdmin users for DomainA and DomainC
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(TestdomainAdminA, TestdomainA)) usermanagement.CreateDomainAdminUser(TestdomainAdminA, TestdomainA, 0, "", 0);
                if (!usermanagement.SearchUser(TestdomainAdminC, TestdomainC)) usermanagement.CreateDomainAdminUser(TestdomainAdminC, TestdomainC, 0, "", 0);

                bool bdaA = usermanagement.SearchUser(TestdomainAdminA, TestdomainA);
                bool bdaC = usermanagement.SearchUser(TestdomainAdminC, TestdomainC);


                //2 Roles for each domain
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.CreateRole(TestdomainA, TestroleA1, "any");
                rolemanagement.CreateRole(TestdomainA, TestroleA2, "any");
                rolemanagement.CreateRole(TestdomainC, TestroleC1, "any");
                rolemanagement.CreateRole(TestdomainC, TestroleC2, "any");

                //RoleA1 with enabled feature
                rolemanagement.SearchRole(TestroleA1, TestdomainA);
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_3 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //RoleA2 with disabled feature
                rolemanagement.SearchRole(TestroleA2, TestdomainA);
                rolemanagement.SelectRole(TestroleA2);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 1);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_4 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //RoleC1 with enabled feature
                rolemanagement.SearchRole(TestroleC1, TestdomainC);
                rolemanagement.SelectRole(TestroleC1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_5 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //RoleC1 with enabled feature
                rolemanagement.SearchRole(TestroleC2, TestdomainC);
                rolemanagement.SelectRole(TestroleC2);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2_6 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                //2 users for each roles of DoaminA
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(TestuserA1, TestdomainA, TestroleA1);//Folder Manager
                usermanagement.CreateUser(TestuserA3, TestdomainA, TestroleA1);//Conference User

                usermanagement.CreateUser(TestuserA2, TestdomainA, TestroleA2);//Non-Conference User
                usermanagement.CreateUser(TestuserA4, TestdomainA, TestroleA2);//Non-Conference User

                bool userA1 = usermanagement.SearchUser(TestuserA1, TestdomainA);
                bool userA2 = usermanagement.SearchUser(TestuserA2, TestdomainA);
                bool userA3 = usermanagement.SearchUser(TestuserA3, TestdomainA);
                bool userA4 = usermanagement.SearchUser(TestuserA4, TestdomainA);

                //1 user for RoleC2 of DomainC
                usermanagement.CreateUser(TestuserC2, TestdomainC, TestroleC2);//Conference User
                bool userC2 = usermanagement.SearchUser(TestuserC2, TestdomainC);

                if (CB2_1 && CB2_2 && CB2_3 && !CB2_4 && CB2_5 && CB2_6 && userA1 && userA2 && userA3 && userA4 && userC2 && bdaA && bdaC)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-3:Pre-conditions-Create Top Level Folder, Sub-Folders and Level3 Sub-Folders (if have not done yet)- DomainA -1) Top Level Folder Name Adult Bone Marrow Transplant;-Folder Managers userA1;-Sub-folders under it-Level 2 Folder Name October 6, 2016; no Description;-Level 3 folder with any name and description;-Level 2 Folder Name October 13, 2016; no Description;-Level 3 folder with any name and description;-Level 3 Folder Name October 20; Description Meeting 10.20.2016.-2) Top Level Folder Name ain Tumor (Neurologic Oncology)-Folder Managers not assigned;-It has No sub-folders.-4) Top Level Folder Name top folder 4 in DomainA;-Folder Manager userA2;-It has a sub-folder with any folder name.-5) Top Level Folder Name top folder 5 in DomainA-Folder Manager userA1-It has a sub-folder with any folder name- DomainC -3) Top Level Folder Name Cutaneous T-cell Lymphoma;-Folder Manager not assigned;-It has a sub-folder with any folder name and description.

                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                //Set1:
                bool Istop1Exist = conferencefolders.CreateToplevelFolder(TopFolderA1, TestuserA1, TestdomainA); //Adult Bone Marrow Transplant
                bool Issub1_2Exist = conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1_1_Level2); //October 6, 2016(Level2)
                bool Issub1_23Exist = conferencefolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2, SubFolderA1_1_Level3); //with any name and description(Level3)

                bool Issub1_2_2Exist = conferencefolders.CreateSubFolder(TopFolderA1, SubFolderA1_2_Level2); //October 13, 2016(Level2)
                bool Issub1_231Exist = conferencefolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_2_Level2, SubFolderA1_2_Level3_1); //with any name and description(Level3)
                bool Issub1_232Exist = conferencefolders.CreateSubFolder(TopFolderA1 + "/" + SubFolderA1_2_Level2, SubFolderA1_2_Level3_2, Description: Desc_A1_Level3_2); //October 20; Description: Meeting 10.20.2016.(Level3)

                //Set2:
                bool Istop2Exist = conferencefolders.CreateToplevelFolder(TopFolderA2, domain: TestdomainA); //Brain Tumor (Neurologic Oncology)
                //Set4:                
                bool Istop4Exist = conferencefolders.CreateToplevelFolder(TopFolderA4, TestuserA2, TestdomainA); //top folder 4 in DomainA
                bool Issub4Exist = conferencefolders.CreateSubFolder(TopFolderA4, SubFolderA4_1_Level2); //any name(Level2)
                //Set5:
                bool Istop5Exist = conferencefolders.CreateToplevelFolder(TopFolderA5, TestuserA1, TestdomainA); //top folder 5 in DomainA
                bool Issub5Exist = conferencefolders.CreateSubFolder(TopFolderA5, SubFolderA5_1_Level2); //any name(Level2)
                //Set3:
                bool Istop3Exist = conferencefolders.CreateToplevelFolder(TopFolderC3, domain: TestdomainC);//Cutaneous T-cell Lymphoma
                bool Issub3Exist = conferencefolders.CreateSubFolder(TopFolderC3, SubFolderC3_1_Level2, Description: Desc_C3_Level2);//any folder name and description(Level2)

                if (Istop1Exist && Issub1_2Exist && Issub1_23Exist && Issub1_2_2Exist && Issub1_231Exist && Issub1_232Exist && Istop2Exist && Istop4Exist && Issub4Exist && Istop5Exist && Issub5Exist && Istop3Exist && Issub3Exist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-4:Login iCA as Super Admin (Administrator), navigate to the Conference Tab and select a domain (DomainA), click the Manage Top Level Folders button
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                bool IsFolderdialogExist = conferencefolders.IsElementVisible(conferencefolders.By_FolderConfigurationdiv());
                if (IsFolderdialogExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-5:Select the Top Level Folder named Adult Bone Marrow Transplant, search a user belongs to the domain (e.g. userA3 in DomainA), assign the user as a Folder manager to the top level folder.
                bool Foldermanager5 = conferencefolders.AddFolderManager(TopFolderA1, TestuserA3);
                conferencefolders.SaveFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conferencefolders.ManageFolderOkBtn().Click();
                if (Foldermanager5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6:Select a different top level folder in the same domain (Brain Tumor (Neurologic Oncology), search a non-conference user belongs to the selected domain (e.g. userA4 in DomainA), assign the user as a Folder Manager of the selected top level folder.
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(conferencefolders.By_FolderConfigurationdiv()));
                bool Foldermanager6 = conferencefolders.AddFolderManager(TopFolderA2, TestuserA4);
                conferencefolders.SaveFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conferencefolders.ManageFolderOkBtn().Click();
                if (Foldermanager6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-7:Login iCA as the newly assigned Folder Manager (userA3), go to the Conference Tab, select the Top Level Folder (Adult Bone Marrow Transplants) the user is an administrator of, edit the description of a sub-folder 'October 6, 2016'
                login.LoginIConnect(TestuserA3, TestuserA3);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/" + SubFolderA1_1_Level2);
                //conferencefolders.ExpandAndSelectFolder(TopFolderA1 + "/"+SubFolderA1_1_Level2+ "/Sub");
                conferencefolders.EditDescription("Description7");
                PageLoadWait.WaitForFrameLoad(20);
                String Newdesc = conferencefolders.EditDesc_CurrentDesc().Text;
                if (Newdesc.Equals("Description7"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Select a top level folder (Brain Tumor (Neurologic Oncology)) in which the Folder Manager (userA3) is not an administrator of, attempt to create a sub-folder.
                conferencefolders.ExpandAndSelectFolder(TopFolderA2);
                if (conferencefolders.CreateFolderButton().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-9:Login iCA as a newly added Folder Manager of a top level folder (e.g. userA4 of ain Tumor (Neurologic Oncology)),  go to the Conference Tab,select the Top Level Folder the user is an administrator of, create a sub-folder with a folder description
                login.LoginIConnect(TestuserA4, TestuserA4);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.CreateSubFolder(TopFolderA2, "Sub2");
                PageLoadWait.WaitForFrameLoad(10);
                if (conferencefolders.ActiveLastsib().Text.Equals("Sub2"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-10:-Login as a Superadmin, go to Conference Tab, select a top level folder, attempt to assign a Folder Manager to a user who is not belonging to the selected domain (e.g. attempt to assign Folder Manager to a user belongs DomainB or DomainC to a top level folder which is under DomainA)
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.DomainSelector().SelectByText(TestdomainC);
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(conferencefolders.By_FolderConfigurationdiv()));
                bool IsFoldermanagerExist10 = conferencefolders.AddFolderManager(TopFolderC3, TestuserA4);
                if (!IsFoldermanagerExist10)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-11:Login iCA as a Domain Admin (daA in DomainA), navigate to User Management tab, create two new users, one is using Conference User enabled role (e.g. userA5 in roleA1), the other is using Conference User disabled role (e.g. userA6 in roleA2). Navigate to Conference Tab, click the Manage Top Level Folder button.
                login.LoginIConnect(TestdomainAdminA, TestdomainAdminA);
                usermanagement = login.Navigate<UserManagement>();
                usermanagement.CreateUser(TestuserA5, TestdomainA, TestroleA1);//Conference User
                usermanagement.CreateUser(TestuserA6, TestdomainA, TestroleA2);//Non-Conference User
                bool userA5 = usermanagement.SearchUser(TestuserA5);
                bool userA6 = usermanagement.SearchUser(TestuserA6);
                conferencefolders = login.Navigate<ConferenceFolders>();
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(conferencefolders.By_FolderConfigurationdiv()));
                if (conferencefolders.FolderConfigurationdiv().Displayed && userA5 && userA6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12:Select the Top Level Folder (e.g. top folder 4 in DomainA), search users belonging the selected domain, add a conference user (userA5) as a Folder Manager to the selected top level folder.
                bool Foldermanager12 = conferencefolders.AddFolderManager(TopFolderA4, TestuserA5);
                conferencefolders.SaveFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conferencefolders.ManageFolderOkBtn().Click();
                if (Foldermanager12)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13:Select a different top level folder (top folder 5 in DomainA),  assign Folder Manager to a non-conference user (userA6).
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(conferencefolders.By_FolderConfigurationdiv()));
                bool Foldermanager13 = conferencefolders.AddFolderManager(TopFolderA5, TestuserA6);
                conferencefolders.SaveFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conferencefolders.ManageFolderOkBtn().Click();
                if (Foldermanager13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-14:Login iCA as the Folder Manager (userA5), navigate to Conference Tab, select the top level folder (top folder 4 in DomainA) in which the user is an administrator of, modify a sub-folder name and description.
                login.LoginIConnect(TestuserA5, TestuserA5);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.RenameFolder(TopFolderA4 + "/" + SubFolderA4_1_Level2, "NewName14");
                conferencefolders.EditDescription("Description14");
                PageLoadWait.WaitForFrameLoad(20);
                String Newdesc14 = conferencefolders.EditDesc_CurrentDesc().Text;
                if (Newdesc14.Equals("Description14") && conferencefolders.ActiveFolder().Text.Equals("NewName14"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-15:Login iCA as the Folder Manager (userA6), navigate to Conference Tab, select the top level folder (top folder 5 in DomainA) in which the user is an administrator of, create and modify sub-folders.
                login.LoginIConnect(TestuserA6, TestuserA6);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(TopFolderA5 + "/" + SubFolderA5_1_Level2);
                conferencefolders.EditDescription("Description15");
                PageLoadWait.WaitForFrameLoad(20);
                String Newdesc15 = conferencefolders.EditDesc_CurrentDesc().Text;
                conferencefolders.CreateSubFolder(TopFolderA5, "Sub15");
                PageLoadWait.WaitForFrameLoad(10);
                if (Newdesc15.Equals("Description15") && conferencefolders.ActiveLastsib().Text.Equals("Sub15"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-16:Login as a Domain Admin (e.g. daA in DomainA), navigate to Conference Tab, open Manage Top Level Folder dialog, select a top level folder, search users and attempt to assign a Folder Manager to a user not belonging to the domain admin's domain (e.g. attempt to find a user belongs to DomainC)
                login.LoginIConnect(TestdomainAdminA, TestdomainAdminA);
                conferencefolders = login.Navigate<ConferenceFolders>();
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='divFolderManagement'] input[id='ConferenceFolderManagementControl_AddFolderButton']")));

                bool Foldermanager16 = conferencefolders.AddFolderManager(TopFolderA4, TestuserC2);
                if (!Foldermanager16)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-17:Login as a folder manager (e.g. userA3), go to Conference Tab, open the Manage Top Level Folder dialog, select a top level folder (Adult Bone Marrow Transplant) in which user is a manager, attempt to add a Folder Manage (userA4) to the top level folder.
                login.LoginIConnect(TestuserA3, TestuserA3);
                conferencefolders = login.Navigate<ConferenceFolders>();
                PageLoadWait.WaitForFrameLoad(30);
                bool IsManageTopFolderIconExist = conferencefolders.IsElementVisible(conferencefolders.By_ManageTopLevelFolders());

                if (IsManageTopFolderIconExist == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-18:Login as a Domain Admin (e.g. daC in DomainC), navigate to User Management page, create a group and grouped user (e.g. userC1 in GroupC1 with roleC1).-Navigate to Conference Tab, open Manage Top Level Folder dialog, search and add the grouped user to the exiting Top Level Folder (Cutaneous T-cell Lymphoma) as a folder manager.
                login.LoginIConnect(TestdomainAdminC, TestdomainAdminC);
                usermanagement = login.Navigate<UserManagement>();
                usermanagement.CreateGroup(TestdomainC, TestuserC1, TestuserC1, TestroleC1, "", IsManaged: 1, GroupUser: TestuserC1);
                bool Groupexists = usermanagement.SearchGroup(TestuserC1, TestdomainC, 0);
                conferencefolders = login.Navigate<ConferenceFolders>();
                PageLoadWait.WaitForFrameLoad(30);
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.ManageTopLevelFolders()));
                conferencefolders.ManageTopLevelFolders().Click();
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='divFolderManagement'] input[id='ConferenceFolderManagementControl_AddFolderButton']")));
                bool Foldermanager18 = conferencefolders.AddFolderManager(TopFolderC3, TestuserC1);
                conferencefolders.SaveFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("form[name='form1'] div [id='ConferenceFolderManagementDialogDiv']")));
                PageLoadWait.WaitForFrameLoad(10);
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector("div[id='ConferenceFolderConfigurationMsgDialogDiv']")));
                conferencefolders.ManageFolderOkBtn().Click();
                if (Foldermanager18 && Groupexists)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19:Add a new Top Level Folder, without define a Folder Manager, e.g.-Folder Name Head and Neck;-Folder Description Folder Description - Head&Neck in DomainC
                conferencefolders.CreateToplevelFolder(TopFolderC1);
                conferencefolders.ExpandAndSelectFolder(TopFolderC1);
                conferencefolders.EditDescription(Desc_TopFolderC1);
                PageLoadWait.WaitForFrameLoad(20);
                String Newdesc19 = conferencefolders.EditDesc_CurrentDesc().Text;
                if (Newdesc19.Equals(Desc_TopFolderC1))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-20:Login iCA as the folder manger (userC1, the grouped user), select a top level fold the user is an administrator of (Cutaneous T-cell Lymphoma), modify sub-folder name and description.
                login.LoginIConnect(TestuserC1, TestuserC1);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.RenameFolder(TopFolderC3 + "/" + SubFolderC3_1_Level2, "NewName20");
                conferencefolders.EditDescription("Description20");
                PageLoadWait.WaitForFrameLoad(20);
                String Newdesc20 = conferencefolders.EditDesc_CurrentDesc().Text;
                if (Newdesc20.Equals("Description20") && conferencefolders.ActiveFolder().Text.Equals("NewName20"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-21:Select a top level folder (Head and Neck) in which the Folder Manager (userC1) is not an administrator of, attempt to create a sub-folder and EDIT folder description.
                conferencefolders.ExpandAndSelectFolder(TopFolderC1);
                bool createfolder = conferencefolders.CreateFolderButton().Enabled;

                if (!createfolder && conferencefolders.EditDesc_Button().Displayed == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - View and Remove Folder Managers from Top Level Folder
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_94437(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferenceFolders;

            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;
            try
            {
                //Fetch required Test data
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;

                //Domains
                String DomainA = "DomainA_94437_" + new Random().Next(1, 1000);
                String DomainC = "DomainC_94437_" + new Random().Next(1, 1000);

                //Domain Admin
                String daA = "daA_94437_" + new Random().Next(1, 1000);
                String daC = "daC_94437_" + new Random().Next(1, 1000);

                //Roles                                
                String roleA1 = "roleA1_94437_" + new Random().Next(1, 1000);
                String roleA2 = "roleA2_94437_" + new Random().Next(1, 1000);
                String roleC1 = "roleC1_94437_" + new Random().Next(1, 1000);
                String roleC2 = "roleC2_94437_" + new Random().Next(1, 1000);

                //Users
                String userA1 = "userA1_94437_" + new Random().Next(1, 1000);
                String userA2 = "userA2_94437_" + new Random().Next(1, 1000);
                String userA3 = "userA3_94437_" + new Random().Next(1, 1000);
                String userA4 = "userA4_94437_" + new Random().Next(1, 1000);
                String userA5 = "userA5_94437_" + new Random().Next(1, 1000);
                String userA6 = "userA6_94437_" + new Random().Next(1, 1000);
                String userC1 = "userC1_94437_" + new Random().Next(1, 1000);
                String userC2 = "userC2_94437_" + new Random().Next(1, 1000);
                String userC3 = "userC3_94437_" + new Random().Next(1, 1000);
                String userC4 = "userC4_94437_" + new Random().Next(1, 1000);

                //Group
                String groupC1 = "group1_94437_" + new Random().Next(1, 1000);
                String groupC3 = "group3_94437_" + new Random().Next(1, 1000);

                //Folders
                String TopFolderA1 = "Adult Bone Marrow Transplant_94437_" + new Random().Next(1, 1000); ;
                String TopFolderA2 = "Brain Tumor (Neurologic Oncology)_94437_" + new Random().Next(1, 1000); ;
                String TopFolderA3 = "TopFolderA3_94437_" + new Random().Next(1, 1000);
                String TopFolderA4 = "TopFolder4_94437_" + new Random().Next(1, 1000);
                String TopFolderA5 = "TopFolder5_94437_" + new Random().Next(1, 1000);

                String TopFolderC1 = "Cutaneous T-cell Lymphoma_94437_" + new Random().Next(1, 1000);
                String TopFolderC2 = "Head and Neck_94437_" + new Random().Next(1, 1000);

                String SubFolderA1_1_Level2 = "October06_94437_" + new Random().Next(1, 1000);
                String SubFolderA1_2_Level2 = "October13_94437_" + new Random().Next(1, 1000);
                String SubFolderA1_3_Level2 = "October20_94437_" + new Random().Next(1, 1000);
                String SubFolderA1_1_Level3 = "Level3_94437_" + new Random().Next(1, 1000);

                String SubFolderA4_1_Level2 = "A4Level2_94437_" + new Random().Next(1, 1000);
                String SubFolderA5_1_Level2 = "A5Level2_94437_" + new Random().Next(1, 1000);              

                //Step 1 - Precondition
                Executedsteps++;

                //Step 2 - Precondition
                login.LoginIConnect(adminUserName, adminPassword);

                //2.1 DomainA - Conference Lists enabled, DomainC - Conference Lists enabled
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                if (!domainmanagement.IsDomainExist(DomainA)) domainmanagement.CreateConfUsrDomain(DomainA);
                else domainmanagement.SetConfListFeatureForDomain(DomainC);
                if (!domainmanagement.IsDomainExist(DomainC)) domainmanagement.CreateConfUsrDomain(DomainC);
                else domainmanagement.SetConfListFeatureForDomain(DomainC);

                bool bDomainA = domainmanagement.IsDomainExist(DomainA);
                bool bDomainC = domainmanagement.IsDomainExist(DomainC);

                //2.2 - daA - Conference User enabled, daC - Conference User enabled
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(daA, DomainA)) usermanagement.CreateDomainAdminUser(daA, DomainA, 0, "", 0, "", 1);
                if (!usermanagement.SearchUser(daC, DomainC)) usermanagement.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);

                bool bdaA = usermanagement.SearchUser(daA, DomainA);
                bool bdaC = usermanagement.SearchUser(daC, DomainC);

                //2.3 - roleA1 - Conference User enabled, roleA2 - Conference User DISABLED, 
                //      roleC1 - Conference User enabled, roleC2 - Conference User enabled
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                if (!rolemanagement.RoleExists(roleA1, DomainA)) rolemanagement.CreateConfListRole(DomainA, roleA1);
                if (!rolemanagement.RoleExists(roleA2, DomainA)) { rolemanagement.ClickNewRoleBtn(); rolemanagement.CreateRole(DomainA, roleA2); }
                if (!rolemanagement.RoleExists(roleC1, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC1);
                if (!rolemanagement.RoleExists(roleC2, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC2);

                bool broleA1 = rolemanagement.RoleExists(roleA1, DomainA);
                bool broleA2 = rolemanagement.RoleExists(roleA2, DomainA);
                bool broleC1 = rolemanagement.RoleExists(roleC1, DomainC);
                bool broleC2 = rolemanagement.RoleExists(roleC2, DomainC);

                ////2.4 - userA1, userA3, userA5 - Folder Manager
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userA1, DomainA)) usermanagement.CreateUser(userA1, DomainA, roleA1); //Folder Manager
                if (!usermanagement.SearchUser(userA3, DomainA)) usermanagement.CreateUser(userA3, DomainA, roleA1); //Folder Manager
                if (!usermanagement.SearchUser(userA5, DomainA)) usermanagement.CreateUser(userA5, DomainA, roleA1); //Folder Manager
                if (!usermanagement.SearchUser(userA2, DomainA)) usermanagement.CreateUser(userA2, DomainA, roleA2);
                if (!usermanagement.SearchUser(userA4, DomainA)) usermanagement.CreateUser(userA4, DomainA, roleA2);
                if (!usermanagement.SearchUser(userA6, DomainA)) usermanagement.CreateUser(userA6, DomainA, roleA2);
                if (!usermanagement.SearchUser(userC2, DomainC)) usermanagement.CreateUser(userC2, DomainC, roleC2);
                if (!usermanagement.SearchGroup(groupC1, DomainC, 0))
                    usermanagement.CreateGroup(DomainC, groupC1, groupC1, roleC2, "", userC1, 1, GroupUser: userC1);

                if (bDomainA && bDomainC && bdaA && bdaC && broleA1 && broleA2 && broleC1 && broleC2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 3 - Create Top Level Folders, Sub-Folders and Level3 Sub-Folders (if not done yet) ---- in DomainA
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conferenceFolders.CreateToplevelFolder(TopFolderA1, userA1 + "-" + userA3, DomainA);
                conferenceFolders.CreateToplevelFolder(TopFolderA2, userA4, DomainA);
                conferenceFolders.CreateToplevelFolder(TopFolderA4, userA2 + "-" + userA5, DomainA);
                conferenceFolders.CreateToplevelFolder(TopFolderA5, userA1 + "-" + userA6, DomainA);

                conferenceFolders.CreateToplevelFolder(TopFolderC1, userC1, DomainC);
                conferenceFolders.CreateToplevelFolder(TopFolderC2, null, DomainC);
                login.Logout();

                Executedsteps++;

                //Step 4
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainA);
                conferenceFolders.OpenManageTopLevelFolder();
                if (IsElementPresent(conferenceFolders.By_FolderConfigurationdiv()))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA1);
                conferenceFolders.SwitchtoConferenceFrame();
                wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#divFolderManagers div:nth-child(1)")));
                if (IsElementPresent(conferenceFolders.By_FolderManager(userA1)) &&
                    IsElementPresent(conferenceFolders.By_FolderManager(userA3)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6
                conferenceFolders.RemoveFolderManager(TopFolderA1, userA1);
                if (!IsElementPresent(conferenceFolders.By_FolderManager(userA1)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("#ConferenceFolderManagementControl_Save")));
                conferenceFolders.SaveTopLevelfolder();

                //Step 7
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders.OpenManageTopLevelFolder();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA1);
                if (!IsElementPresent(conferenceFolders.By_FolderManager(userA1)) &&
                     IsElementPresent(conferenceFolders.By_FolderManager(userA3)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA5);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userA1)) &&
                    IsElementPresent(conferenceFolders.By_FolderManager(userA6)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferenceFolders.CloseManageTopLevelFolder();

                //Step 9
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                conferenceFolders.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);                
                BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count > 0);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userC1)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10                
                conferenceFolders.FolderManager(userC1).Click();
                conferenceFolders.DeleteFolderManagerBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.FolderManagerOKBtn()));
                conferenceFolders.FolderManagerOKBtn().Click();
                if (!IsElementPresent(conferenceFolders.By_FolderManager(userC1)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferenceFolders.SaveTopLevelfolder();
                login.Logout();

                //Step 11
                login.LoginIConnect(daA, daA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.OpenManageTopLevelFolder();
                if (IsElementPresent(conferenceFolders.By_FolderConfigurationdiv()))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA2);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userA4)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13
                conferenceFolders.FolderManager(userA4).Click();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.DeleteFolderManagerBtn()));
                conferenceFolders.DeleteFolderManagerBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.FolderManagerOKBtn()));
                conferenceFolders.FolderManagerOKBtn().Click();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA2);
                conferenceFolders.AddFolderManager(TopFolderA2, userA2);
                if (!IsElementPresent(conferenceFolders.By_FolderManager(userA4)) &&
                    IsElementPresent(conferenceFolders.By_FolderManager(userA2)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14                
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA4);
                BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count > 0);
                conferenceFolders.FolderManager(userA2).Click();
                conferenceFolders.DeleteFolderManagerBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.FolderManagerOKBtn()));
                conferenceFolders.FolderManagerOKBtn().Click();
                if (!IsElementPresent(conferenceFolders.By_FolderManager(userA2)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15                
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA2);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userA2)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.SaveFolderBtn()));
                conferenceFolders.SaveTopLevelfolder();
                login.Logout();

                //Step 16                
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderA5);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(conferenceFolders.By_CreateFolderButton()));
                bool IsSubFolderEnabledForA5 = conferenceFolders.CreateFolderButton().Enabled;
                login.Logout();

                login.LoginIConnect(userA2, userA2);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderA2);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(conferenceFolders.By_CreateFolderButton()));
                bool IsSubFolderEnabledForA2 = conferenceFolders.CreateFolderButton().Enabled;
                login.Logout();

                if (IsSubFolderEnabledForA5 && IsSubFolderEnabledForA2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17                
                login.LoginIConnect(userA1, userA1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderA1);
                bool IsSubFolderEnabledForA1 = conferenceFolders.CreateFolderButton().GetAttribute("class").Contains("disabled");
                login.Logout();

                login.LoginIConnect(userA2, userA2);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderA4);
                bool IsSubFolderEnabledForA4 = conferenceFolders.CreateFolderButton().GetAttribute("class").Contains("disabled");
                login.Logout();

                if (!IsSubFolderEnabledForA1 && !IsSubFolderEnabledForA4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 18
                login.LoginIConnect(userA4, userA4);
                if (!login.IsTabPresent("Conference Folders"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 19
                login.LoginIConnect(daA, daA);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (usermanagement.SearchUser(userA5))
                {
                    usermanagement.SelectUser(userA5);
                    usermanagement.ClickButtonInUser("delete");
                    wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("#ctl00_ConfirmButton")));
                    Driver.FindElement(By.CssSelector("#ctl00_ConfirmButton")).Click();
                }
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.OpenManageTopLevelFolder();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderA4);
                BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count > 0);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userA5)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 20
                login.LoginIConnect(daC, daC);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchGroup(groupC3, DomainC, 0))
                    usermanagement.CreateGroup(DomainC, groupC3, groupC3, roleC1, "", userC3, 1);
                if (!usermanagement.SearchUser(userC4, DomainC)) usermanagement.CreateUser(userC4, DomainC, roleC2);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.OpenManageTopLevelFolder();
                if (IsElementPresent(conferenceFolders.By_FolderConfigurationdiv()))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);
                new Actions(BasePage.Driver).Click(conferenceFolders.FolderManagerTextBox()).SendKeys("user").Build().Perform();
                PageLoadWait.WaitForFrameLoad(30);
                PageLoadWait.WaitForSuggestionToLoad();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.FolderManager_Suggestion()));

                String[] list1 = new String[] { userC1, userC2, userC3, userC4 };
                String[] list2 = new String[conferenceFolders.AutoCompleteDiv().Count];

                int counter = 0;
                foreach (IWebElement FManager in conferenceFolders.AutoCompleteDiv())
                {
                    string[] FManagerArr = FManager.Text.Split(' ');
                    list2[counter++] = FManagerArr[0];
                }

                if (list1.SequenceEqual(list2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 22
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders.AddFolderManager(TopFolderC1, userC1);
                conferenceFolders.AddFolderManager(TopFolderC1, userC2);
                conferenceFolders.SaveTopLevelfolder();
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders.OpenManageTopLevelFolder();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);
                BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count > 0);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userC1)) &&
                    IsElementPresent(conferenceFolders.By_FolderManager(userC2)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 23
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);
                conferenceFolders.RemoveFolderManager(TopFolderC1, userC1);
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);
                BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count > 0);
                conferenceFolders.RemoveFolderManager(TopFolderC1, userC2);
                conferenceFolders.SwitchtoConferenceFrame();
                conferenceFolders.AddFolderManager(TopFolderC1, userC3);
                conferenceFolders.AddFolderManager(TopFolderC1, userC4);
                conferenceFolders.SaveTopLevelfolder();
                conferenceFolders.OpenManageTopLevelFolder();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userC3)) &&
                    IsElementPresent(conferenceFolders.By_FolderManager(userC4)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 24
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC2);
                if (BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count == 0))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 25                
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC2); //remove
                conferenceFolders.AddFolderManager(TopFolderC2, userC1);
                PageLoadWait.WaitForFrameLoad(10);
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.TopLevelFolderCancelButton()));
                conferenceFolders.TopLevelFolderCancelButton().Click();
                conferenceFolders.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(10);
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC2);
                //Thread.Sleep(5000);
                if (BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count == 0))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 26
                login.LoginIConnect(userC2, userC2);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderC1);
                if (!IsElementVisible(By.CssSelector("input#CreateFolderButton")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 27
                login.LoginIConnect(userC4, userC4);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                PageLoadWait.WaitForFrameLoad(10);
                conferenceFolders.ExpandAndSelectFolder(TopFolderC1);
                if (conferenceFolders.CreateFolderButton().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 28
                login.LoginIConnect(daC, daC);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (usermanagement.IsGroupExist(groupC3))
                {
                    usermanagement.SelectGroupByName(groupC3);
                    PageLoadWait.WaitForFrameLoad(10);
                    BasePage.Driver.FindElement(By.CssSelector("#DeleteGroupButton")).Click();
                    BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                    //wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("#ctl00_ConfirmButton")));
                    Driver.FindElement(By.CssSelector("#ctl00_ConfirmButton")).Click();
                }
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.OpenManageTopLevelFolder();
                conferenceFolders.SelectTopFolderInConfigDiv(TopFolderC1);
                BasePage.wait.Until<Boolean>(d => d.FindElements(By.CssSelector("div.dialogRoundedConferenceInnerDiv div#divFolderManagers div")).Count > 0);
                if (IsElementPresent(conferenceFolders.By_FolderManager(userC3)) &&
                    IsElementPresent(conferenceFolders.By_FolderManager(userC4)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                Logger.Instance.InfoLog("Executed Steps" + Executedsteps);
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Viewing conference study is not limited by role access filters (desktop)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_99158(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = new Taskbar();
            ServiceTool servicetool = new ServiceTool();
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            Studies studies;
            StudyViewer studyViewer;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String DatasourceList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                String[] Datasource = DatasourceList.Split(':');
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String RefPhysician = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RefPhysician");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] PatientID = PatientIDList.Split(':');
                String PatientName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String IPID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "IPID");
                String ReadingPhysician = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "ReadingPhysician");

                //DomainA
                String TestdomainA = "Test58_DomainA" + new Random().Next(1, 1000);
                String TestdomainAdminA = "Test58_DomainAdminA" + new Random().Next(1, 1000);
                String TestroleA1 = "Test58_Role1A" + new Random().Next(1, 1000);
                String TestuserA1 = RefPhysician + new Random().Next(1, 1000);

                //FolderNames for DomainA
                //Set1:
                String topfoldername = "Top" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername = "Sub" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String folderpath = topfoldername + "/" + subfoldername;

                //Step 1 - Pre-conditions
                taskbar.Hide();
                servicetool.LaunchServiceTool();
                servicetool.RemoveDataSourceExcludedAttributes(Datasource[1]);
                servicetool.CloseServiceTool();
                taskbar.Show();

                Executedsteps++;

                //Step 2 - Pre-conditions
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.CreateDomain(TestdomainA, TestdomainAdminA, Datasource);
                domainmanagement.ClickSaveNewDomain();
                domainmanagement.SearchDomain(TestdomainA);
                if (domainmanagement.DomainExists(TestdomainA) == true)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                    throw new Exception("New Domain does not exist");
                }

                //Step 3 - Pre-conditions
                Executedsteps++;

                //Step 4 - Create a new role and user and add role access filter
                login.Logout();

                login.LoginIConnect(TestdomainA, TestdomainA);
                domainmanagement = login.Navigate<DomainManagement>();
                PageLoadWait.WaitForFrameLoad(5);
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool step4_1 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();

                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(TestdomainA, TestroleA1, "any", domainadmin: true);
                bool role1 = rolemanagement.RoleExists(TestroleA1);
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.AddFilterinRole("Referring Physician", RefPhysician);

                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool step4_2 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                usermanagement = login.Navigate<UserManagement>();
                usermanagement.CreateUser(TestuserA1, TestdomainA, TestroleA1);
                bool userA1 = usermanagement.SearchUser(TestuserA1, TestdomainA);
                if (step4_1 && role1 && step4_2 && userA1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5 - Add folder in conference tab. Add study notes
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.CreateToplevelFolder(topfoldername); //First Top Folder
                conferencefolders.CreateSubFolder(topfoldername, subfoldername);

                studies = login.Navigate<Studies>();
                studies.SelectAllDateAndData();
                studies.SearchStudy("Accession", Accession[1]);
                studies.SelectStudy("Accession", Accession[1]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath, notes: "Step5_Test");
                studyViewer.CloseStudy();
                Executedsteps++;

                //Step 6 - Add one of related study which is permit to the user
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath, notes: "Step6_Test");
                studyViewer.CloseStudy();
                Executedsteps++;

                //Step 7 - Login as the newly created conference user, navigate to the Studies tab, search all studies.
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SelectAllDateAndData();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                bool isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));

                string[] step7 = studies.GetStudyDetails("Refer. Physician");
                bool step7result = (step7 == null || step7.Length == 0) ? false : step7.Where(q => q.ToLower().Contains(RefPhysician.ToLower())).Count() == step7.Length;
                if (isscrollbar && step7result)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8 - Navigate to the Conference Folders tab, from folder browser select the folder that has conference studies and notes added by the domain admin.
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);
                Executedsteps++;

                //Step 9 -  Select each of studies that are not permitted in the role access filter, load these conference studies into study viewer and review conference study notes in History fly-out.
                conferencefolders.SelectStudy("Accession", Accession[1]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step9_1 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step9_2 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step9_3 = studyViewer.StudyNotesSection().Text.Equals("Step5_Test");
                login.CloseHistoryPanel();
                studies.CloseStudy();

                if (step9_1 && step9_2 && step9_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10 - Select the added related study which the user is permitted in role access filter, load the related study from the Conference Folders tab, open History fly-out once the study is loaded.
                conferencefolders.SelectStudy("Accession", Accession[0]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step10_1 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step10_2 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step10_3 = studyViewer.StudyNotesSection().Text.Equals("Step6_Test");

                if (step10_1 && step10_2 && step10_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11 - Load the other related study which is not a conference study.
                studyViewer.DoubleClick(studyViewer.Study(2));
                if (studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12 - Pre-conditions
                studies.CloseStudy();
                login.Logout();
                Executedsteps++;

                //Step 13 - Login as the domain  admin (da), navigate to the Role Management tab, change the user role access filter to use Accession Number
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.RemoveAccessFilter();
                rolemanagement.AddFilterinRole("Accession Number", Accession[2]);
                PageLoadWait.WaitForFrameLoad(5);
                bool step13 = rolemanagement.AccessFilterElement(1).Displayed;
                rolemanagement.ClickSaveEditRole();
                if (step13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14 - Navigate to the Studies tab, add one the related study, that is not accessible to the user, to the same sub-folder
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accession[3]);
                studies.SelectStudy("Accession", Accession[3]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath, notes: "Step14_Test");
                studyViewer.CloseStudy();

                Executedsteps++;

                //Step 15 - Login as the newly created conference user, navigate to the Studies tab, search all studies.
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                string[] step15 = studies.GetStudyDetails("Accession");
                isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));
                bool step15result = (step15 == null || step15.Length == 0) ? false : step15.Where(q => q.ToLower().Contains(Accession[2].ToLower())).Count() == step15.Length;
                if (isscrollbar && step15result)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 16 - Navigate to the Conference Folders tab, from the study folder select each study that are not outside the role access filter, load these conference studies
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);

                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step16 = studyViewer.SeriesViewer_1X1().Displayed;

                if (step16)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                studies.CloseStudy();

                //Step 17 - Select the added related study which is NOT permitted in role access filter, load the related study from the Conference Folders tab, open History fly-out once the study is loaded
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step17_1 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step17_2 = studyViewer.StudylistInHistoryPanel().Count == 2;
                bool step17_3 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step17_4 = studyViewer.StudyNotesSection().Text.Equals("Step14_Test");

                if (step17_1 && step17_2 && step17_3 && step17_4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 18 - Load the related study which is not a conference study.
                studyViewer.DoubleClick(studyViewer.Study(1));
                if (studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 19 - Pre-conditions
                login.CloseHistoryPanel();
                studies.CloseStudy();
                login.Logout();
                Executedsteps++;

                //Step 20 - navigate to the Role Management tab, change the user role access filter to use Patient ID 
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.RemoveAccessFilter();
                rolemanagement.AddFilterinRole("Patient ID", PatientID[0]);
                PageLoadWait.WaitForFrameLoad(5);
                bool step20 = rolemanagement.AccessFilterElement(1).Displayed;
                rolemanagement.ClickSaveEditRole();
                if (step20)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21 - Login as the newly created conference user, navigate to the Studies tab, search all studies.
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                string[] step21 = studies.GetStudyDetails("Patient ID");
                isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));
                bool step21result = (step21 == null || step21.Length == 0) ? false : step21.Where(q => q.ToLower().Contains(PatientID[0].ToLower())).Count() == step21.Length;
                if (isscrollbar && step15result)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 22 - Navigate to the Conference Folders tab, from the study folder select each study that are not outside the role access filter, load these conference studies
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step22 = studyViewer.SeriesViewer_1X1().Displayed;

                if (step22)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                studies.CloseStudy();

                //Step 23 - Select the added related study which is NOT permitted in role access filter, load the related study from the Conference Folders tab, open History fly-out once the study is loaded
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step23_1 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step23_2 = studyViewer.StudylistInHistoryPanel().Count == 2;
                bool step23_3 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step23_4 = studyViewer.StudyNotesSection().Text.Equals("Step14_Test");

                if (step23_1 && step23_2 && step23_3 && step23_4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 24 - Load the related study which is not a conference study.
                studyViewer.DoubleClick(studyViewer.Study(2));
                if (studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 25 - Login as the domain admin (da), navigate to the Role Management tab, add the Patient ID-- 1001580391 to the role access filter.
                login.CloseHistoryPanel();
                studies.CloseStudy();

                login.Logout();
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.AddFilterinRole("Patient ID", PatientID[1]);
                PageLoadWait.WaitForFrameLoad(5);
                bool step25 = rolemanagement.AccessFilterElement(2).Displayed;
                rolemanagement.ClickSaveEditRole();
                if (step25)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 26 - Login as the newly created conference user, navigate to the Studies tab, search all studies.
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));
                if (isscrollbar)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 27 - Navigate to the Conference Folders tab, from the study folder, select the added related study which is permitted in role access filter, load the related study from the Conference Folders tab, open History fly-out once the study is loaded
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step27_1 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step27_2 = studyViewer.StudylistInHistoryPanel().Count == 2;
                bool step27_3 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step27_4 = studyViewer.StudyNotesSection().Text.Equals("Step14_Test");

                if (step27_1 && step27_2 && step27_3 && step27_4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 28 - Load the related study which is not a conference study.
                studyViewer.DoubleClick(studyViewer.Study(2));
                if (studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 29 - Repeat above step to this time using Patient Name in role access filter.
                login.CloseHistoryPanel();
                studies.CloseStudy();
                login.Logout();
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.RemoveAccessFilter();
                rolemanagement.AddFilterinRole("Patient Name", PatientName);
                PageLoadWait.WaitForFrameLoad(5);
                bool step29_1 = rolemanagement.AccessFilterElement(1).Displayed;
                rolemanagement.ClickSaveEditRole();
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step29_2 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step29_3 = studyViewer.StudylistInHistoryPanel().Count == 2;
                bool step29_4 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step29_5 = studyViewer.StudyNotesSection().Text.Equals("Step14_Test");
                studyViewer.DoubleClick(studyViewer.Study(2));

                if (studyViewer.studyPanel(2).Displayed && step29_1 && step29_2 && step29_3 && step29_4 && step29_5 && isscrollbar)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 30 - Repeat above step to this time using IPID in role access filter.
                login.CloseHistoryPanel();
                studies.CloseStudy();
                login.Logout();
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.RemoveAccessFilter();
                rolemanagement.AddFilterinRole("IPID", IPID);
                PageLoadWait.WaitForFrameLoad(5);
                bool step30_1 = rolemanagement.AccessFilterElement(1).Displayed;
                rolemanagement.ClickSaveEditRole();
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                bool count = BasePage.GetSearchResults().Count > 0;
                isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step30_2 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step30_3 = studyViewer.StudylistInHistoryPanel().Count > 1;
                bool step30_4 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step30_5 = studyViewer.StudyNotesSection().Text.Equals("Step14_Test");
                studyViewer.DoubleClick(studyViewer.Study(2));

                if (count && studyViewer.studyPanel(2).Displayed && step30_1 && step30_2 && step30_3 && step30_4 && step30_5 && isscrollbar)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 31 - Repeat above step to this time using Reading Physician in role access filter.
                //Executedsteps++;
                login.CloseHistoryPanel();
                studies.CloseStudy();
                login.Logout();
                login.LoginIConnect(TestdomainA, TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                rolemanagement.RemoveAccessFilter();
                rolemanagement.AddFilterinRole("Reading Physician", ReadingPhysician);
                PageLoadWait.WaitForFrameLoad(5);
                bool step31_1 = rolemanagement.AccessFilterElement(1).Displayed;
                rolemanagement.ClickSaveEditRole();
                login.Logout();
                login.LoginIConnect(TestuserA1, TestuserA1);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("last", "*");
                PageLoadWait.WaitForLoadingMessage(30);
                count = BasePage.GetSearchResults().Count > 0;
                isscrollbar = !studies.IsVerticalScrollBarPresent(BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList > div.ui-jqgrid-bdiv")));
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(folderpath);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step31_2 = studyViewer.SeriesViewer_1X1().Displayed;

                login.NavigateToHistoryPanel();
                bool step31_3 = studyViewer.StudylistInHistoryPanel().Count > 1;
                bool step31_4 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step31_5 = studyViewer.StudyNotesSection().Text.Equals("Step14_Test");
                studyViewer.DoubleClick(studyViewer.Study(2));

                if (count && studyViewer.studyPanel(2).Displayed && step31_1 && step31_2 && step31_3 && step31_4 && step31_5 && isscrollbar)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Conference Tab reads and updates the Active Folder when initializing folder browser
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_98607(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domain;
            RoleManagement role;
            UserManagement user;
            Studies study;
            Patients patient;
            Inbounds inbounds;
            Outbounds outbounds;
            ConferenceFolders conference;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;


            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                string EA_91 = "VMSSA-5-38-91";
                string EA_131 = "VMSSA-4-38-131";

                String[] datasource = null;

                //String Dest1 = Config.Dest1;
                //String EIPath = Config.EIFilePath;

                String PatientNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] PatientName = PatientNameList.Split(':');

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');



                //Step-1:[Pre-conditions-]

                //1. iCA build under testing is installed on the iCA server.
                //2. Image Sharing, XDS are configured on the iCA sever 
                //3. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool
                //\Enable Features tab\General sub tab on iCA server under testing  
                //4. Domains, Role, Folder Manager, Conference user, non-conference user 
                //and Conference Folders, Study Folders are available for the test.


                taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();

                //**##- uncomment
                //servicetool.LaunchServiceTool();
                //servicetool.NavigateToEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.ModifyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.EnableConferenceLists(0);
                //wpfobject.WaitTillLoad();
                //servicetool.ApplyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //wpfobject.ClickOkPopUp();
                //wpfobject.WaitTillLoad();
                //servicetool.RestartService();
                //wpfobject.WaitTillLoad();
                //servicetool.CloseServiceTool();
                taskbar.Show();



                //Enable ConferenceLists Check Box in Super Admin Domain
                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();

                if (domain.ConferenceListsCB().Selected == false)
                {
                    domain.ConferenceListsCB().Click();
                    Logger.Instance.InfoLog("ConferenceLists Check Box Selected successfully");
                }
                else
                {
                    Logger.Instance.InfoLog("ConferenceLists Check Box already selected");
                }
                domain.ClickSaveNewDomain();
                login.Logout();

                //Define domains, roles, users and Conference User settings (if have not done yet)
                //Domain-  DomainA (Conference User enabled) -Domain Admin-  daA (Conference User enabled) 
                //Role-  roleA1 (Conference User enabled) 
                //User in roleA1-  userA1 (Folder Manager); userA3 (conference user); 
                //Role-  roleA2 (Conference User disabled)
                //User in roleA2-  userA2 (non-conference user, Folder Manager); userA4 (non-conference user)


                String DomainA = "DomainA_98607_" + new Random().Next(1000);
                String daA = "daA_98607_" + new Random().Next(1000);
                String userA1 = "userA1_98607_" + new Random().Next(1000);//Folder Manager
                String userA3 = "userA3_98607_" + new Random().Next(1000);//conference user

                String roleA1 = "roleA1_98607_" + new Random().Next(1000);
                String roleA2 = "roleA2_98607_" + new Random().Next(1000);

                String TopFolder_6 = "top folder 6 in DomainA_98607_" + new Random().Next(1000);
                String TopFolder_7 = "top folder 7 in DomainA_98607_" + new Random().Next(1000);
                String TopFolder_8 = "top folder 8 in DomainA_98607_" + new Random().Next(1000);
                String TopFolder_9 = "top folder 9 in DomainA_98607_" + new Random().Next(1000);

                String level2 = "level2_98607_" + new Random().Next(1000);
                String level3 = "level3_98607_" + new Random().Next(1000);
                String level4 = "level4_98607_" + new Random().Next(1000);
                String level5 = "level5_98607_" + new Random().Next(1000);
                String level6 = "level6_98607_" + new Random().Next(1000);
                String level7 = "level7_98607_" + new Random().Next(1000);
                String level8 = "level8_98607_" + new Random().Next(1000);
                String level9 = "level9_98607_" + new Random().Next(1000);
                String level10 = "level10_98607_" + new Random().Next(1000);

                String TopFolder_6_notes = "Top 6 notes text 6 _98607_" + new Random().Next(1000);
                String TopFolder_7_notes = "Notes for top 7 _98607_" + new Random().Next(1000);



                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainA, DomainA, datasources: datasource);
                //Enable conference list and grant access check box
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.ClickSaveNewDomain();

                user = (UserManagement)login.Navigate("UserManagement");
                user.NewDomainAdminBtn().Click();
                PageLoadWait.WaitForPageLoad(20);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                user.DomainAdmin_DomainName_Dropdown().SelectByText(DomainA);
                PageLoadWait.WaitForPageLoad(20);
                user.UserIdTxtBox().SendKeys(daA);
                user.LastNameTxtBox().SendKeys(daA);
                user.FirstNameTxtBox().SendKeys(daA);
                user.PasswordTxtBox().SendKeys(daA);
                user.ConfirmPwdTxtBox().SendKeys(daA);
                //Enable Conference List
                user.ConferenceUserCB().Click();
                user.SaveBtn().Click();
                PageLoadWait.WaitForPageLoad(20);

                //roleA1 (Conference User enabled) 

                role = (RoleManagement)login.Navigate("RoleManagement");
                role.CreateRole(DomainA, roleA1, "physician=conference"); //Inbounds and Outbounds

                //Users in roleA1 

                user = (UserManagement)login.Navigate("UserManagement");
                user.CreateUser(userA1, DomainA, roleA1);//Folder Manager
                user.CreateUser(userA3, DomainA, roleA1);//Conference User

                //roleA2: (Conference User disabled) 

                role = (RoleManagement)login.Navigate("RoleManagement");
                role.CreateRole(DomainA, roleA2, "any");

                user = (UserManagement)login.Navigate("UserManagement");

                bool uA1 = user.SearchUser(userA1, DomainA);
                bool uA3 = user.SearchUser(userA3, DomainA);

                login.Logout();

                //--move study to outbounds of userA1 ---

                login.DriverGoTo(login.url);
                login.LoginIConnect(userA1, userA1);
                study = (Studies)login.Navigate("Studies");
                //Accession[0] ="U-ID179490"
                study.SearchStudy(AccessionNo: Accession[0], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[0]);
                study.ShareStudy(false, new String[] { userA3 });
                login.Logout();

                //--move study to inbounds of userA1 ---
                login.DriverGoTo(login.url);
                login.LoginIConnect(userA3, userA3);
                study = (Studies)login.Navigate("Studies");
                //Accession[1] ="1211824"
                study.SearchStudy(AccessionNo: Accession[1], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[1]);
                study.ShareStudy(false, new String[] { userA1 });
                login.Logout();

                if (uA1 && uA3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();


                //Step-2
                //Pre-conditions- 
                //Prepare Conference Folders if they are not available in domain(s)
                //1. Multiple top level conference folders and scroll bar in the Folder Browser are available
                //2. Conference studies with and without notes are stored under in multiple level sub-folders
                //(e.g. top level\level2  top level\level2\level3,  top level\level2\level3\level4,   
                //top level\level2\level3\...\level10\..etc..)  
                //3. Conference Folders do not contain any conference study (non Study Folders) 
                //4. Conference Folders contains sub-folders with mixed of Study Folders and non Study Folders

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");

                conference.CreateToplevelFolder(TopFolder_6, userA1, domain: DomainA);
                conference.CreateToplevelFolder(TopFolder_7, userA1, domain: DomainA);
                conference.CreateToplevelFolder(TopFolder_8, userA1, domain: DomainA);
                conference.CreateToplevelFolder(TopFolder_9, userA1, domain: DomainA);


                bool step2_1 = conference.CreateSubFolder(TopFolder_6, level2, Domain_Name: DomainA);

                bool step2_2 = conference.CreateSubFolder(TopFolder_7, level2, Domain_Name: DomainA);
                bool step2_3 = conference.CreateSubFolder(TopFolder_7 + "/" + level2, level3, Domain_Name: DomainA);

                bool step2_4 = conference.CreateSubFolder(TopFolder_8, level2, Domain_Name: DomainA);
                bool step2_5 = conference.CreateSubFolder(TopFolder_8 + "/" + level2, level3, Domain_Name: DomainA);
                bool step2_6 = conference.CreateSubFolder(TopFolder_8 + "/" + level2 + "/" + level3, level4, Domain_Name: DomainA);

                bool step2_7 = conference.CreateSubFolder(TopFolder_9, level2, Domain_Name: DomainA);
                bool step2_8 = conference.CreateSubFolder(TopFolder_9 + "/" + level2, level3, Domain_Name: DomainA);
                bool step2_9 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3, level4, Domain_Name: DomainA);
                bool step2_10 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4, level5, Domain_Name: DomainA);
                bool step2_11 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5, level6, Domain_Name: DomainA);
                bool step2_12 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6, level7, Domain_Name: DomainA);
                bool step2_13 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6 + "/" + level7, level8, Domain_Name: DomainA);
                bool step2_14 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6 + "/" + level7 + "/" + level8, level9, Domain_Name: DomainA);
                bool step2_15 = conference.CreateSubFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6 + "/" + level7 + "/" + level8 + "/" + level9, level10, Domain_Name: DomainA);

                login.Logout();

                login.DriverGoTo(login.url);
                login.LoginIConnect(DomainA, DomainA);
                //Accession[2]:AA123
                study = (Studies)login.Navigate("Studies");
                study.SearchStudy(AccessionNo: Accession[2], Datasource: EA_131);
                study.SelectStudy("Accession", Accession[2]);
                StudyViewer viewer = StudyViewer.LaunchStudy();

                //Adding the studies to Conference Folder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolder_6 + "/" + level2, notes: TopFolder_6_notes);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolder_7 + "/" + level2 + "/" + level3, notes: TopFolder_7_notes);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolder_8 + "/" + level2 + "/" + level3 + "/" + level4);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6 + "/" + level7 + "/" + level8 + "/" + level9 + "/" + level10);


                if (step2_1 && step2_2 && step2_3 && step2_4 && step2_5 && step2_6 && step2_7 && step2_8
                    && step2_9 && step2_10 && step2_11 && step2_12 && step2_13 && step2_14 && step2_15)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3
                //[Set Active Folder from Conference Folders tab]  
                //Login iCA as a Conference user in a Domain that has Study Folders, 
                //Navigate to the Conference Folders tab.    
                //[Term-  an Active Folder is A reference to the last Folder to be selected 
                //on the Conference tab or the last Folder in which a Conference Study was added.
                //This reference shall be stored in a user&#-3;s session data]

                login.DriverGoTo(login.url);
                login.LoginIConnect(userA3, userA3);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folder tab reads and updates the Active Folder when initializing the folder browser;
                //there is no Active Folder is available.
                if (conference.IsElementPresent(conference.By_ActiveFolder()) == false &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-4
                //Browse and select a Study folder from a top level folder
                conference.ExpandAndSelectFolder(TopFolder_6 + "/" + level2);

                //Expand Folder logic

                int oldSubFolderCount = 0;
                int Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                int Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                int SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                int GrantTotal = Topcount + SubFoldercount;

                oldSubFolderCount = SubFoldercount;


                //When a Folder is selected in the Conference Folder tab\Folder Browser, 
                //the Folder selected is set as the current Active Folder.
                if (conference.ActiveFolder().Text.Equals(level2) &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_6 + " - " + level2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5
                //Load a conference study from the Conference Folders tab; 
                //close the study view back to the Conference Folders tab.

                //Accession[2]=AA123
                conference.SelectStudy("Accession", Accession[2]);
                viewer = conference.LaunchStudy(isConferenceTab: true);

                bool step5_1 = viewer.SeriesViewer_1X1().Displayed;
                conference.CloseStudy();


                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser;
                //the same sub-folder remains as the current Active Folder;
                //the Active Folder is selected with all parent/ancestor Folders expanded

                if (step5_1 && conference.ActiveFolder().Text.Equals(level2) &&
                    Totalcount == conference.VisibleTopAndSubLevelfolders().Count &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_6 + " - " + level2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6
                //From the Folder Browser scroll down to the last top level folder,  
                //select a sub-folder that is not a Study Folder.

                conference.ExpandAndSelectFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6 + "/" + level7 + "/" + level8 + "/" + level9 + "/" + level10);


                Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                GrantTotal = Topcount + SubFoldercount;

                oldSubFolderCount = SubFoldercount;

                //When a Folder is selected in the Conference Folders tab\Folder Browser,
                //the Folder selected is set as the current Active Folder.

                if (conference.ActiveFolder().Text.Equals(level10) &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_9 + " - " + level2 + " - " + level3 + " - " + level4 + " - " + level5 + " - " + level6 + " - " + level7 + " - " + level8 + " - " + level9 + " - " + level10))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7
                //Switch to tabs (Studies, Patients, Inbounds&#-3;), review studies, 
                //close the study view, navigate back to the Conference Folders tab.
                //Accession[0] ="U-ID179490"
                //Accession[3] ="ACC1957"
                //patientName[0]=Adam, PQA

                study = (Studies)login.Navigate("Studies");
                study.SearchStudy(AccessionNo: Accession[0], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[0]);
                viewer = StudyViewer.LaunchStudy();
                bool step7_1 = viewer.SeriesViewer_1X1().Displayed;
                study.CloseStudy();

                patient = (Patients)login.Navigate("Patients");
                patient.InputData(PatientName[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientName[0].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, Accession[3]);
                bool step7_2 = viewer.SeriesViewer_1X1().Displayed;
                viewer.CloseStudy();
                patient.ClosePatientRecord();

                inbounds = (Inbounds)login.Navigate("Inbounds");
                inbounds.SearchStudy(AccessionNo: Accession[0]);
                inbounds.SelectStudy("Accession", Accession[0]);
                viewer = StudyViewer.LaunchStudy();
                bool step7_3 = viewer.SeriesViewer_1X1().Displayed;
                inbounds.CloseStudy();

                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder 
                //when initializing the folder browser;
                //the same sub-folder remains as the current Active Folder,
                //the Active Folder is selected with all parent/ancestor Folders expanded

                //GrantTotal -- logic calculation---*

                if (conference.ActiveFolder().Text.Equals(level10) &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_9 + " - " + level2 + " - " + level3 + " - " + level4 + " - " + level5 + " - " + level6 + " - " + level7 + " - " + level8 + " - " + level9 + " - " + level10) &&
                    conference.VisibleTopAndSubLevelfolders().Count == GrantTotal &&
                    step7_1 && step7_2 && step7_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-8
                //Logout and re-login iCA as the same user, navigate to the Conference Folders tab,
                //verify the availability of Active Folder.

                login.Logout();
                login.LoginIConnect(userA3, userA3);
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser;
                //The Active Folder is valid until the user&#-3;s session ends;
                //(there is no valid Active Folder set for this user)

                if (conference.IsElementPresent(conference.By_ActiveFolder()) == false &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9
                //[Active Folder is set after added a study to a folder]  
                //Select a sub-folder to set an current Active Folder, logout from iCA.
                //Login iCA a conference user, navigate to the Conference Folders tab,
                //verify the availability of Active Folder.

                conference.ExpandAndSelectFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4);

                bool step_9 = conference.ActiveFolder().Text.Equals(level4);

                login.Logout();
                login.LoginIConnect(userA3, userA3); //Conference User
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //The Active Folder is valid until the user&#-3;s session ends; 
                //(there is no valid Active Folder set for this user)

                if (conference.IsElementPresent(conference.By_ActiveFolder()) == false
                    && conference.FolderPathDiv().GetAttribute("innerHTML").Equals("")
                    && step_9)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-10
                //Set an Active Folder and then logout iCA. Login iCA as a Folder Manager,
                //navigate to the Conference Folders tab, verify the availability of Active Folder.
                //Do not set an Active Folder in the Conference Folders tab.

                conference.ExpandAndSelectFolder(TopFolder_9 + "/" + level2);

                bool step_10 = conference.ActiveFolder().Text.Equals(level2);

                login.Logout();
                login.LoginIConnect(userA1, userA1); //Folder Manager
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing
                //the folder browser; there is no current Active Folder set.

                if (conference.IsElementPresent(conference.By_ActiveFolder()) == false && step_10 &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-11
                //Navigate to Studies tab, load a study, add the study to a valid sub-folder
                //that does not contain any sub-folders.
                //Accession[4] ="414953"

                study = (Studies)login.Navigate("Studies");
                study.SearchStudy(AccessionNo: Accession[4], Datasource: EA_131);
                study.SelectStudy("Accession", Accession[4]);
                viewer = StudyViewer.LaunchStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#AddConferenceStudyDialogDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.BrowseBtn()));

                //Adding the study
                viewer.BrowseBtn().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("span > span.fancytree-title")));

                viewer.ExpandAndSelectFolder(TopFolder_9 + "/" + level2 + "/" + level3 + "/" + level4 + "/" + level5 + "/" + level6 + "/" + level7 + "/" + level8 + "/" + level9 + "/" + level10);

                //Counting visible folder
                oldSubFolderCount = 0; //First time it is 0
                Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                GrantTotal = Topcount + SubFoldercount;
                oldSubFolderCount = SubFoldercount;

                viewer.SelectFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.AddBtn()));
                viewer.AddBtn().Click();
                study.CloseStudy();

                //The conference study is added the selected destination folder without error.
                Executedsteps++;

                //Step-12
                //Navigate to the Conference Folders tab, verify the availability of Active Folder.
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();


                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //an Active Folder is set to the selected destination folder when conference study was added. 
                //the Active Folder is selected with all parent/ancestor Folders expanded
                
                Dictionary<string, string> Studylist_1 = conference.GetMatchingRow("Accession", Accession[4]);

                if (Studylist_1 != null && //Validation for Step-11
                    conference.ActiveFolder().Text.Equals(level10) &&
                    conference.VisibleTopAndSubLevelfolders().Count == GrantTotal &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_9 + " - " + level2 + " - " + level3 + " - " + level4 + " - " + level5 + " - " + level6 + " - " + level7 + " - " + level8 + " - " + level9 + " - " + level10))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13
                //Repeat above steps instead this time add a conference study from 
                //a related study view to a different destination folder from study view; 
                //Navigate to the Conference Folders tab, verify the availability of Active Folder.
                //Accession[4] ="414953"

                study = (Studies)login.Navigate("Studies");
                study.SearchStudy(AccessionNo: Accession[4], Datasource: EA_131);
                study.SelectStudy("Accession", Accession[4]);
                viewer = StudyViewer.LaunchStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#AddConferenceStudyDialogDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.BrowseBtn()));


                //Adding the study
                viewer.BrowseBtn().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("span > span.fancytree-title")));

                viewer.ExpandAndSelectFolder(TopFolder_8 + "/" + level2 + "/" + level3 + "/" + level4);

                //Counting visible folder
                //oldSubFolderCount = 0; //First time it is 0
                Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                GrantTotal = Topcount + SubFoldercount;
                oldSubFolderCount = SubFoldercount;

                viewer.SelectFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.AddBtn()));
                viewer.AddBtn().Click();
                study.CloseStudy();

                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //an Active Folder is set to the last destination folder when conference study was added.
                //the Active Folder is selected with all parent/ancestor Folders expanded

                if (conference.ActiveFolder().Text.Equals(level4) &&
                    conference.VisibleTopAndSubLevelfolders().Count == GrantTotal &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_8 + " - " + level2 + " - " + level3 + " - " + level4))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-14

                //Repeat above steps instead this time the study view is launched from Patients tab,
                //add a conference study to a different destination folder from study view;
                //Navigate to the Conference Folders tab, verify the availability of Active Folder.
                //Accession[3] ="ACC1957"
                //patientName[0]=Adam, PQA

                patient = (Patients)login.Navigate("Patients");

                patient.InputData(PatientName[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientName[0].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, Accession[3]);

                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#AddConferenceStudyDialogDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.BrowseBtn()));

                viewer.BrowseBtn().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("span > span.fancytree-title")));

                viewer.ExpandAndSelectFolder(TopFolder_7 + "/" + level2 + "/" + level3);

                //Counting visible folder
                //oldSubFolderCount = 0; //First time it is 0
                Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                GrantTotal = Topcount + SubFoldercount;
                oldSubFolderCount = SubFoldercount;

                viewer.SelectFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.AddBtn()));
                viewer.AddBtn().Click();

                viewer.CloseStudy();
                patient.ClosePatientRecord();

                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //an Active Folder is set to the last destination folder when conference study was added.
                //the Active Folder is selected with all parent/ancestor Folders expanded


                if (conference.ActiveFolder().Text.Equals(level3) &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_7 + " - " + level2 + " - " + level3) &&
                    conference.VisibleTopAndSubLevelfolders().Count == GrantTotal)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-15
                //Repeat above steps instead this time the study view is launched from Inbounds tab,
                //add a conference study to a different destination folder from study view;
                //Navigate to the Conference Folders tab, verify the availability of Active Folder.
                //Accession[1] ="1211824"

                inbounds = (Inbounds)login.Navigate("Inbounds");
                inbounds.SearchStudy(AccessionNo: Accession[1]);
                inbounds.SelectStudy("Accession", Accession[1]);
                viewer = StudyViewer.LaunchStudy();

                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#AddConferenceStudyDialogDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.BrowseBtn()));

                viewer.BrowseBtn().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("span > span.fancytree-title")));

                viewer.ExpandAndSelectFolder(TopFolder_6 + "/" + level2);

                //Counting visible folder
                //oldSubFolderCount = 0; //First time it is 0
                Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                GrantTotal = Topcount + SubFoldercount;
                oldSubFolderCount = SubFoldercount;

                viewer.SelectFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.AddBtn()));
                viewer.AddBtn().Click();

                viewer.CloseStudy();


                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //an Active Folder is set to the last destination folder when conference study was added.
                //the Active Folder is selected with all parent/ancestor Folders expanded

                if (conference.ActiveFolder().Text.Equals(level2) &&
                   conference.VisibleTopAndSubLevelfolders().Count == GrantTotal &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_6 + " - " + level2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-16
                //Repeat above steps instead this time the study view is launched from Outbounds tab,
                //add a conference study to a different destination folder from study view; 
                //Navigate to the Conference Folders tab, verify the availability of Active Folder.
                //Accession[0] ="U-ID179490"

                outbounds = (Outbounds)login.Navigate("Outbounds");
                outbounds.SearchStudy(AccessionNo: Accession[0]);
                outbounds.SelectStudy("Accession", Accession[0]);
                viewer = StudyViewer.LaunchStudy();

                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#AddConferenceStudyDialogDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.BrowseBtn()));

                viewer.BrowseBtn().Click();
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("span > span.fancytree-title")));

                viewer.ExpandAndSelectFolder(TopFolder_8 + "/" + level2 + "/" + level3 + "/" + level4);

                //Counting visible folder
                //oldSubFolderCount = 0; //First time it is 0
                Totalcount = conference.VisibleTopAndSubLevelfolders().Count;
                Topcount = conference.AllTopLevelfolders().Count;
                //After expand another folder and refresh page
                SubFoldercount = Totalcount - Topcount - oldSubFolderCount;
                GrantTotal = Topcount + SubFoldercount;
                oldSubFolderCount = SubFoldercount;

                viewer.SelectFolderBtn().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector("#FolderBrowserDialogContentDiv")));
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewer.AddBtn()));
                viewer.AddBtn().Click();

                viewer.CloseStudy();


                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();


                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser;
                //an Active Folder is set to the last destination folder when conference study was added.
                //the Active Folder is selected with all parent/ancestor Folders expanded


                if (conference.ActiveFolder().Text.Equals(level4) &&
                    conference.VisibleTopAndSubLevelfolders().Count == GrantTotal &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_8 + " - " + level2 + " - " + level3 + " - " + level4))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-17
                //Switch to tabs (Studies, Patients, Inbounds&#-3;), review studies, close the study view, 
                //navigate back to the Conference Folders tab.
                //Accession[0] ="U-ID179490"
                //patientName[0]=Adam, PQA
                //Accession[3] ="ACC1957"
                //Accession[1] ="1211824"

                study = (Studies)login.Navigate("Studies");
                study.SearchStudy(AccessionNo: Accession[0]);
                study.SelectStudy("Accession", Accession[0]);
                viewer = StudyViewer.LaunchStudy();
                bool step17_1 = viewer.SeriesViewer_1X1().Displayed;
                study.CloseStudy();


                patient = (Patients)login.Navigate("Patients");

                patient.InputData(PatientName[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientName[0].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, Accession[3]);

                bool step17_2 = viewer.SeriesViewer_1X1().Displayed;
                viewer.CloseStudy();
                patient.ClosePatientRecord();

                

                inbounds = (Inbounds)login.Navigate("Inbounds");
                inbounds.SearchStudy(AccessionNo: Accession[1]);
                inbounds.SelectStudy("Accession", Accession[1]);
                viewer = StudyViewer.LaunchStudy();
                bool step17_3 = viewer.SeriesViewer_1X1().Displayed;
                inbounds.CloseStudy();

                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();

                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //the same sub-folder remains as the current Active Folder,
                //the Active Folder is selected with all parent/ancestor Folders expanded

                if (conference.ActiveFolder().Text.Equals(level4) &&
                  conference.VisibleTopAndSubLevelfolders().Count == GrantTotal &&
                  conference.FolderPathDiv().GetAttribute("innerHTML").Equals(TopFolder_8 + " - " + level2 + " - " + level3 + " - " + level4) &&
                    step17_1 && step17_2 && step17_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-18
                //Logout and re-login iCA as the same  user, navigate to the Conference Folders tab, 
                //verify the availability of Active Folder.
                bool step_18 = conference.ActiveFolder().Text.Equals(level4);

                login.Logout();

                login.LoginIConnect(userA1, userA1); //Folder Manager
                conference = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conference.SwitchtoConferenceFrame();


                //The Conference Folders tab reads and updates the Active Folder when initializing the folder browser
                //The Active Folder is valid until the user&#-3;s session ends; 
                //(there is no valid Active Folder set for this user)

                if (conference.IsElementPresent(conference.By_ActiveFolder()) == false && step_18 &&
                    conference.FolderPathDiv().GetAttribute("innerHTML").Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Auditing (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test1_98608(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            String topfoldername = "Top" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername = "Sub" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath = topfoldername + "/" + subfoldername;
            String rolename = "Role" + +new System.DateTime().Millisecond + random.Next(100, 1000);
            String userid = "User" + +new System.DateTime().Millisecond + random.Next(100, 1000);
            String password = userid;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            int eventcount_before = 0;
            String eventtype1 = "Security Alert/Object Security Attributes Changed";
            int eventcount_after = 0;


            try
            {
                //Step-1-Precondition       
                //Create a Domain/Role and User.
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                String domainname = domainattr[DomainManagement.DomainAttr.DomainName];
                String domainadmin = domainattr[DomainManagement.DomainAttr.UserID];
                String domainAdminPassword = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);
                var role = login.Navigate<RoleManagement>();
                role.CreateRole(domainname, rolename, "Conference");
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userid, domainname, rolename, 1, Config.emailid, 1, userid);
                login.Logout();
                executedsteps++;

                //Step-2 - Login as Domain Admin - Create Top Level and Sub level folder
                login.LoginIConnect(domainadmin, domainAdminPassword);
                var maint = login.Navigate<Maintenance>();
                eventcount_before = maint.GetEventCount(eventtype1);
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-3 - Create SubFolder
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.CreateSubFolder(topfoldername, subfoldername);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Step-4
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.EditDescription("Test-1");
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[++executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Add Folder Manager
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                try
                {
                    conffolder.OpenManageTopLevelFolder();
                    conffolder.AddFolderManager(topfoldername, domainattr[DomainManagement.DomainAttr.FirstName]);
                    conffolder.SaveTopLevelfolder();
                }
                catch (Exception) { conffolder.CloseManageTopLevelFolder(); }
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Remove Folder Manager
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                try
                {
                    conffolder.OpenManageTopLevelFolder();
                    conffolder.RemoveFolderManager(topfoldername, domainadmin);
                    conffolder.SaveTopLevelfolder();
                }
                catch (Exception) { conffolder.CloseManageTopLevelFolder(); }
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Add Conference Study   
                eventcount_before = eventcount_after;
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", accession);
                studies.SelectStudy("Accession", accession);
                StudyViewer studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath);
                studyViewer.CloseStudy();
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Modify Conference Study Notes
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.SelectStudy("Accession", accession);
                conffolder.ModifyConferenceStudyNotes("Testing Notes--" + random.Next(1, 1000));
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Change Archive status of Conference Folder   
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.ArchiveConferenceFolder(folderpath);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Unarchive Conference Folder
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.NavigateToArchiveMode();
                conffolder.UndoArchiveFolder(folderpath);
                conffolder.NavigateToActiveMode();
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Delete Conference Study
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.DeleteStudy("Accession", accession);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Delete Conference Folder
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.DeleteFolder(folderpath);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Result for Step-4
                if (result.steps[executedsteps].statuslist.Any<String>(status => status == "Fail"))
                {
                    result.steps[executedsteps].status = "Fail";
                }
                else
                {
                    result.steps[executedsteps].status = "Pass";
                }

                //Step-5
                result.steps[++executedsteps].status = "Not Automated";

                //Step-6 - Repeat above for Administrator
                result.steps[++executedsteps].status = "Not Automated";


                //Report Result
                result.FinalResult(executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout                
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Auditing (Desktop only) -Login as SuperAdmin
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_98608(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            String rolename = "ConRole" + +new System.DateTime().Millisecond + random.Next(100, 1000);
            String conuser = "User" + +new System.DateTime().Millisecond + random.Next(100, 1000);
            String topfoldername = "Top" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername = "Sub" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath = topfoldername + "/" + subfoldername;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            int eventtype1 = 16;
            String domainname = "SuperAdminGroup";
            int eventcount_before = 0;
            int eventcount_after = 0;           

            try
            {
                //Step-1-Precondition  
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var role = login.Navigate<RoleManagement>();
                role.CreateRole(domainname, rolename, "Conference");
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(conuser, domainname, rolename, 1, Config.emailid, 1, conuser);
                executedsteps++;

                //Step-2 - Login as Administrator - Create Top Level and Sub level folder
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                DomainManagement domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();

                if (domain.ConferenceListsCB().Selected == false)
                {
                    domain.ConferenceListsCB().Click();
                    Logger.Instance.InfoLog("ConferenceLists Check Box Selected successfully");
                }
                else
                {
                    Logger.Instance.InfoLog("ConferenceLists Check Box already selected");
                }
                domain.ClickSaveNewDomain();

                var maint = login.Navigate<Maintenance>();
                eventcount_before = maint.GetEventCount(eventtype1);
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, domain: domainname);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-3 - Create SubFolder
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.CreateSubFolder(topfoldername, subfoldername, Domain_Name: domainname);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Step-4
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath, domainname);
                conffolder.EditDescription("Test-1");
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[++executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Add Folder Manager
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                try
                {
                    conffolder.ExpandAndSelectFolder(topfoldername, DomainName: domainname);
                    conffolder.OpenManageTopLevelFolder();                    
                    conffolder.AddFolderManager(topfoldername, "SuperAdmin Default");
                    conffolder.SaveTopLevelfolder();
                }
                catch (Exception) { conffolder.CloseManageTopLevelFolder(); }
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Remove Folder Manager
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                try
                {
                    conffolder.ExpandAndSelectFolder(topfoldername, DomainName: domainname);
                    conffolder.OpenManageTopLevelFolder();
                    conffolder.RemoveFolderManager(topfoldername, "Administrator");
                    conffolder.SaveTopLevelfolder();
                }
                catch (Exception) {conffolder.CloseManageTopLevelFolder(); }
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Add Conference Study   
                eventcount_before = eventcount_after;
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", accession);
                studies.SelectStudy("Accession", accession);
                StudyViewer studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath);
                studyViewer.CloseStudy();
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Modify Conference Study Notes
                eventcount_before = eventcount_after;
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.SelectStudy("Accession", accession);
                conffolder.ModifyConferenceStudyNotes("Testing Notes--" + random.Next(1, 1000));
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Change Archive status of Conference Folder   
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.ArchiveConferenceFolder(folderpath);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Unarchive Conference Folder
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.NavigateToArchiveMode();
                conffolder.UndoArchiveFolder(folderpath);
                conffolder.NavigateToActiveMode();
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Delete Conference Study
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.DeleteStudy("Accession", accession);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Delete Conference Folder
                eventcount_before = eventcount_after;
                login.Navigate<ConferenceFolders>();
                conffolder.DeleteFolder(folderpath);
                maint = login.Navigate<Maintenance>();
                eventcount_after = maint.GetEventCount(eventtype1);
                if (eventcount_after == eventcount_before + 1)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Result for Step-4
                if (result.steps[executedsteps].statuslist.Any<String>(status => status.Equals("Fail")))
                {
                    result.steps[executedsteps].status = "Fail";
                }
                else
                {
                    result.steps[executedsteps].status = "Pass";
                }

                //Step-5
                result.steps[++executedsteps].status = "Not Automated";


                //Report Result
                result.FinalResult(executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout                
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Launch a Conference Study into the study viewer (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96214(String testid, String teststeps, int stepcount)
        {
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            Studies studies = new Studies();

            //Set up validation steps
            result.SetTestStepDescription(teststeps);
            int ExecutedSteps = -1;

            try
            {
                //Fetch required Test data
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String PatientNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String StudyDateList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyDate");
                String DataSourceList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                //String[] DatasourceList = { login.GetHostName(Config.SanityPACS), login.GetHostName(Config.EA91), };

                String[] Accessions = AccessionList.Split(':');
                String[] PatientNames = PatientNameList.Split(':');
                String[] Datasource = DataSourceList.Split(':');
                String[] PatientID = PatientIDList.Split(':');
                String[] StudyDate = StudyDateList.Split(':');
                //String datasource = login.GetHostName(Config.SanityPACS);      

                String EA = login.GetHostName(Config.EA91);
                String MP = login.GetHostName(Config.SanityPACS);
                String RDM_EA = login.GetHostName(Config.EA1);
                String RDM_MP = login.GetHostName(Config.PACS2);

                //Domains                               
                String DomainC = "DomainC_96214_" + new Random().Next(1, 1000);
                String DomainB = "DomainB_96214_" + new Random().Next(1, 1000);

                //Domain Admin                
                String daC = "daC_96214_5" + new Random().Next(1, 1000);
                String daB = "daB_96214_5" + new Random().Next(1, 1000);

                //Roles                
                String roleC1 = "roleC1_96214_" + new Random().Next(1, 1000);
                String roleC2 = "roleC2_96214_" + new Random().Next(1, 1000);
                String roleB = "roleB_96214_" + new Random().Next(1, 1000);
                String rolePhysician = "rolePhysician_96214_" + new Random().Next(1, 1000);
                String roleArchivist = "roleArchivist_96214_" + new Random().Next(1, 1000);
                String roleStaff = "roleStaff_96214_" + new Random().Next(1, 1000);

                //Users
                String groupC1 = "group1_96214_" + new Random().Next(1, 1000);
                String userC1 = "userC1_96214_" + new Random().Next(1, 1000);
                String userC5 = "userC5_96214_" + new Random().Next(1, 1000);

                String userC2 = "userC2_96214_" + new Random().Next(1, 1000);
                String userC4 = "userC4_96214_" + new Random().Next(1, 1000);
                String userB = "userB_96214_" + new Random().Next(1, 1000);

                String ph = "ph_96214_" + new Random().Next(1, 1000);
                String ar = "ar_96214_" + new Random().Next(1, 1000);
                String st = "st_96214_" + new Random().Next(1, 1000);

                //Folders
                String TopFolderC1 = "Cutaneous T-cell Lymphoma_96214_" + new Random().Next(1, 1000);
                String SubFolderC1_Level2_Sub1 = "SubFolderC_Level2_Sub1_96214_" + new Random().Next(1, 1000);
                String SubFolderC1_Level2_Sub2 = "SubFolderC_Level2_Sub2_96214_" + new Random().Next(1, 1000);
                String SubFolderC1_Level3_Sub2_1 = "SubFolderC_Level3_Sub2_1_96214_" + new Random().Next(1, 1000);
                String SubFolderC1_Level2_Sub3 = "SubFolderC_Level2_Sub3_96214_" + new Random().Next(1, 1000);

                String TopFolderC2 = "Head and Neck_96214_" + new Random().Next(1, 1000);
                String SubFolderC2_Level2_Sub1 = "Different Modalities_96214_" + new Random().Next(1, 1000);
                String SubFolderC2_Level3_Sub2_1 = "meeting for week1_96214_" + new Random().Next(1, 1000);
                String SubFolderC2_Level3_Sub2_2 = "meeting for week2_96214_" + new Random().Next(1, 1000);
                String SubFolderC2_Level2_Sub2 = "Studies from related view_96214_" + new Random().Next(1, 1000);
                String SubFolderC2_Level2_Sub3 = "Saved GSPS studies_96214_" + new Random().Next(1, 1000);

                String TopFolderB1 = "Monthly Oncology Tumor Boards_96214_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_Sub1 = "Hybrid_96214_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_Sub2 = "XDS Only_96214_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_Sub3 = "DICOM Only_96214_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_Sub4 = "XDS_Sub_Tab_96214_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2_Sub5 = "MIME types_96214_" + new Random().Next(1, 1000);

                String TopFolderB2 = "Pediatric Bone Marrow Transplant_96214_" + new Random().Next(1, 1000);
                String SubFolderB2_Level2_Sub1 = "Image sharing #1_96214_" + new Random().Next(1, 1000);

                String TopFolderSuper = "TopFolderSuper_96214_" + new Random().Next(1, 1000);
                String TopFolderSuper_Level2_Sub1 = "Level2_Sub1_96214_" + new Random().Next(1, 1000); 

                //Step 1 - Precondition
                ExecutedSteps++;

                //Step 2 - Precondition
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                //Domains 
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                if (!domainmanagement.IsDomainExist(DomainB))
                {
                    domainmanagement.CreateConfUsrDomain(DomainB);
                    domainmanagement.SearchDomain(DomainB);
                    domainmanagement.SelectDomain(DomainB);
                    domainmanagement.ClickEditDomain();
                    PageLoadWait.WaitForFrameLoad(5);
                    BasePage.Driver.SwitchTo().DefaultContent();
                    Driver.SwitchTo().Frame("UserHomeFrame");
                    domainmanagement.SetCheckBoxInEditDomain("imagesharing", 0);
                    PageLoadWait.WaitForFrameLoad(5);
                    domainmanagement.ClickSaveEditDomain();
                    PageLoadWait.WaitForPageLoad(10);
                    PageLoadWait.WaitForFrameLoad(20);
                }
                if (!domainmanagement.IsDomainExist(DomainC))
                {
                    domainmanagement.CreateConfUsrDomain(DomainC);
                    domainmanagement.SearchDomain(DomainC);
                    domainmanagement.SelectDomain(DomainC);
                    domainmanagement.ClickEditDomain();
                    PageLoadWait.WaitForFrameLoad(5);
                    BasePage.Driver.SwitchTo().DefaultContent();
                    Driver.SwitchTo().Frame("UserHomeFrame");
                    domainmanagement.SetCheckBoxInEditDomain("grant", 0);
                    PageLoadWait.WaitForFrameLoad(5);
                    domainmanagement.ClickSaveEditDomain();
                    PageLoadWait.WaitForPageLoad(10);
                    PageLoadWait.WaitForFrameLoad(20);
                }
                //else domainmanagement.SetConfListFeatureForDomain(DomainC);

                bool bDomainB = domainmanagement.IsDomainExist(DomainB);
                bool bDomainC = domainmanagement.IsDomainExist(DomainC);

                //Domain admins
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(daB, DomainB)) usermanagement.CreateDomainAdminUser(daB, DomainB, 0, "", 0, "", 1);
                if (!usermanagement.SearchUser(daC, DomainC)) usermanagement.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);

                bool bdaB = usermanagement.SearchUser(daB, DomainB);
                bool bdaC = usermanagement.SearchUser(daC, DomainC);

                //Roles
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                if (!rolemanagement.RoleExists(roleB, DomainB)) rolemanagement.CreateRole(DomainB, roleB, "Conference", Config.xds1 + "=" + Config.xds2); //Need to connect one more XDS_DS
                if (!rolemanagement.RoleExists(roleC1, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC1);                //
                if (!rolemanagement.RoleExists(roleC2, DomainC)) rolemanagement.CreateRole(DomainC, roleC2, "Conference", MP); //Either MP or EA
                if (!rolemanagement.RoleExists(rolePhysician, DomainB)) rolemanagement.CreateConfListRole(DomainB, rolePhysician);
                if (!rolemanagement.RoleExists(roleArchivist, DomainB)) rolemanagement.CreateConfListRole(DomainB, roleArchivist);
                if (!rolemanagement.RoleExists(roleStaff, DomainB)) rolemanagement.CreateConfListRole(DomainB, roleStaff);

                bool broleB1 = rolemanagement.RoleExists(roleB, DomainB);
                bool broleC1 = rolemanagement.RoleExists(roleC1, DomainC);
                bool broleC2 = rolemanagement.RoleExists(roleC2, DomainC);
                bool brolePhysician = rolemanagement.RoleExists(rolePhysician, DomainB);
                bool broleArchivist = rolemanagement.RoleExists(roleArchivist, DomainB);
                bool broleStaff = rolemanagement.RoleExists(roleStaff, DomainB);

                //Users
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userB, DomainB)) usermanagement.CreateUser(userB, DomainB, roleB);
                usermanagement.CreateGroup(DomainC, groupC1, rolenames: new string[] { roleC1 }, datasources: new string[] { RDM_MP }, rdm: 1); //rdm.ea or rdm mp
                usermanagement.CreateUserForGroup(groupC1, userC1, DomainC, roleC1);
                usermanagement.CreateUserForGroup(groupC1, userC5, DomainC, roleC1);
                if (!usermanagement.SearchUser(userC2, DomainC))
                {
                    usermanagement.ClearUsrBtn().Click();
                    usermanagement.ClearBtn().Click();
                    usermanagement.CreateUser(userC2, DomainC, roleC2);
                }
                if (!usermanagement.SearchUser(userC4, DomainC)) usermanagement.CreateUser(userC4, DomainC, roleC2);
                if (!usermanagement.SearchUser(ph, DomainB)) usermanagement.CreateUser(ph, DomainB, rolePhysician);
                if (!usermanagement.SearchUser(ar, DomainB)) usermanagement.CreateUser(ar, DomainB, roleArchivist);
                if (!usermanagement.SearchUser(st, DomainB)) usermanagement.CreateUser(st, DomainB, roleStaff);

                bool buserB = usermanagement.SearchUser(userB, DomainB);
                bool buserC1 = usermanagement.SearchUser(userC1, DomainC);
                bool buserC5 = usermanagement.SearchUser(userC5, DomainC);
                bool buserC2 = usermanagement.SearchUser(userC2, DomainC);
                bool buserC4 = usermanagement.SearchUser(userC4, DomainC);

                if (bDomainB && bDomainC && bdaB && bdaC && broleB1 && broleC1 && broleC2
                    && brolePhysician && broleArchivist && broleStaff && buserB && buserC1
                    && buserC5 && buserC2 && buserC4)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }                

                //Step 3
                var conferenceFolder = login.Navigate<ConferenceFolders>();
                conferenceFolder.DomainSelector().SelectByText(DomainC);
                conferenceFolder.CreateToplevelFolder(TopFolderC1, foldermanager: userC5, domain: DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC1, SubFolderC1_Level2_Sub1, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC1, SubFolderC1_Level2_Sub2, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub2, SubFolderC1_Level3_Sub2_1, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC1, SubFolderC1_Level2_Sub3, DomainC);

                conferenceFolder.CreateToplevelFolder(TopFolderC2, userC4, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC2, SubFolderC2_Level2_Sub1, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1, SubFolderC2_Level3_Sub2_1, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1, SubFolderC2_Level3_Sub2_2, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC2, SubFolderC2_Level2_Sub2, DomainC);
                conferenceFolder.CreateSubFolder(TopFolderC2, SubFolderC2_Level2_Sub3, DomainC);

                ExecutedSteps++;

                //Step 4               
                conferenceFolder.DomainSelector().SelectByText(DomainB);
                conferenceFolder.CreateToplevelFolder(TopFolderB1, foldermanager: userB, domain: DomainB);
                conferenceFolder.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_Sub1, DomainB);
                conferenceFolder.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_Sub2, DomainB);
                conferenceFolder.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_Sub3, DomainB);
                conferenceFolder.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_Sub4, DomainB);
                conferenceFolder.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_Sub5, DomainB);

                conferenceFolder.CreateToplevelFolder(TopFolderB2, foldermanager: ar + "-" + ph, domain: DomainB);
                conferenceFolder.CreateSubFolder(TopFolderB2, SubFolderB2_Level2_Sub1, DomainB);
                login.Logout();

                //Adding studies to the folders
                login.LoginIConnect(DomainC, DomainC);
                studies = login.Navigate<Studies>();
                //Level 2 sub1 - references to 1 conference study
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub1,
                                                                Accessions[0], Config.EA91);

                //Level3 sub2/1 - references to 1 conference study
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub2 + "/" + SubFolderC1_Level3_Sub2_1,
                                                                Accessions[0], Config.EA91);

                //Level2 sub3 - references to 4 studies from MP, EA, rdm.mp, rdm.ea                
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3, Accessions[1], login.GetHostName(Config.SanityPACS)); //A7
                //EA
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3, Accessions[2], login.GetHostName(Config.EA91));
                //rdm.mp
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3, Accessions[3], login.GetHostName(Config.PACS2)); //A6
                //rdm.ea
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3, Accessions[4], login.GetHostName(Config.EA1)); //

                //meeting for week1
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1 + "/" + SubFolderC2_Level3_Sub2_1,
                                                                Accessions[5], login.GetHostName(Config.SanityPACS));
                //meeting for week2
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1 + "/" + SubFolderC2_Level3_Sub2_2,
                                                                Accessions[6], login.GetHostName(Config.SanityPACS));

                //Studies from related view
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub2,
                                                               Accessions[7], login.GetHostName(Config.SanityPACS));
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub2,
                                                               Accessions[8], login.GetHostName(Config.SanityPACS));
                //Saved GSPS studies 
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub3,
                                                               Accessions[9], login.GetHostName(Config.EA91));

                login.Logout();

                login.LoginIConnect(DomainB, DomainB);
                studies = login.Navigate<Studies>();

                //TODO XDS sub-tab             
                StudyDate[0] = "15-May-1998 4:09:38 PM";
                StudyDate[1] = "unknown";

                //Hybrid, XDS only & DICOM only
                studies.SearchStudy(AccessionNo: Accessions[10], Datasource: Datasource[0]);
                studies.SelectStudy("Accession", Accessions[10]);
                StudyViewer viewer = LaunchStudy();

                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[0] });
                PageLoadWait.WaitForPageLoad(30);

                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[1] });
                PageLoadWait.WaitForPageLoad(30);
                PageLoadWait.WaitForFrameLoad(20);

                //viewer.SeriesViewer_1X1(1).Click(); 
                //Driver.FindElement(By.CssSelector("#m_studyPanels_m_studyPanel_1_studyPanel")).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub1); //Hybrid

                viewer.SeriesViewer_1X1(2).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub3); //Dicom

                viewer.SeriesViewer_1X1(3).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub2, notes: "XDS Study");
                viewer.CloseStudy();

                //TODO MIME types
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub5, Accessions[13].Split(',')[0], Datasource[0]);

                var patient = (Patients)login.Navigate("Patients");
                patient.InputData(PatientNames[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientNames[0].Trim());
                var viewer1 = patient.LaunchStudy(Patients.PatientColumns.Accession, Accessions[14]);

                viewer1.NavigateToHistoryPanel();
                viewer1.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[0] });
                PageLoadWait.WaitForPageLoad(30);
                viewer1.SeriesViewer_1X1(1).Click();
                viewer1.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer1.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub4);

                viewer1.NavigateToHistoryPanel();
                viewer1.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[1] });
                PageLoadWait.WaitForPageLoad(30);
                viewer1.SeriesViewer_1X1(3).Click();
                viewer1.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer1.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub4);
                login.Logout();

                login.LoginIConnect(userC4, userC4);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[16]);
                studies.SelectStudy("Accession", Accessions[16]);
                studies.ShareStudy(false, new String[] { userC1 });
                studies.SearchStudy("Accession", Accessions[16]);
                studies.SelectStudy("Accession", Accessions[16]);
                StudyViewer viewer2 = LaunchStudy();
                viewer2.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer2.AddStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1 + "/" + SubFolderC2_Level3_Sub2_2); //To Shared studyFolder
                viewer2.CloseStudy();
                login.Logout();

                ExecutedSteps++;

                //Step 5
                login.LoginIConnect(userC1, userC1);
                var conferenceFolders2 = login.Navigate<ConferenceFolders>();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[1]);
                StudyViewer studyViewer5 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 6
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_6 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer5.studyPanel());
                if (step_6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub2 + "/" + SubFolderC1_Level3_Sub2_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[0]);
                StudyViewer studyViewer7 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 8 
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_8 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer7.studyPanel());
                if (step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[3]);
                StudyViewer studyViewer9 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 10
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_10 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer9.studyPanel());
                if (step_10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[3]);
                StudyViewer studyViewer11 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 12
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_12 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer11.studyPanel());
                if (step_12)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1 + "/" + SubFolderC2_Level3_Sub2_1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[5]);
                StudyViewer studyViewer13 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 14
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_14 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer13.studyPanel());
                if (step_14)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 15
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[9]);
                StudyViewer studyViewer15 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 16
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_16 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer15.studyPanel());
                if (step_16)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 17
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub1 + "/" + SubFolderC2_Level3_Sub2_2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[16]);
                StudyViewer studyViewer17 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 18
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_18 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer17.studyPanel());
                if (step_18)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                
                //Step 19
                conferenceFolders2.CloseStudy();
                conferenceFolders2.ExpandAndSelectFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders2.SelectStudy("Accession", Accessions[7]);
                StudyViewer studyViewer19 = conferenceFolders2.LaunchStudy(isConferenceTab: true);
                ExecutedSteps++;

                //Step 20
                studyViewer19.NavigateToHistoryPanel();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_20 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer19.PatientHistoryContainer());
                if (step_20)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 21            
                studyViewer19.ChooseColumns(new String[] { "Accession" });
                studyViewer19.OpenPriors(new String[] { "Accession" }, new String[] { Accessions[8] });
                PageLoadWait.WaitForAllViewportsToLoad(30);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_21 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer19.studyPanel());
                if (step_21)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 22
                studyViewer19.CloseStudy();
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 23
                login.LoginIConnect(ph, ph);
                var conferenceFolders3 = login.Navigate<ConferenceFolders>();
                conferenceFolders3.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders3.SelectStudy("Accession", Accessions[10]);
                StudyViewer studyViewer23 = conferenceFolders3.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_23 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer23.studyPanel());
                if (step_23)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 24
                conferenceFolders3.CloseStudy();
                conferenceFolders3.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders3.SelectStudy("Patient ID", PatientID[0]);
                StudyViewer studyViewer24 = conferenceFolders3.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_24 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer24.studyPanel());
                if (step_24)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 25
                conferenceFolders3.CloseStudy();
                conferenceFolders3.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders3.SelectStudy("Accession", Accessions[12]);
                StudyViewer studyViewer25 = conferenceFolders3.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_25 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer25.studyPanel());
                if (step_25)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 26
                conferenceFolders3.CloseStudy();
                conferenceFolders3.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub4);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders3.SelectStudy("Accession", Accessions[10]);
                StudyViewer studyViewer26 = conferenceFolders3.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_26 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer26.studyPanel());
                if (step_26)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 27
                conferenceFolders3.CloseStudy();
                conferenceFolders3.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2_Sub5);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders3.SelectStudy("Accession", Accessions[13].Split(',')[0]);
                StudyViewer studyViewer27 = conferenceFolders3.LaunchStudy(isConferenceTab: true);
                studyViewer27.NavigateToHistoryPanel();
                if (BasePage.GetSearchResults().Count.ToString().Equals(Accessions[13].Split(',')[1]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 28
                studyViewer27.ChooseColumns(new String[] { "Accession" });
                studyViewer27.OpenPriors(new String[] { "Accession" }, new String[] { Accessions[14] });
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_27 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer27.studyPanel());
                if (step_27)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 29
                conferenceFolders3.CloseStudy();
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accessions[13].Split(',')[0]);
                studies.SelectStudy("Accession", Accessions[13].Split(',')[0]);
                StudyViewer studyViewer29 = StudyViewer.LaunchStudy();
                studyViewer29.NavigateToHistoryPanel();
                if (BasePage.GetSearchResults().Count.ToString().Equals(Accessions[13].Split(',')[1]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studyViewer29.CloseStudy();

                //Step 30
                login.Navigate<ConferenceFolders>();
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 31
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var conferenceFolders4 = login.Navigate<ConferenceFolders>();
                if (!conferenceFolders4.IsTopLevelFolderExist("SuperAdminGroup", TopFolderSuper))
                    conferenceFolders4.CreateToplevelFolder(TopFolderSuper, null, "SuperAdminGroup");
                conferenceFolders4.CreateSubFolder(TopFolderSuper, TopFolderSuper_Level2_Sub1, "SuperAdminGroup");
                studies = (Studies)login.Navigate("Studies");
                studies.ChooseColumns(new string[] { "Accession" });
                studies.AddDatasourceSpecificStudyToStudyFolder(TopFolderSuper + "/" + TopFolderSuper_Level2_Sub1,
                                                                Accessions[15], Datasource[1]);

                login.Navigate<ConferenceFolders>();
                conferenceFolders4.DomainSelector().SelectByText("SuperAdminGroup");
                conferenceFolders4.ExpandAndSelectFolder(TopFolderSuper + "/" + TopFolderSuper_Level2_Sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders4.SelectStudy("Accession", Accessions[15]);
                StudyViewer studyViewer31 = conferenceFolders4.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_31 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer31.studyPanel());
                if (step_31)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 32
                studyViewer31.CloseStudy();
                conferenceFolders4.DomainSelector().SelectByText(DomainC);
                conferenceFolders4.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders4.SelectStudy("Accession", Accessions[0]);
                if (!Driver.FindElement(By.CssSelector("#ViewStudyButton")).Enabled)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                login.Logout();

                //Step 33
                login.LoginIConnect(DomainC, DomainC);
                var conferenceFolders5 = login.Navigate<ConferenceFolders>();
                conferenceFolders5.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders5.SelectStudy("Accession", Accessions[0]);
                StudyViewer studyViewer33 = conferenceFolders5.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_33 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer33.studyPanel());
                if (step_33)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studyViewer33.CloseStudy();
                login.Logout();

                //Step 34
                login.LoginIConnect(userC5, userC5);
                var conferenceFolders6 = login.Navigate<ConferenceFolders>();
                conferenceFolders6.ExpandAndSelectFolder(TopFolderC2 + "/" + SubFolderC2_Level2_Sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders6.SelectStudy("Accession", Accessions[9]);
                StudyViewer studyViewer34 = conferenceFolders6.LaunchStudy(isConferenceTab: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_34 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer34.studyPanel());
                if (step_34)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 35                
                studyViewer34.DrawLineMeasurement(studyViewer34.SeriesViewer_1X1(),
                    studyViewer34.SeriesViewer_1X1().Size.Width / 3,
                    studyViewer34.SeriesViewer_1X1().Size.Height / 3);
                studyViewer34.SeriesViewer_1X1().Click();
                studyViewer34.SelectToolInToolBar("Invert");
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_35 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer34.studyPanel());
                if (step_35)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                studyViewer34.CloseStudy();
                login.Logout();

                //Step 36
                login.LoginIConnect(userC5, userC5);
                var conferenceFolders7 = login.Navigate<ConferenceFolders>();
                conferenceFolders7.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2_Sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders7.SelectStudy("Accession", Accessions[0]);
                StudyViewer studyViewer36 = conferenceFolders7.LaunchStudy(isConferenceTab: true);
                studyViewer36.DrawLineMeasurement(studyViewer34.SeriesViewer_1X1(),
                    studyViewer36.SeriesViewer_1X1().Size.Width / 3,
                    studyViewer36.SeriesViewer_1X1().Size.Height / 3);
                studyViewer36.SeriesViewer_1X1().Click();
                studyViewer36.SelectToolInToolBar("Invert");
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_36 = studies.CompareImage(result.steps[ExecutedSteps], studyViewer34.studyPanel());
                if (step_36)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout                
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Browse Conference Folders and Conference Studies (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96215(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            Studies studies;
            StudyViewer studyViewer;
            ConferenceFolders conferencefolders;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = AccessionIDList.Split(':');
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String datasource = login.GetHostName(Config.SanityPACS);
                Random random = new Random();
                String topfoldername = "Top" + new System.DateTime().Millisecond + random.Next(100, 10000);
                String subfoldername1 = "Sub" + new System.DateTime().Millisecond + random.Next(100, 10000);
                String subfoldername2 = "Sub" + new System.DateTime().Millisecond + random.Next(100, 10000);
                String rolename = "Role1" + new System.DateTime().Millisecond + random.Next(100, 1000);
                String rolename2 = "Role2" + new System.DateTime().Millisecond + random.Next(100, 1000);
                String userid = "User1" + new System.DateTime().Millisecond + random.Next(100, 1000);
                String password = userid;
                String userid2 = "User2" + new System.DateTime().Millisecond + random.Next(100, 1000);
                String password2 = userid;
                String folderpath1 = topfoldername + "/" + subfoldername1;
                String folderpath2 = topfoldername + "/" + subfoldername2;
                String StudyNotes = "StudyNotes_" + new System.DateTime().Millisecond + random.Next(100, 1000);


                //Step-1:iCA build under testing is installed on the main iCA server.--2. XDS, Remote Data source Manager are configured on the main sever; image sharing configuration is optional--3. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing--4. Domains, Role, Folder Manager, Conference user, non-conference user and Conference Folders, Study Folders are available for the test.
                Executedsteps++;


                //Step-2:-Prepare Conference Folders if they are not available in domain(s)- ---1. Conference studies with and without conference notes are stored in a sub-folder---2. Conference studies with and without notes are stored under in multiple level sub-folders (e.g. ---top level\level2---top level\level2\level3,---top level\level2\level3\level4, ---top level\level2\level3\...\level10\..etc..)---3. Conference Folders do not contain any conference study (non Study Folders)---4. Conference Folders contains sub-folders with mixed of Study Folders and non Study Folders
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr1 = domain.CreateDomainAttr();
                String domainname = domainattr1[DomainManagement.DomainAttr.DomainName];
                String foldermanager = domainattr1[DomainManagement.DomainAttr.FirstName];
                String FolderManager_User = domainattr1[DomainManagement.DomainAttr.UserID];
                String FolderManager_Pwd = domainattr1[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr1, isconferenceneeded: true);
                var role = login.Navigate<RoleManagement>();
                role.CreateRole(domainname, rolename, "Conference");
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userid, domainname, rolename, 1, Config.emailid, 1, userid);

                //Domain-2
                domain = login.Navigate<DomainManagement>();
                var domainattr2 = domain.CreateDomainAttr();
                String domainname2 = domainattr2[DomainManagement.DomainAttr.DomainName];
                String foldermanager2 = domainattr2[DomainManagement.DomainAttr.FirstName];
                String FolderManager_User2 = domainattr2[DomainManagement.DomainAttr.UserID];
                String FolderManager_Pwd2 = domainattr2[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr2, isconferenceneeded: true);
                role = login.Navigate<RoleManagement>();
                role.CreateRole(domainname2, rolename2, "Conference");
                usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userid2, domainname2, rolename2, 1, Config.emailid, 1, userid2);

                //Create Top Level and Sub level folder
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, foldermanager, domainname);
                conffolder.CreateSubFolder(topfoldername, subfoldername1, domainname);
                conffolder.CreateSubFolder(topfoldername, subfoldername2, domainname);

                //Create Top Level and 10 SubLevel folders
                String TopLevel = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
                String Sub;
                String Root = TopLevel;
                String FolderPath;
                conffolder.CreateToplevelFolder(TopLevel, userid, domainname);
                for (int i = 2; i <= 10; i++)
                {
                    Sub = "Sub" + i + "";
                    conffolder.CreateSubFolder(Root, Sub, domainname);
                    Root = Root + "/" + Sub;
                    FolderPath = Root;
                }

                //Folders for Domain-2
                conffolder.CreateToplevelFolder(topfoldername, foldermanager2, domainname2);
                conffolder.CreateSubFolder(topfoldername, subfoldername1, domainname2);
                conffolder.CreateSubFolder(topfoldername, subfoldername2, domainname2);
                //Create Top Level and 10 SubLevel folders
                String TopLevel2 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
                String Sub2;
                String Root2 = TopLevel2;
                String FolderPath2;
                conffolder.CreateToplevelFolder(TopLevel2, userid2, domainname2);
                for (int i = 2; i <= 10; i++)
                {
                    Sub2 = "Sub" + i + "";
                    conffolder.CreateSubFolder(Root2, Sub2, domainname2);
                    Root2 = Root2 + "/" + Sub2;
                    FolderPath2 = Root2;
                }
                login.Logout();

                //Add a study to Study Folder
                login.LoginIConnect(FolderManager_User, FolderManager_Pwd);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath1); //Conference Study added
                studyViewer.CloseStudy();
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(folderpath1, notes: StudyNotes); //Conference Study with Notes added
                studyViewer.CloseStudy();
                login.Logout();

                login.LoginIConnect(FolderManager_User2, FolderManager_Pwd2);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Root2, notes: StudyNotes); //Conference Study with Notes added
                studyViewer.CloseStudy();
                login.Logout();
                Executedsteps++;


                //Step-3:Login as a Folder Manager in a Domain that has Study Folders, Navigate to the Conference Folders tab, select a top level folder that contains conference studies with and without conference notes in sub-folders, browse through each level of sub-folders in the Folder Browser.
                login.LoginIConnect(FolderManager_User, FolderManager_Pwd);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                if (conferencefolders.ActiveFolder().Text.Equals(subfoldername1) && BasePage.GetSearchResults().Count > 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-4:Select the Study Folder that contains conference studies with and without conference notes in a sub-folder
                Dictionary<string, string> Studylist_1 = conferencefolders.GetMatchingRow("Accession", Accessions[0]);
                Dictionary<string, string> Studylist_2 = conferencefolders.GetMatchingRow("Accession", Accessions[1]);

                if (Studylist_1 != null && Studylist_2 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5:Sort conference studies by column headers in the conference studies list.
                bool sortresult = conferencefolders.CheckSortInPatientHistory(1);
                if (sortresult == true)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-6:Browse conference studies by Group By filter in the conference studies list
                conferencefolders.SelectGroupByInStudiesTab("Patient DOB", 1);
                PageLoadWait.WaitForPageLoad(5);
                bool step9_1 = conferencefolders.IsGroupedBy("Patient DOB", 1);
                bool step9_2 = BasePage.GetColumnValues("Patient ID").All<String>(columnvalue => columnvalue.Equals(PatientID));
                if (step9_2 && step9_1 && (BasePage.GetSearchResults().Count > 0))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7:From the Conference Studies list, go through each conference study in the list.
                conferencefolders.SelectGroupByInStudiesTab("No Grouping", 1);
                conferencefolders.SelectStudy("Accession", Accessions[1]);
                PageLoadWait.WaitForFrameLoad(5);
                String notes7 = conferencefolders.GetConferenceStudyNotes();
                if (notes7.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-8:Repeat above steps, go through each of top level folders, their level of sub-folders and conference studies (if have).
                conferencefolders.ExpandAndSelectFolder(Root);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                PageLoadWait.WaitForPageLoad(5);
                if (conferencefolders.ActiveFolder().Text.Equals("Sub10"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-9:Verify conference studies and notes in the each folders 
                conferencefolders.ExpandAndSelectFolder(folderpath1);
                conferencefolders.SelectStudy("Accession", Accessions[0]);
                String notes9_1 = conferencefolders.GetConferenceStudyNotes();
                conferencefolders.ExpandAndSelectFolder(folderpath2);
                PageLoadWait.WaitForFrameLoad(5);
                if (notes9_1.Trim().Equals("") && (BasePage.GetSearchResults().Count == 0))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-10:Create a Study Folder with conference studies and notes entered, and the Study Folder is at the 10th levels sub-folder under the path, from the Conference Folders tab browse each level of folders of the folder tree in the Folder Brower.
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Root, notes: StudyNotes);
                studyViewer.CloseStudy();
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(TopLevel + "/Sub1");
                int StudyExist_1 = BasePage.GetSearchResults().Count;
                conferencefolders.ExpandAndSelectFolder(Root);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int StudyExist_2 = BasePage.GetSearchResults().Count;

                if (StudyExist_1 == 0 && StudyExist_2 != 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-11:Attempt to browse a Study Folder that is belonging to a different Domain and the current user does not have access.
                PageLoadWait.WaitForFrameLoad(5);
                IList<IWebElement> TopFolders = conferencefolders.AllTopLevelfolders();

                if (!(TopFolders.All<IWebElement>(Text => Text.Equals(TopLevel2))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-12:Repeat the same steps above, this time login iCA as a conference user Navigate to the Conference Folders tab, browse conference folders and conference studies in the Folder Browser.
                login.LoginIConnect(userid, userid);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(Root);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int StudyCount_12 = BasePage.GetSearchResults().Count;
                conferencefolders.SelectStudy("Accession", Accessions[0]);
                String notes12 = conferencefolders.GetConferenceStudyNotes();
                if (StudyCount_12 != 0 && notes12.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-13:Repeat the same steps above, this time login Domain Admin as a conference user Navigate to the Conference Folders tab, browse conference folders and conference studies in the Folder Browser.
                Executedsteps++; //FolderManager is the DomainAdmin

                //Step-14:Login iCA as a Super Admin. Navigate to the Conference Folders tab, select of a Domain, repeat the same steps, browse conference folders and studies in the Folder Browser.
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferencefolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferencefolders.ExpandAndSelectFolder(Root, domainname);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int StudyCount_14 = BasePage.GetSearchResults().Count;
                conferencefolders.SelectStudy("Accession", Accessions[0]);
                String notes14 = conferencefolders.GetConferenceStudyNotes();
                if (StudyCount_14 != 0 && notes14.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-15:Select a different Domain, browse conference folders and studies in the Folder Browser.
                conferencefolders.ExpandAndSelectFolder(Root2, domainname2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int StudyCount_15 = BasePage.GetSearchResults().Count;
                conferencefolders.SelectStudy("Accession", Accessions[0]);
                String notes15 = conferencefolders.GetConferenceStudyNotes();
                if (StudyCount_15 != 0 && notes15.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-16:Attempt to browse a Study Folder that is not belonging to the selected domain
                PageLoadWait.WaitForFrameLoad(5);
                IList<IWebElement> TopFolders16 = conferencefolders.AllTopLevelfolders();
                if (!(TopFolders16.All<IWebElement>(Text => Text.Equals(TopLevel))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();



                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Query and view prior conference studies and notes (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96216(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String roleB = "RoleB" + random.Next(1, limit);
            String physician = "Physician" + random.Next(1, limit);
            String phUser = "ph" + random.Next(1, limit);
            String archivist = "Archivist" + random.Next(1, limit);
            String aruser = "ar" + random.Next(1, limit);
            String staff = "Staff" + random.Next(1, limit);
            String stUser = "st" + random.Next(1, limit);
            String userB = "UserB" + random.Next(1, limit);
            String destination = "Destination" + random.Next(1, limit);
            String topfoldername = "Top" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername1 = "Sub1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername2 = "Sub2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername3 = "Sub3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            String patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
            String[] arraccession = accession.Split(':');            
            String holdingpen = login.GetHostName(Config.HoldingPenIP);
            String studypath = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyPath");
            String[] arrstudypath = studypath.Split(':');
            String destpacs = login.GetHostName(Config.DestinationPACS);


            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition
                //Crate DomainB and DomainAdmin Dab
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                String domainB = domainattr[DomainManagement.DomainAttr.DomainName];
                String domainadminB = domainattr[DomainManagement.DomainAttr.UserID];
                domain.CreateDomain(domainattr, isconferenceneeded: true);

                //Create RoleB with only XDS Data Sources -- Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainB, roleB, "Conference", Config.xds1 + "=" + Config.xds2);

                //Create UserB (Folder Manager) of RoleB
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userB, domainadminB, roleB, 1, Config.emailid, 1, userB);

                //Create Physcian Role (Conference User)
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainB, physician, "Conference=Physician", holdingpen + "=" + destpacs);
                login.Navigate<UserManagement>();
                usermgmt.CreateUser(phUser, domainadminB, physician, 1, Config.emailid, 1, phUser);

                //Create Archivist Role with conference enabled
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainB, archivist, "Conference=Archivist", holdingpen + "=" + destpacs);
                login.Navigate<UserManagement>();
                usermgmt.CreateUser(aruser, domainadminB, archivist, 1, Config.emailid, 1, aruser);

                //Create St Role and User without Conference feature
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainB, staff, "Staff", holdingpen + "=" + destpacs);
                login.Navigate<UserManagement>();
                usermgmt.CreateUser(stUser, domainadminB, staff, 1, Config.emailid, 1, stUser);

                //Create Destination for DomainB
                var imagesharing = (Image_Sharing)login.Navigate("Image Sharing");
                var pagedestination = (Image_Sharing.Destination)imagesharing.NavigateToSubTab("Destination");
                pagedestination.CreateDestination(destpacs, phUser, aruser, destination, domainB);

                //Generate EI Installer
                var servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                servicetool.NavigateToTab("Image Sharing");
                servicetool.GenerateInstallerExamImporter(domainB, "EI" + domainB);
                servicetool.RestartService();
                servicetool.CloseServiceTool();

                //Install EI
                var ei = new ExamImporter();
                ei.EI_Installation(domainB, "EI" + domainB, Config.Inst1, phUser, phUser);
                Logger.Instance.InfoLog("The Window name of EI is" + "EI" + domainB);
                executedsteps++;
                #endregion Step-2-Precondition


                /* //Testing and Debuggin purpose
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                domain =  login.Navigate<DomainManagement>();
                domainattr = domain.SetDomainAttr("Domain05652", "Domain05652", "Inst0565", "Admin0565", "Last0565", "First0565",
                                     "lakshman.shiva@aspiresys.com", "Pass0565", "DomainAdmin0565", "DomainAdmin0565");
                roleB = "RoleB1534";
                physician = "Physician1107";
                phUser = "ph1578";
                archivist = "Archivist1053";
                aruser = "ar793";
                staff = "Staff1369";
                stUser = "st1016";
                userB = "UserB770";
                destination = "Destination1450";
                domainB = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminB  = domainattr[DomainManagement.DomainAttr.UserID];*/


                //Step-3 -Precondition-Test Data Setup *Uploading Prior-4 to ImageSharing Destination*
                String eipath = "C:\\Users\\Administrator\\AppData\\Local\\Apps" + "\\EI" + domainattr[DomainManagement.DomainAttr.DomainName] + "\\bin" + "\\UploaderTool.exe";
                var cduploader = new ExamImporter();
                cduploader.eiWinName = "EI" + domainattr[DomainManagement.DomainAttr.DomainName];
                cduploader.EIDicomUpload(phUser, phUser, destination, arrstudypath[0], path: eipath);
                login.Logout();
                login.LoginIConnect(phUser, phUser);
                var inbounds = login.Navigate<Inbounds>();
                inbounds.SearchStudy("Accession", arraccession[3]);
                inbounds.SelectStudy("Accession", arraccession[3]);
                inbounds.NominateForArchive("Testing");
                login.Logout();
                login.LoginIConnect(aruser, aruser);
                login.Navigate<Inbounds>();
                inbounds.SearchStudy("Accession", arraccession[3]);
                inbounds.SelectStudy("Accession", arraccession[3]);
                inbounds.ArchiveStudy("Testing", "Testing");
                executedsteps++;

                //Steps-4-Login as domain admin Create Top level folders and subfolders.
                login.Logout();
                login.LoginIConnect(domainadminB, domainattr[DomainManagement.DomainAttr.Password]);
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, userB);
                String folderpath = topfoldername;
                conffolder.CreateSubFolder(folderpath, subfoldername1);
                folderpath = folderpath + "/" + subfoldername1;
                conffolder.CreateSubFolder(folderpath, subfoldername2);
                folderpath = folderpath + "/" + subfoldername2;
                executedsteps++;

                //Step-5 - Logins as folder manager and check priors count
                login.Logout();
                login.LoginIConnect(userB, userB);
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                StudyViewer studyviewer = studies.LaunchStudy();
                studyviewer.NavigateToHistoryPanel();
                int priorscount5 = BasePage.GetSearchResults().Count;
                if (priorscount5 == 3)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-6 -- open priors and add to conference folder **Need to Check Synup**
                studyviewer.ChooseColumns(new string[] { "Accession" });
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[1] });
                studyviewer.NavigateToHistoryPanel();
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[2] });
                int iterate6 = 1;
                foreach (String accessionnumber in arraccession)
                {
                    //Select Prior
                    if (iterate6 == 4) { studyviewer.CloseStudy(); break; }
                    studyviewer.ActivateStudysViewport(iterate6);
                    iterate6++;

                    //Add to Coneference foldeer
                    studyviewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    studyviewer.AddStudyToStudyFolder(folderpath);
                }
                login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath);
                if (BasePage.GetSearchResults().Count == 3)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-7
                login.Logout();
                login.LoginIConnect(phUser, phUser);
                login.Navigate<Studies>();
                studies.SearchStudy("Patient ID", patientid);
                if (BasePage.GetSearchResults().Count == 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-8
                studies.ChooseColumns(new string[] { "Accession" });
                studies.SelectStudy("Accession", arraccession[3]);
                studies.LaunchStudy();
                studies.NavigateToHistoryPanel();
                int priorcount7 = BasePage.GetSearchResults().Count;
                if (priorcount7 == 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-9
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath);
                if (BasePage.GetSearchResults().Count == 3)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-10
                conffolder.SelectStudy("Patient ID", patientid);
                conffolder.LaunchStudy(isConferenceTab: true);
                executedsteps++;

                //Step-11
                conffolder.NavigateToHistoryPanel();
                int priorscount11 = BasePage.GetSearchResults().Count;
                if (priorscount11 == 4)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-12--Load conference and non-conference study
                studyviewer.ChooseColumns(new string[] { "Accession" });
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[1] });
                studyviewer.NavigateToHistoryPanel();
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[3] });
                executedsteps++;

                //Step-13 -- Upload and Archive a study -Prior-5
                var cduploader13 = new ExamImporter();
                cduploader13.eiWinName = "EI" + domainattr[DomainManagement.DomainAttr.DomainName];
                cduploader13.EIDicomUpload(phUser, phUser, destination, arrstudypath[1], path: eipath);
                login.Logout();
                login.LoginIConnect(phUser, phUser);
                inbounds = login.Navigate<Inbounds>();
                inbounds.SearchStudy("Accession", arraccession[4]);
                inbounds.SelectStudy("Accession", arraccession[4]);
                inbounds.NominateForArchive("Testing");
                login.Logout();
                login.LoginIConnect(aruser, aruser);
                login.Navigate<Inbounds>();
                inbounds.SearchStudy("Accession", arraccession[4]);
                inbounds.SelectStudy("Accession", arraccession[4]);
                inbounds.ArchiveStudy("Testing", "Testing");
                executedsteps++;

                //Step-14
                login.Logout();
                login.LoginIConnect(userB, userB);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Patient ID", patientid);
                studies.SelectStudy("Patient ID", patientid);
                studyviewer = studies.LaunchStudy();
                studies.NavigateToHistoryPanel();
                int priorscount14 = BasePage.GetSearchResults().Count;
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                if (priorscount14 == priorscount5)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-15
                login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath);
                if (BasePage.GetSearchResults().Count == 3)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-16
                conffolder.SelectStudy("Accession", arraccession[0]);
                conffolder.LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                int priorcount16 = BasePage.GetSearchResults().Count;
                if (priorcount16 == 5)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-17-Load non conferece Studies
                studyviewer.ChooseColumns(new string[] { "Accession" });
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[3] });
                studyviewer.NavigateToHistoryPanel();
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[4] });
                executedsteps++;

                //Step-18 and 19 -- Add Prior-4 to conference folder                
                BasePage.Driver.FindElement(By.CssSelector("div#studyPanelDiv_2")).Click();
                studyviewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyviewer.AddStudyToStudyFolder(folderpath);
                ++executedsteps;
                studyviewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath);
                if (BasePage.GetSearchResults().Count == 4)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-20
                conffolder.SelectStudy("Accession", arraccession[3]);
                conffolder.LaunchStudy(isConferenceTab: true);
                executedsteps++;

                //stepcount-21
                studyviewer.NavigateToHistoryPanel();
                int priorcount21 = BasePage.GetSearchResults().Count;
                if (priorcount21 == 5)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-22
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                conffolder.CreateSubFolder(topfoldername + "/" + subfoldername1, subfoldername3);
                String folderpath_new = topfoldername + "/" + subfoldername1 + "/" + subfoldername3;
                executedsteps++;

                //Step-23 and 24
                conffolder.ExpandAndSelectFolder(folderpath);
                conffolder.SelectStudy("Accession", arraccession[3]);
                conffolder.LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                studyviewer.ChooseColumns(new string[] { "Accession" });
                studyviewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[4] });
                studyviewer.ActivateStudysViewport(2);
                studyviewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyviewer.AddStudyToStudyFolder(folderpath_new, notes: "Testing");
                executedsteps++;
                studyviewer.CloseStudy();
                conffolder.ExpandAndSelectFolder(folderpath_new);
                var studycount23 = studyviewer.GetMatchingRow("Accession", arraccession[4]);
                if (studycount23 != null)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-25
                conffolder.SelectStudy("Accession", arraccession[4]);
                conffolder.LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                if (BasePage.GetSearchResults().Count == 5)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout       
                studyviewer.CloseHistoryPanel();
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Attempt to add uploaded/archived studies stored in Holding Pen to a Sub-Folder (Imagesharing)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96213(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = new Taskbar();
            ServiceTool servicetool = new ServiceTool();
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            StudyViewer studyViewer;
            Inbounds inbounds = null;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);          
            int Executedsteps = -1;

            try
            {
                //Set up Validation Steps
                result.SetTestStepDescription(teststeps);

                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                Random random = new Random();
                int limit = Math.Abs((int)DateTime.Now.Ticks);
                limit = Int32.Parse(limit.ToString().Substring(0, 4));

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] PatientID = PatientIDList.Split(':');

                String eiWindow = "ExamImporter_213_" + random.Next(1000);
                ei.eiWinName = eiWindow;                
                String UploadFilePathList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyPath");
                String[] UploadFilePath = UploadFilePathList.Split(':');
                String imagePathList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "ImageFilePath");
                String[] imagePath = imagePathList.Split(':');
                String Description = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String destpacs = login.GetHostName(Config.DestinationPACS);
                String destination = "Destination" + random.Next(1, limit);

                //DomainB
                String TestdomainB = "DomainB_213_" + random.Next(1, 1000);
                String TestdomainAdminB = "DomainAdminB_213_" + random.Next(1, 1000);
                String stUserName = "st_" + TestdomainB;
                String phUserName = "ph_" + TestdomainB;
                String arUserName = "ar_" + TestdomainB;
                String stPassword = Config.stPassword;
                String phPassword = Config.phPassword;
                String arPassword = Config.arPassword;
                //FolderNames for DomainB
                String topfoldername = "Pediatric Bone Marrow Transplant_213" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername = "image sharing #1_213" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String folderpath = topfoldername + "/" + subfoldername;

                //Step 1- Pre-conditions
                taskbar.Hide();
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableConferenceLists();
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                Executedsteps++;

                //Step 2
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.CreateDomain(TestdomainB, TestdomainAdminB, DS: new String[] { "imagesharing" }, datasources: null);
                bool step2 = domainmanagement.SearchDomain(TestdomainB);
                domainmanagement.SetConfListFeatureForDomain(TestdomainB);

                rolemanagement = login.Navigate<RoleManagement>();
                if (!rolemanagement.RoleExists("Staff_" + TestdomainB, TestdomainB))
                {
                    rolemanagement.ClickNewRoleBtn();
                    rolemanagement.CreateRole(TestdomainB, "Staff_" + TestdomainB);
                }
                if (!rolemanagement.RoleExists("Physician_" + TestdomainB, TestdomainB))
                {
                    rolemanagement.ClickNewRoleBtn();
                    rolemanagement.CreateRole(TestdomainB, "Physician_" + TestdomainB, 1);
                }
                if (!rolemanagement.RoleExists("Archivist_" + TestdomainB, TestdomainB))
                {
                    rolemanagement.ClickNewRoleBtn();
                    rolemanagement.CreateRole(TestdomainB, "Archivist_" + TestdomainB, 2);
                }

                usermanagement = login.Navigate<UserManagement>();
                if (!usermanagement.SearchUser(stUserName, TestdomainB)) usermanagement.CreateUser(stUserName, TestdomainB, "Staff_" + TestdomainB, 1, Config.emailid, 1, stPassword);
                if (!usermanagement.SearchUser(phUserName, TestdomainB)) usermanagement.CreateUser(phUserName, TestdomainB, "Physician_" + TestdomainB, 1, Config.emailid, 1, phPassword);
                if (!usermanagement.SearchUser(arUserName, TestdomainB)) usermanagement.CreateUser(arUserName, TestdomainB, "Archivist_" + TestdomainB, 1, Config.emailid, 1, arPassword);
                usermanagement = login.Navigate<UserManagement>();
                bool userB1 = usermanagement.SearchUser(stUserName, TestdomainB);
                bool userB2 = usermanagement.SearchUser(phUserName, TestdomainB);
                bool userB3 = usermanagement.SearchUser(arUserName, TestdomainB);

                usermanagement.SearchUser(phUserName, TestdomainB);
                usermanagement.SelectUser(phUserName);
                usermanagement.ClickEditUser();
                SetCheckbox(BasePage.Driver.FindElement(By.CssSelector("#ctl00_MasterContentPlaceHolder_RoleAccessFilter_ConferenceUserCB")));
                ClickButton("#ctl00_MasterContentPlaceHolder_SaveButton");

                usermanagement.SearchUser(arUserName, TestdomainB);
                usermanagement.SelectUser(arUserName);
                usermanagement.ClickEditUser();
                SetCheckbox(BasePage.Driver.FindElement(By.CssSelector("#ctl00_MasterContentPlaceHolder_RoleAccessFilter_ConferenceUserCB")));
                ClickButton("#ctl00_MasterContentPlaceHolder_SaveButton");

                var imagesharing = (Image_Sharing)login.Navigate("Image Sharing");
                var pagedestination = (Image_Sharing.Destination)imagesharing.NavigateToSubTab("Destination");
                pagedestination.CreateDestination(destpacs, phUserName, arUserName, destination, TestdomainB);

                if (step2 && userB1 && userB2 && userB3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                    throw new Exception("New Domain does not exist");
                }
                login.Logout();

                taskbar = new Taskbar();
                taskbar.Hide();
                servicetool.LaunchServiceTool();
                servicetool.GenerateInstallerExamImporter(TestdomainB, eiWindow);
                //servicetool.GenerateInstallerPOP();
                servicetool.RestartService();
                servicetool.CloseServiceTool();
                taskbar.Show();

                //Install EI

                String path = ei.EI_Installation(TestdomainB, eiWindow, Config.Inst1, stUserName, stPassword);
                Logger.Instance.InfoLog("The Window name of EI is" + "EI" + TestdomainB);                

                //Step 3
                login.LoginIConnect(TestdomainB, TestdomainB);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.CreateToplevelFolder(topfoldername, phUserName + "-" + arUserName); ; //First Top Folder
                bool step3 = conferencefolders.CreateSubFolder(topfoldername, subfoldername);
                if (step3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step 4
                ei.EIDicomUpload(stUserName, stPassword, destination, UploadFilePath[0], path:path);
                ei.EIDicomUpload(stUserName, stPassword, destination, UploadFilePath[1], path:path);
                Executedsteps++;

                //Step 5
                login.LoginIConnect(phUserName, phPassword);
                inbounds = login.Navigate<Inbounds>();
                inbounds.SelectAllInboundData();
                //Search Study
                inbounds.SearchStudy("Accession", Accession[0]);
                var studystatus = inbounds.GetMatchingRow(new string[] { "Accession", "Status" }, new string[] { Accession[0], "Uploaded" });
                if (inbounds.CheckStudy("Accession", Accession[0]) == true && studystatus != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6
                inbounds.SelectStudy("Accession", Accession[0]);
                studyViewer = StudyViewer.LaunchStudy();
                PageLoadWait.WaitForAllViewportsToLoad(10);
                String[] ToolsList = studyViewer.GetStudyToolsinViewer();
                Boolean IsToolExist_6 = ToolsList.Contains("Add To Conference Folder");
                if (!IsToolExist_6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                inbounds.CloseStudy();

                //Step 7
                inbounds.SelectStudy("Accession", Accession[0]);
                inbounds.NominateForArchive("Testing7_1");
                inbounds.SearchStudy("Accession", Accession[1]);
                inbounds.SelectStudy("Accession", Accession[1]);
                inbounds.NominateForArchive("Testing7_2");

                //Find study status
                String studyStatus1, studyStatus2;
                inbounds.SearchStudy("Accession", Accession[0]);
                inbounds.GetMatchingRow("Accession", Accession[0]).TryGetValue("Status", out studyStatus1);
                inbounds.SearchStudy("Accession", Accession[1]);
                inbounds.GetMatchingRow("Accession", Accession[1]).TryGetValue("Status", out studyStatus2);

                login.Logout();
                login.LoginIConnect(arUserName, arPassword);
                inbounds = login.Navigate<Inbounds>();
                inbounds.SelectAllInboundData();
                //Search Study
                inbounds.SearchStudy("lastname", "*");

                if (inbounds.CheckStudy("Accession", Accession[0]) == true && inbounds.CheckStudy("Accession", Accession[1]) == true && studyStatus1 == "Nominated For Archive" && studyStatus2 == "Nominated For Archive")
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8
                inbounds.SelectStudy("Accession", Accession[0]);
                inbounds.LaunchStudy();
                PageLoadWait.WaitForAllViewportsToLoad(10);
                ToolsList = studyViewer.GetStudyToolsinViewer();
                Boolean IsToolExist_8 = ToolsList.Contains("Add To Conference Folder");
                if (!IsToolExist_8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                inbounds.CloseStudy();

                // Step 9
                inbounds.SelectStudy("Accession", Accession[0]);
                inbounds.ArchiveStudy("Testing9_1", "");
                inbounds.SelectStudy("Accession", Accession[1]);
                inbounds.ArchiveStudy("Testing9_2", "");

                //Validate StudyStatus as Routing Completed
                inbounds.SearchStudy("Accession", Accession[0]);
                inbounds.SearchStudy("Accession", Accession[0]);
                inbounds.SelectStudy("Accession", Accession[0]);
                Dictionary<string, string> study9_1 = inbounds.GetMatchingRow(new string[] { "Accession", "Status" }, new string[] { Accession[0], "Routing Completed" });
                inbounds.SearchStudy("Accession", Accession[1]);
                inbounds.SearchStudy("Accession", Accession[1]);
                inbounds.SelectStudy("Accession", Accession[1]);
                Dictionary<string, string> study9_2 = inbounds.GetMatchingRow(new string[] { "Accession", "Status" }, new string[] { Accession[1], "Routing Completed" });

                if (study9_1 != null && study9_2 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 10
                ei.EINonDicomUpload(stUserName, stPassword, destination, "", "", UploadFilePath[2], imagePath[0], "Test_96213_S9_1", PatientID[0], Accession[2], pdf: 1, pdfPath: imagePath[1], path: path);
                ei.EINonDicomUpload(stUserName, stPassword, destination, "", "", UploadFilePath[3], imagePath[2], "Test_96213_S9_2", PatientID[1], Accession[3], pdf: 1, pdfPath: imagePath[3], path: path);
                Executedsteps++;

                // Step 11
                login.DriverGoTo(url);
                login.LoginIConnect(phUserName, phPassword);
                inbounds = login.Navigate<Inbounds>();
                //Search Study
                inbounds.SearchStudy("lastname", "*");
                studystatus = inbounds.GetMatchingRow(new string[] { "Patient ID", "Status" }, new string[] { PatientID[0], "Uploaded" });
                var study2status = inbounds.GetMatchingRow(new string[] { "Patient ID", "Status" }, new string[] { PatientID[1], "Uploaded" });

                if (inbounds.CheckStudy("Patient ID", PatientID[0]) == true && inbounds.CheckStudy("Patient ID", PatientID[1]) == true && studystatus != null && study2status != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12
                inbounds.SelectStudy("Patient ID", PatientID[0]);
                inbounds.NominateForArchive("Testing12_1");
                inbounds.SelectStudy("Patient ID", PatientID[1]);
                inbounds.NominateForArchive("Testing12_2");

                //Find study status
                inbounds.SearchStudy("patient", PatientID[0]);
                inbounds.GetMatchingRow("Patient ID", PatientID[0]).TryGetValue("Status", out studyStatus1);
                inbounds.SearchStudy("patient", PatientID[1]);
                inbounds.GetMatchingRow("Patient ID", PatientID[1]).TryGetValue("Status", out studyStatus2);

                if (studyStatus1 == "Nominated For Archive" && studyStatus2 == "Nominated For Archive")
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13
                login.Logout();
                login.LoginIConnect(arUserName, arPassword);
                inbounds = login.Navigate<Inbounds>();
                inbounds.SearchStudy("lastname", "*");
                inbounds.SelectStudy("Patient ID", PatientID[0]);
                inbounds.ArchiveStudy("Testing13_1", "");
                inbounds.SelectStudy("Patient ID", PatientID[1]);
                inbounds.ArchiveStudy("Testing13_2", "");

                //Validate StudyStatus as Routing Completed
                inbounds.SearchStudy("patient", PatientID[0]);
                inbounds.SearchStudy("patient", PatientID[0]);
                inbounds.SelectStudy("Patient ID", PatientID[0]);
                Dictionary<string, string> study13_1 = inbounds.GetMatchingRow(new string[] { "Patient ID", "Status" }, new string[] { PatientID[0], "Routing Completed" });
                inbounds.SearchStudy("patient", PatientID[1]);
                inbounds.SearchStudy("patient", PatientID[1]);
                inbounds.SelectStudy("Patient ID", PatientID[1]);
                Dictionary<string, string> study13_2 = inbounds.GetMatchingRow(new string[] { "Patient ID", "Status" }, new string[] { PatientID[1], "Routing Completed" });

                if (study13_1 != null && study13_2 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14
                inbounds.SearchStudy("patient", PatientID[0]);
                inbounds.SelectStudy("Patient ID", PatientID[0]);
                inbounds.LaunchStudy();
                PageLoadWait.WaitForAllViewportsToLoad(10);
                ToolsList = studyViewer.GetStudyToolsinViewer();
                Boolean IsToolExist_14 = ToolsList.Contains("Add To Conference Folder");
                if (!IsToolExist_14)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                inbounds.CloseStudy();

                //Step-15,16,17:upload study from POP installed on a client machine
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";
                result.steps[++Executedsteps].status = "Not Automated";

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }            
            
        }

        /// <summary>
        /// Conference Lists - Modify Conference Study Notes (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96219(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferenceFolders;

            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String[] Accession = AccessionList.Split(':');

                //Domains
                //String DomainB = "DomainB_96219_" + new Random().Next(1, 1000);
                String DomainB = "SuperAdminGroup";
                String DomainC = "DomainC_96219_" + new Random().Next(1, 1000);
                String DomainD = "DomainD_96219_" + new Random().Next(1, 1000);

                //Domain Admin
                //String daB = "daB_96219_" + new Random().Next(1, 1000);
                String daB = "Administrator";
                String daC = "daC_96219_" + new Random().Next(1, 1000);
                String daD = "daD_96219_" + new Random().Next(1, 1000);

                //Roles                
                String roleB = "roleB1_96219_" + new Random().Next(1, 1000);
                String rolePhysician = "Physician_96219_" + new Random().Next(1, 1000);
                String roleC1 = "roleC1_96219_" + new Random().Next(1, 1000);

                //Users
                String userB = "userB_96219_2" + new Random().Next(1, 1000);
                String userB1 = "userB1_96219_2" + new Random().Next(1, 1000);
                String ph = "Ph_96219_" + new Random().Next(1, 1000);
                String ar = "ar_96219_" + new Random().Next(1, 1000);
                String DoctorA = "DoctorA_96219_" + new Random().Next(1, 1000);
                String userC1 = "userC1_96219_" + new Random().Next(1, 1000);
                String userC5 = "userC5_96219_" + new Random().Next(1, 1000);

                //Folders
                String TopFolderB1 = "ONCOLOGY_96219_" + new Random().Next(1, 1000);
                String SubFolderB1_Level2 = "Head_96219_" + new Random().Next(1, 1000);
                String SubFolderB1_Level3 = "8-1-16 - 8-5-16-_96219_" + new Random().Next(1, 1000);

                String TopFolderB2 = "Pediatric Bone Marrow Transplant_96219_" + new Random().Next(1, 1000);
                String SubFolderB2_Level2 = "Head_96219_" + new Random().Next(1, 1000);
                String SubFolderB2_Level3 = "8-1-16 - 8-5-16-_96219_" + new Random().Next(1, 1000);

                String TopFolderC1 = "Head and Neck_96219_";
                String TopFolderC2 = "Cutaneous T-cell Lymphoma_96219_" + new Random().Next(1, 1000);
                String SubFolderC2_Level2 = "Head_96219_" + new Random().Next(1, 1000);
                String SubFolderC2_Level3 = "8-1-16 - 8-5-16-_96219_" + new Random().Next(1, 1000);

                //Step 1 - Precondition
                Executedsteps++;

                //Step 2 - Precondition
                login.LoginIConnect(adminUserName, adminPassword);

                //Domains 
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                if (!domainmanagement.IsDomainExist(DomainB)) domainmanagement.CreateConfUsrDomain(DomainB);
                else domainmanagement.SetConfListFeatureForDomain(DomainB);
                if (!domainmanagement.IsDomainExist(DomainC)) domainmanagement.CreateConfUsrDomain(DomainC);
                else domainmanagement.SetConfListFeatureForDomain(DomainC);
                if (!domainmanagement.IsDomainExist(DomainD)) domainmanagement.CreateConfUsrDomain(DomainD);
                else domainmanagement.SetConfListFeatureForDomain(DomainD);

                bool bDomainB = domainmanagement.IsDomainExist(DomainB);
                bool bDomainC = domainmanagement.IsDomainExist(DomainC);
                bool bDomainD = domainmanagement.IsDomainExist(DomainD);

                //Domain managers
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                //if (!usermanagement.SearchUser("SuperAdmin", DomainB)) usermanagement.CreateDomainAdminUser(daB, DomainB, 0, "", 0, "", 1);
                if (!usermanagement.SearchUser(daC, DomainC)) usermanagement.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);
                if (!usermanagement.SearchUser(daD, DomainB)) usermanagement.CreateDomainAdminUser(daD, DomainB, 0, "", 0, "", 1);

                //bool bdaB = usermanagement.SearchUser("SuperAdmin", DomainB);
                bool bdaC = usermanagement.SearchUser(daC, DomainC);
                bool bdD = usermanagement.SearchUser(daD, DomainB);

                //Roles
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                if (!rolemanagement.RoleExists(roleB, DomainB)) rolemanagement.CreateConfListRole(DomainB, roleB);
                if (!rolemanagement.RoleExists(rolePhysician, DomainB)) rolemanagement.CreateConfListRole(DomainB, rolePhysician);
                if (!rolemanagement.RoleExists(roleC1, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC1);

                bool broleB1 = rolemanagement.RoleExists(roleB, DomainB);
                bool broleB2 = rolemanagement.RoleExists(rolePhysician, DomainB);
                bool broleC1 = rolemanagement.RoleExists(roleC1, DomainC);

                //Users
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userB, DomainB)) usermanagement.CreateUser(userB, DomainB, roleB);
                if (!usermanagement.SearchUser(userB1, DomainB)) usermanagement.CreateUser(userB1, DomainB, roleB);
                if (!usermanagement.SearchUser(ph, DomainB)) usermanagement.CreateUser(ph, DomainB, rolePhysician);
                if (!usermanagement.SearchUser(ar, DomainB)) usermanagement.CreateUser(ar, DomainB, rolePhysician);
                if (!usermanagement.SearchUser(DoctorA, DomainB)) usermanagement.CreateUser(DoctorA, DomainB, rolePhysician);
                if (!usermanagement.SearchUser(userC1, DomainC)) usermanagement.CreateUser(userC1, DomainC, roleC1);
                if (!usermanagement.SearchUser(userC5, DomainC)) usermanagement.CreateUser(userC5, DomainC, roleC1);

                bool buserB1 = usermanagement.SearchUser(userB, DomainB);
                bool buserB2 = usermanagement.SearchUser(userB1, DomainB);
                bool buserB3 = usermanagement.SearchUser(ph, DomainB);
                bool buserB4 = usermanagement.SearchUser(DoctorA, DomainB);
                bool buserC1 = usermanagement.SearchUser(userC1, DomainC);
                bool buserC5 = usermanagement.SearchUser(userC5, DomainC);

                //Folders                
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainB, TopFolderB1))
                    conferenceFolders.CreateToplevelFolder(TopFolderB1, userB1, DomainB, TopFolderB1 + " Description");
                conferenceFolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2, DomainB);
                conferenceFolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2, SubFolderB1_Level3, DomainB, SubFolderB1_Level3 + " Description");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainB, TopFolderB2)) conferenceFolders.CreateToplevelFolder(TopFolderB2, ph + "-" + ar, null, TopFolderB2 + " Description");
                conferenceFolders.CreateSubFolder(TopFolderB2, SubFolderB2_Level2, DomainB);
                conferenceFolders.CreateSubFolder(TopFolderB2 + "/" + SubFolderB2_Level2, SubFolderB2_Level3, DomainB, SubFolderB2_Level3 + " Description");
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopFolderC1)) conferenceFolders.CreateToplevelFolder(TopFolderC1, userC1, null, TopFolderC1 + " Description");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopFolderC2)) conferenceFolders.CreateToplevelFolder(TopFolderC2, userC5, null, TopFolderC2 + " Description");
                conferenceFolders.CreateSubFolder(TopFolderC2, SubFolderC2_Level2, DomainC);
                conferenceFolders.CreateSubFolder(TopFolderC2 + "/" + SubFolderC2_Level2, SubFolderC2_Level3, DomainC, SubFolderC2_Level3 + " Description");

                var studies = login.Navigate<Studies>();

                //UserB
                studies.SearchStudy("Accession", Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                StudyViewer studyViewer1 = studies.LaunchStudy();
                studyViewer1.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer1.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3, notes: "related1");
                studyViewer1.CloseStudy();

                studies.ClearSearchBtn().Click();
                studies.SearchStudy("Accession", Accession[1]);
                studies.SelectStudy("Accession", Accession[1]);
                StudyViewer studyViewer2 = studies.LaunchStudy();
                studyViewer2.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer2.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3);
                studyViewer2.CloseStudy();

                studies.ClearSearchBtn().Click();
                studies.SearchStudy("Accession", Accession[2]);
                studies.SelectStudy("Accession", Accession[2]);
                StudyViewer studyViewer3 = studies.LaunchStudy();
                studyViewer3.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer3.AddStudyToStudyFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3, null, "related3");
                studyViewer3.CloseStudy();

                studies.ClearSearchBtn().Click();
                studies.SearchStudy("Accession", Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                StudyViewer studyViewer4 = studies.LaunchStudy();
                studyViewer4.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer4.AddStudyToStudyFolder(TopFolderB2 + "/" + SubFolderB2_Level2 + "/" + SubFolderB2_Level3, notes: "related1");
                studyViewer4.CloseStudy();

                studies.ClearSearchBtn().Click();
                studies.SearchStudy("Accession", Accession[1]);
                studies.SelectStudy("Accession", Accession[1]);
                StudyViewer studyViewer5 = studies.LaunchStudy();
                studyViewer5.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer5.AddStudyToStudyFolder(TopFolderB2 + "/" + SubFolderB2_Level2 + "/" + SubFolderB2_Level3);
                studyViewer5.CloseStudy();

                studies.ClearSearchBtn().Click();
                studies.SearchStudy("Accession", Accession[2]);
                studies.SelectStudy("Accession", Accession[2]);
                StudyViewer studyViewer6 = studies.LaunchStudy();
                studyViewer6.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer6.AddStudyToStudyFolder(TopFolderB2 + "/" + SubFolderB2_Level2 + "/" + SubFolderB2_Level3, null, "related3");
                studyViewer6.CloseStudy();
                login.Logout();

                //UserC
                login.LoginIConnect(daC, daC);
                var studies1 = login.Navigate<Studies>();

                wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                studies1.ClearSearchBtn().Click();
                studies1.SearchStudy("Accession", Accession[0]);
                studies1.SelectStudy("Accession", Accession[0]);
                StudyViewer studyViewer7 = studies.LaunchStudy();
                studyViewer7.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer7.AddStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2 + "/" + SubFolderC2_Level3, notes: "related1");
                studyViewer7.CloseStudy();

                wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                studies1.ClearSearchBtn().Click();
                studies1.SearchStudy("Accession", Accession[1]);
                studies1.SelectStudy("Accession", Accession[1]);
                StudyViewer studyViewer8 = studies.LaunchStudy();
                studyViewer8.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer8.AddStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2 + "/" + SubFolderC2_Level3);
                studyViewer8.CloseStudy();

                wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                studies1.ClearSearchBtn().Click();
                studies1.SearchStudy("Accession", Accession[2]);
                studies1.SelectStudy("Accession", Accession[2]);
                StudyViewer studyViewer9 = studies.LaunchStudy();
                studyViewer9.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer9.AddStudyToStudyFolder(TopFolderC2 + "/" + SubFolderC2_Level2 + "/" + SubFolderC2_Level3, null, "related3");
                studyViewer9.CloseStudy();

                if (bDomainB && bDomainC && bdaC && broleB1 && broleB2 && broleC1 && buserB1 && buserB2 && buserB3 && buserB4 && buserC5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 3
                login.LoginIConnect(userB1, userB1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals("related1") && conferenceFolders.Btn_EditStudyNotes().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 4
                conferenceFolders.Btn_EditStudyNotes().Click();
                if (conferenceFolders.GetConferenceStudyNotes().Equals("related1"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferenceFolders.Btn_OkStudyNotes().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.Btn_EditStudyNotes()));

                //Step 5 - Modify the study notes, Click Ok button.                
                string step_5 = " step5";
                conferenceFolders.ModifyConferenceStudyNotes(step_5, "append");
                if (conferenceFolders.GetConferenceStudyNotes().Equals("related1" + step_5))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6 - Browse to a different Study Folder under the same top level folder managed by the Folder Manager, select a conference study with an existing conference notes                
                conferenceFolders.SelectStudy("Accession", Accession[2]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals("related3") && conferenceFolders.Btn_EditStudyNotes().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7 - Browse back to the Study Folder where conference study notes was modified.
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals("related1" + step_5))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8 - Load the conference study into study viewer, open History fly-out, verify the modified conference notes of the study in the Study Notes tab.
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                StudyViewer studyViewer = conferenceFolders.LaunchStudy(isConferenceTab: true);
                studyViewer.NavigateToHistoryPanel();
                studyViewer.StudyNotesTab().Click();
                if (login.GetText("id", "m_patientHistory_m_StudyNotesViewer_studyNotesContent").Equals("related1" + step_5))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 9
                studyViewer.CloseHistoryPanel();
                studyViewer.CloseStudy();
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                string step_9 = "step9 notes";
                conferenceFolders.ModifyConferenceStudyNotes(step_9);
                wait.Until(ExpectedConditions.ElementToBeClickable(conferenceFolders.Btn_EditStudyNotes()));
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_9))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10
                conferenceFolders.SelectStudy("Accession", Accession[2]);
                StudyViewer studyViewer10 = conferenceFolders.LaunchStudy(isConferenceTab: true);
                studyViewer10.NavigateToHistoryPanel();
                studyViewer10.StudyNotesTab().Click();
                if (login.GetText("id", "m_patientHistory_m_StudyNotesViewer_studyNotesContent").Equals("related3"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11
                Executedsteps++;

                //Step 12
                studyViewer10.CloseHistoryPanel();
                studyViewer10.CloseStudy();
                PageLoadWait.WaitForFrameLoad(10);
                conferenceFolders.SelectStudy("Accession", Accession[1]);
                String whitespace = conferenceFolders.GetConferenceStudyNotes();
                if (String.IsNullOrEmpty(whitespace))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13
                string step_13 = "step13 notes";
                conferenceFolders.ModifyConferenceStudyNotes(step_13);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_13))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_9))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_9))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 16
                login.LoginIConnect(userB, userB);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals("step9 notes"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17
                if (!conferenceFolders.Btn_EditStudyNotes().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 18
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_9))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 19
                if (!conferenceFolders.Btn_EditStudyNotes().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 20
                login.LoginIConnect(daB, daB);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainB);
                conferenceFolders.ExpandAndSelectFolder(TopFolderB2 + "/" + SubFolderB2_Level2 + "/" + SubFolderB2_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                string step_20 = "step20 notes";
                conferenceFolders.ModifyConferenceStudyNotes(step_20);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_20))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21
                conferenceFolders.ExpandAndSelectFolder(TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                string step_21 = "step21 notes";
                conferenceFolders.ModifyConferenceStudyNotes(step_21);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_21))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 22
                login.LoginIConnect(daD, daD);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 23
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainB);
                conferenceFolders.ExpandAndSelectFolder(TopFolderB2 + "/" + SubFolderB2_Level2 + "/" + SubFolderB2_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                string step_23 = "step23 notes";
                conferenceFolders.ModifyConferenceStudyNotes(step_23);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_23))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 24   
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                conferenceFolders.ExpandAndSelectFolder(TopFolderC2 + "/" + SubFolderC2_Level2 + "/" + SubFolderC2_Level3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                conferenceFolders.SelectStudy("Accession", Accession[0]);
                string step_24 = "step24 notes";
                conferenceFolders.ModifyConferenceStudyNotes(step_24);
                if (conferenceFolders.GetConferenceStudyNotes().Equals(step_24))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout                
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Delete Conference Study Notes for a Conference Study (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96220(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables           
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferenceFolders;
            Studies studies;
            StudyViewer studyViewer;

            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = AccessionIDList.Split(':');
                Random random = new Random();
                int limit = Math.Abs((int)DateTime.Now.Ticks);
                limit = Int32.Parse(limit.ToString().Substring(0, 4));
                String roleC1 = "Role1C" + random.Next(1, limit);

                //Domains               
                //String DomainC = "DomainC_96220_" + random.Next(1, limit);

                //Domain Admin
                //String daB = "daB_96220_" + random.Next(1, limit);
                //String daB = "Administrator";
                //String daC = "daC_96220_" + random.Next(1, limit);

                //Roles                
                String roleB1 = "roleB1_96220_1_" + random.Next(1, limit);
                String roleB2 = "Physician_96220_1_" + random.Next(1, limit);
                //String roleC1 = "roleC1_96220_" + new Random().Next(1, 100);


                //Users
                String userB1 = "userB1_96220_" + random.Next(1, limit);
                String userB2 = "userB2_96220_" + random.Next(1, limit);
                String ph = "Ph_96220_" + random.Next(1, limit);
                String DoctorB = "DoctorB_96220_" + random.Next(1, limit);
                String userC1 = "userC1_96220_" + random.Next(1, limit);
                String userC2 = "userC2_96220_" + random.Next(1, limit);
                String ar = "ar_96219_" + random.Next(1, limit);

                //Folders
                String TopFolderB1 = "ONCOLOGY_96220_" + random.Next(1, 100);
                String SubFolderB1_Level2 = "Head_96220_" + random.Next(1, 100);//with no description
                String SubFolderB1_Level3 = "8-1-16 - 8-5-16_96220";
                String TopFolderB2 = "Pediatric Bone Marrow Transplant_96220_" + random.Next(1, 100);
                String SubFolderB2_Level2 = "StudyFolderB2_96220_" + random.Next(1, 100);
                String TopFolderC1 = "Cutaneous T-cell Lymphoma_96220_" + random.Next(1, 100);
                String SubFolderC1_Level2 = "StudyFolderC2";
                String StudyNotes = "StudyNotes_" + new System.DateTime().Millisecond + new Random().Next(100, 1000);

                String StudyFolder = "StudyFolder_" + random.Next(1, 100);
                String StudyFolderPath = TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + StudyFolder;
                String RelatedFolderPath = TopFolderB1 + "/" + SubFolderB1_Level2 + "/" + SubFolderB1_Level3;
                String holdingpen = "DataSource1";
                String destpacs = login.GetHostName(Config.DestinationPACS);

                //Step 1 - Precondition
                Executedsteps++;

                //Step 2 - Precondition
                login.LoginIConnect(adminUserName, adminPassword);

                //2.1 DomainB and DomainC - Conference Lists enabled

                //DomainB
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                var domainattr = domainmanagement.CreateDomainAttr();
                String DomainB = domainattr[DomainManagement.DomainAttr.DomainName];
                String daB = domainattr[DomainManagement.DomainAttr.UserID];
                String daB_pwd = domainattr[DomainManagement.DomainAttr.Password];
                domainmanagement.CreateDomain(domainattr, isconferenceneeded: true);

                //Create RoleB1 with only XDS Data Sources -- Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(DomainB, roleB1, "Conference", Config.xds1 + "=" + Config.xds2 + Config.xds3);

                //Create Physcian Role (RoleB2-Conference enabled)
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(DomainB, roleB2, "Conference=Physician", holdingpen + "=" + destpacs);

                //DomainC
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                var domainattr1 = domainmanagement.CreateDomainAttr();
                String DomainC = domainattr1[DomainManagement.DomainAttr.DomainName];
                String daC = domainattr1[DomainManagement.DomainAttr.UserID];
                String daC_pwd = domainattr1[DomainManagement.DomainAttr.Password];
                domainmanagement.CreateDomain(domainattr1, isconferenceneeded: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool bDomainB = domainmanagement.IsDomainExist(DomainB);
                bool bDomainC = domainmanagement.IsDomainExist(DomainC);

                //2.2 - daB - Conference User enabled, daC - Conference User enabled
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                //bool bdaB = usermanagement.SearchUser(daB, DomainB);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementToBeClickable(usermanagement.ClearUsrBtn()));
                bool bdaB = usermanagement.SearchUser(domainattr[DomainManagement.DomainAttr.FirstName], DomainB);
                bool bdaC = usermanagement.SearchUser(domainattr1[DomainManagement.DomainAttr.FirstName], DomainC);

                //2.3 - roleC2 - Conference User enabled
                rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                if (!rolemanagement.RoleExists(roleC1, DomainC)) rolemanagement.CreateRole(DomainC, roleC1, "Conference", Config.rdm + "=" + holdingpen + "=" + destpacs);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool broleB1 = rolemanagement.RoleExists(roleB1, DomainB);
                bool broleB2 = rolemanagement.RoleExists(roleB2, DomainB);
                bool broleC1 = rolemanagement.RoleExists(roleC1, DomainC);


                //2.4 - userA1 - Folder Manager, userA3 - conference user
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userB1, DomainB)) usermanagement.CreateUser(userB1, DomainB, roleB1); //Folder Manager
                if (!usermanagement.SearchUser(userB2, DomainB)) usermanagement.CreateUser(userB2, DomainB, roleB1); //Conference User
                if (!usermanagement.SearchUser(ph, DomainB)) usermanagement.CreateUser(ph, DomainB, roleB2); //Non-Conference User
                if (!usermanagement.SearchUser(ar, DomainB)) usermanagement.CreateUser(ar, DomainB, roleB2); //Non-Conference User
                if (!usermanagement.SearchUser(DoctorB, DomainB)) usermanagement.CreateUser(DoctorB, DomainB, roleB2); //Non-Conference User                      
                if (!usermanagement.SearchUser(userC1, DomainC)) usermanagement.CreateUser(userC1, DomainC, roleC1); //Conference User
                if (!usermanagement.SearchUser(userC2, DomainC)) usermanagement.CreateUser(userC2, DomainC, roleC1); //Conference User
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool buserB1 = usermanagement.SearchUser(userB1, DomainB);
                bool buserB2 = usermanagement.SearchUser(userB2, DomainB);
                bool buserB3 = usermanagement.SearchUser(ph, DomainB);
                bool buserB4 = usermanagement.SearchUser(DoctorB, DomainB);
                bool buserB5 = usermanagement.SearchUser(ar, DomainB);
                bool buserC1 = usermanagement.SearchUser(userC1, DomainC);
                bool buserC2 = usermanagement.SearchUser(userC2, DomainC);

                if (bDomainB && bDomainC && bdaB && bdaC && broleB1 && broleB2 && broleC1 &&
                    buserB1 && buserB2 && buserB3 && buserB4 && buserB5 && buserC2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 2.5 - Create Top Level Folders, Sub-Folders and Level3 Sub-Folders (if not done yet) ---- in DomainA
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainB, TopFolderB1))
                    conferenceFolders.CreateToplevelFolder(TopFolderB1, userB1, DomainB, TopFolderB1 + " Description");//TopFolder
                conferenceFolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2, DomainB);//Subfolder-level2

                conferenceFolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2,
                                                 SubFolderB1_Level3, DomainB,
                                                  SubFolderB1_Level3 + " Description");//SubFolder-level3
                conferenceFolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2,
                                                  StudyFolder, DomainB,
                                                  SubFolderB1_Level3 + " Description");//SubFolder-level3
                if (!conferenceFolders.IsTopLevelFolderExist(DomainB, TopFolderB2)) conferenceFolders.CreateToplevelFolder(TopFolderB2, ph + "-" + ar, null, TopFolderB2 + " Description");//Topfolder2 ph + "-" + ar

                conferenceFolders.CreateSubFolder(TopFolderB2, SubFolderB2_Level2, DomainB, SubFolderB2_Level2 + " Description");

                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopFolderC1)) conferenceFolders.CreateToplevelFolder(TopFolderC1, userC2, null, TopFolderC1 + " Description");//TopFolder3
                conferenceFolders.CreateSubFolder(TopFolderC1, SubFolderC1_Level2, DomainC, SubFolderC1_Level2 + " Description");//Subfolder-level2
                login.Logout();

                login.LoginIConnect(daB, daB_pwd);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(RelatedFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy("Accession", Accessions[2]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(RelatedFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();
                studies.SearchStudy("Accession", Accessions[3]);
                studies.SelectStudy("Accession", Accessions[3]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(RelatedFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();
                login.Logout();

                login.LoginIConnect(daC, daC_pwd);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(TopFolderC1 + "/" + SubFolderC1_Level2, notes: StudyNotes);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.CloseStudy();
                login.Logout();


                //Step 3 - Login iCA as the Folder Manager (userB of DomainB), navigate to the Conference Folders tab, select the top level folder (ONCOLOGY)
                //in which the user is a manager, browse to a study folder, select a conference study that has an exiting conference notes.     
                login.LoginIConnect(userB1, userB1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[0]);
                String notes3 = conferenceFolders.GetConferenceStudyNotes();
                if (notes3.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 4 - Click Edit Study Notes button
                conferenceFolders.Btn_EditStudyNotes().Click();
                String notes4 = conferenceFolders.GetConferenceStudyNotes();
                if (notes4.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5 - Deletes all study notes text, press Enter button.
                conferenceFolders.TxtArea_StudyNotes().Clear();
                conferenceFolders.Btn_OkStudyNotes().Click();
                String notes5 = conferenceFolders.GetConferenceStudyNotes();
                if (notes5.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6 - Browse to a different Study Folder under the same top level folder, 
                //select a conference study with an existing conference notes.
                conferenceFolders.ExpandAndSelectFolder(RelatedFolderPath);
                conferenceFolders.SelectStudy("Accession", Accessions[1]);
                String notes6 = conferenceFolders.GetConferenceStudyNotes();
                if (notes6.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7 - Browse back to the Study Folder where conference study notes was deleted.
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPath);
                conferenceFolders.SelectStudy("Accession", Accessions[0]);
                String notes7 = conferenceFolders.GetConferenceStudyNotes();
                if (notes7.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 8 - Load the conference study into study viewer, open History fly-out,
                //verify the deleted conference notes of the study in the Study Notes tab.
                conferenceFolders.SelectStudy("Accession", Accessions[0]);
                conferenceFolders.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studies.NavigateToHistoryPanel();
                bool step8_1 = studyViewer.StudyNotesTab().Enabled;
                string step8_2 = studyViewer.StudyNotesTab().GetAttribute("disabled");                
                if (step8_1 == false && step8_2.Equals("true"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studies.CloseHistoryPanel();
                studies.CloseStudy();

                //step 9 - Close study viewer, under the same top level folder select a Study Folder that has priors 
                //conference studies (e.g. related1 with notes, related2 no notes, related3 with notes), select one of 
                //them with notes (related1), delete the conference notes, verify the conference notes in NOTES/COMMENTS area.
                conferenceFolders.ExpandAndSelectFolder(RelatedFolderPath);
                conferenceFolders.SelectStudy("Accession", Accessions[1]);
                conferenceFolders.ModifyConferenceStudyNotes("", "remove");
                String notes9 = conferenceFolders.GetConferenceStudyNotes();
                if (notes9.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step-10: Select a different related study (related3 with notes) from the same patient, load the 
                //conference study into study viewer, open History fly-out, select the prior conference study(related1)
                //that has its conference notes been deleted, verify the conference study notes in the History fly-out.
                conferenceFolders.SelectStudy("Accession", Accessions[3]);
                conferenceFolders.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                login.NavigateToHistoryPanel();
                studies.ChooseColumns(new string[] { "Accession" });
                conferenceFolders.SelectStudy("Accession", Accessions[1]);
                bool step10 = studyViewer.StudyNotesTab().Enabled;
                if (step10 == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 11 - Select the related study(related3) that its notes has not been deleted.
                conferenceFolders.SelectStudy("Accession", Accessions[3]);
                bool step11_1 = studyViewer.StudyNotesTab().Displayed;
                wait.Until(ExpectedConditions.ElementToBeClickable(studyViewer.StudyNotesTab()));
                studyViewer.StudyNotesTab().Click();
                studyViewer.StudyNotesTab().Click();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")));
                bool step11_2 = conferenceFolders.Div_StudyNotes_HistoryPanel().Text.Equals(StudyNotes);
                //bool step11_2 = login.GetText("id", "m_patientHistory_m_StudyNotesViewer_studyNotesContent").Equals(StudyNotes);
                if (step11_1 && step11_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.CloseHistoryPanel();
                studies.CloseStudy();
                login.Logout();

                //Pre-condition:
                login.LoginIConnect(daB, daB_pwd);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[4]);
                studies.SelectStudy("Accession", Accessions[4]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(TopFolderB2 + "/" + SubFolderB2_Level2, notes: StudyNotes);
                studyViewer.CloseStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[0]);
                conferenceFolders.ModifyConferenceStudyNotes(StudyNotes);
                login.Logout();


                //step 12 - Login iCA as the Folder Manager (userB), select a top level folder that is not managed
                //by the Folder Manager (e.g. Pediatric Bone Marrow Transplant), browse to a conference study that
                //has notes.

                login.LoginIConnect(userB1, userB1);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderB2 + "/" + SubFolderB2_Level2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[4]);
                String notes12 = conferenceFolders.GetConferenceStudyNotes();
                if (notes12.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 13 - Attempt to delete the conference study notes by remove all text, press Enter button.

                string editBtn = conferenceFolders.Btn_EditStudyNotes().GetAttribute("disabled");
                if (conferenceFolders.Btn_EditStudyNotes().Enabled == false && editBtn.Equals("true"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();


                //step 14 - Login iCA as a conference user (e.g. DoctorA in DomainB), browse to and select a 
                //conference study that has notes.
                login.LoginIConnect(DoctorB, DoctorB);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[0]);

                //Pre Condition ******
                //conferenceFolders.ModifyConferenceStudyNotes(StudyNotes);
                //******
                String notes13 = conferenceFolders.GetConferenceStudyNotes();
                if (notes13.Equals(StudyNotes))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 15 - Attempt to delete the conference study notes.
                string editBtn2 = conferenceFolders.Btn_EditStudyNotes().GetAttribute("disabled");
                if (conferenceFolders.Btn_EditStudyNotes().Enabled == false && editBtn.Equals("true"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 16 - Login iCA as the domain admin (daB of DomainB), navigate to the Conference Folders tab,
                //select any top level conference folder in the domain (e.g. Pediatric Bone Marrow Transplant), 
                //browse to a study folder under the selected top level folder, select a conference study, 
                //delete its conference notes.
                login.LoginIConnect(daB, daB_pwd);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(TopFolderB2 + "/" + SubFolderB2_Level2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[4]);
                String notes16_1 = conferenceFolders.GetConferenceStudyNotes();
                conferenceFolders.ModifyConferenceStudyNotes("", "remove");
                String notes16_2 = conferenceFolders.GetConferenceStudyNotes();
                if (notes16_1.Equals(StudyNotes) && notes16_2.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 17 - Select a different top level folder in the domain, browse to a study folder under the
                //selected top level folder, select a conference study, delete its conference notes.
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[0]);
                //Pre Condition ******
                conferenceFolders.ModifyConferenceStudyNotes(StudyNotes);
                //******
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders.SwitchtoConferenceFrame();
                String notes17_1 = conferenceFolders.GetConferenceStudyNotes();
                conferenceFolders.ModifyConferenceStudyNotes("", "remove");
                String notes17_2 = conferenceFolders.GetConferenceStudyNotes();
                if (notes17_1.Equals(StudyNotes) && notes17_2.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //step 18 - With the domain admin (daB of DomainB) logged in iCA, search and attempt to select a 
                //top level folder under a different domain that is not managed by the domain admin 
                //(e.g. top level folder Cutaneous T-cell Lymphoma in DomainC)
                IWebElement folder = conferenceFolders.ExpandAndSelectFolder(TopFolderC1);
                if (folder == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Pre-condition:               
                conferenceFolders.ExpandAndSelectFolder(TopFolderB2 + "/" + SubFolderB2_Level2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[4]);
                conferenceFolders.ModifyConferenceStudyNotes("Studynotes");
                login.Logout();


                //step 19 - Login iCA as Super Admin, navigate to the Conference Folders tab, select a domain 
                //(DomainB), select any top level conference folder in the selected domain (e.g. Pediatric Bone Marrow Transplant),
                //browse to a study folder under the selected top level folder, select a conference study, delete its conference notes.
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                conferenceFolders.DomainSelector().SelectByText(DomainB);
                conferenceFolders.ExpandAndSelectFolder(TopFolderB2 + "/" + SubFolderB2_Level2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[4]);
                String notes19_1 = conferenceFolders.GetConferenceStudyNotes();
                conferenceFolders.ModifyConferenceStudyNotes("", "remove");
                String notes19_2 = conferenceFolders.GetConferenceStudyNotes();
                if (notes19_1.Equals("Studynotes") && notes19_2.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //step 20 - Select a different domain (e.g. DomainC) select any top level conference folder in the 
                //selected domain (e.g. Cutaneous T-cell Lymphoma in DomainC), browse to a study folder under the 
                //selected top level folder, select a conference study, delete its conference notes.
                conferenceFolders.DomainSelector().SelectByText(DomainC);
                conferenceFolders.ExpandAndSelectFolder(TopFolderC1 + "/" + SubFolderC1_Level2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[0]);
                String notes20_1 = conferenceFolders.GetConferenceStudyNotes();
                conferenceFolders.ModifyConferenceStudyNotes("", "remove");
                String notes20_2 = conferenceFolders.GetConferenceStudyNotes();
                if (notes20_1.Equals(StudyNotes) && notes20_2.Equals(""))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout                
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Archive Folder (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96221(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domain;
            RoleManagement role1;
            UserManagement user;
            Studies study;
            Patients patient;
            Inbounds inbounds;
            Outbounds outbounds;
            StudyViewer viewer;
            ConferenceFolders conference;
            TestCaseResult result;

            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;


            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                string EA_91 = "VMSSA-5-38-91";
                string EA_131 = "VMSSA-4-38-131";
                string RDM_EA_131 = Config.rdm +".VMSSA-4-38-131";
                string RDM = Config.rdm;
                string XDS = "XDS_DS";
                string EA_116 = "EA-116";
                string EA_46 = "EA-46";
                //string Datasource_Image = "DATASOURCE1";
                String holdingpen = login.GetHostName(Config.HoldingPenIP);
                //string PACS_A3 = "PA-A3-WS8";
                String destpacs = login.GetHostName(Config.DestinationPACS);

                string PACS_A7 = "PA-A7-WS8";
                string RDM_PACS_A6 = Config.rdm+".PA-A6-WS8";


                //String[] datasource = null;

                //String Dest1 = Config.Dest1;
                //String EIPath = Config.EIFilePath;

                String PatientNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] PatientName = PatientNameList.Split(':');

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                String StudyDateList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyDate");
                String[] StudyDate = StudyDateList.Split('=');


                //Step-1:[Pre-conditions-]
                //1. iCA build under testing is installed on the main iCA server.
                //2. Image Sharing, XDS, Remote Data source Manager are configured on the main sever
                //3. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing
                //4. Domains and Roles have Conference Lists and Conference User enabled
                //5. Other iCA configurations under testing are specified in Test Assignments 
                //and PQA Test Plan for the release. (e.g. version of remote iCA server, HTTP or HTTPS,
                //HTML4 viewer or HTML5 viewer, browser versions, OS versions etc...)


                taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();

                //**##- uncomment
                //servicetool.LaunchServiceTool();
                //servicetool.NavigateToEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.ModifyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.EnableConferenceLists(0);
                //wpfobject.WaitTillLoad();
                //servicetool.ApplyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //wpfobject.ClickOkPopUp();
                //wpfobject.WaitTillLoad();
                //servicetool.RestartService();
                //wpfobject.WaitTillLoad();
                //servicetool.CloseServiceTool();
                taskbar.Show();






                //Enable ConferenceLists Check Box in Super Admin Domain


                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();

                if (domain.ConferenceListsCB().Selected == false)
                {
                    domain.ConferenceListsCB().Click();
                    Logger.Instance.InfoLog("ConferenceLists Check Box Selected successfully");
                }
                else
                {
                    Logger.Instance.InfoLog("ConferenceLists Check Box already selected");
                }
                domain.ClickSaveNewDomain();
                login.Logout();

                Executedsteps++;

                //****
                int random_No = new Random().Next(1000);
                //int random_No = 970;

                //Stpe-2
                //Pre-conditions-   

                //Use existing domains, roles and Conference Users or created new ones as following. e.g.
                //-----> DomainC: connect to MergePACS, EADICOM, RDM.MergePACS and RDM.EADICOM (e.g. MP, EA, rdm.mp, rdm.ea)
                //Domain Admin: daC
                //Role: roleC1, connect to all data source
                //GroupC1 users in roleC1: userC1, userC5
                //GroupC1 Data sourced: only connected to 1 data source (e.g. rdm.ea or rdm.pm);
                //Role: roleC2, only connected to 1 data source MP or EA, no access to RDM data source
                //Ungrouped users in roleC2: userC2, userC4

                //-----> DomainB has XDS and Imagesharing enabled
                //Domain Admin: daB
                //Role: roleB, connect only to PQA XDS test data sources: EA-46, EA-116, XDS_DS
                //User in roleB: userB
                //The following image sharing roles are not able to access data sources in role daB
                //Role: Physician; User: ph, doctorA  **
                //Role: Archivist, User: ar        **
                //Role: staff (conference disabled at domain and role); 
                //User: st (non-conference user)

                String DomainC = "DomainC_96221_" + random_No;
                String daC = DomainC;
                String roleC1 = "roleC1_96221_" + random_No; //connect to all data source
                String roleC2 = "roleC2_96221_" + random_No; //only connected to 1 data source MP or EA, no access to RDM data source

                //Group--
                String GroupC1 = "GroupC1_96221_" + random_No; //GroupC1 

                String userC1 = "userC1_96221_" + random_No; //GroupC1 users
                String userC5 = "userC5_96221_" + random_No; //GroupC1 users
                String userC2 = "userC2_96221_" + random_No; //Ungrouped users
                String userC4 = "userC4_96221_" + random_No; //Ungrouped users
                String userC1Manager = "userC1_FM_96221_" + random_No; //Folder Manager--

                // DomainB has XDS and Imagesharing enabled
                String DomainB = "DomainB_96221_" + random_No;
                String daB = DomainB;

                String roleB = "roleB_96221_" + random_No; //PQA XDS test data sources: EA-46, EA-116, XDS_DS
                String userB = "userB_96221_" + random_No; //roleB

                String Physician = "Physician_96221_" + random_No;
                String ph = "ph_96221_" + random_No;
                String doctorA = "doctorA_96221_" + random_No;

                String Archivist = "Archivist_96221_" + random_No;
                String ar = "ar_96221_" + random_No;

                String Staff = "Staff_96221_" + random_No; //conference disabled at domain and role
                String st = "st_96221_" + random_No;

                //-------------------DomainC

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainC, DomainC, datasources: new String[] { EA_91, PACS_A7, RDM }); //4 DS
                //Enable conference list and grant access check box
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.ClickSaveNewDomain();


                role1 = (RoleManagement)login.Navigate("RoleManagement");
                //Role: roleC1, connect to all data source
                role1.CreateRole(DomainC, roleC1, "conference");
                //Role: roleC2, only connected to 1 data source MP or EA, no access to RDM data source
                role1.CreateRole(DomainC, roleC2, "conference", EA_91);

                user = (UserManagement)login.Navigate("UserManagement");
                //Ungrouped users in roleC2: userC2, userC4
                user.CreateUser(userC2, DomainC, roleC2);
                user.CreateUser(userC4, DomainC, roleC2);

                bool uC2 = user.SearchUser(userC2, DomainC);
                bool uC4 = user.SearchUser(userC4, DomainC);

                //GroupC1 users in roleC1: userC1, userC5
                user.CreateGroup(DomainC, GroupC1, rolenames: new string[] { roleC1 }, rdm: 1, datasources: new string[] { EA_131 });//RDM EA 131
                user.CreateUserForGroup(GroupC1, userC1, DomainC, roleC1);
                user.CreateUserForGroup(GroupC1, userC5, DomainC, roleC1);
                user.CreateUserForGroup(GroupC1, userC1Manager, DomainC, roleC1); //Fro Grant Access

                bool uC1 = user.SearchUser(userC1, DomainC);
                bool uC5 = user.SearchUser(userC5, DomainC);
                bool uC1Manager = user.SearchUser(userC1Manager, DomainC);

                //------DomainB has XDS and Imagesharing enabled
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainB, DomainB, datasources: new String[] { XDS, EA_46, EA_116, holdingpen, destpacs });
                //Enable conference list , grant access and image sharing check box
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.SetCheckBoxInEditDomain("imagesharing", 0);
                domain.ClickSaveNewDomain();

                role1 = (RoleManagement)login.Navigate("RoleManagement");
                //role1.CreateRole(DomainC, roleC1, "conference", new String[] { XDS, EA_46, EA_116 });
                role1.CreateRole(DomainB, roleB, "conference", XDS + "=" + EA_46 + "=" + EA_116); //have to update code
                PageLoadWait.WaitForPageLoad(20);
                role1.CreateRole(DomainB, Physician, "conference=physician", destpacs);
                PageLoadWait.WaitForPageLoad(20);
                role1.CreateRole(DomainB, Archivist, "conference=archivist");
                PageLoadWait.WaitForPageLoad(20);
                role1.CreateRole(DomainB, Staff, "NA"); //(conference disabled at domain and role);


                user = (UserManagement)login.Navigate("UserManagement");
                user.CreateUser(userB, DomainB, roleB);
                user.CreateUser(ph, DomainB, Physician);
                user.CreateUser(doctorA, DomainB, Physician);
                user.CreateUser(ar, DomainB, Archivist);
                user.CreateUser(st, DomainB, Staff);  //Staff (non-conference user)

                bool uB = user.SearchUser(userB, DomainB);
                bool uPh = user.SearchUser(ph, DomainB);
                bool udoctorA = user.SearchUser(doctorA, DomainB);
                bool uar = user.SearchUser(ar, DomainB);
                bool ust = user.SearchUser(st, DomainB);

                if (uB && uPh && udoctorA && uar && ust &&
                    uC1 && uC2 && uC4 && uC5 && uC1Manager)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();


                //Step-3
                //Pre-conditions:
                //Use existing conference folders and conference studies or create new ones as following e.g.
                //              -----> DomainC
                //A) Top Level Folder Name: Cutaneous T-cell Lymphoma; Folder Manager: userC5
                // --> Level 2 sub1 - test Active Folder Status --> references to 1 conference study
                // --> Level 2 sub2 - test Active Folder Status --> Level3 sub2/1 --> references to 1 conference study
                // --> Level2 sub3 - from different data sources --> references to 4 studies from MP, EA, rdm.mp, rdm.ea

                //B) Top level Folder Name: Head and Neck; Folder Manager: userC4
                // --> Different Modalities --> multiple level3 sub-folders (meeting for week1, and meeting for week2, etc...) 
                //     --> references to more than one conference studies with supported modalities CR, DX, MG, IO, US-mf, CT, MR, NM, US, SC SC-mf Color, XA, RF, Breast Tomo, PT, ES VL, OPT, RTIMAGE, with or without notes
                // --> Studies from related view --> references to 3 related conference studies
                // --> Saved GSPS studies --> references 2 conference studies with saved GSPS image or series
                // --> studies from Grant Access --> references to 2 studies that were shared via grant access 
                //(1 study with/without notes and granted by userC1 in Inbounds , 1 granted by userC4 in Outbounds without notes)

                //DomainC
                //Top Folder

                String Cutaneous = "Cutaneous T-cell Lymphoma_96221_" + random_No;
                String Level_2_sub1 = "Level 2 sub1_96221_" + random_No;//Level 2.
                String Level_2_sub2 = "Level 2 sub2_96221_" + random_No;//Level 2.
                String Level_3_sub2_1 = "Level 3 sub2_1_96221_" + random_No; //Level 3
                String Level_2_sub3 = "Level 2 sub3_96221_" + random_No; //Level -2.. 4 studies--

                //Top Folder
                String Head_and_Neck = "Head and Neck_96221_" + random_No;
                String Different_Modalities_L2 = "Different Modalities_96221_" + random_No; //Level 2
                String meeting_for_week1_L_3 = "meeting for week1_L_3_96221_" + random_No;  //Level3
                String meeting_for_week2_L_3 = "meeting for week2_L_3_96221_" + random_No; //Level3

                String Studies_from_related_view_L2 = "Studies from related view_96221_" + random_No;  //Level2
                String Saved_GSPS_studies_L2 = "Saved GSPS studies_96221_" + random_No;  //Level2
                String studies_from_Grant_Access_L2 = "studies from Grant Access_96221_" + random_No;  //Level2


                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);

                conference = login.Navigate<ConferenceFolders>();
                //Cutaneous T-cell Lymphoma
                bool Top1 = conference.CreateToplevelFolder(Cutaneous, domain: DomainC, foldermanager: userC5); //TopFloder   
                bool sub1 = conference.CreateSubFolder(Cutaneous, Level_2_sub1, DomainC); //Level 2
                bool sub2 = conference.CreateSubFolder(Cutaneous, Level_2_sub2, DomainC); //Level 2
                bool sub3 = conference.CreateSubFolder(Cutaneous + "/" + Level_2_sub2, Level_3_sub2_1, DomainC); //Level 3
                bool sub4 = conference.CreateSubFolder(Cutaneous, Level_2_sub3, DomainC);

                //Head and Neck
                bool Top2 = conference.CreateToplevelFolder(Head_and_Neck, foldermanager: userC4 + "-" + userC1Manager, domain: DomainC); //TopFloder   

                bool sub5 = conference.CreateSubFolder(Head_and_Neck, Different_Modalities_L2, Domain_Name: DomainC);  //Level 2
                bool sub6 = conference.CreateSubFolder(Head_and_Neck + "/" + Different_Modalities_L2, meeting_for_week1_L_3, Domain_Name: DomainC);  //Level 3
                bool sub7 = conference.CreateSubFolder(Head_and_Neck + "/" + Different_Modalities_L2, meeting_for_week2_L_3, Domain_Name: DomainC);  //Level 3
                bool sub8 = conference.CreateSubFolder(Head_and_Neck, Studies_from_related_view_L2, DomainC);  //Level 2
                bool sub9 = conference.CreateSubFolder(Head_and_Neck, Saved_GSPS_studies_L2, DomainC);  //Level 2
                bool sub10 = conference.CreateSubFolder(Head_and_Neck, studies_from_Grant_Access_L2, DomainC);  //Level 2                
                login.Logout();


                login.DriverGoTo(login.url);
                login.LoginIConnect(DomainC, DomainC);

                study = (Studies)login.Navigate("Studies");
                study.RDM_MouseHover("rdm");
                //Accession[0] =MS10025 --A7
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[0], PACS_A7);
                //Accession[1] =1105201501 --RDM A6
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[1], RDM_PACS_A6);
                //Accession[2] =40079 --RDM 131
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[2], RDM_EA_131);
                //Accession[3] =U-ID179490 -- EA 91
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[3], EA_91);
                //Accession[4] =TW31747884 -- EA 91
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub1, Accession[4], EA_91);
                //Accession[5] =MS10026 -- EA 91
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1, Accession[5], EA_91);

                //week 1 Different modality
                //Accession[6]:Accession[7]
                //SMS000023:AC8357267: DR:XA:
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3, Accession[6], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3, Accession[7], EA_91);

                //week 2 Different modality
                //Accession[8]:Accession[9]
                //537103:8   PT:US
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3, Accession[8], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3, Accession[9], EA_91);

                //3 related study--- //B E
                //Accession[10]:Accession[11]:Accession[12]
                //:1700795:1742901:1211824
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Studies_from_related_view_L2, Accession[10], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Studies_from_related_view_L2, Accession[11], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Studies_from_related_view_L2, Accession[12], EA_91);

                //GSPS
                //Accession[13] =d60067ea5  -- GSPS --A7
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2, Accession[13], PACS_A7);
                login.Logout();


                login.DriverGoTo(login.url);
                login.LoginIConnect(userC4, userC4);
                study = (Studies)login.Navigate("Studies");
                //Accession[14]:Accession[15] EA 91
                //414953:234234
                study.SearchStudy(AccessionNo: Accession[14], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[14]);
                study.ShareStudy(false, new String[] { userC1Manager });

                study.SearchStudy(AccessionNo: Accession[15], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[15]);
                study.ShareStudy(false, new String[] { userC1Manager });
                outbounds = (Outbounds)login.Navigate("Outbounds");
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + studies_from_Grant_Access_L2, Accession[14]);

                login.Logout();
                login.DriverGoTo(login.url);
                login.LoginIConnect(userC1Manager, userC1Manager);
                inbounds = (Inbounds)login.Navigate("Inbounds");
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + studies_from_Grant_Access_L2, Accession[15]);
                login.Logout();


                if (Top1 && Top2 && sub1 && sub2 && sub3 && sub4
                   && sub5 && sub6 && sub7 && sub8 && sub9 && sub10)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-4
                //Pre-conditions:
                //-----> DomainB
                //C) Top Level Folder Name: Monthly Oncology Tumor Boards; Folder Manager: userB
                //  --> Hybrid, XDS only & DICOM only --> references to hybrid, XDS only, DICOM only conference studies added from Studies tab
                //  --> From Patient Record\XDS sub-tab -->references to 1 DICOM added from related view, without notes in 2nd view; 
                //                         1 XDS added from related view, with notes in 3rd view studies added from Patients tab
                //  --> MIME types --> references to all supported MINE types studies

                //D) Top Level Folder Name: Pediatric Bone Marrow Transplant; Folder Manager: ar, ph
                //Pediatric Bone Marrow Transplant --> Image sharing #1 ---> references to 0 studies

                //DomainB
                String Monthly_Oncology = "Monthly Oncology Tumor Boards_96221_" + random_No; //TopFloder   
                String Hybrid_XDS_DICOM_L2 = "Hybrid, XDS only, DICOM only_96221_" + random_No; // Level 2
                String From_Patient_Record_XDS_sub_tab_L2 = "From Patient Record or XDS sub-tab_96221_" + random_No; //Level2
                String MIME_types_L2 = "MIME types_96221_" + random_No; //Level2

                String Pediatric_Bone = "Pediatric Bone Marrow Transplant_96221_" + random_No;//TopFloder   
                String Image_sharing_L2 = "Image sharing #1_96221_" + random_No; //Level2



                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);

                conference = login.Navigate<ConferenceFolders>();

                //Monthly Oncology Tumor Boards
                bool Top3 = conference.CreateToplevelFolder(Monthly_Oncology, userB, DomainB); //TopFloder   

                bool sub11 = conference.CreateSubFolder(Monthly_Oncology, Hybrid_XDS_DICOM_L2, DomainB); //Level2
                bool sub12 = conference.CreateSubFolder(Monthly_Oncology, From_Patient_Record_XDS_sub_tab_L2, DomainB); //Level2
                bool sub13 = conference.CreateSubFolder(Monthly_Oncology, MIME_types_L2, DomainB); //Level2

                //TopFloder -Pediatric Bone Marrow Transplant
                bool Top4 = conference.CreateToplevelFolder(Pediatric_Bone, ar + "-" + ph, DomainB);
                bool sub14 = conference.CreateSubFolder(Pediatric_Bone, Image_sharing_L2, DomainB); //Level2
                login.Logout();

                login.DriverGoTo(login.url);
                login.LoginIConnect(DomainB, DomainB);

                study = (Studies)login.Navigate("Studies");

                //Accession[16] ="ACC1962" -- hybrid
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2, Accession[16], EA_46);
                //Accession[17] ="ACC19621" -- DICOM
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2, Accession[17], EA_46);

                //Adding XDS Studies From Studies Tab(History Panel).
                //StudyDate[1]=unknown   (AE1962)  ---- XDS
                study.SearchStudy(AccessionNo: Accession[16], Datasource: EA_46);
                study.SelectStudy("Accession", Accession[16]);
                viewer = study.LaunchStudy();
                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[1] });
                PageLoadWait.WaitForPageLoad(30);
                viewer.Thumbnails(2)[0].Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);
                study.CloseStudy();

                //Accession[16] ="ACC1962" -- hybrid -MIME
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[16], EA_46);


                patient = (Patients)login.Navigate("Patients");

                //PatientName[0]=Burton, PQA
                //Accession[16] ="ACC1962" -- hybrid
                //StudyDate[0]=15-May-1998 4:09:38 PM  (ACC19621)-- DICOM
                //StudyDate[1]=unknown   (AE1962)  ---- XDS

                patient.InputData(PatientName[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientName[0].Trim());
                viewer = patient.LaunchStudy(Patients.PatientColumns.Accession, Accession[16]);

                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[0] });
                PageLoadWait.WaitForPageLoad(30);

                viewer.NavigateToHistoryPanel();
                viewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[1] });
                PageLoadWait.WaitForPageLoad(30);

                viewer.SeriesViewer_1X1(2).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(Monthly_Oncology + "/" + From_Patient_Record_XDS_sub_tab_L2);

                viewer.SeriesViewer_1X1(3).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(Monthly_Oncology + "/" + From_Patient_Record_XDS_sub_tab_L2, notes: "XDS Study Notes Precondition");


                viewer.CloseStudy();
                patient.ClosePatientRecord();

                login.Logout();

                if (Top3 && Top4 && sub11 && sub12 && sub13 && sub14)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-5
                //[Folder Manager archives a Folder in which the user is an administrator of]
                //Login iCA as a folder manager (userC5 in DomainC), navigate to the Conference Folders tab,
                // browse to a top level folder that is managed by the user,
                //select a study folder under it (has 1 study). 
                //(Cutaneous T-cell Lymphoma -->Level 2 sub1 - test Active Folder Status --> references to 1 conference study), 
                //click Archive button.

                //[Note: before a archive folder, 
                //please take a screenshot or notes of folder details to be archived,
                //such as patient and study information, number of studies and images; 
                //they will be used in next test case (Conference Lists - 
                //View the contents of the archive and bring Folder out from archive (Desktop only)) 
                //for correctness checking]

                //Have to take structure**

                login.LoginIConnect(userC5, userC5);
                conference = login.Navigate<ConferenceFolders>();


                conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub1);

                //Archive and synchup
                conference.ClickElement(conference.Btn_ArchiveFolder());
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (conference.Div_Confirmation().FindElement(By.CssSelector("div#ConfirmationDiv>div:nth-of-type(1)>span")).GetAttribute("innerHTML").ToLower().Equals("archive folder"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });

                //User is presented with a confirmation dialog with OK/Cancel buttons.

                if (conference.Div_Confirmation().Displayed &&
                    conference.Btn_Cancel_ConfirmationDiv().Displayed &&
                    conference.Btn_OKConfirmationDiv().Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6
                //Click OK in the dialog.

                conference.Btn_OKConfirmationDiv().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(conference.Div_ConfirmationBy()));
                conference.SwitchtoConferenceFrame();
                BasePage.wait.Until<Boolean>(driver => driver.FindElements(By.CssSelector("table#gridTableConferenceStudyRecords tr")).Count == 1);


                //Folder Managers is able to archive a Sub-Folder under a Top Level Folder or
                //one of the children of a Top Level Folder in which they are a Folder Manager.
                Executedsteps++;

                //Step-7

                //From Folder Browser attempt to select and view the contents of study folder that just archived.

                IWebElement ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub1);





                //The Study Folder that just archived is no longer listed in the folder browser when the selected Folder was a Study Folder.
                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8

                //From Folder Browser, under a top level folder managed by the user, 
                //select a study folder contains more conference studies. 
                //(Cutaneous T-cell Lymphoma --> Level2 sub3 - from different data sources --> 
                //references to 4 studies from MP, EA, rdm.mp, rdm.ea), Archive the selected Study Folder


                conference.ArchiveConferenceFolder(Cutaneous + "/" + Level_2_sub3);


                //Folder Managers is able to archive a Sub-Folder under a Top Level Folder or
                //one of the children of a Top Level Folder in which they are a Folder Manager.
                Executedsteps++;


                //Step-9
                //From Folder Browser attempt to select and view the contents of study folder 
                //that just archived.

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub1);




                //The Study Folder that just archived is no longer listed in the folder browser when the selected Folder was a Study Folder.
                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-10

                //Login iCA as a different folder manager (userC4 from DomainC), navigate to the Conference Folders tab,
                // from Folder Browser selected the top level folder managed by the user, 
                //and then select a sub-folder which is not a Study Folder and it contains more than one Study Folders
                //(Head and Neck --> Different Modalities --> multiple level3 sub-folders), 
                //Archive the Non-Study Folder (Head and Neck -->Different Modalities)


                login.LoginIConnect(userC4, userC4);
                conference = login.Navigate<ConferenceFolders>();

                conference.ArchiveConferenceFolder(Head_and_Neck + "/" + Different_Modalities_L2);

                //Folder Managers is able to archive a Sub-Folder under a Top Level Folder or one of the children of a Top Level Folder in which they are a Folder Manager.
                Executedsteps++;

                //Ste[-11
                //From Folder Browser attempt to select and view the contents of the sub-folder that was selected for archived.

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3);
                bool Step11_1 = ele == null;


                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3);
                bool Step11_2 = ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2);
                bool Step11_3 = ele.GetAttribute("innerHTML").Equals(Different_Modalities_L2);

                //All child/descendent Study Folders of the selected folder are archived and no longer listed; 
                //Applying an archive operation to a Non-Study Folder shall archive all child/descendent Study Folders.

                //** Have to verify count (child/descendent)

                if (Step11_1 && Step11_2 && Step11_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12

                //[Folder Manager attempts to archive a Top Level Folder in which the user is an administrator of]
                //Select the top level folder (Head and Neck) that is managed by the Folder Manager (userC4),
                //attempt to archive the top level folder.

                conference.ExpandAndSelectFolder(Head_and_Neck);

                //The Archive button is disabled when the Top Level Folder managed by the user is selected; 
                //Folder Managers are only able to archive a Sub-Folder in a Top Level Folder or
                //one of the children of a Top Level Folder in which they are a Folder Manager.

                if (conference.Btn_ArchiveFolder().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13

                //[Folder Manager attempts to archive a Folder in which the user is NOT an administrator of]  
                //As the folder manager (userC4) logged iCA, from Folder Browser select a study folder 
                //which is not managed by the folder manager 
                //(e.g. Cutaneous T-cell Lymphoma --> Level 2 sub2 - test Active Folder Status --> Level3 sub2/1),
                //attempt to archive the selected folder.


                conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);


                //The Archive button is disabled when the user is not a Folder Manager of the top level folder;
                //Folder Managers are only able to archive a Sub-Folder in a Top Level Folder 
                //or one of the children of a Top Level Folder in which they are a Folder Manager.

                if (conference.Btn_ArchiveFolder().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-14

                //Select the top level folder (Head and Neck) that is managed by the folder manager, 
                //create a new sub-folder (e.g. 9/6/16 - 9/9/16), without adding any studies to this folder, 
                //attempt to archive the folder.

                String Sub_9_6_16__9_9_16_L2 = "9_6_16__9_9_16_L2" + random_No;

                conference.CreateSubFolder(Head_and_Neck, Sub_9_6_16__9_9_16_L2);

                conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Sub_9_6_16__9_9_16_L2);

                //The Archive button is disabled when the selected sub-folder does not contain any references to a study 
                //(or does not contain any study folders); 
                //Only Study Folders and Folders which contain at least one child/descendent
                //Study Folder are eligible for an archive operation.

                if (conference.Btn_ArchiveFolder().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();
                //Step-15

                //[Conference User attempts to archive a Folder within the use's domain]  
                //Login iCA as a conference user (userC1 in DomainC), select a folder that contains study folder(s),
                //attempt to archive folders.

                login.LoginIConnect(userC1, userC1);
                conference = login.Navigate<ConferenceFolders>();

                conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);

                //The Archive button is hidden, conference user has no permission to archive any folders.

                if (conference.Btn_ArchiveFolder().Displayed == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-16
                //[Domain Admin archives a Folder in the domain the user is an administrator of]  
                //Login iCA as a domain admin (daB in DomainB), navigate to Conference Folders tab, 
                //select a study folder in the domain 
                //(e.g. Monthly Oncology Tumor Boards -->Hybrid, XDS only & DICOM only) Archive the folder.

                login.LoginIConnect(daB, daB);
                conference = login.Navigate<ConferenceFolders>();

                conference.ArchiveConferenceFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);


                //The study folder is archived when the selected Folder was a Study Folder; 
                //the archived Study Folder is removed from the Active sub-tab and listed in the Archive sub-tab;
                //Domain Admins have permission to archive any Study Folders under the domain in which they are an administrator of.

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);
                conference.NavigateToArchiveMode();
                IWebElement Arc_ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);


                if (ele == null && Arc_ele != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-17
                //Login iCA as a domain admin who is managing a different domain (daC in DomainC),
                //navigate to the Conference Folders tab, select Active sub-folder in the folder browser,
                //select a top level folder in the domain (Head and Neck),
                //in which, it has archived study folders, 3 have not yet archived study folders 
                //and 1 folder does not have any study; archive the top level folder (non-Study folder)

                login.LoginIConnect(daC, daC);
                conference = login.Navigate<ConferenceFolders>();

                conference.ArchiveConferenceFolder(Head_and_Neck);

                //Domain Admins have the ability to archive Top Level Folder.
                //The archived Study Folder is removed from the Active sub-tab and added into the Archive sub-tab;

                //the non-study folder remains in the Active sub-tab unchanged.


                //studies_from_Grant_Access_L2
                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Sub_9_6_16__9_9_16_L2);
                bool step17_1 = ele != null && ele.GetAttribute("innerHTML").Equals(Sub_9_6_16__9_9_16_L2);

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2);
                bool step17_2 = ele != null && ele.GetAttribute("innerHTML").Equals(Different_Modalities_L2);

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Studies_from_related_view_L2);
                bool step17_3 = ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2);
                bool step17_4 = ele == null;

                conference.NavigateToArchiveMode();

                Arc_ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Studies_from_related_view_L2);
                bool step17_6 = Arc_ele != null && Arc_ele.GetAttribute("innerHTML").Equals(Studies_from_related_view_L2);

                Arc_ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2);
                bool step17_7 = Arc_ele != null && Arc_ele.GetAttribute("innerHTML").Equals(Saved_GSPS_studies_L2);


                if (step17_1 && step17_2 && step17_3 && step17_4 && step17_6 && step17_7)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-18
                //From Folder Browser Active sub-tab view the folder just archived.
                conference.NavigateToActiveMode();

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Sub_9_6_16__9_9_16_L2);
                bool step18_1 = ele != null && ele.GetAttribute("innerHTML").Equals(Sub_9_6_16__9_9_16_L2); ;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2);
                bool step18_2 = ele != null && ele.GetAttribute("innerHTML").Equals(Different_Modalities_L2);

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3);
                bool step18_3 = ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3);
                bool step18_4 = ele == null;


                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Studies_from_related_view_L2);
                bool step18_5 = ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2);
                bool step18_6 = ele == null;


                //Applying an archive operation to a Non-Study Folder shall archive all child/descendent Study Folders.
                //All child/descendent Study Folders of the archived folders are listed in the Archive sub-tab; 
                //the Non-study sub-folder (Head and Neck --> 9/6/16 - 9/9/16) contains no study is not archived 
                //and remains in the Archive sub-tab unchanged.

                if (step18_1 && step18_2 && step18_3 && step18_4 && step18_5 && step18_6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19

                //From Folder Browser Active sub-tab, Attempt to view conference studies under the archived Study Folder.

                //studies_from_Grant_Access_L2**

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2);
                bool step19_1 = ele != null && ele.GetAttribute("innerHTML").Equals(Different_Modalities_L2);

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3);
                bool step19_2 = ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3);
                bool step19_3 = ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Studies_from_related_view_L2);
                bool step19_4 = ele == null;

                ele = conference.ExpandAndSelectFolder("test1" + "/" + Studies_from_related_view_L2);

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2);
                bool step19_5 = ele == null;

                Logger.Instance.InfoLog(step19_1 + "  " + step19_2 + "  " + step19_3 + "  " + step19_4 + "  " + step19_5);

                //The archived folders are no longer visible in the Active sub-tab in the Conference tab.


                if (step19_1 && step19_2 && step19_3 && step19_4 && step19_5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-20

                //[Domain Admin attempts to archive a Folder belongs to a domain the user is not an administrator of]
                //Login iCA as a domain admin (daB in DomainB), navigate to Conference Folders tab,
                //select Active sub-tab; attempt to archive a folder that is not belonging to the domain manager
                //(e.g. DomainC, Cutaneous T-cell Lymphoma --> Level 2 sub2 - test Active Folder Status --> Level3 sub2/1-->
                //references to 1 conference study)

                login.LoginIConnect(daB, daB);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);

                //The domain admin does not have access any folders belonging to a domain 
                //in which the user is not an administrator of.
                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-21
                //[Super Admin archives a Folder within the selected domain]  
                //Login iCA as Super Admin, navigate to Conference Folders tab, 
                //select a domain (e.g. DomainC), archive a folder contains a Study Folder 
                //(e.g. Cutaneous T-cell Lymphoma --> Level 2 sub2 - test Active Folder Status --> Level3 sub2/1--> 
                //references to 1 conference study)


                login.LoginIConnect(adminusername, adminpassword);
                conference = login.Navigate<ConferenceFolders>();

                conference.ArchiveConferenceFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1, DomainC);


                //When the selected Folder contains Study Folder,
                //the Study Folder is archived and moved from Active sub-tab to Archive sub-tab;
                //Super Admins have permission to archive any Study Folders under a domain selected.


                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);
                conference.NavigateToArchiveMode();
                Arc_ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);

                if (Arc_ele != null && Arc_ele.GetAttribute("innerHTML").Equals(Level_3_sub2_1))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-22

                //Select a different domain (DomainB), repeat above step, 
                //select a top level folder with the domain (Pediatric Bone Marrow Transplant\Image sharing #1), 
                //Archive the top level folder.
                conference.NavigateToActiveMode();

                conference.ExpandAndSelectFolder(Pediatric_Bone, DomainB);

                //When the selected Folder contains Study Folder, 
                //the Study Folder is archived and moved from Active sub-tab to Archive sub-tab;
                //Super Admins have permission to archive any Study Folders under a domain selected.


                //Studies not available in the "Pediatric Bone" Folder, just verifying the button is disabled status,

                if (conference.Btn_ArchiveFolder().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-23

                //[Super Admin archives a Folder that is belonging to a domain outside of the selected domain] 
                //Login iCA as Super Admin, navigate to Conference Folders tab, select a domain (e.g. DomainB), 
                //attempt to archive a folder contains a Study Folder which is in a different domain 
                //(e.g. Cutaneous T-cell Lymphoma -->Level 2 sub2 - test Active Folder Status-->Level3 sub2/1 under DomainC)

                conference.DomainSelector().SelectByText(DomainB);

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);


                //The top level folder outside the selected domain is not listed in the Folder Browse Active sub-tab.

                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-24

                //[Conference user browse folder]  
                //Login iCA as a conference user in a domain (userC1 in DomainC),
                //navigate to each of folder in the Conference Folders tab, 
                //attempt to view contents of each folder that has been archived.


                login.LoginIConnect(userC1, userC1);
                conference = login.Navigate<ConferenceFolders>();

                bool flag = true;

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub1);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub3);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Studies_from_related_view_L2);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2);
                flag = flag && ele == null;

                ele = conference.ExpandAndSelectFolder(Head_and_Neck + "/" + studies_from_Grant_Access_L2);
                flag = flag && ele == null;

                //Conference user is no longer able to view contents of study folders that are archived;

                if (flag)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-25
                //Login iCA as a conference user the other domain (doctorA in DomainB),
                //navigate to each of folder in the Conference Folders tab, 
                //attempt to view contents of each folder that has been archived.

                // Archived only one study Hybrid_XDS_DICOM_L2 folder

                login.LoginIConnect(doctorA, doctorA);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);

                //Conference user is no longer able to view contents of study folders that are archived;

                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-26
                //Browse and view contents of those study folders that have not been archived.

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + From_Patient_Record_XDS_sub_tab_L2);
                bool step_26_1 = ele != null && ele.GetAttribute("innerHTML").Equals(From_Patient_Record_XDS_sub_tab_L2);

                //Verify the study list
                bool step_26_2 = BasePage.GetSearchResults().Count == 2;

                Dictionary<string, string> Studylist_26_1 = conference.GetMatchingRow("Accession", Accession[16]);
                Dictionary<string, string> Studylist_26_2 = conference.GetMatchingRow("Accession", Accession[16]);


                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + MIME_types_L2);
                bool step_26_3 = ele != null && ele.GetAttribute("innerHTML").Equals(MIME_types_L2);

                //Verify the study list
                bool step_26_4 = BasePage.GetSearchResults().Count == 1; //one study added
                Dictionary<string, string> Studylist_26_3 = conference.GetMatchingRow("Accession", Accession[16]);

                //Those study folders and their conference studies/notes are displayed in the folder browser in Conference Folders tab.

                if (step_26_1 && step_26_2 && step_26_3 && step_26_4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Test 99055 - Conference Lists - Manage Archived Folders (desktop)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test1_99055(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainA, RoleA and UserA
            String domainA = String.Empty;
            String domainadminA = String.Empty;
            String passwordA = String.Empty;
            String roleA = "RoleA" + random.Next(1, limit);
            String userA = "UserA" + random.Next(1, limit);
            StudyViewer viewer = null;        

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername1 = "Sub1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername2 = "Sub2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername3 = "Sub3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;

            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername22 = "Sub22" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername23 = "Sub23" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath21 = topfoldername2;
            String folderpath22 = topfoldername2;

            String topfoldername3 = "Top3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername31 = "Sub31" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description3 = "Desc3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes3 = "Notes3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath3 = topfoldername3;

            String topfoldername4 = "Top4" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername41 = "Sub41" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername42 = "Sub42" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description4 = "Desc4" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes4 = "Notes4" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath41 = topfoldername4;
            String folderpath42 = topfoldername4;

            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            String[] arraccession = accession.Split('-');

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainA, RoleA and User A
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                domainA = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminA = domainattr[DomainManagement.DomainAttr.UserID];
                passwordA = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);
                foldermanager = domainattr[DomainManagement.DomainAttr.FirstName];

                //Create Role with Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainA, roleA, "Conference");

                //Create UserA of RoleA
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userA, domainA, roleA, 1, Config.emailid, 1, userA);               
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminA, passwordA);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername1, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername1;
                confolder.CreateSubFolder(folderpath1, subfoldername2, Description: description1);
                folderpath1 = folderpath1 + "/" + subfoldername2;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername22, Description: description2);
                folderpath21 = topfoldername2 + "/" + subfoldername22;
                confolder.CreateSubFolder(topfoldername2, subfoldername23, Description: description2);
                folderpath22 = topfoldername2 + "/" + subfoldername23;

                //Case-3
                confolder.CreateToplevelFolder(topfoldername3, description: description3);
                confolder.CreateSubFolder(topfoldername3, subfoldername31, Description: description3);
                folderpath3 = topfoldername3 + "/" + subfoldername31;

                //Add Studies to Case-1
                var studies = login.Navigate<Studies>();
                String[] studyset1 = arraccession[0].Split(':');
                foreach (String accessionno in studyset1)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(folderpath1, notes: notes1);
                    viewer.CloseStudy();
                }


                //Add Studies to Case-2 SubFolder-1                
                String[] studyset2 = arraccession[1].Split(':');
                foreach (String accessionno in studyset2)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(topfoldername2 + "/" + subfoldername22, notes: notes2);
                    viewer.CloseStudy();
                }

                //Add Studies to Case-2 SubFolder-2 (Priors)             
                String[] studyset3 = arraccession[2].Split(':');
                foreach (String accessionno in studyset3)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(topfoldername2 + "/" + subfoldername23, notes: notes3);
                    viewer.CloseStudy();
                }

                //Archive Folders
                login.Navigate<ConferenceFolders>();
                confolder.ArchiveConferenceFolder(folderpath1);
                confolder.ArchiveConferenceFolder(folderpath21);
                confolder.ArchiveConferenceFolder(folderpath22);
                executedsteps++;
                #endregion Step-3-Precondition            

                //Step-4-Verify AddFolder and Manage Top lvel folder button is disabled.
                login.Logout();
                login.LoginIConnect(domainadminA, passwordA);
                login.Navigate<ConferenceFolders>();
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(folderpath1);
                if (confolder.AddFolderBtn().GetAttribute("style").Contains("opacity: 1") == false && confolder.ManageTopLevelFolders().Enabled == false)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-5-Verify Description and studies
                bool isDescription = confolder.DescriptionText().Equals(description1);
                bool isStudycount = BasePage.GetSearchResults().Count == studyset1.Length;
                if (isDescription && isStudycount)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-6 Edit Top level folder name and Description
                String topfolder1new = "Test1" + random.Next() + random.Next(1, limit);
                String description1new = "Test1New" + random.Next() + random.Next(1, limit);
                confolder.EditTopLevelFolder(topfoldername1, topfolder1new);
                confolder.EditDescription(description1new);
                bool isNamechanged = confolder.ExpandAndSelectFolder(topfolder1new).Text.Equals(topfolder1new);
                bool isDescription6 = confolder.DescriptionText().Equals(description1new);
                if (isNamechanged && isDescription6)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-7-Edit SubFolder name and Description
                String subfolder1new = "Test1Sub" + random.Next() + random.Next(1, limit);
                String subdescription1new = "TestSub1" + random.Next() + random.Next(1, limit);
                confolder.RenameFolder(topfolder1new + "/" + subfoldername1, subfolder1new);
                confolder.EditDescription(subdescription1new);
                bool isNamechanged7 = false;
                try { isNamechanged7 = confolder.ExpandAndSelectFolder(topfolder1new + "/" + subfolder1new).Text.Equals(subfolder1new); }
                catch (Exception) { isNamechanged7 = false; }
                bool isDescription7 = confolder.DescriptionText().Equals(subdescription1new);
                if (isNamechanged7 && isDescription7)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-8 -Select Study and Edit Conference Notes
                String notes8 = "Notes8" + random.Next(1, limit);
                folderpath1 = topfolder1new + "/" + subfolder1new + "/" + subfoldername2;
                confolder.ExpandAndSelectFolder(folderpath1);
                confolder.SelectStudy("Accession", studyset1[0]);
                confolder.ModifyConferenceStudyNotes(notes8);
                bool isNotesupdated8 = confolder.GetStudyNotesFromTextArea().Equals(notes8);
                if (isNotesupdated8)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-9 -- Launch study and check conference notes
                viewer = confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.StudyNotesTab().Click();
                Thread.Sleep(1000);
                bool isNotesupdated9 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes8);
                viewer.CloseStudy();
                if (isNotesupdated9)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-10
                #region  Validate Sort, Add remove and Grop By
                executedsteps++;

                //Step-Validate sort works                
                bool isSortedAsc = false;
                IWebElement[] elements = BasePage.GetColumnElements(isConferenceTab:true);
                IWebElement Col_accession = null;
                foreach(IWebElement element in elements)
                {
                    String columnname = element.Text.Trim().Replace(" ", "");
                    if (columnname.Equals("Accession")) { Col_accession = element; break; }
                }
                Col_accession.Click();
                String[] values = BasePage.GetColumnValues(BasePage.GetSearchResults(), "Accession", BasePage.GetColumnNames());
                String[] sortedvalues = values.ToList().OrderBy<String, String>(value => value).ToArray();
                isSortedAsc = values.SequenceEqual(sortedvalues);
      
                if (isSortedAsc)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }

                //Validate group by
                confolder.SelectGroupByInStudiesTab("Accession", 1);
                if (confolder.IsGroupedBy("Accession", 1))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }
                confolder.SelectGroupByInStudiesTab("No Grouping", 1);

                //Validate Add Remove column
                confolder.ChooseColumns(new string[] {"Last Name"});
                if (BasePage.GetColumnNames().Any(columnname => columnname.Equals("Last Name")))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }

                confolder.ClickChooseColumns();
                confolder.SelectColumns(new string[] {"Last Name"}, "Remove", isConferenceTab:true, isRerarrange:false);
                confolder.OKButton_ChooseColumns().Click();
                if (!BasePage.GetColumnNames().Any(columnname => columnname.Equals("Last Name")))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }
                

                if(result.steps[executedsteps].statuslist.Contains("Fail"))
                {
                    result.steps[executedsteps].status = "Fail";
                }
                else
                {
                    result.steps[executedsteps].status = "Pass";
                }
                #endregion  Validate Sort, Add remove and Grop By

                //Step-11 - Delete one Study
                confolder.DeleteStudy("Accession", studyset1[1]);
                int studycount11 = BasePage.GetSearchResults().Count;
                if (studycount11 == studyset1.Length - 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-12- Undo Archive                
                confolder.UndoArchiveFolder(folderpath1);
                bool isFolderRemoved = false;
                try { isFolderRemoved = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderRemoved = false; }
                confolder.NavigateToActiveMode();
                bool isFolderRestored = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2);
                if (!isFolderRemoved && isFolderRestored)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-13 - Login as conference user - And check changes made
                login.Logout();
                login.LoginIConnect(userA, userA);
                login.Navigate<ConferenceFolders>();
                confolder.ExpandAndSelectFolder(folderpath1);
                bool isStudycount13 = BasePage.GetSearchResults().Count == (studyset1.Length - 1);

                //Take Topfoldername and description
                bool isTopfolderupdated13 = confolder.ExpandAndSelectFolder(topfolder1new).Text.Equals(topfolder1new);
                bool isDescription13 = confolder.DescriptionText().Equals(description1new);

                //Take subfoldername and Descritption
                bool isSubfolderupdated13 = confolder.ExpandAndSelectFolder(topfolder1new + "/" + subfolder1new).Text.Equals(subfolder1new);
                bool isSubDescription13 = confolder.DescriptionText().Equals(subdescription1new);

                if (isStudycount13 && isTopfolderupdated13 && isDescription13 && isSubfolderupdated13 && isSubDescription13)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-14 
                confolder.ExpandAndSelectFolder(folderpath1);
                confolder.SelectStudy("Accession", studyset1[0]);
                viewer = confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.StudyNotesTab().Click();
                Thread.Sleep(1000);
                bool isNotesupdated14 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes8);
                if (isNotesupdated14)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-15 - Login as domainadmin and update study notes of prior studies in Archive tab
                login.Logout();
                login.LoginIConnect(domainadminA, passwordA);
                login.Navigate<ConferenceFolders>();
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23);
                String notes15 = "NotesPriors" + random.Next(1, limit);
                bool isNotesUpdated15 = false;
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy("Accession", accessionno);
                    confolder.ModifyConferenceStudyNotes(notes15);
                }
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy("Accession", accessionno);
                    isNotesUpdated15 = confolder.GetStudyNotesFromTextArea().Equals(notes15);
                    if (!isNotesUpdated15) break;
                }
                if (isNotesUpdated15)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-16-UndoArchive Study
                confolder.UndoArchiveFolder(topfoldername2 + "/" + subfoldername23);
                confolder.NavigateToActiveMode();
                bool isFolderRestored16 = confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23).Text.Equals(subfoldername23);
                if (isFolderRestored16)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-17
                login.Logout();
                login.LoginIConnect(userA, userA);
                login.Navigate<ConferenceFolders>();
                confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23);
                int studycount17 = BasePage.GetSearchResults().Count;
                bool isNotesUpdated17 = false;
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy("Accession", studyset3[0]);
                    isNotesUpdated17 = confolder.GetStudyNotesFromTextArea().Equals(notes15);
                    if (!isNotesUpdated17) break;
                }
                if (isNotesUpdated17)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-18
                confolder.SelectStudy("Accession", studyset3[0]);
                confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.ChooseColumns(new string[] { "Accession" });
                bool isNotesUpdated18 = false;
                foreach (String accessionno in studyset3)
                {
                    viewer.SelectStudy("Accession", accessionno);
                    viewer.StudyNotesTab().Click();
                    Thread.Sleep(1000);
                    isNotesUpdated18 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes15);
                    if (!isNotesUpdated18) break;
                }
                if (isNotesUpdated18)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-19-Login as domainadmin and archive restored folders
                login.Logout();
                login.LoginIConnect(domainadminA, passwordA);
                login.Navigate<ConferenceFolders>();
                confolder.ArchiveConferenceFolder(folderpath1);
                confolder.ArchiveConferenceFolder(topfoldername2 + "/" + subfoldername23);
                confolder.NavigateToArchiveMode();
                bool isArchived19_1 = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2);
                bool isArchived19_2 = confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23).Text.Equals(subfoldername23);
                if (isArchived19_1 && isArchived19_2)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-20 - Delete Study folder
                confolder.DeleteFolder(folderpath1);
                bool isFolderDeleted = false;
                try { isFolderDeleted = !confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderDeleted = true; }
                if (isFolderDeleted)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-21 - Delete Top Folder which has mutiple folders
                confolder.DeleteFolder(topfoldername2);
                bool isFolderDeleted21 = false;
                try { isFolderDeleted21 = !confolder.ExpandAndSelectFolder(topfoldername2).Text.Equals(topfoldername2); }
                catch (Exception) { isFolderDeleted21 = true; }
                if (isFolderDeleted21)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-22 - Delete Topfolder which has no study folders
                confolder.DeleteFolder(topfoldername3);
                bool isFolderDeleted22 = false;
                try { isFolderDeleted22 = !confolder.ExpandAndSelectFolder(topfoldername3).Text.Equals(topfoldername3); }
                catch (Exception) { isFolderDeleted22 = true; }
                if (isFolderDeleted22)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Step-23 - Create a new Toplevel folder and sub folders with study
                confolder.NavigateToActiveMode();
                confolder.CreateToplevelFolder(topfoldername4, description: description4);
                confolder.CreateSubFolder(topfoldername4, subfoldername41, Description: description4);
                folderpath41 = topfoldername4 + "/" + subfoldername41;
                confolder.CreateSubFolder(topfoldername4, subfoldername42, Description: description4);
                folderpath42 = topfoldername4 + "/" + subfoldername42;
                //Add Studies            
                String[] studyset4 = arraccession[3].Split(':');
                login.Navigate<Studies>();
                foreach (String accessionno in studyset4)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(folderpath41, notes: notes4);
                    viewer.CloseStudy();
                }
                String[] studyset5 = arraccession[4].Split(':');
                foreach (String accessionno in studyset5)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(folderpath42, notes: notes4);
                    viewer.CloseStudy();
                }
                login.Navigate<ConferenceFolders>();
                confolder.ArchiveConferenceFolder(folderpath41);
                executedsteps++;

                //Step-24 - Delete the top folder
                confolder.NavigateToArchiveMode();
                confolder.DeleteFolder(topfoldername4);
                bool isFolderDeleted24 = false;
                try { isFolderDeleted24 = !(confolder.ExpandAndSelectFolder(topfoldername4).Text.Equals(topfoldername4)); }
                catch (Exception) { isFolderDeleted24 = true; }
                if (isFolderDeleted24)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //This will be covered in separate Test
                result.steps[++executedsteps].status = "Not Automated";

                //This will be covered in separate Test
                result.steps[++executedsteps].status = "Not Automated";


                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Conference Lists - Query for study notes that belong to a Conference Study prior (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96218(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = new Taskbar();
            ServiceTool servicetool = new ServiceTool();
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            Studies studies;
            StudyViewer studyViewer;
            Patients patient;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String DatasourceList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                String[] Datasource = DatasourceList.Split(':');
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String PatientNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] PatientName = PatientNameList.Split(':');
                String ModalityList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Modality");
                String[] Modality = ModalityList.Split(':');
                String DescriptionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String[] Description = DescriptionList.Split(':');
                String StudyDateList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyDate");
                String[] StudyDate = StudyDateList.Split('>');
                String PriorList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PriorList");


                //DomainB
                String TestdomainB = "Test218_DomainB_" + new Random().Next(1, 1000);
                String TestdomainAdminB = "Test218_DomainAdminB_" + new Random().Next(1, 1000);
                String TestroleB = "Test218_RoleB_" + new Random().Next(1, 1000);
                String TestuserB = "Test218_User1B_" + new Random().Next(1, 1000);
                String TestrolePhysician = "Test218_Physician_" + new Random().Next(1, 1000);
                String Testuserdoctor = "Test218_doctor_" + new Random().Next(1, 1000);

                //FolderNames for DomainB
                //Set1:
                String topfoldername = "ONCOLOGY" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername1 = "Head" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername2 = "8-1-16-8-5-16_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername3 = "8-15-16-8-19-16_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);


                String studynotes1 = "related1";
                String studynotes2 = "related3";
                String studynotes3 = "3- this is a different conference notes for the same related study";
                String studynotes4 = "1- the study is added to a different sub-folder";
                String studynotes5 = "Step25Notes";

                //Step 1 - Pre-conditions
                //taskbar.Hide();
                //servicetool.LaunchServiceTool();
                //servicetool.NavigateToEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.ModifyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.EnableConferenceLists();
                //wpfobject.WaitTillLoad();
                //servicetool.ApplyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //wpfobject.ClickOkPopUp();
                //wpfobject.WaitTillLoad();
                //servicetool.RestartService();
                //wpfobject.WaitTillLoad();
                //servicetool.CloseServiceTool();
                //taskbar.Show();
                Executedsteps++;

                //Step 2
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.CreateDomain(TestdomainB, TestdomainAdminB, new string[] { Datasource[0], Datasource[1], Datasource[2], Datasource[3] });
                domainmanagement.ClickSaveNewDomain();
                bool step2_1 = domainmanagement.SearchDomain(TestdomainB);
                domainmanagement.SetConfListFeatureForDomain(TestdomainB);

                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(TestdomainB, TestroleB, "any", Datasource[0] + "=" + Datasource[2] + "=" + Datasource[3]);
                bool step2_2 = rolemanagement.RoleExists(TestroleB, TestdomainB);
                rolemanagement.SelectRole(TestroleB);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB1 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();

                usermanagement = login.Navigate<UserManagement>();
                usermanagement.CreateUser(TestuserB, TestdomainB, TestroleB);
                bool step2_3 = usermanagement.SearchUser(TestuserB, TestdomainB);

                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(TestdomainB, TestrolePhysician, "any", Datasource[1]);
                bool step2_4 = rolemanagement.RoleExists(TestrolePhysician, TestdomainB);
                rolemanagement.SelectRole(TestrolePhysician);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool CB2 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                usermanagement = login.Navigate<UserManagement>();
                usermanagement.CreateUser(Testuserdoctor, TestdomainB, TestrolePhysician);
                bool step2_5 = usermanagement.SearchUser(TestuserB, TestdomainB);

                if (step2_1 && step2_2 && step2_3 && step2_4 && step2_5 && CB1 && CB2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 3
                login.LoginIConnect(TestdomainB, TestdomainB);
                conferencefolders = login.Navigate<ConferenceFolders>();
                bool step3_1 = conferencefolders.CreateToplevelFolder(topfoldername, TestuserB); //Top level folder
                bool step3_2 = conferencefolders.CreateSubFolder(topfoldername, subfoldername1); //Level 2 sub-folder
                bool step3_3 = conferencefolders.CreateSubFolder(topfoldername + "/" + subfoldername1, subfoldername2); //Level 3 sub-folder
                bool step3_4 = conferencefolders.CreateSubFolder(topfoldername + "/" + subfoldername1, subfoldername3); //Level 3 sub-folder

                if (step3_1 && step3_2 && step3_3 && step3_4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 4
                Executedsteps++;

                //Step 5
                login.LoginIConnect(TestuserB, TestuserB);
                patient = login.Navigate<Patients>();
                patient.InputData(PatientName[0]);
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(PatientName[1].Trim());
                studyViewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientID);
                studyViewer.NavigateToHistoryPanel();
                int priorcount5 = BasePage.GetSearchResults().Count;
                if (priorcount5 >= Int32.Parse(PriorList))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 6
                studyViewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[3] });
                //studyViewer.OpenPriors(new string[] { "Modality" }, new string[] { Modality[0] });

                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                studyViewer.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[2] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                studyViewer.studyPanel(1).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2, notes: studynotes1);

                if (studyViewer.studyPanel(1).Displayed && studyViewer.studyPanel(2).Displayed && studyViewer.studyPanel(3).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 7
                var priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_3_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2, notes: studynotes2);

                if (studyViewer.studyPanel(3).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 8
                studyViewer.studyPanel(2).Click();
                priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_2_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);

                if (studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                studyViewer.CloseStudy();
                login.Logout();

                //Step 9
                login.LoginIConnect(Testuserdoctor, Testuserdoctor);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                int StudyCount_9 = BasePage.GetSearchResults().Count;
                if (StudyCount_9 == 3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10
                conferencefolders.SelectStudy("Accession", Accession[0]);
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes1))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11
                conferencefolders.SelectStudy("Accession", Accession[1]);
                var whitespace = conferencefolders.GetConferenceStudyNotes();
                if (String.IsNullOrWhiteSpace(whitespace))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 12
                conferencefolders.SelectStudy("Accession", Accession[2]);
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 13
                conferencefolders.SelectStudy("Accession", Accession[1]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                priorviewer = BasePage.Driver.FindElement(By.CssSelector("#studyPanelDiv_1"));
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                bool status13 = login.CompareImage(result.steps[Executedsteps], priorviewer);
                if (status13)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 14
                login.NavigateToHistoryPanel();
                bool step14_1 = studyViewer.StudyNotesTab().Enabled;
                priorcount5 = BasePage.GetSearchResults().Count;

                if (!step14_1 && priorcount5 >= Int32.Parse(PriorList))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 15
                studyViewer.SelectStudy("Study Date", StudyDate[2]);

                bool step15_1 = studyViewer.StudyNotesTab().Displayed;
                PageLoadWait.WaitForElement(studyViewer.By_StudyNotesTab(), WaitTypes.Clickable, 30);
                studyViewer.StudyNotesTab().Click();

                bool step15_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes2);

                if (step15_1 && step15_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 16
                studyViewer.SelectStudy("Study Date", StudyDate[1]);

                bool step16_1 = studyViewer.StudyNotesTab().Enabled;
                if (!step16_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 17
                studyViewer.SelectStudy("Study Date", StudyDate[0]);

                bool step17_1 = studyViewer.StudyNotesTab().Displayed;
                PageLoadWait.WaitForElement(studyViewer.By_StudyNotesTab(), WaitTypes.Clickable, 30);
                studyViewer.StudyNotesTab().Click();
                bool step17_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes1);

                if (step17_1 && step17_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                studyViewer.CloseHistoryPanel();
                studyViewer.CloseStudy();
                login.Logout();

                //Step 18
                login.LoginIConnect(TestuserB, TestuserB);
                patient = login.Navigate<Patients>();
                patient.InputData(PatientName[0]);
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(PatientName[1].Trim());
                studyViewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientID);
                studyViewer.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[2] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);

                priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_2_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3, notes: studynotes3);

                if (studyViewer.studyPanel(1).Displayed && studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 19
                studyViewer.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[3] });
                //studyViewer.OpenPriors(new string[] { "Modality" }, new string[] { Modality[0] });

                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3, notes: studynotes4);
                priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_3_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3);

                if (studyViewer.studyPanel(1).Displayed && studyViewer.studyPanel(2).Displayed && studyViewer.studyPanel(3).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                studyViewer.CloseStudy();
                login.Logout();

                //Step 20
                login.LoginIConnect(Testuserdoctor, Testuserdoctor);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3);

                conferencefolders.SelectStudy("Accession", Accession[0]);
                bool step20_1 = conferencefolders.GetConferenceStudyNotes().Equals(studynotes4);
                conferencefolders.SelectStudy("Accession", Accession[1]);
                bool step20_2 = String.IsNullOrWhiteSpace(conferencefolders.GetConferenceStudyNotes());
                conferencefolders.SelectStudy("Accession", Accession[2]);
                bool step20_3 = conferencefolders.GetConferenceStudyNotes().Equals(studynotes3);
                if (step20_1 && step20_2 && step20_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 21
                conferencefolders.SelectStudy("Accession", Accession[2]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                login.NavigateToHistoryPanel();
                bool step21_1 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step21_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes3);
                if (step21_1 && step21_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 22
                studyViewer.SelectStudy("Study Description", Description[0]);

                bool step22_1 = studyViewer.StudyNotesTab().Displayed;
                PageLoadWait.WaitForElement(studyViewer.By_StudyNotesTab(), WaitTypes.Clickable, 30);
                studyViewer.StudyNotesTab().Click();
                bool step22_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes4);

                if (step22_1 && step22_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 23
                studyViewer.SelectStudy("Study Description", Description[3]);

                bool step23_1 = studyViewer.StudyNotesTab().Enabled;

                if (!step23_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 24
                studyViewer.CloseHistoryPanel();
                studyViewer.CloseStudy();
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                conferencefolders.SelectStudy("Accession", Accession[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                login.NavigateToHistoryPanel();
                bool step24_1 = studyViewer.StudyNotesTab().Displayed;
                PageLoadWait.WaitForElement(studyViewer.By_StudyNotesTab(), WaitTypes.Clickable, 30);
                studyViewer.StudyNotesTab().Click();
                bool step24_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes1);

                studyViewer.SelectStudy("Study Description", Description[2]);

                PageLoadWait.WaitForElement(studyViewer.By_StudyNotesTab(), WaitTypes.Clickable, 30);
                studyViewer.StudyNotesTab().Click();
                bool step24_3 = studyViewer.StudyNotesSection().Text.Equals(studynotes2);

                if (step24_1 && step24_2 && step24_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseHistoryPanel();
                studyViewer.CloseStudy();
                login.Logout();

                //Step 25
                login.LoginIConnect(TestdomainB, TestdomainB);
                studies = login.Navigate<Studies>();
                studies.SelectAllDateAndData();
                studies.SearchStudy("Accession", Accession[3]);
                studies.SelectStudy("Accession", Accession[3]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3);
                login.NavigateToHistoryPanel();
                studyViewer.DoubleClick(studyViewer.Study(1));
                PageLoadWait.WaitForAllViewportsToLoad(30, 2);
                priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_2_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3, notes: studynotes5);

                if (studyViewer.studyPanel(1).Displayed && studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseStudy();
                login.Logout();

                //Step 26
                login.LoginIConnect(Testuserdoctor, Testuserdoctor);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3);
                conferencefolders.SelectStudy("Modality", Modality[2]);
                bool step26_1 = String.IsNullOrWhiteSpace(conferencefolders.GetConferenceStudyNotes());
                conferencefolders.SelectStudy("Modality", Modality[3]);
                bool step26_2 = conferencefolders.GetConferenceStudyNotes().Equals(studynotes5);
                if (step26_1 && step26_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 27
                conferencefolders.SelectStudy("Modality", Modality[2]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                bool step27_1 = studyViewer.SeriesViewer_1X1().Displayed;

                studyViewer.NavigateToHistoryPanel();
                bool step27_2 = studyViewer.StudyNotesTab().Displayed;
                bool step27_3 = studyViewer.StudyNotesTab().Enabled;

                studyViewer.SelectStudy("Modality", Modality[3]);
                bool step27_4 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step27_5 = studyViewer.StudyNotesSection().Text.Equals(studynotes5);

                if (step27_1 && step27_2 && !step27_3 && step27_4 && step27_5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                studyViewer.CloseHistoryPanel();
                studyViewer.CloseStudy();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Test2 99055 - Conference Lists - Manage Archived Folders (desktop) - Validate as SuperAdmin
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_99055(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainA, RoleA and UserA
            String domainA = String.Empty;
            String domainadminA = String.Empty;
            String passwordA = String.Empty;
            String roleA = "RoleA" + random.Next(1, limit);
            String userA = "UserA" + random.Next(1, limit);
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername1 = "Sub1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername2 = "Sub2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername3 = "Sub3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;

            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername22 = "Sub22" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername23 = "Sub23" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath21 = topfoldername2;
            String folderpath22 = topfoldername2;

            String topfoldername3 = "Top3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername31 = "Sub31" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description3 = "Desc3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes3 = "Notes3" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath3 = topfoldername3;

            String topfoldername4 = "Top4" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername41 = "Sub41" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername42 = "Sub42" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description4 = "Desc4" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes4 = "Notes4" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath41 = topfoldername4;
            String folderpath42 = topfoldername4;

            String topfoldername5 = "Top5" + new System.DateTime().Millisecond + random.Next(100, 10000);
            Logger.Instance.InfoLog("FolderName--" + topfoldername5);            
            String subfoldername51 = "Sub51" + new System.DateTime().Millisecond + random.Next(100, 10000);
            Logger.Instance.InfoLog("FolderName--" + subfoldername51);

            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
            String[] arraccession = accession.Split('-');

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainA, RoleA and User A
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                domainA = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminA = domainattr[DomainManagement.DomainAttr.UserID];
                passwordA = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);
                foldermanager = domainattr[DomainManagement.DomainAttr.FirstName];

                //Create Role with Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainA, roleA, "Conference");

                //Create UserA of RoleA
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userA, domainA, roleA, 1, Config.emailid, 1, userA);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminA, passwordA);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername1, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername1;
                confolder.CreateSubFolder(folderpath1, subfoldername2, Description: description1);
                folderpath1 = folderpath1 + "/" + subfoldername2;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername22, Description: description2);
                folderpath21 = topfoldername2 + "/" + subfoldername22;
                confolder.CreateSubFolder(topfoldername2, subfoldername23, Description: description2);
                folderpath22 = topfoldername2 + "/" + subfoldername23;

                //Case-3
                confolder.CreateToplevelFolder(topfoldername3, description: description3);
                confolder.CreateSubFolder(topfoldername3, subfoldername31, Description: description3);
                folderpath3 = topfoldername3 + "/" + subfoldername31;

                //Add Studies to Case-1
                var studies = login.Navigate<Studies>();
                String[] studyset1 = arraccession[0].Split(':');
                foreach (String accessionno in studyset1)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(folderpath1, notes: notes1);
                    viewer.CloseStudy();
                }


                //Add Studies to Case-2 SubFolder-1                
                String[] studyset2 = arraccession[1].Split(':');
                foreach (String accessionno in studyset2)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(topfoldername2 + "/" + subfoldername22, notes: notes2);
                    viewer.CloseStudy();
                }

                //Add Studies to Case-2 SubFolder-2 (Priors)             
                String[] studyset3 = arraccession[2].Split(':');
                foreach (String accessionno in studyset3)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(topfoldername2 + "/" + subfoldername23, notes: notes3);
                    viewer.CloseStudy();
                }

                //Archive Folders
                login.Navigate<ConferenceFolders>();
                confolder.ArchiveConferenceFolder(folderpath1);
                confolder.ArchiveConferenceFolder(folderpath21);
                confolder.ArchiveConferenceFolder(folderpath22);                

                //Create and Archive folder in SuperAdminGroup
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate<ConferenceFolders>();
                confolder.CreateToplevelFolder(topfoldername5, domain:"SuperAdminGroup", description:description1);
                confolder.CreateSubFolder(topfoldername5, subfoldername51, Description: description1);
                login.Navigate<Studies>();

                //Add Study to this folder                          
                foreach (String accessionno in studyset3)
                {
                    studies.SearchStudy("Accession", accessionno);
                    PageLoadWait.WaitForLoadingMessage(20);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(topfoldername5 + "/" + subfoldername51, notes: notes3);
                    viewer.CloseStudy();
                }

                //Archive this folder
                login.Navigate<ConferenceFolders>();
                confolder.ArchiveConferenceFolder(topfoldername5 + "/" + subfoldername51, DomainName: "SuperAdminGroup");
                executedsteps++;

                #endregion Step-3-Precondition

                //Step-4-Verify AddFolder and Manage Top lvel folder button is disabled.
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate<ConferenceFolders>();
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(folderpath1, DomainName: domainA);
                if (confolder.AddFolderBtn().GetAttribute("style").Contains("opacity: 1") == false && confolder.ManageTopLevelFolders().Enabled == false)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-5-Verify Description and studies
                bool isDescription = confolder.DescriptionText().Equals(description1);
                bool isStudycount = BasePage.GetSearchResults().Count == studyset1.Length;
                if (isDescription && isStudycount)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-6 Edit Top level folder name and Description
                String topfolder1new = "Test1" + random.Next() + random.Next(1, limit);
                String description1new = "Test1New" + random.Next() + random.Next(1, limit);
                confolder.EditTopLevelFolder(topfoldername1, topfolder1new);
                confolder.EditDescription(description1new);
                bool isNamechanged = confolder.ExpandAndSelectFolder(topfolder1new).Text.Equals(topfolder1new);
                bool isDescription6 = confolder.DescriptionText().Equals(description1new);
                if (isNamechanged && isDescription6)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-7-Edit SubFolder name and Description
                String subfolder1new = "Test1Sub" + random.Next() + random.Next(1, limit);
                String subdescription1new = "TestSub1" + random.Next() + random.Next(1, limit);
                confolder.RenameFolder(topfolder1new + "/" + subfoldername1, subfolder1new, DomainName: domainA);
                confolder.EditDescription(subdescription1new);
                bool isNamechanged7 = false;
                try { isNamechanged7 = confolder.ExpandAndSelectFolder(topfolder1new + "/" + subfolder1new).Text.Equals(subfolder1new); }
                catch (Exception) { isNamechanged7 = false; }
                bool isDescription7 = confolder.DescriptionText().Equals(subdescription1new);
                if (isNamechanged7 && isDescription7)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-8 --Select Study and Edit Conference Notes
                String notes8 = "Notes8" + random.Next(1, limit);
                folderpath1 = topfolder1new + "/" + subfolder1new + "/" + subfoldername2;
                confolder.ExpandAndSelectFolder(folderpath1);
                confolder.SelectStudy("Accession", studyset1[0]);
                confolder.ModifyConferenceStudyNotes(notes8);
                bool isNotesupdated8 = confolder.GetStudyNotesFromTextArea().Equals(notes8);
                if (isNotesupdated8)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-9 -- Launch study and check conference notes(Super Admin will not be able to launch conference study from other domains)
                bool isNotesupdated9 = false;
                try
                {
                    viewer = confolder.LaunchStudy(isConferenceTab: true);
                    viewer.NavigateToHistoryPanel();
                    viewer.StudyNotesTab().Click();
                    Thread.Sleep(1000);
                    isNotesupdated9 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes8);
                    viewer.CloseStudy();
                    isNotesupdated9 = true;
                }
                catch (Exception) { isNotesupdated9 = false; }
                if (!isNotesupdated9)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-10
                #region  Validate Sort, Add remove and Grop By
                executedsteps++;

                //Step-Validate sort works                
                bool isSortedAsc = false;
                IWebElement[] elements = BasePage.GetColumnElements(isConferenceTab: true);
                IWebElement Col_accession = null;
                foreach (IWebElement element in elements)
                {
                    String columnname = element.Text.Trim().Replace(" ", "");
                    if (columnname.Equals("Accession")) { Col_accession = element; break; }
                }
                Col_accession.Click();
                String[] values = BasePage.GetColumnValues(BasePage.GetSearchResults(), "Accession", BasePage.GetColumnNames());
                String[] sortedvalues = values.ToList().OrderBy<String, String>(value => value).ToArray();
                isSortedAsc = values.SequenceEqual(sortedvalues);

                if (isSortedAsc)
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }

                //Validate group by
                confolder.SelectGroupByInStudiesTab("Accession", 1);
                if (confolder.IsGroupedBy("Accession", 1))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }
                confolder.SelectGroupByInStudiesTab("No Grouping", 1);                

                //Validate Add Remove column
                confolder.ChooseColumns(new string[] { "Last Name" });
                if (BasePage.GetColumnNames().Any(columnname => columnname.Equals("Last Name")))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }

                confolder.ClickChooseColumns();
                confolder.SelectColumns(new string[] { "Last Name" }, "Remove", isConferenceTab: true, isRerarrange: false);
                confolder.OKButton_ChooseColumns().Click();
                if (!BasePage.GetColumnNames().Any(columnname => columnname.Equals("Last Name")))
                {
                    result.steps[executedsteps].statuslist.Add("Pass");
                }
                else
                {
                    result.steps[executedsteps].statuslist.Add("Fail");
                }


                if (result.steps[executedsteps].statuslist.Contains("Fail"))
                {
                    result.steps[executedsteps].status = "Fail";
                }
                else
                {
                    result.steps[executedsteps].status = "Pass";
                }
                #endregion  Validate Sort, Add remove and Grop By

                //Step-11 - Delete one Study
                confolder.DeleteStudy("Accession", studyset1[1]);
                int studycount11 = BasePage.GetSearchResults().Count;
                if (studycount11 == studyset1.Length - 1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-12- Undo Archive                
                confolder.UndoArchiveFolder(folderpath1);
                bool isFolderRemoved = false;
                try { isFolderRemoved = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderRemoved = false; }
                confolder.NavigateToActiveMode();
                bool isFolderRestored = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2);
                if (!isFolderRemoved && isFolderRestored)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-13 - Login as conference user - And check changes made
                login.Logout();
                login.LoginIConnect(userA, userA);
                login.Navigate<ConferenceFolders>();
                confolder.ExpandAndSelectFolder(folderpath1);
                bool isStudycount13 = BasePage.GetSearchResults().Count == (studyset1.Length - 1);

                //Take Topfoldername and description
                bool isTopfolderupdated13 = confolder.ExpandAndSelectFolder(topfolder1new).Text.Equals(topfolder1new);
                bool isDescription13 = confolder.DescriptionText().Equals(description1new);

                //Take subfoldername and Descritption
                bool isSubfolderupdated13 = confolder.ExpandAndSelectFolder(topfolder1new + "/" + subfolder1new).Text.Equals(subfolder1new);
                bool isSubDescription13 = confolder.DescriptionText().Equals(subdescription1new);

                if (isStudycount13 && isTopfolderupdated13 && isDescription13 && isSubfolderupdated13 && isSubDescription13)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-14 
                confolder.ExpandAndSelectFolder(folderpath1);
                confolder.SelectStudy("Accession", studyset1[0]);
                viewer = confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.StudyNotesTab().Click();
                Thread.Sleep(1000);
                bool isNotesupdated14 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes8);
                if (isNotesupdated14)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-15 - Login as SuperAdmin and update study notes of prior studies in Archive tab
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate<ConferenceFolders>();
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23, DomainName: domainA);
                String notes15 = "NotesPriors" + random.Next(1, limit);
                bool isNotesUpdated15 = false;
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy("Accession", accessionno);
                    confolder.ModifyConferenceStudyNotes(notes15);
                }
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy("Accession", accessionno);
                    isNotesUpdated15 = confolder.GetStudyNotesFromTextArea().Equals(notes15);
                    if (!isNotesUpdated15) break;
                }
                if (isNotesUpdated15)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-16-UndoArchive Study
                confolder.UndoArchiveFolder(topfoldername2 + "/" + subfoldername23);
                confolder.NavigateToActiveMode();
                bool isFolderRestored16 = confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23).Text.Equals(subfoldername23);
                if (isFolderRestored16)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-17
                login.Logout();
                login.LoginIConnect(userA, userA);
                login.Navigate<ConferenceFolders>();
                confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23);
                int studycount17 = BasePage.GetSearchResults().Count;
                bool isNotesUpdated17 = false;
                foreach (String accessionno in studyset3)
                {
                    confolder.SelectStudy("Accession", studyset3[0]);
                    isNotesUpdated17 = confolder.GetStudyNotesFromTextArea().Equals(notes15);
                    if (!isNotesUpdated17) break;
                }
                if (isNotesUpdated17)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-18
                confolder.SelectStudy("Accession", studyset3[0]);
                confolder.LaunchStudy(isConferenceTab: true);
                viewer.NavigateToHistoryPanel();
                viewer.ChooseColumns(new string[] { "Accession" });
                bool isNotesUpdated18 = false;
                foreach (String accessionno in studyset3)
                {
                    viewer.SelectStudy("Accession", accessionno);
                    viewer.StudyNotesTab().Click();
                    Thread.Sleep(1000);
                    isNotesUpdated18 = BasePage.Driver.FindElement(By.CssSelector("#m_patientHistory_m_StudyNotesViewer_studyNotesContent")).GetAttribute("innerHTML").Equals(notes15);
                    if (!isNotesUpdated18) break;
                }
                if (isNotesUpdated18)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-19-Login as SuperAdmin and archive restored folders
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate<ConferenceFolders>();                
                confolder.ArchiveConferenceFolder(folderpath1, DomainName:domainA);
                confolder.ArchiveConferenceFolder(topfoldername2 + "/" + subfoldername23, DomainName: domainA);
                confolder.NavigateToArchiveMode();
                bool isArchived19_1 = confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2);
                bool isArchived19_2 = confolder.ExpandAndSelectFolder(topfoldername2 + "/" + subfoldername23).Text.Equals(subfoldername23);
                if (isArchived19_1 && isArchived19_2)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-20 - Delete Study folder
                confolder.DeleteFolder(folderpath1);
                bool isFolderDeleted = false;
                try { isFolderDeleted = !confolder.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderDeleted = true; }
                if (isFolderDeleted)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-21 - Delete Top Folder which has mutiple folders
                confolder.DeleteFolder(topfoldername2);
                bool isFolderDeleted21 = false;
                try { isFolderDeleted21 = !confolder.ExpandAndSelectFolder(topfoldername2).Text.Equals(topfoldername2); }
                catch (Exception) { isFolderDeleted21 = true; }
                if (isFolderDeleted21)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-22 - Delete Topfolder which has no study folders
                confolder.DeleteFolder(topfoldername3);
                bool isFolderDeleted22 = false;
                try { isFolderDeleted22 = !confolder.ExpandAndSelectFolder(topfoldername3).Text.Equals(topfoldername3); }
                catch (Exception) { isFolderDeleted22 = true; }
                if (isFolderDeleted22)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Step-23 - Create a new Toplevel folder and sub folders with study
                login.Logout();
                login.LoginIConnect(domainadminA, passwordA);
                login.Navigate<ConferenceFolders>();                
                confolder.CreateToplevelFolder(topfoldername4, description: description4);
                confolder.CreateSubFolder(topfoldername4, subfoldername41, Description: description4);
                folderpath41 = topfoldername4 + "/" + subfoldername41;
                confolder.CreateSubFolder(topfoldername4, subfoldername42, Description: description4);
                folderpath42 = topfoldername4 + "/" + subfoldername42;
                //Add Studies            
                String[] studyset4 = arraccession[3].Split(':');
                login.Navigate<Studies>();
                foreach (String accessionno in studyset4)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(folderpath41, notes: notes4);
                    viewer.CloseStudy();
                }
                String[] studyset5 = arraccession[4].Split(':');
                foreach (String accessionno in studyset5)
                {
                    studies.SearchStudy("Accession", accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(folderpath42, notes: notes4);
                    viewer.CloseStudy();
                }
                login.Navigate<ConferenceFolders>();
                confolder.ArchiveConferenceFolder(folderpath41);
                executedsteps++;

                //Step-24 - Delete the top folder
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate<ConferenceFolders>();
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(topfoldername4, DomainName: domainA);
                confolder.DeleteFolder(topfoldername4);
                bool isFolderDeleted24 = false;
                try { isFolderDeleted24 = !(confolder.ExpandAndSelectFolder(topfoldername4).Text.Equals(topfoldername4)); }
                catch (Exception) { isFolderDeleted24 = true; }
                if (isFolderDeleted24)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-25
                confolder.NavigateToArchiveMode();
                confolder.ExpandAndSelectFolder(topfoldername5+"/"+subfoldername51, DomainName:"SuperAdminGroup");
                confolder.SelectStudy("Accession", studyset3[0]);
                confolder.LaunchStudy(isConferenceTab: true);
                executedsteps++;

                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Conference Lists - View the contents of the archive and bring Folder out from archive (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96223(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables             
            Studies studies;
            StudyViewer studyViewer;
            Outbounds outbounds;
            Inbounds inbounds;
            Patients patient;
            ConferenceFolders conferencefolders;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = AccessionIDList.Split(':');
                String Studies_4 = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Acc_MP_EA_RDM_MPEA");
                String[] Acc_4Studies = Studies_4.Split(':');
                String DiffMod1Studies = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Acc_DiffMod1");
                String[] Acc_DiffMod1Studies = DiffMod1Studies.Split(':');
                String DiffMod2Studies = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Acc_DiffMod2");
                String[] Acc_DiffMod2Studies = DiffMod2Studies.Split(':');
                String RelatedStudies = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Acc_RelatedStudies");
                String[] Acc_RelatedStudies = RelatedStudies.Split(':');
                String HybridStudies = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Acc_Hybrids");
                String[] Acc_Hybrids = HybridStudies.Split(':');
                String Studydatelist = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyDate");
                String[] StudyDate = Studydatelist.Split('=');
                String Patientname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] PatientName = Patientname.Split(':');
                String Acc_GSPS = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Acc_GSPS");
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRole = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");

                Random random = new Random();
                String StudyNotes = "StudyNotes_" + random.Next(100, 1000);
                //DomainC
                String Cutaneous = "Cutaneous T-cell Lymphoma" + random.Next(100, 10000);  //TopFloder              
                String Level_2_sub1 = "Level 2 sub1" + random.Next(100, 10000);
                String Level_2_sub2 = "Level 2 sub2" + random.Next(100, 10000);
                String Level_3_sub2_1 = "Level3 sub2_1" + random.Next(100, 10000);
                String Level_2_sub3 = "Level 2 sub3" + random.Next(100, 10000);
                String Head_and_Neck = "Head and Neck" + random.Next(100, 10000); //TopFloder   
                String Different_Modalities = "Different Modalities" + random.Next(100, 10000); //Level2
                String meeting_for_week1 = "meeting for week1" + random.Next(100, 10000); //Level3
                String meeting_for_week2 = "meeting for week2" + random.Next(100, 10000); //Level3
                String Studies_from_related_view = "Studies from related view" + random.Next(100, 10000); //Level2
                String Saved_GSPS_studies = "Saved GSPS studies" + random.Next(100, 10000); //Level2
                String studies_from_Grant_Access = "studies from Grant Access" + random.Next(100, 10000); //Level2

                //DomainB
                String Oncology = "Monthly Oncology Tumor Boards" + random.Next(100, 10000); //TopFloder   
                String Hybrid = "Hybrid, XDS only_DICOM only" + random.Next(100, 10000); //Level2
                String sub_tab = "From Patient Record_XDS sub-tab" + random.Next(100, 10000); //Level2
                String MIME_types = "MIME types" + random.Next(100, 10000); //Level2               
                String Pediatric = "Pediatric Bone Marrow Transplant" + random.Next(100, 10000); //TopFloder   
                String Image_sharing = "Image sharing #1" + random.Next(100, 10000); //Level2

                String RoleC1 = "RoleC1" + random.Next(100, 1000);
                String RoleC2 = "RoleC2" + random.Next(100, 1000);
                String UserC1 = "UserC1" + random.Next(100, 1000);
                String UserC5 = "UserC5" + random.Next(100, 1000);
                String UserC1Manager = "UC1" + random.Next(100, 1000);
                String UserC2 = "UserC2" + random.Next(100, 1000);
                String UserC4 = "UserC4" + random.Next(100, 1000);
                String GroupC1 = "GroupC1" + random.Next(100, 1000);

                String EA = login.GetHostName(Config.EA91);
                String MP = login.GetHostName(Config.SanityPACS); //A7
                String RDM_EA = login.GetHostName(Config.EA1);
                String RDM_MP = login.GetHostName(Config.PACS2);
                String XDS_DS = "XDS_DS";
                String folderpath_sub1 = Cutaneous + "/" + Level_2_sub1;
                String folderpath_sub2 = Cutaneous + "/" + Level_2_sub2;
                String folderpath_sub2_1 = folderpath_sub2 + "/" + Level_3_sub2_1;
                String folderpath_sub3 = Cutaneous + "/" + Level_2_sub3;

                String Week1_Path = Head_and_Neck + "/" + Different_Modalities + "/" + meeting_for_week1;
                String Week2_Path = Head_and_Neck + "/" + Different_Modalities + "/" + meeting_for_week2;
                String Related_Path = Head_and_Neck + "/" + Studies_from_related_view;
                String Shared_Path = Head_and_Neck + "/" + studies_from_Grant_Access;
                String GSPS_Path = Head_and_Neck + "/" + Saved_GSPS_studies;

                String Hybrid_Path = Oncology + "/" + Hybrid;
                String Subtab_Path = Oncology + "/" + sub_tab;
                String MIME_Path = Oncology + "/" + MIME_types;

                int limit = Math.Abs((int)DateTime.Now.Ticks);
                limit = Int32.Parse(limit.ToString().Substring(0, 4));
                String roleB = "RoleB" + random.Next(1, limit);
                String physician = "Physician" + random.Next(1, limit);
                String phUser = "ph" + random.Next(1, limit);
                String doctorA = "doctorA" + random.Next(1, limit);
                String archivist = "Archivist" + random.Next(1, limit);
                String aruser = "ar" + random.Next(1, limit);
                String staff = "Staff" + random.Next(1, limit);
                String stUser = "st" + random.Next(1, limit);
                String userB = "UserB" + random.Next(1, limit);
                String destpacs = login.GetHostName(Config.DestinationPACS);

                //Step-1:Pre-conditions---1. iCA build under testing is installed on the main iCA server.--2. Image Sharing, XDS, Remote Data source Manager are configured on the main sever--
                //3. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing--4. Domains and Roles have Conference Lists and Conference User enabled--5. Other iCA configurations under testing are specified in Test Assignments and PQA Test Plan for the release. (e.g., version of remote iCA server, HTTP or HTTPS, HTML4 viewer or HTML5 viewer etc...)
                Executedsteps++;


                //Step-2:-Prepare Conference Folders if they are not available in domain(s)- ---1. Conference studies with and without conference notes are stored in a sub-folder---2. Conference studies with and without notes are stored under in multiple level sub-folders (e.g. ---top level\level2---top level\level2\level3,---top level\level2\level3\level4, ---top level\level2\level3\...\level10\..etc..)---3. Conference Folders do not contain any conference study (non Study Folders)---4. Conference Folders contains sub-folders with mixed of Study Folders and non Study Folders
                //Domain-C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr1 = domain.CreateDomainAttr();
                String domainnameC = domainattr1[DomainManagement.DomainAttr.DomainName];
                String DomainC_User = domainattr1[DomainManagement.DomainAttr.UserID];
                String DomainC_Pwd = domainattr1[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr1, new string[] { MP, EA, Config.rdm }, isconferenceneeded: true, isgrantaccessneeded: true); //MP, EA, rdm.mp, rdm.ea
                var role = login.Navigate<RoleManagement>();
                role.CreateRole(domainnameC, RoleC1, "Conference"); //All datasources are connected
                role.CreateRole(domainnameC, RoleC2, "Conference", MP); //Either MP or EA
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(UserC2, domainnameC, RoleC2, 1, Config.emailid, 1, UserC2);
                usermgmt.CreateUser(UserC4, domainnameC, RoleC2, 1, Config.emailid, 1, UserC4);
                usermgmt.CreateGroup(domainnameC, GroupC1, rolenames: new string[] { RoleC1 }, datasources: new string[] { RDM_MP }, rdm: 1); //rdm.ea or rdm mp
                usermgmt.CreateUserForGroup(GroupC1, UserC1, domainnameC, RoleC1);
                usermgmt.CreateUserForGroup(GroupC1, UserC5, domainnameC, RoleC1);
                usermgmt.CreateUserForGroup(GroupC1, UserC1Manager, domainnameC, RoleC1);

                //Domain-B
                domain = login.Navigate<DomainManagement>();
                var domainattr2 = domain.CreateDomainAttr();
                String domainnameB = domainattr2[DomainManagement.DomainAttr.DomainName];
                String foldermanager2 = domainattr2[DomainManagement.DomainAttr.FirstName];
                String domainadminB = domainattr2[DomainManagement.DomainAttr.UserID];
                String DomainB_User = domainadminB;
                String DomainB_Pwd = domainattr2[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr2, isconferenceneeded: true, datasources: new String[] { Config.xds1, Config.xds2, destpacs, XDS_DS }, isimagesharingneeded: true); //XDS and Imagesharing

                //Create RoleB with only XDS Data Sources -- Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainnameB, roleB, "Conference", Config.xds1 + "=" + Config.xds2); //Need to connect one more XDS_DS

                //Create UserB (Folder Manager) of RoleB
                usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userB, domainadminB, roleB, 1, Config.emailid, 1, userB);

                //Create Physcian Role (Conference User)
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainnameB, physician, "Conference=Physician", destpacs);
                login.Navigate<UserManagement>();
                usermgmt.CreateUser(phUser, domainadminB, physician, 1, Config.emailid, 1, phUser);
                usermgmt.CreateUser(doctorA, domainadminB, physician, 1, Config.emailid, 1, doctorA);

                //Create Archivist Role with conference enabled
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainnameB, archivist, "Conference=Archivist", destpacs);
                login.Navigate<UserManagement>();
                usermgmt.CreateUser(aruser, domainadminB, archivist, 1, Config.emailid, 1, aruser);

                //Create St Role and User without Conference feature
                rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainnameB, staff, "Staff", destpacs);
                login.Navigate<UserManagement>();
                usermgmt.CreateUser(stUser, domainadminB, staff, 1, Config.emailid, 1, stUser);
                Executedsteps++;

                //Step-3:PreConditions:Use existing conference folders and conference studies or create new ones as following e.g.------ 
                //DomainC---A) Top Level Folder Name- Cutaneous T-cell Lymphoma; Folder Manager- userC5---Cutaneous T-cell Lymphoma --- Level 2 sub1 - test Active Folder Status --- references to 1 conference study---Cutaneous T-cell Lymphoma --- Level 2 sub2 - test Active Folder Status --- Level3 sub2/1 --- references to 1 conference study---
                //Cutaneous T-cell Lymphoma --- Level2 sub3 - from different data sources --- references to 4 studies from MP, EA, rdm.mp, rdm.ea------B) Top level Folder Name- Head and Neck; Folder Manager- userC4---Head and Neck --- Different Modalities --- multiple level3 sub-folders (meeting for week1, and meeting for week2, etc...) --- references to more than one conference studies with supported modalities CR, DX, MG, IO, US-mf, CT, MR, NM, US, SC SC-mf Color, XA, RF, -east Tomo, PT, ES VL, OPT, RTIMAGE, with or without notes---Head and Neck --- Studies from related view --- references to 3 related conference studies---Head and Neck --- Saved GSPS studies --- references 2 conference studies with saved GSPS image or series---Head and Neck --- studies from Grant Access --- references to 2 studies that were shared via grant access (1 study with/without notes and granted by userC1 in Inbounds , 1 granted by userC4 in Outbounds without notes)                              
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(Cutaneous, foldermanager: UserC5, domain: domainnameC); //TopFloder   
                conffolder.CreateSubFolder(Cutaneous, Level_2_sub1, domainnameC); //Level2
                conffolder.CreateSubFolder(Cutaneous, Level_2_sub2, domainnameC); //Level2
                conffolder.CreateSubFolder(Cutaneous + "/" + Level_2_sub2, Level_3_sub2_1, domainnameC); //Level3
                conffolder.CreateSubFolder(Cutaneous, Level_2_sub3, domainnameC);  //level2

                conffolder.CreateToplevelFolder(Head_and_Neck, UserC4 + "-" + UserC1Manager, domainnameC); //TopFloder   
                conffolder.CreateSubFolder(Head_and_Neck, Different_Modalities, domainnameC);  //Level2
                conffolder.CreateSubFolder(Head_and_Neck + "/" + Different_Modalities, meeting_for_week1, domainnameC);
                conffolder.CreateSubFolder(Head_and_Neck + "/" + Different_Modalities, meeting_for_week2, domainnameC);
                conffolder.CreateSubFolder(Head_and_Neck, Studies_from_related_view, domainnameC);  //Level2
                conffolder.CreateSubFolder(Head_and_Neck, Saved_GSPS_studies, domainnameC);  //Level2(To be clarified)
                conffolder.CreateSubFolder(Head_and_Neck, studies_from_Grant_Access, domainnameC);  //Level2                

                Executedsteps++;

                //Step-4:Pre-conditions------- DomainB---III) Top Level Folder- Monthly Oncology Tumor Boards---Folder Manager- userB---1. sub-folder path- Hy-id, XDS only & DICOM only --- references to hy-id, XDS only, DICOM only conference studies added from Studies tab---2. sub-folder path- From Patient Record\XDS sub-tab --- references to hy-id, XDS only, DICOM only conference studies added from Patients tab---3. sub-folder path- MIME types --- references to all supported MINE types studies------
                //IV) Top Level Folder- Pediatric Bone Marrow Transplant---Folder Manager- ar, ph---1. sub-folder- Image sharing #1 ---- references to 0 study                
                conffolder.CreateToplevelFolder(Oncology, userB, domainnameB); //TopFloder   
                conffolder.CreateSubFolder(Oncology, Hybrid, domainnameB); //Level2
                conffolder.CreateSubFolder(Oncology, sub_tab, domainnameB); //Level2
                conffolder.CreateSubFolder(Oncology, MIME_types, domainnameB); //Level2

                conffolder.CreateToplevelFolder(Pediatric, foldermanager2, domainnameB); //TopFloder   
                conffolder.CreateSubFolder(Pediatric, Image_sharing, domainnameB); //Level2
                login.Logout();

                //Adding studies to the folders of DomainC
                //To Cutaneous
                login.LoginIConnect(DomainC_User, DomainC_Pwd);
                studies = login.Navigate<Studies>();
                studies.RDM_MouseHover();
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath_sub1, Accessions[0], MP); //To Level_2_sub1
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath_sub2_1, Accessions[0], MP, StudyNotes: StudyNotes); //To Level_3_sub2_1                
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath_sub3, Acc_4Studies[0], MP); //To Level_2_sub3 (MP)               
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath_sub3, Acc_4Studies[1], EA); //To Level_2_sub3 (EA)                
                studies.RDM_MouseHover();
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath_sub3, Acc_4Studies[2], Config.rdm + "." + RDM_MP); //To Level_2_sub3 (RDM.MP)
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath_sub3, Acc_4Studies[3], Config.rdm + "." + RDM_EA); //To Level_2_sub3 (RDM.EA)

                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.NavigateToActiveMode();
                conferencefolders.ExpandAndSelectFolder(folderpath_sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Sub1StudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ArchiveConferenceFolder(folderpath_sub1); //Archiving Level2 sub1 
                conferencefolders.NavigateToActiveMode();
                conferencefolders.ExpandAndSelectFolder(folderpath_sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Sub3StudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ArchiveConferenceFolder(folderpath_sub3); //Archiving Level2 sub3

                //To Head and Neck
                studies = login.Navigate<Studies>();
                studies.AddDatasourceSpecificStudyToStudyFolder(Week1_Path, Acc_DiffMod1Studies[0], MP); //To week1 
                studies.AddDatasourceSpecificStudyToStudyFolder(Week1_Path, Acc_DiffMod1Studies[1], MP); //To week1 
                studies.AddDatasourceSpecificStudyToStudyFolder(Week2_Path, Acc_DiffMod2Studies[0], MP); //To week2    
                studies.AddDatasourceSpecificStudyToStudyFolder(Week2_Path, Acc_DiffMod2Studies[1], MP); //To week2  
                try
                {
                    studies.AddDatasourceSpecificStudyToStudyFolder(Related_Path, Acc_RelatedStudies[0], EA);
                }
                catch (Exception)
                {
                    login.Logout();
                    login.LoginIConnect(DomainC_User, DomainC_Pwd);
                    studies = login.Navigate<Studies>();
                    studies.AddDatasourceSpecificStudyToStudyFolder(Related_Path, Acc_RelatedStudies[0], EA); //To Related  
                }
                studies.AddDatasourceSpecificStudyToStudyFolder(Related_Path, Acc_RelatedStudies[1], EA); //To Related  
                studies.AddDatasourceSpecificStudyToStudyFolder(Related_Path, Acc_RelatedStudies[2], EA); //To Related  
                studies.AddDatasourceSpecificStudyToStudyFolder(Related_Path, Acc_RelatedStudies[3], EA); //To Related  
                studies.AddDatasourceSpecificStudyToStudyFolder(GSPS_Path, Acc_GSPS, EA); //To GSPS
                login.Logout();
                //Sharing studies and adding to StudyFolder
                login.LoginIConnect(UserC4, UserC4);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studies.ShareStudy(false, new String[] { UserC1Manager });
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studies.ShareStudy(false, new String[] { UserC1Manager });
                outbounds = login.Navigate<Outbounds>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Shared_Path); //To Shared studyFolder
                studyViewer.CloseStudy();
                login.Logout();
                login.LoginIConnect(UserC1Manager, UserC1Manager);
                inbounds = login.Navigate<Inbounds>();
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Shared_Path); //To Shared studyFolder
                studyViewer.CloseStudy();
                login.Logout();
                login.LoginIConnect(DomainC_User, DomainC_Pwd);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.NavigateToActiveMode();
                conferencefolders.ExpandAndSelectFolder(Week1_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Week1_PathStudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ExpandAndSelectFolder(Week2_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Week2_PathStudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ExpandAndSelectFolder(Related_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Related_PathStudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ExpandAndSelectFolder(Shared_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Shared_PathStudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ExpandAndSelectFolder(GSPS_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int GSPS_PathStudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                //conferencefolders.NavigateToActiveMode();
                conferencefolders.ArchiveConferenceFolder(Head_and_Neck); //Archiving Head and Neck TopFolder
                login.Logout();


                //Adding studies to the folders of DomainB
                login.LoginIConnect(DomainB_User, DomainB_Pwd);
                studies = login.Navigate<Studies>();
                studies.AddDatasourceSpecificStudyToStudyFolder(Hybrid_Path, Acc_Hybrids[0], Config.xds2); //To Hybrid (Hybrid data)
                studies.AddDatasourceSpecificStudyToStudyFolder(Hybrid_Path, Acc_Hybrids[1], Config.xds2); //To Hybrid (DICOM)
                studies.AddDatasourceSpecificStudyToStudyFolder(MIME_Path, Acc_Hybrids[0], Config.xds2); //To MIME                

                //Accession[3] =" AE1962" -- XDS ** have to add
                //study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2, Accession[10], EA_46);

                patient = (Patients)login.Navigate("Patients");
                patient.InputData(PatientName[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientName[0].Trim());
                studyViewer = patient.LaunchStudy(Patients.PatientColumns.Accession, Acc_Hybrids[0]);
                studyViewer.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[0] });
                PageLoadWait.WaitForPageLoad(30);
                studyViewer.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Date" }, new string[] { StudyDate[1] });
                PageLoadWait.WaitForPageLoad(30);
                studyViewer.studyPanel(1).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Subtab_Path); //To Subtab (Hybrid data)
                studyViewer.studyPanel(2).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Subtab_Path); //To Subtab (DICOM)
                studyViewer.studyPanel(3).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(Subtab_Path, notes: "XDS Study Notes Precondition"); //To Subtab (XDS)
                studyViewer.CloseStudy();
                patient.ClosePatientRecord();
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.NavigateToActiveMode();
                conferencefolders.ExpandAndSelectFolder(Hybrid_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Hybrid_PathStudyCount_BeforeArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ArchiveConferenceFolder(Hybrid_Path); //Archiving Hybrid subfolder
                login.Logout();
                Executedsteps++;

                //Step-5:Login iCA as a domain admin (daC in DomainC), navigate to the Conference Folders tab, select Active sub-tab in folder browser, select a study folder been archived (e.g. Cutaneous T-cell Lymphoma ---Level 2 sub1 - test Active Folder Status)
                login.LoginIConnect(DomainC_User, DomainC_Pwd);
                conferencefolders = login.Navigate<ConferenceFolders>();
                IWebElement SubFolderList5 = conferencefolders.ExpandAndSelectFolder(folderpath_sub1);
                if (SubFolderList5 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-6:Click the Archive button (sub-tab) in the folder browser to toggle Archive mode.
                conferencefolders.NavigateToArchiveMode();
                Executedsteps++;

                //Step-7:From the folder browser Archive sub-tab, browse and select a folder which contains 1 study. (Cutaneous T-cell Lymphoma ---Level 2 sub1 - test Active Folder Status)                
                IWebElement SubFolderList7 = conferencefolders.ExpandAndSelectFolder(folderpath_sub1);
                if (SubFolderList7 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Browse contents of the archived folder selected, compare the study folder with the screen shot taken in previous test case (Conference Lists - Archive Folder (Desktop only))
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-9:Click Undo Archive button.
                conferencefolders.ExpandAndSelectFolder(folderpath_sub1);
                conferencefolders.Btn_UndoArchiveFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool IsDialogExist = conferencefolders.IsElementPresent(conferencefolders.Div_ConfirmationBy());
                bool IsOKExist = conferencefolders.IsElementPresent(conferencefolders.By_Btn_OKConfirmationDiv());
                bool IsCancelExist = conferencefolders.IsElementVisible(conferencefolders.By_Btn_CancelConfirmationDiv());
                if (IsDialogExist && IsOKExist && IsCancelExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-10:Click OK button.
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conferencefolders.Btn_OKConfirmationDiv().Click();
                IWebElement SubFolderList10 = conferencefolders.ExpandAndSelectFolder(folderpath_sub1);
                if (SubFolderList10 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-11:Login iCA as conference user of the domain (userC1 in DomainC), navigate to the Conference Folders tab, browse to the restored study folder (e.g. (Cutaneous T-cell Lymphoma ---Level 2 sub1 - test Active Folder Status --- references to 1 conference study), compare the listed conference study with the screenshot.
                login.LoginIConnect(UserC1, UserC1);
                conferencefolders = login.Navigate<ConferenceFolders>();
                IWebElement SubFolderList11 = conferencefolders.ExpandAndSelectFolder(folderpath_sub1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferencefolders.ExpandAndSelectFolder(Hybrid_Path);
                int Sub1StudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                if (SubFolderList11 != null && Sub1StudyCount_BeforeArchive == Sub1StudyCount_UndoArchive)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12:Load the study under the restored folder.
                conferencefolders.SelectStudy("Accession", Accessions[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                Boolean ViewerStatus12 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport_12 = studyViewer.SeriesViewer_1X1().Displayed;
                if (ViewerStatus12 && viewport_12)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseStudy();
                login.Logout();

                //Step-13:Login as a Domain Admin (daC in DomainC), navigate to the Conference Folders tab, toggle on the Archive mode, select a top level folder has been archived (e.g. Head and Neck), bring the top level folder back from archive.
                login.LoginIConnect(DomainC_User, DomainC_Pwd);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.UndoArchiveFolder(Head_and_Neck);
                IWebElement SubFolderList13_1 = conferencefolders.ExpandAndSelectFolder(Week1_Path);
                IWebElement SubFolderList13_2 = conferencefolders.ExpandAndSelectFolder(Week2_Path);
                IWebElement SubFolderList13_3 = conferencefolders.ExpandAndSelectFolder(Related_Path);
                IWebElement SubFolderList13_4 = conferencefolders.ExpandAndSelectFolder(Shared_Path);
                if (SubFolderList13_1 == null && SubFolderList13_2 == null && SubFolderList13_3 == null && SubFolderList13_4 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-14:Login iCA as conference user of the domain (userC1 in DomainC), navigate to the Conference Folders tab, browse to the restored folder in Active sub-tab, compare the listed conference study with the screenshot.
                login.LoginIConnect(UserC1, UserC1);
                conferencefolders = login.Navigate<ConferenceFolders>();
                IWebElement SubFolderList14_1 = conferencefolders.ExpandAndSelectFolder(Week1_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Week1_PathStudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                IWebElement SubFolderList14_2 = conferencefolders.ExpandAndSelectFolder(Week2_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Week2_PathStudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                IWebElement SubFolderList14_3 = conferencefolders.ExpandAndSelectFolder(Related_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Related_PathStudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                IWebElement SubFolderList14_4 = conferencefolders.ExpandAndSelectFolder(Shared_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Shared_PathStudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                conferencefolders.ExpandAndSelectFolder(GSPS_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int GSPS_PathStudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                Logger.Instance.InfoLog("Count of Week1 before archive :" + Week1_PathStudyCount_BeforeArchive +" Count of Week1 undo archive :"+ Week1_PathStudyCount_UndoArchive);
                Logger.Instance.InfoLog("Count of Week2 before archive :" + Week2_PathStudyCount_BeforeArchive + " Count of Week2 undo archive :" + Week2_PathStudyCount_UndoArchive);
                Logger.Instance.InfoLog("Count of Related before archive :" + Related_PathStudyCount_BeforeArchive + " Count of Related undo archive :" + Related_PathStudyCount_UndoArchive);
                Logger.Instance.InfoLog("Count of Shared before archive :" + Shared_PathStudyCount_BeforeArchive + " Count of Shared undo archive :" + Shared_PathStudyCount_UndoArchive);
                Logger.Instance.InfoLog("Count of GSPS before archive :" + GSPS_PathStudyCount_BeforeArchive + " Count of GSPS undo archive :" + GSPS_PathStudyCount_UndoArchive);

                if (SubFolderList14_1 != null && SubFolderList14_2 != null && SubFolderList14_3 != null && SubFolderList14_4 != null &&
                    Week1_PathStudyCount_BeforeArchive == Week1_PathStudyCount_UndoArchive && Week2_PathStudyCount_BeforeArchive == Week2_PathStudyCount_UndoArchive &&
                    Related_PathStudyCount_BeforeArchive == Related_PathStudyCount_UndoArchive && Shared_PathStudyCount_BeforeArchive == Shared_PathStudyCount_UndoArchive &&
                    GSPS_PathStudyCount_BeforeArchive == GSPS_PathStudyCount_UndoArchive)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-15:Load the studies from each of restored folders. (Head and Neck studies)
                conferencefolders.ExpandAndSelectFolder(Week1_Path);
                conferencefolders.SelectStudy("Accession", Acc_DiffMod1Studies[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                Boolean ViewerStatus15_1 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport1_15 = studyViewer.SeriesViewer_1X1().Displayed;
                studyViewer.CloseStudy();
                conferencefolders.ExpandAndSelectFolder(Week2_Path);
                conferencefolders.SelectStudy("Accession", Acc_DiffMod2Studies[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 2);
                Boolean ViewerStatus15_2 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport2_15 = studyViewer.SeriesViewer_1X1().Displayed;
                studyViewer.CloseStudy();
                conferencefolders.ExpandAndSelectFolder(Related_Path);
                conferencefolders.SelectStudy("Accession", Acc_RelatedStudies[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 3);
                Boolean ViewerStatus15_3 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport3_15 = studyViewer.SeriesViewer_1X1().Displayed;
                studyViewer.CloseStudy();
                conferencefolders.ExpandAndSelectFolder(Shared_Path);
                conferencefolders.SelectStudy("Accession", Accessions[1]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 4);
                Boolean ViewerStatus15_4 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer(), 4, 1);
                bool viewport4_15 = studyViewer.SeriesViewer_1X1().Displayed;


                if (viewport1_15 && ViewerStatus15_1 && ViewerStatus15_2 && viewport2_15 && ViewerStatus15_3 && viewport3_15 && ViewerStatus15_4 && viewport4_15)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseStudy();
                login.Logout();

                //Step-16:Login as the Domain Admin (daB in DomainB), navigate to the Conference Folder tab, click the Archive button (sub-tab) in the folder browser, attempt to select and restore an archived study folder that is under a different domain (DomainC) which is not managed by this domain admin (Cutaneous T-cell Lymphoma --- Level2 sub3 - from different data sources --- references to 4 studies from MP, EA, rdm.mp, rdm.ea).
                login.LoginIConnect(DomainB_User, DomainB_Pwd);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.NavigateToArchiveMode();
                IWebElement DomainCTopFolder = conferencefolders.ExpandAndSelectFolder(Cutaneous);
                if (DomainCTopFolder == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-17:Login as a Super Admin, navigate to the Conference Folders tab, select a domain (DomainC), click the Archive button (sub-tab) in the folder browser to toggle Archive mode.
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.DomainSelector().SelectByText(domainnameC);
                conferencefolders.NavigateToArchiveMode();
                if (conferencefolders.Btn_UndoArchiveFolder().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-18:From the folder browser Archive sub-tab, Browse and select a folder (e.g. Cutaneous T-cell Lymphoma ---Level2 sub3 - from different data sources.)
                IWebElement IsSub3Exist18 = conferencefolders.ExpandAndSelectFolder(folderpath_sub3);
                if (IsSub3Exist18 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19:Browse contents of the archived folder, compare the study folder with the screen shot taken in previous test case
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-20 & 21:Click Undo Archive button and Click OK button.
                conferencefolders.UndoArchiveFolder(folderpath_sub3);
                Executedsteps++;
                IWebElement IsSub3Exist21 = conferencefolders.ExpandAndSelectFolder(folderpath_sub3);
                if (IsSub3Exist21 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-22:Login iCA as conference user of the domain (userC1 in DomainC), navigate to the Conference Folders tab, browse the restored (e.g. (Cutaneous T-cell Lymphoma ---Level2 sub3 - from different data sources ---references to 4 studies from MP, EA, rdm.mp, rdm.ea.), compare the listed conference study with the screenshot.
                login.LoginIConnect(UserC1, UserC1);
                conferencefolders = login.Navigate<ConferenceFolders>();
                IWebElement IsSub3Exist22 = conferencefolders.ExpandAndSelectFolder(folderpath_sub3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Sub3StudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                if (IsSub3Exist22 != null && Sub3StudyCount_UndoArchive == Sub3StudyCount_BeforeArchive)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-23:Load each study from the restored folder. (4 studies from diff datasources)
                conferencefolders.SelectStudy("Accession", Acc_4Studies[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps, 1);
                Boolean ViewerStatus23_1 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport1_23 = studyViewer.SeriesViewer_1X1().Displayed;
                studyViewer.CloseStudy();
                conferencefolders.SelectStudy("Accession", Acc_4Studies[1]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 2);
                Boolean ViewerStatus23_2 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport2_23 = studyViewer.SeriesViewer_1X1().Displayed;
                studyViewer.CloseStudy();
                conferencefolders.SelectStudy("Accession", Acc_4Studies[2]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 3);
                Boolean ViewerStatus23_3 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport3_23 = studyViewer.SeriesViewer_1X1().Displayed;
                studyViewer.CloseStudy();
                conferencefolders.SelectStudy("Accession", Acc_4Studies[3]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[Executedsteps].SetPath(testid, Executedsteps, 4);
                Boolean ViewerStatus23_4 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer(), 4, 1);
                bool viewport4_23 = studyViewer.SeriesViewer_1X1().Displayed;

                if (ViewerStatus23_1 && viewport1_23 && ViewerStatus23_2 && viewport2_23 && ViewerStatus23_3 && viewport3_23 && ViewerStatus23_4 && viewport4_23)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseStudy();
                login.Logout();

                //Step-24:Login as a Super Admin, navigate to the Conference Folders tab, select a domain (DomainC), toggle on Archive mode, search an archived study folder that is belonging to a different domain (DomainB, Monthly Oncology Tumor Boards --- Hy-id, XDS only & DICOM only --- 4 XDS studies)
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.DomainSelector().SelectByText(domainnameC);
                IWebElement IsFolderExist = conferencefolders.ExpandAndSelectFolder(Oncology);
                if (IsFolderExist == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-25:Login iCA as a Folder Manager (userC4 in DomainC), navigate to the Conference Folders tab, attempt to toggle on the Archive mode by clicking the Archive button (sub-tab) from the folder browser.
                login.LoginIConnect(UserC4, UserC4);
                conferencefolders = login.Navigate<ConferenceFolders>();
                bool IsArchiveTabExist25 = conferencefolders.IsElementVisible(conferencefolders.By_Btn_ArchiveMode());
                if (!IsArchiveTabExist25)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-26:Login iCA as a conference user (userC1 in DomainC), navigate to the Conference Folders tab, attempt to toggle on the Archive mode by clicking the Archive button (sub-tab) from the folder browser.
                login.LoginIConnect(UserC1, UserC1);
                conferencefolders = login.Navigate<ConferenceFolders>();
                bool IsArchiveTabExist26 = conferencefolders.IsElementVisible(conferencefolders.By_Btn_ArchiveMode());
                if (!IsArchiveTabExist26)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-27:Login as a Domain Admin (daB in DomainB), navigate to the Conference Folders tab, toggle on the Archive mode, bring all archived folders in the domain back from archive
                login.LoginIConnect(DomainB_User, DomainB_Pwd);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.UndoArchiveFolder(Hybrid_Path);
                IWebElement IsHybridFolderExist27 = conferencefolders.ExpandAndSelectFolder(Hybrid_Path);
                if (IsHybridFolderExist27 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-28:Login iCA as conference user of the domain (DoctorA in DomainB), navigate to the Conference Folders tab, browse the restored folder, compare the listed conference study with the screenshot.
                login.LoginIConnect(doctorA, doctorA);
                conferencefolders = login.Navigate<ConferenceFolders>();
                IWebElement IsHybridFolderExist28 = conferencefolders.ExpandAndSelectFolder(Hybrid_Path);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int Hybrid_PathStudyCount_UndoArchive = BasePage.GetSearchResults().Count;
                if (IsHybridFolderExist28 != null && Hybrid_PathStudyCount_BeforeArchive == Hybrid_PathStudyCount_UndoArchive)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-29:Load the studies from each of restored folders.
                conferencefolders.SelectStudy("Accession", Acc_Hybrids[0]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                Boolean ViewerStatus29 = studies.CompareImage(result.steps[Executedsteps], studyViewer.ViewerContainer());
                bool viewport_29 = studyViewer.studyPanel(1).Displayed; //Have to be modified
                if (ViewerStatus29 && viewport_29)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseStudy();
                login.Logout();


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - GUI Verification in SubFolders and FolderDescription
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test1_98703(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;   
                String Checkboxes = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Checkboxes");
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String LDAPDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainName");
                String LDAPDomainAdmin = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainAdmin");
                String LDAPRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP RoleName");
                String[] LDAPRoles = LDAPRoleName.Split('=');
                String LDAPInstName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP InstituitionName");
                String LDAPDomainDesc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainDescription");
                String LDAPRoleDesc = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP RoleDescription");
                String[] RoleDesc = LDAPRoleDesc.Split(':');
                String LDAPPassword = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Password");
                String LDAPUsers = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Users");
                String[] Users = LDAPUsers.Split('=');
                String userid = Users[0];  //Conference user
                String userid2 = Users[1];  //Conference user 
                String userid3 = Users[2];  //Non Conference user
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Firstname");
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String user1 = LDAPUsernames[0]; //Conference Username
                String user2 = LDAPUsernames[1]; //Conference Username
                String user3 = LDAPUsernames[2]; //Non Conference Username
                String LDAP_GroupDetails = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Group");
                String[] LDAPGroup = LDAP_GroupDetails.Split(':');
                String DomainAdmin_Userid = LDAPDomainAdmin;
                String DomainAdmin_Pwd = LDAPPassword;
                String rolename = LDAPRoles[0];
                String rolename2 = LDAPRoles[1];
                String rolename3 = LDAPRoles[2];
                String EA91 = login.GetHostName(Config.EA91);
                String PACSA7 = login.GetHostName(Config.SanityPACS);               
                Random random = new Random();
                String topfoldername = "1Top1" + random.Next(100, 10000);
                String subfoldername1 = "1Sub" + random.Next(100, 10000);
                String subfoldername2 = "1Sub" + random.Next(100, 10000);
                String StudyNotes = "1StudyNotes_" + random.Next(100, 1000);
                String Description = "1Description_" + random.Next(100, 1000);
                String folderpath1 = topfoldername + "/" + subfoldername1;
                String folderpath2 = topfoldername + "/" + subfoldername2;



                //Step-1:Pre-conditions--1. iCA build under testing is a fresh installation.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Mixed data base is used; Ldap user data base is configured (Server- ica.ldap.merge.ad IP- 10.4.38.27, Account Name- ica.administrator)-4. HTML5 viewer is enabled
                //Setup Ldap- tenet final data model.   
                Taskbar taskbar = new Taskbar();
                taskbar.Hide();
                servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                servicetool.LDAPTenetFinaldmSetup();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                Executedsteps++;

                //Step-2:Pre-conditions--Configure Domains, Roles, Groups are configured according to steps in test cases under LDAP/MultipleDomain Ldap Image Sharing (Test 27680 - Main PreSetup, Test 27681 - Setup Domain that are mapped in LDAP, Test 27682 - Create Roles that are configured in the LDAP, -Test 27683 - Create the Groups).
                Executedsteps++;

                //Step-3:-Pre-conditions--Ensure that Conference Lists in Domain Management tab and Conference User in Role Management tab are enabled for super admin and domain admin.-Ensure there is a user role under a domain with Conference User enabled; and another role with the option disabled-Ensure that there are Conference Users and non-Conference users in the same domain
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                domain.SearchDomain(DefaultDomain);
                domain.SelectDomain(DefaultDomain);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.ClickSaveEditDomain();
                if (!domain.SearchDomain(LDAPDomain))
                {
                    domain.CreateDomain(LDAPDomain, LDAPDomainDesc, LDAPInstName, LDAPDomainAdmin, "", LDAPDomainAdmin, LDAPDomainAdmin, LDAPPassword, LDAPDomainAdmin, LDAPDomainAdmin, 1, new string[] { EA91, PACSA7}, Checkboxes);
                }
                var role = login.Navigate<RoleManagement>();
                role.DomainSelector().SelectByText(LDAPDomain);
                PageLoadWait.WaitForFrameLoad(30);
                if (!role.RoleExists(rolename))
                {
                    role.CreateRole(LDAPDomain, rolename, RoleDesc[0], new string[] { "receiveexam", "conferenceuser", "datadownload", "datatransfer" }, isGrantAccessGrouponly: true); //Physician
                }
                if (!role.RoleExists(rolename2))
                {
                    role.CreateRole(LDAPDomain, rolename2, RoleDesc[1], new string[] { "archive", "datadownload", "datatransfer", "conferenceuser" }, isGrantAccessAnyone: true); //Archivist
                }
                if (!role.RoleExists(rolename3))
                {
                    role.CreateRole(LDAPDomain, rolename3, RoleDesc[2], new string[] { "datadownload", "datatransfer" }, isGrantAccessGrouponly: true); //PACS Admin
                }
                var usermgmt = login.Navigate<UserManagement>();
                //Group and subgroup creation
               
                if (!usermgmt.SearchGroup(LDAPGroup[0], LDAPDomain, 0))
                {
                    PageLoadWait.WaitForPageLoad(10);
                    usermgmt.CreateGroup(LDAPDomain, LDAPGroup[0], groupdesc: LDAPGroup[1]);
                    usermgmt.CreateSubGroup(LDAPGroup[0], LDAPGroup[2]);
                    usermgmt.CreateSubGroup(LDAPGroup[0], LDAPGroup[3]);
                    usermgmt.CreateSubGroup(LDAPGroup[0], LDAPGroup[4]);                    
                }
                bool IsGroupExist = usermgmt.SearchGroup(LDAPGroup[0], LDAPDomain, 0);
                bool IsRadiologyExist = usermgmt.SearchGroup(LDAPGroup[0], LDAPDomain, 1, subgroupname: LDAPGroup[2]);
                bool IsCardiologyExist = usermgmt.SearchGroup(LDAPGroup[0], LDAPDomain, 1, LDAPGroup[3]);
                bool IsUrologyExist = usermgmt.SearchGroup(LDAPGroup[0], LDAPDomain,1, LDAPGroup[4]);
                bool User1 = usermgmt.SearchUser(user1, LDAPDomain,userid);//Conference user
                bool User2 = usermgmt.SearchUser(user2, LDAPDomain,userid2); //Conference user
                bool User3 = usermgmt.SearchUser(user3, LDAPDomain,userid3); //Non Conference user               

                //Create Top Level and Sub level folder
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, DomainAdmin_Userid, LDAPDomain, Description);
                conffolder.CreateSubFolder(topfoldername, subfoldername1, LDAPDomain, Description);
                conffolder.CreateSubFolder(topfoldername, subfoldername2, LDAPDomain);
                if (User1 && User2 && User3 && IsGroupExist && IsRadiologyExist && IsCardiologyExist && IsUrologyExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();
               


                //Step-4:Login as the domain admin, from the Conference Folders tab, select the Active sub-tab in the Folder Browser, select a top level folder, click Add Folder button.
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conffolder.NavigateToActiveMode();
                conffolder.ExpandAndSelectFolder(topfoldername);
                IWebElement Syncup = PageLoadWait.WaitForElement(By.CssSelector("#treeDiv>ul"), WaitTypes.Visible, 30);
                conffolder.CreateFolderButton().Click();
                List<IWebElement> inputbox = Syncup.FindElements(By.TagName("input")).ToList();

                if (inputbox.Count == 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-5:Enter sub-folder name and press the Enter button on the keyboard
                Driver.FindElement(By.CssSelector(".fancytree-edit-input")).SendKeys("NewSub");
                Driver.FindElement(By.CssSelector(".fancytree-edit-input")).SendKeys(Keys.Enter);
                //Adding sync up
                foreach (IWebElement item in inputbox)
                {
                    wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector(".fancytree-edit-input")));
                }
                if (conffolder.ActiveFolder().Text.Equals("NewSub"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6:Add sub-folders which at least has 10 sub levels.               
                String Sub;
                String Root = topfoldername;
                int count = 0;
                for (int i = 1; i <= 10; i++)
                {
                    Sub = "Sub" + i + "";
                    conffolder.CreateSubFolder(Root, Sub);
                    count++;
                    Root = Root + "/" + Sub;
                }
                if (count == 10)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7:Create a few sub-folders with folder name contains special characters (~!@#$%^&*()_+{}|<>/)
                conffolder.CreateSubFolder(topfoldername, "~!@#$%^&*()_+{}|<>/");
                if (conffolder.ActiveFolder().Text.Equals("~!@#$%^&*()_+{}|<>/"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Perform boundary validation in the sub-folder name field. //256 is the limit
                PageLoadWait.WaitForFrameLoad(30);
                string text = "";
                for (int i = 1; i <= 33; i++)
                {
                    text = text + "abcdefgh";
                }
                //conffolder.CreateSubFolder(topfoldername, text);
                bool IsFolderCreated;
                List<IWebElement> inputbox1;
                try 
                {
                    //Select Folder
                    conffolder.ExpandAndSelectFolder(topfoldername);
                    
                    //Create new folder
                    conffolder.CreateFolderButton().Click();
                    inputbox1 = Syncup.FindElements(By.TagName("input")).ToList();
                    Driver.FindElement(By.CssSelector(".fancytree-edit-input")).SendKeys(text);
                    Driver.FindElement(By.CssSelector(".fancytree-edit-input")).SendKeys(Keys.Enter);
                    //Adding sync up
                    foreach (IWebElement item in inputbox1)
                    {
                        wait.Until(ExpectedConditions.InvisibilityOfElementLocated(By.CssSelector(".fancytree-edit-input")));
                    }

                    if (conffolder.ActiveFolder().Text.Equals(text))
                    {

                        Logger.Instance.InfoLog("Subfolder is created");
                        IsFolderCreated = false;
                    }
                    IsFolderCreated = false;
                }
                catch(Exception)
                {
                    IsFolderCreated = true;
                }

                if (IsFolderCreated)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9:Expand folders in the Folder Browser Active sub-tab to display a scroll bar. Move scroll bar to browse folders.
                /*   String Sub1;
                   String Root1 = topfoldername;               
                   int count1 = 0;
                   for (int i = 1; i <= 10; i++)
                   {
                       Sub1 = "SubFolder" + i + "";
                       conffolder.CreateSubFolder(Root1, Sub1);
                       count1++;
                       Root1 = Root1 + "/" + Sub1;                   
                   }*/

                result.steps[++Executedsteps].status = "Not Automated";


                //Step-10:Select a sub-folder, modify this folder by clicking this folder again.
                String browser = ((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower();
                conffolder.ExpandAndSelectFolder(topfoldername + "/" + "NewSub");
                conffolder.ActiveFolder().Click();
                PageLoadWait.WaitForFolderPathToChange(conffolder.ActiveFolder().Text);

                if (browser.Equals("chrome") || browser.Equals("internet explorer"))
                {
                    conffolder.ActiveFolder().Click();
                    wait.Until(ExpectedConditions.ElementExists(By.CssSelector(".fancytree-edit-input")));
                }
                String name = Driver.FindElement(By.CssSelector(".fancytree-edit-input")).GetAttribute("value");
                if (name.Equals("NewSub"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-11:Edit name and then cancel the name modification.
                Driver.FindElement(By.CssSelector(".fancytree-edit-input")).Clear();
                IWebElement IsSubfolderExist = conffolder.ExpandAndSelectFolder(topfoldername + "/" + "NewSub");

                if (IsSubfolderExist != null && conffolder.ActiveFolder().Text.Equals("NewSub"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12:Repeat above step, modify a sub-folder name, this time press Enter button on the keyboard.                
                conffolder.RenameFolder(topfoldername + "/" + "NewSub", "Sub01");
                if (conffolder.ActiveFolder().Text.Equals("Sub01"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13:Select a sub-folder click Delete Folder button
                conffolder.ExpandAndSelectFolder(topfoldername + "/" + "Sub01");
                conffolder.Btn_DeleteFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool IsDialogExist = conffolder.IsElementPresent(conffolder.Div_ConfirmationBy());
                bool IsOKExist = conffolder.IsElementPresent(conffolder.By_Btn_OKConfirmationDiv());
                bool IsCancelExist = conffolder.IsElementVisible(conffolder.By_Btn_CancelConfirmationDiv());
                if (IsDialogExist && IsOKExist && IsCancelExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-14:Click Cancel
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                IWebElement IsSub01Exist = conffolder.ExpandAndSelectFolder(topfoldername + "/" + "Sub01");
                if (IsSub01Exist != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-15:Repeat above step, this time click OK in the dialog.
                conffolder.DeleteFolder(topfoldername + "/" + "Sub01");
                IWebElement IsSub01Exist_15 = conffolder.ExpandAndSelectFolder(topfoldername + "/" + "Sub01");
                if (IsSub01Exist_15 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-16:Login as the domain admin, from the Folder Browser Active sub-folder, select a Folder (top or sub folder), verify Folder Description in the middle pane.
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conffolder.NavigateToActiveMode();
                conffolder.ExpandAndSelectFolder(topfoldername);
                String TopDesc = conffolder.EditDesc_CurrentDesc().Text;
                if (conffolder.ActiveFolder().Text.Equals(topfoldername) && TopDesc.Equals(Description))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-17:Click Edit Folder Description button, enter folder descriptions in the text area, press Enter button.
                conffolder.EditDesc_Button().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.EditDesc_TextArea()));
                conffolder.EditDesc_TextArea().Click();
                conffolder.EditDesc_TextArea().Clear();
                conffolder.EditDesc_TextArea().SendKeys("New_Description");
                conffolder.EditDesc_TextArea().SendKeys(Keys.Enter);
                if (conffolder.EditDesc_TextArea().GetAttribute("style").Contains("display: inline-block"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-18:Edit folder descriptions with special characters (~!@#$%^&*()_+{}|<>/)
                conffolder.EditDescription("~!@#$%^&*()_+{}|<>/");
                String TopDesc_18 = conffolder.EditDesc_CurrentDesc().Text;
                if (TopDesc_18.Equals("~!@#$%^&*()_+{}|<>/"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19:Perform boundary validation in the Folder Description field. (Test up to some arbitrary limit, e.g.10,000 characters should be sufficient, though there is no actual size restriction.)
                string desc = "";
                for (int i = 1; i <= 1250; i++)
                {
                    desc = desc + "abcdefgh";
                }

                conffolder.EditDescription(desc);
                String TopDesc_19 = conffolder.EditDesc_CurrentDesc().Text;
                if (TopDesc_19.Equals(desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-20:Edit Folder Description and then Cancel the modification.
                conffolder.EditDescription("Testing", "CANCEL");
                String TopDesc_20 = conffolder.EditDesc_CurrentDesc().Text;
                if (TopDesc_20.Equals(desc))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-21:Edit Folder Description in different level of folders (e.g. Description of Top level folder, sub-folders) using different text. Select each of these folders. Verify Folder Description displays for the selected one.
                conffolder.CreateToplevelFolder("1TOP");
                conffolder.ExpandAndSelectFolder("1TOP");
                conffolder.EditDescription("Automation");
                conffolder.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1);
                conffolder.EditDescription("AutomationTesting");
                conffolder.ExpandAndSelectFolder("1TOP");
                String TopDesc_21 = conffolder.EditDesc_CurrentDesc().Text;
                conffolder.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1);
                String SubDesc_21 = conffolder.EditDesc_CurrentDesc().Text;
                if (TopDesc_21.Equals("Automation") && SubDesc_21.Equals("AutomationTesting"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Test 96211 - Conference Lists - Add conference study with/without notes to a Sub-Folder in Study Viewer (MPACS, EA, RDM)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test1_96211(String testid, String teststeps, int stepcount)
        {

            #region Test Split

            //Step 1 to 40  - 1st Split - Test1_96211()

            //Step-41 to 42 - Test2_96211() - Adding Studies of different Modality and ensure they study in viewer is loaded properly.

            //Step-43-47 - - Test3_96211() Adding a Study and its 2 priors to the conference folder

            //Step-48 to 49 - Test4_96211() Open study in viewer (Studies Tab) - Apply tools and Save images and add to conference folder

            //Stepp-50 and 51 - Test5_96211() Same as above but save as series

            //Step-52 to 60 -  Test6_96211() Adding study shared to a user to conference folder

            //Setp-61 to 66 - Test7_96211() - Domain Admin adds a study to a folder

            //Step-67 to 70 -  Test8_96211() - SuperAdmin adds study to conference folde in his domain.

            //Step-71 - Clean up - Not Automation Requited

            #endregion Test Split


            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainC, RoleC and User
            String domainC = String.Empty;
            String domainadminC = String.Empty;
            String passwordC = String.Empty;
            String roleC1 = "Role1C" + random.Next(1, limit);
            String roleC2 = "RoleC2" + random.Next(1, limit);
            String groupC1 = "GroupC1" + random.Next(1, limit);
            String userC1 = "UserC1" + random.Next(1, limit);
            String userC2 = "UserC2" + random.Next(1, limit);
            String userC4 = "UserC4" + random.Next(1, limit);
            String userC5 = "UserC5" + random.Next(1, limit);
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername11 = "Sub11" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername12 = "Sub12" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername122 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;
            String foldermanager1 = userC5;

            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername21 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath2 = topfoldername2;
            String foldermanager2 = userC4;

            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String datasource = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
            String[] arraccession = accession.Split(':');
            String[] arrdatasource = datasource.Split(':');

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainC, RoleC and User C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();

                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();

                if (domain.ConferenceListsCB().Selected == false)
                {
                    domain.ConferenceListsCB().Click();
                    Logger.Instance.InfoLog("ConferenceLists Check Box Selected successfully");
                }
                else
                {
                    Logger.Instance.InfoLog("ConferenceLists Check Box already selected");
                }
                domain.ClickSaveNewDomain();

                var domainattr = domain.CreateDomainAttr();
                domainC = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminC = domainattr[DomainManagement.DomainAttr.UserID];
                passwordC = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);

                //Create Role roleC1 and roleC2 with Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainC, roleC1, "Conference");
                rolemgmt.CreateRole(domainC, roleC2, "Conference");

                //Create GroupC1 and its users
                var usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateGroup(domainC, groupC1, rolenames: new string[] { roleC1 }, selectallroles: 1, selectalldatasources: 1);
                usermgmt.CreateUserForGroup(groupC1, userC1, domainC, roleC1, hasPass: 1, Password: userC1);
                usermgmt.CreateUserForGroup(groupC1, userC5, domainC, roleC1, hasPass: 1, Password: userC5);

                //Create UserC2 and UserC4
                login.Navigate<RoleManagement>();
                usermgmt = login.Navigate<UserManagement>();
                usermgmt.CreateUser(userC2, domainadminC, roleC2, 1, Config.emailid, 1, userC2);
                usermgmt.CreateUser(userC4, domainadminC, roleC2, 1, Config.emailid, 1, userC4);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition Folder Creation
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, foldermanager: userC5, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername11, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername11;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, foldermanager: userC4, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername21, Description: description2);
                folderpath2 = topfoldername2 + "/" + subfoldername21;
                executedsteps++;
                #endregion Step-3-Precondition Folder Creation

                //Step-4 - Already Automated in Step-2
                executedsteps++;

                //Step-5 - Create Folders
                login.Logout();
                login.LoginIConnect(userC5, userC5);
                var conference = login.Navigate<ConferenceFolders>();
                subfoldername11 = subfoldername11 + "New";
                conference.RenameFolder(folderpath1, subfoldername11);
                folderpath1 = topfoldername1 + "/" + subfoldername11;
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                PageLoadWait.WaitForLoadingMessage(20);
                studies.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();
                executedsteps++;

                //Step-6 - Select Tool - Add to Conference Folder
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                executedsteps++;

                //Step-7-Clicks the Browse button in the dialog                
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                executedsteps++;

                //Step-8-Verify folder manager able to see only his folders
                bool isFolder2Present = false;
                try { isFolder2Present = conference.ExpandAndSelectFolder(folderpath2).Text.Equals(subfoldername21); }
                catch (Exception) { isFolder2Present = false; }
                bool isFolder1Present = conference.ExpandAndSelectFolder(folderpath1).Text.Equals(subfoldername11);
                if (isFolder1Present && !isFolder2Present)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-9 - Select a sub-folder that does not contain any Sub-Folders (Level 2 sub1 - test Active Folder Status). Click Select Folder button.
                BasePage.Driver.FindElement(viewer.Btn_SelectFolder()).Click();                
                var folderpath = (String)((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return(document.querySelector(\"input#AddConferenceStudyControl_DestinationFolderTextBox\").value)");
                bool isPathDisplayed = folderpath.Substring(1, (folderpath.Length-1)).Equals(folderpath1);
                if (isPathDisplayed)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-10-Enter Study Notes and click add button
                SetText("id", "AddConferenceStudyControl_StudyNotes", notes1);
                BasePage.Driver.FindElement(viewer.Btn_Add()).Click();
                viewer.CloseStudy();                
                executedsteps++;

                //Step-11 - Verify Study added and Active folder
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder = conference.ActiveFolder().Text.Equals(subfoldername11);
                var study = conference.GetMatchingRow("Accession", arraccession[0]);
                if (study != null && isActiveFolder)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-12 - Switch to different tabs and then navigate back to the Conference Folders tab,
                //verify the Active Folder selection from the Folder Browser
                login.Navigate<Studies>();                
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder12 = conference.ActiveFolder().Text.Equals(subfoldername11);
                if (isActiveFolder12)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-13 - Verify Patient info and Study notes
                var study13 = conference.GetMatchingRow("Accession", arraccession[0]);
                conference.SelectStudy("Accession", arraccession[0]);
                String notes13 = conference.GetStudyNotesFromTextArea();
                if (study13!=null && notes13.Equals(notes1))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-14-Select Top folder and make it as Active folder
                conference.ExpandAndSelectFolder(topfoldername1);
                bool isTopFolderActive14 = conference.ActiveFolder().Text.Equals(topfoldername1);
                if (isTopFolderActive14)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-15 - Create another Sub folder level 2 and 3
                conference.CreateSubFolder(topfoldername1, subfoldername12, Description: description1);
                String folderpath12 = topfoldername1 + "/" + subfoldername12;
                conference.CreateSubFolder(folderpath12, subfoldername122, Description: description1);
                folderpath12 = folderpath12 + "/" + subfoldername122;
                if(conference.ActiveFolder().Text.Equals(subfoldername122))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-16-Set level-2 as active folder
                conference.ExpandAndSelectFolder(topfoldername1 + "/" + subfoldername12);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                conference.ExpandAndSelectFolder(topfoldername1 + "/" + subfoldername12);
                if (BasePage.wait.Until<Boolean>(d => d.FindElement(By.CssSelector("input[id$= '_SelectFolderButton']")).Enabled == false))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Step-17-Check level2 Subfolder is active folder
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                if(conference.ActiveFolder().Text.Equals(subfoldername12))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-18- Check Default destination folder and add button
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                var folderpath18 = (String)((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return(document.querySelector(\"input#AddConferenceStudyControl_DestinationFolderTextBox\").value)");
                bool isAddBtnEnabled18 = BasePage.Driver.FindElement(viewer.Btn_Add()).GetAttribute("style").ToLower().Contains("opacity: 1");
                if (folderpath18.Split('/').Last().Equals(subfoldername12) && !isAddBtnEnabled18)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }                
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                viewer.CloseStudy();

                //Step-19-Ensure Level2 is active folder
                login.Navigate<ConferenceFolders>();
                if (conference.ActiveFolder().Text.Equals(subfoldername12))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-20 - Make level3 as active and check in viewer
                conference.ExpandAndSelectFolder(folderpath12);
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                var folderpath20 = (String)((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return(document.querySelector(\"input#AddConferenceStudyControl_DestinationFolderTextBox\").value)");
                if(folderpath20.Split('/').Last().Equals(subfoldername122))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-21 - Add Study to Level-3 Active Folder                
                SetText("id", "AddConferenceStudyControl_StudyNotes", notes13);
                BasePage.Driver.FindElement(viewer.Btn_Add()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                executedsteps++;

                //Step-22--Checked Level-3 is active folder
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder22 = conference.ActiveFolder().Text.Equals(subfoldername122);
                if(isActiveFolder22)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-23
                var study23 = conference.GetMatchingRow("Accession", arraccession[0]);
                conference.SelectStudy("Accession", arraccession[0]);
                bool isNotesPresent = conference.GetStudyNotesFromTextArea().Equals(notes13);
                if (study23!=null && isNotesPresent)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-24-Ensure Active Folder is still the same
                login.Navigate<Studies>();
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder24 = conference.ActiveFolder().Text.Equals(subfoldername122);
                if (isActiveFolder24)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-25--Logout and Login again and check the Active folder
                login.Logout();
                login.LoginIConnect(userC5, userC5);
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder25 = false;
                try
                {
                    isActiveFolder25 = conference.ActiveFolder().Text.Equals(subfoldername122);
                }
                catch (Exception) { isActiveFolder25 = false; }
                if (!isActiveFolder25)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-26 to 28 -- Add a Study only in PACS and Validate
                String subfoldername13 = "Sub" + random.Next(1, limit);
                conference.CreateSubFolder(topfoldername1, subfoldername13);
                String folderpath13 = topfoldername1 + "/" + subfoldername13;
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[1]);
                studies.SelectStudy("Accession", arraccession[1]);
                studies.LaunchStudy();
                executedsteps++;
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath13, notes: notes1);
                executedsteps++;
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder28 = conference.ActiveFolder().Text.Equals(subfoldername13);
                conference.SelectStudy("Accession", arraccession[1]);
                bool isNotesPeresent28 = conference.GetStudyNotesFromTextArea().Equals(notes1);
                if(isActiveFolder28 && isNotesPeresent28)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-29 to 30 -- Add a Study only in EA and Validate
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[2]);
                studies.ChooseColumns(new String[]{"Accession"});
                studies.SelectStudy("Accession", arraccession[2]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath13, notes: notes1);
                executedsteps++;
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder30 = conference.ActiveFolder().Text.Equals(subfoldername13);
                conference.SelectStudy("Accession", arraccession[2]);
                bool isNotesPeresent30 = conference.GetStudyNotesFromTextArea().Equals(notes1);
                if (isActiveFolder30 && isNotesPeresent30)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-31 -- Add a Study only in RDM.MPACS and Validate
                login.Navigate<Studies>();
                studies.SearchStudy(AccessionNo:arraccession[3], Datasource:Config.rdm+"."+arrdatasource[0], rdm:true);
                studies.SelectStudy("Accession", arraccession[3]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath13, notes: notes1);                
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder31 = conference.ActiveFolder().Text.Equals(subfoldername13);                
                conference.SelectStudy("Accession", arraccession[3]);
                bool isNotesPeresent31 = conference.GetStudyNotesFromTextArea().Equals(notes1);
                if (isActiveFolder31 && isNotesPeresent31)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }                

                //Step-32 -- Add a study only in RDM.EA and Validate
                login.Navigate<Studies>();
                studies.SearchStudy(AccessionNo: arraccession[4], Datasource: Config.rdm + "." + arrdatasource[1], rdm: true);
                studies.SelectStudy("Accession", arraccession[4]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath13, notes: notes1);
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                bool isActiveFolder32 = conference.ActiveFolder().Text.Equals(subfoldername13);
                conference.SelectStudy("Accession", arraccession[4]);
                bool isNotesPeresent32 = conference.GetStudyNotesFromTextArea().Equals(notes1);
                if (isActiveFolder32 && isNotesPeresent32)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-33 -- Load the above 4 studies from conference tab and Validate.
                result.steps[++executedsteps].status = "Not Automated";


                //Step-34 -- Validate same study cannot be added to subfolder which already has it
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[4]);
                studies.SelectStudy("Accession", arraccession[4]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();                
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });                
                viewer.ExpandAndSelectFolder(folderpath);
                bool isSelectfolderEnabled = BasePage.Driver.FindElement(viewer.Btn_SelectFolder()).GetAttribute("style").Contains("opacity: 1");
                if(!isSelectfolderEnabled)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                viewer.CloseStudy();

                //Step-35 -- Validate that same study can be added to a different subfolder
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[4]);
                studies.SelectStudy("Accession", arraccession[4]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath1, notes:notes1);
                executedsteps++;

                //Step-36 - Folder Manager tries to add a study to folder for which he is not a Manager.
                login.Logout();
                login.LoginIConnect(userC4, userC4);
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                bool isFoldervisible = false; 
                try
                {
                    isFoldervisible = viewer.ExpandAndSelectFolder(folderpath13).Text.Equals(subfoldername13);
                }
                catch(Exception)
                {
                    isFoldervisible = false;
                }
                if(!isFoldervisible)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-37 -- Try adding a study to top level folder
                viewer.ExpandAndSelectFolder(topfoldername2);
                bool isErrorMessage = BasePage.Driver.FindElement(viewer.ErrLabel_FolderSelect()).
                GetAttribute("innerHTML").Equals("Selected folder cannot be top level/intermediate folder.");
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                if(isErrorMessage)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-38 - Non conference User tries to add a Study
                login.Logout();
                login.LoginIConnect(userC1, userC1);
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                bool isToolDisplayed = false;
                try
                {
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    BasePage.wait.Until<Boolean>(driver =>
                    {
                        if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                        {
                            return true;
                        }
                        else
                        {
                            return false;
                        }
                    });
                    isToolDisplayed = true;
                }
                catch (Exception) { isToolDisplayed = false; }
                if(!isToolDisplayed)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Setp-39 - Login as User C4.
                login.Logout();
                login.LoginIConnect(userC4, userC4);
                login.Navigate<ConferenceFolders>();
                String modalitysubfolder = "Modality" + random.Next(1, limit);
                conference.CreateSubFolder(topfoldername2, modalitysubfolder);
                String folderpath_modality = topfoldername2 + "/" + modalitysubfolder;
                executedsteps++;

                //Step-40 -- Add a CT Study to this Subfolder
                login.Navigate<Studies>();
                studies.SearchStudy(AccessionNo: arraccession[5]);
                studies.SelectStudy("Accession", arraccession[5]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath_modality, notes: notes2);
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();                
                conference.SelectStudy("Accession", arraccession[5]);
                bool isNotesPresent40 = conference.GetStudyNotesFromTextArea().Equals(notes2);
                if(isNotesPresent40)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }                

                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Test 96211_2 Step-41 to 42
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_96211(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainC, RoleC and User
            String domainC = String.Empty;
            String domainadminC = String.Empty;
            String passwordC = String.Empty;
            String roleC1 = String.Empty;
            String roleC2 = String.Empty;
            String groupC1 = String.Empty;
            String userC1 = String.Empty;
            String userC2 = String.Empty;
            String userC4 = String.Empty;
            String userC5 = String.Empty;
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername11 = "Sub11" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername12 = "Sub12" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername122 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;
            

            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername21 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath2 = topfoldername2;
            

            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String datasource = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
            String[] arraccession = accession.Split(':');
            String[] arrdatasource = datasource.Split(':');

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;                       

                #region Step-2-Precondition User Creation
                //Create DomainC, RoleC and User C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                domainC = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminC = domainattr[DomainManagement.DomainAttr.UserID];
                passwordC = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);

                //Create Role roleC1 and roleC2 with Conference enabled
                var rolemgmt = login.Navigate<RoleManagement>();
                roleC1 = BasePage.GetUniqueRole("RoleC1");
                rolemgmt.CreateRole(domainC, roleC1, "Conference");
                roleC2 = BasePage.GetUniqueRole("RoleC2");
                rolemgmt.CreateRole(domainC, roleC2, "Conference");

                //Create GroupC1 and its users
                var usermgmt = login.Navigate<UserManagement>();
                groupC1 = BasePage.GetUniqueGroupId("GroupC1");
                userC1 = BasePage.GetUniqueUserId("UserC1");
                usermgmt.CreateGroup(domainC, groupC1, rolenames: new string[] { roleC1 }, selectallroles: 1, selectalldatasources: 1);
                usermgmt.CreateUserForGroup(groupC1, userC1, domainC, roleC1, hasPass: 1, Password: userC1);
                userC5 = BasePage.GetUniqueUserId("UserC5");
                String foldermanager1 = userC5;
                usermgmt.CreateUserForGroup(groupC1, userC5, domainC, roleC1, hasPass: 1, Password: userC5);

                //Create UserC2 and UserC4
                login.Navigate<RoleManagement>();
                usermgmt = login.Navigate<UserManagement>();
                userC2 = BasePage.GetUniqueUserId("UserC2");
                usermgmt.CreateUser(userC2, domainadminC, roleC2, 1, Config.emailid, 1, userC2);
                userC4 = BasePage.GetUniqueUserId("UserC4");
                String foldermanager2 = userC4;
                usermgmt.CreateUser(userC4, domainadminC, roleC2, 1, Config.emailid, 1, userC4);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition Folder Creation
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, foldermanager: userC5, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername11, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername11;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, foldermanager: userC4, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername21, Description: description2);
                folderpath2 = topfoldername2 + "/" + subfoldername21;
                executedsteps++;
                #endregion Step-3-Precondition Folder Creation

                //Step-4 - Already Automated in Step-2
                executedsteps++;

                //Setp-5 - Login as User C4.-Add studies of different modality
                login.Logout();
                login.LoginIConnect(userC4, userC4);
                var conference = login.Navigate<ConferenceFolders>();
                String modalitysubfolder = "Modality" + random.Next(1, limit);
                conference.CreateSubFolder(topfoldername2, modalitysubfolder);
                String folderpath_modality = topfoldername2 + "/" + modalitysubfolder;
                executedsteps++;

                
                int counter = 0;
                bool isNotesPresent40 = false;                
                foreach (String accessionno in arraccession)
                {
                    counter++;
                    var studies = login.Navigate<Studies>();
                    studies.SearchStudy(AccessionNo: accessionno);
                    studies.SelectStudy("Accession", accessionno);
                    viewer  = studies.LaunchStudy();
                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    if (counter>2)
                        viewer.AddStudyToStudyFolder(folderpath_modality, notes: notes2);
                    else
                        viewer.AddStudyToStudyFolder(folderpath_modality);
                    viewer.CloseStudy();
                    login.Navigate<ConferenceFolders>();
                    conference.SelectStudy("Accession", accessionno);
                    if (counter > 2)
                        isNotesPresent40 = conference.GetStudyNotesFromTextArea().Equals(notes2);
                    else
                        isNotesPresent40 = true;

                    if (isNotesPresent40)
                    {
                        result.steps[executedsteps].statuslist.Add("Pass");
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                    }
                    else
                    {
                        result.steps[executedsteps].statuslist.Add("Fail");
                        Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                        result.steps[executedsteps].SetLogs();
                    }
                }
                result.steps[executedsteps].status = result.steps[executedsteps].statuslist.Contains("Fail") ? "Fail" : "Pass";
                
                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Test 96211_3 - Step-43 to 47
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test3_96211(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainC, RoleC and User
            String domainC = String.Empty;
            String domainadminC = String.Empty;
            String passwordC = String.Empty;                     
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername11 = "Sub11" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername12 = "Sub12" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername122 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;
            

            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername21 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath2 = topfoldername2;       
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String datasource = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
            String[] arraccession = accession.Split(':');
            String[] arrdatasource = datasource.Split(':');

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainC, RoleC and User C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                domainC = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminC = domainattr[DomainManagement.DomainAttr.UserID];
                passwordC = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);

                //Create Role roleC1 and roleC2 with Conference enabled
                String roleC1 = BasePage.GetUniqueRole("RoleC1");
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainC, roleC1, "Conference");
                String roleC2 = BasePage.GetUniqueRole("RoleC2");
                rolemgmt.CreateRole(domainC, roleC2, "Conference");

                //Create GroupC1 and its users
                var usermgmt = login.Navigate<UserManagement>();
                String groupC1 = BasePage.GetUniqueGroupId("GroupC1");
                String userC1 = BasePage.GetUniqueUserId("UserC1");
                usermgmt.CreateGroup(domainC, groupC1, rolenames: new string[] { roleC1 }, selectallroles: 1, selectalldatasources: 1);
                usermgmt.CreateUserForGroup(groupC1, userC1, domainC, roleC1, hasPass: 1, Password: userC1);
                String userC5 = BasePage.GetUniqueUserId("UserC5");
                String foldermanager1 = userC5;
                usermgmt.CreateUserForGroup(groupC1, userC5, domainC, roleC1, hasPass: 1, Password: userC5);

                //Create UserC2 and UserC4
                login.Navigate<RoleManagement>();
                usermgmt = login.Navigate<UserManagement>();
                String userC2 = BasePage.GetUniqueUserId("UserC2");                
                usermgmt.CreateUser(userC2, domainadminC, roleC2, 1, Config.emailid, 1, userC2);
                String userC4 = BasePage.GetUniqueUserId("UserC4");
                String foldermanager2 = userC4;
                usermgmt.CreateUser(userC4, domainadminC, roleC2, 1, Config.emailid, 1, userC4);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition Folder Creation
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, foldermanager: userC5, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername11, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername11;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, foldermanager: userC4, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername21, Description: description2);
                folderpath2 = topfoldername2 + "/" + subfoldername21;
                executedsteps++;
                #endregion Step-3-Precondition Folder Creation

                //Step-4 - Already Automated in Step-2
                executedsteps++;

                //Setp-5 - Login as User C4.
                login.Logout();
                login.LoginIConnect(userC4, userC4);
                var conference = login.Navigate<ConferenceFolders>();
                String modalitysubfolder = "Modality" + random.Next(1, limit);
                conference.CreateSubFolder(topfoldername2, modalitysubfolder);
                String folderpath_modality = topfoldername2 + "/" + modalitysubfolder;

                var studies  = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                viewer  = studies.LaunchStudy();

                //Wait till Add folder Dialog appears
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();

                //Wait till Add folder Dialog appears
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });

                //Expand and Select Folder
                this.ExpandAndSelectFolder(folderpath_modality);
                BasePage.Driver.FindElement(viewer.Btn_SelectFolder()).Click();

                //Wait till Add folder Dialog to Disappear
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                SetText("id", "AddConferenceStudyControl_StudyNotes", notes1);               
                BasePage.Driver.FindElement(viewer.Btn_Add()).Click();
                executedsteps++;

                //Step-6
                viewer.NavigateToHistoryPanel();
                viewer.ChooseColumns(new string[] { "Accession" });                
                viewer.OpenPriors(new string[] { "Accession" }, new string[] {arraccession[1]});
                BasePage.Driver.FindElement(By.CssSelector("div[id$=_studyPanel_2_panelInfoDiv]")).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                SetText("id", "AddConferenceStudyControl_StudyNotes", notes1);
                BasePage.Driver.FindElement(viewer.Btn_Add()).Click();
                executedsteps++;

                //Step-7
                viewer.NavigateToHistoryPanel();                
                viewer.OpenPriors(new string[] { "Accession" }, new string[] { arraccession[2] });
                BasePage.Driver.FindElement(By.CssSelector("div[id$=_studyPanel_3_panelInfoDiv]")).Click();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                SetText("id", "AddConferenceStudyControl_StudyNotes", notes1);
                BasePage.Driver.FindElement(viewer.Btn_Add()).Click();
                viewer.CloseStudy();
                executedsteps++;

                //Step-8
                conference = login.Navigate<ConferenceFolders>();
                int studycount = BasePage.GetSearchResults().Count;
                bool isNotesPresent = false;
                foreach(String accessionno in arraccession)
                {
                    conference.SelectStudy("Accession", accessionno);
                    isNotesPresent = conference.GetConferenceStudyNotes().Equals(notes1);
                    if (!isNotesPresent) { isNotesPresent = false; break; }
                }
                if(studycount==3 && isNotesPresent)
                {
                    result.steps[++executedsteps].status="Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status="Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-9
                bool isImageCompare = false;
                executedsteps++;
                int counter = 0;
                foreach (String accessionno in arraccession)
                {
                    counter++;
                    conference.SelectStudy("Accession", accessionno);
                    viewer  = conference.LaunchStudy(isConferenceTab:true);                    
                    result.steps[executedsteps].SetPath(testid, executedsteps, counter);
                    isImageCompare = viewer.CompareImage(result.steps[executedsteps], viewer.studyPanel());
                    if (!isImageCompare) { break;}                    
                    viewer.CloseStudy();
                }
                if (isImageCompare)
                {
                    result.steps[executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Setp-61 to 66 - Test7_96211() - Domain Admin adds a study to a folder
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test7_96211(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainC, RoleC and User
            String domainC = String.Empty;
            String domainadminC = String.Empty;
            String passwordC = String.Empty;
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername11 = "Sub11" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername12 = "Sub12" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername122 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;
            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername21 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath2 = topfoldername2;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String datasource = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
            String[] arraccession = accession.Split(':');
            String[] arrdatasource = datasource.Split(':');

            //Error Messages
            String actualmessage = "Selected folder cannot be top level/intermediate folder.";

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainC, RoleC and User C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();                
                domainC = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminC = domainattr[DomainManagement.DomainAttr.UserID];
                passwordC = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);

                //Create Role roleC1 and roleC2 with Conference enabled
                String roleC1 = BasePage.GetUniqueRole("RoleC1");
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainC, roleC1, "Conference");
                String roleC2 = BasePage.GetUniqueRole("RoleC2");
                rolemgmt.CreateRole(domainC, roleC2, "Conference");

                //Create GroupC1 and its users
                var usermgmt = login.Navigate<UserManagement>();
                String groupC1 = BasePage.GetUniqueGroupId("GroupC1");
                String userC1 = BasePage.GetUniqueUserId("UserC1");
                usermgmt.CreateGroup(domainC, groupC1, rolenames: new string[] { roleC1 }, selectallroles: 1, selectalldatasources: 1);
                usermgmt.CreateUserForGroup(groupC1, userC1, domainC, roleC1, hasPass: 1, Password: userC1);
                String userC5 = BasePage.GetUniqueUserId("UserC5");
                String foldermanager1 = userC5;
                usermgmt.CreateUserForGroup(groupC1, userC5, domainC, roleC1, hasPass: 1, Password: userC5);

                //Create UserC2 and UserC4
                login.Navigate<RoleManagement>();
                usermgmt = login.Navigate<UserManagement>();
                String userC2 = BasePage.GetUniqueUserId("UserC2");
                usermgmt.CreateUser(userC2, domainadminC, roleC2, 1, Config.emailid, 1, userC2);
                String userC4 = BasePage.GetUniqueUserId("UserC4");
                String foldermanager2 = userC4;
                usermgmt.CreateUser(userC4, domainadminC, roleC2, 1, Config.emailid, 1, userC4);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition Folder Creation
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, foldermanager: userC5, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername11, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername11;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, foldermanager: userC4, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername21, Description: description2);
                folderpath2 = topfoldername2 + "/" + subfoldername21;
                executedsteps++;
                #endregion Step-3-Precondition Folder Creation

                //Step-4 - Already Automated in Step-2
                executedsteps++;

                //Setp-5 - Login as Domain Admin and add study to subfolder w/o study notes(Step-61)
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var conference = login.Navigate<ConferenceFolders>();
                String modalitysubfolder = "Modality" + random.Next(1, limit);
                conference.CreateSubFolder(topfoldername2, modalitysubfolder);
                String folderpath_modality = topfoldername2 + "/" + modalitysubfolder;
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();                
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath_modality);
                viewer.CloseStudy();
                executedsteps++;

                //Step-6 - Add study to study folder under different to folder with study notes Step-62
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[1]);
                studies.SelectStudy("Accession", arraccession[1]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath_modality, notes:notes1);
                viewer.CloseStudy();
                executedsteps++;

                //Step-7 - Add Study to a sub folder under different Top folder. Step-63
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[2]);
                studies.SelectStudy("Accession", arraccession[2]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath2+"/"+subfoldername21, notes:notes1);
                viewer.CloseStudy();
                executedsteps++;

                //Step-8 - Step-64 - Add study to subfolder which has a Subfolder
                login.Navigate<ConferenceFolders>();
                String subfolder3 = "Sub" + random.Next(1, limit);
                confolder.CreateSubFolder(topfoldername2, subfolder3, Description: description2);
                confolder.CreateSubFolder(topfoldername2, subfolder3, Description: description2);
                String folderpath3 = topfoldername2 + "/" + subfolder3;
                String subfolder31 = "Sub" + random.Next(1, limit);
                confolder.CreateSubFolder(folderpath3, subfolder31, Description: description2);
                folderpath3 = folderpath3 + "/" + subfolder31;
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                conference.ExpandAndSelectFolder(folderpath3);
                String errormessage8 = BasePage.Driver.FindElement(By.CssSelector("span[id$='_errorLabelInvalidFolderSelection']")).GetAttribute("innerHTML");
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                if (errormessage8.Equals(actualmessage))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step9 - (Step-65) - Adding study to Top level folder under same domain
                viewer.CloseStudy();
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                this.ExpandAndSelectFolder(topfoldername2);
                String errormessage9 = BasePage.Driver.FindElement(By.CssSelector("span[id$='_errorLabelInvalidFolderSelection']")).GetAttribute("innerHTML");
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                if (errormessage9.Equals(actualmessage))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-10 (Step-66) - Domain Admin adding study to folder which is not in his doamin.
                result.steps[++executedsteps].status = "Not Automated";


                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Step-67 to 70 -  Test8_96211() - SuperAdmin adds study to conference folde in his domain.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test8_96211(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainC, RoleC and User
            String domainC = String.Empty;
            String domainadminC = String.Empty;
            String passwordC = String.Empty;
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername11 = "Sub11" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername12 = "Sub12" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername122 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;
            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername21 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath2 = topfoldername2;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String datasource = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
            String[] arraccession = accession.Split(':');
            String[] arrdatasource = datasource.Split(':');

            //Error Messages
            String actualmessage = "Selected folder cannot be top level/intermediate folder.";

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainC, RoleC and User C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                domainC = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminC = domainattr[DomainManagement.DomainAttr.UserID];
                passwordC = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true);

                //Create Role roleC1 and roleC2 with Conference enabled
                String roleC1 = BasePage.GetUniqueRole("RoleC1");
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainC, roleC1, "Conference");
                String roleC2 = BasePage.GetUniqueRole("RoleC2");
                rolemgmt.CreateRole(domainC, roleC2, "Conference");

                //Create GroupC1 and its users
                var usermgmt = login.Navigate<UserManagement>();
                String groupC1 = BasePage.GetUniqueGroupId("GroupC1");
                String userC1 = BasePage.GetUniqueUserId("UserC1");
                usermgmt.CreateGroup(domainC, groupC1, rolenames: new string[] {roleC1}, selectallroles: 1, selectalldatasources: 1);
                usermgmt.CreateUserForGroup(groupC1, userC1, domainC, roleC1, hasPass: 1, Password: userC1);
                String userC5 = BasePage.GetUniqueUserId("UserC5");
                String foldermanager1 = userC5;
                usermgmt.CreateUserForGroup(groupC1, userC5, domainC, roleC1, hasPass: 1, Password: userC5);

                //Create UserC2 and UserC4
                login.Navigate<RoleManagement>();
                usermgmt = login.Navigate<UserManagement>();
                String userC2 = BasePage.GetUniqueUserId("UserC2");
                usermgmt.CreateUser(userC2, domainadminC, roleC2, 1, Config.emailid, 1, userC2);
                String userC4 = BasePage.GetUniqueUserId("UserC4");
                String foldermanager2 = userC4;
                usermgmt.CreateUser(userC4, domainadminC, roleC2, 1, Config.emailid, 1, userC4);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition Folder Creation
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, foldermanager: userC5, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername11, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername11;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, foldermanager: userC4, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername21, Description: description2);
                folderpath2 = topfoldername2 + "/" + subfoldername21;
                executedsteps++;
                #endregion Step-3-Precondition Folder Creation

                //Step-4 - Already Automated in Step-2
                executedsteps++;

                //Step-5 (Step-67) - Login as SuperAdmin, Create Top level and sub folder
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var conffolder = login.Navigate<ConferenceFolders>();
                String topfolder = "Top" + random.Next(1, limit);
                conffolder.CreateToplevelFolder(topfolder, domain: "SuperAdminGroup", description: description1);
                String folderpath = topfolder;
                String subfolder = "Sub" + random.Next(1, limit);
                conffolder.CreateSubFolder(topfolder, subfolder, Domain_Name: "SuperAdminGroup", Description: description1);
                folderpath = topfolder + "/" + subfolder;
                executedsteps++;

                //Step-6 (Step-68) - Add Study to a valid sub folder with notes
                var studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath, notes:notes1);
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                if (BasePage.GetSearchResults().Count==1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-7 (Step-69) - Add study to a sub folder which is not part of superadmingroup
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();               
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                bool isSubFolderFound = false;
                try
                {
                    var folder = conffolder.ExpandAndSelectFolder(folderpath1);
                    if (folder.Text.Equals(subfoldername11)) { isSubFolderFound = true; }
                }
                catch (Exception) { isSubFolderFound = false; }
                if(!isSubFolderFound)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }       
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                viewer.CloseStudy();

                //Step-8 (Step-70) - Create a Top level folder and add a study folder
                login.Navigate<ConferenceFolders>();
                String topfolder4 = "Top4" + random.Next(1, limit);
                conffolder.CreateToplevelFolder(topfolder4, domain: "SuperAdminGroup");
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[0]);
                studies.SelectStudy("Accession", arraccession[0]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_Browser()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (!driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").ToLower().Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                conffolder.ExpandAndSelectFolder(topfolder4);
                String errormessage8 = BasePage.Driver.FindElement(By.CssSelector("span[id$='_errorLabelInvalidFolderSelection']")).GetAttribute("innerHTML");
                if(errormessage8.Equals(actualmessage))
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }
                BasePage.Driver.FindElement(viewer.Btn_Cancel()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_BrowseFolder()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                BasePage.Driver.FindElement(viewer.Btn_CancelAddingConfStudy()).Click();
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (driver.FindElement(viewer.Popup_AddConferenceStudy()).GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                viewer.CloseStudy();

                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Step-52 to 60 -  Test6_96211() Adding study shared to a user to conference folder
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test6_96211(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables              
            TestCaseResult result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            int executedsteps = -1;
            Random random = new Random();
            int limit = Math.Abs((int)DateTime.Now.Ticks);
            limit = Int32.Parse(limit.ToString().Substring(0, 4));
            String description = "Desc" + random.Next(1, limit);

            //DomainC, RoleC and User
            String domainC = String.Empty;
            String domainadminC = String.Empty;
            String passwordC = String.Empty;
            StudyViewer viewer = null;

            //Folders
            String topfoldername1 = "Top1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername11 = "Sub11" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername12 = "Sub12" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername122 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String foldermanager = String.Empty;
            String description1 = "Desc1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes1 = "Notes1" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath1 = topfoldername1;
            String topfoldername2 = "Top2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String subfoldername21 = "Sub21" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String description2 = "Desc2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String notes2 = "Notes2" + new System.DateTime().Millisecond + random.Next(100, 10000);
            String folderpath2 = topfoldername2;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String datasource = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
            String[] arraccession = accession.Split(':');
            String datasource1 = datasource.Split(':')[0];
            String datasource2 = datasource.Split(':')[1];
            datasource1 = Config.rdm + "." + datasource1;           

            try
            {
                //Step-1-Precondition - General Precondition    
                executedsteps++;

                #region Step-2-Precondition User Creation

                //Create DomainC, RoleC and User C
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                DomainManagement domain = login.Navigate<DomainManagement>();
                var domainattr = domain.CreateDomainAttr();
                domainC = domainattr[DomainManagement.DomainAttr.DomainName];
                domainadminC = domainattr[DomainManagement.DomainAttr.UserID];
                passwordC = domainattr[DomainManagement.DomainAttr.Password];
                domain.CreateDomain(domainattr, isconferenceneeded: true, isgrantaccessneeded:true);

                //Create Role roleC1 and roleC2 with Conference enabled
                String roleC1 = BasePage.GetUniqueRole("RoleC1");
                var rolemgmt = login.Navigate<RoleManagement>();
                rolemgmt.CreateRole(domainC, roleC1, "", datasourcelist:datasource1);
                String roleC2 = BasePage.GetUniqueRole("RoleC2");
                rolemgmt.CreateRole(domainC, roleC2, "Conference",datasourcelist: datasource2);

                //Create GroupC1 and its users
                var usermgmt = login.Navigate<UserManagement>();
                String groupC1 = BasePage.GetUniqueGroupId("GroupC1");
                String userC1 = BasePage.GetUniqueUserId("UserC1");
                usermgmt.CreateGroup(domainC, groupC1, rolenames: new string[] { roleC1 });
                usermgmt.CreateUserForGroup(groupC1, userC1, domainC, roleC1, hasPass: 1, Password: userC1);
                String userC5 = BasePage.GetUniqueUserId("UserC5");
                String foldermanager1 = userC5;
                usermgmt.CreateUserForGroup(groupC1, userC5, domainC, roleC1, hasPass: 1, Password: userC5);

                //Create UserC2 and UserC4
                login.Navigate<RoleManagement>();
                usermgmt = login.Navigate<UserManagement>();
                String userC2 = BasePage.GetUniqueUserId("UserC2");
                usermgmt.CreateUser(userC2, domainadminC, roleC2, 1, Config.emailid, 1, userC2);
                String userC4 = BasePage.GetUniqueUserId("UserC4");
                String foldermanager2 = userC4;
                usermgmt.CreateUser(userC4, domainadminC, roleC2, 1, Config.emailid, 1, userC4);
                executedsteps++;

                #endregion Step-2-Precondition User Creation

                #region Step-3-Precondition Folder Creation
                //Step-3 - Create Folders and Add studies
                login.Logout();
                login.LoginIConnect(domainadminC, passwordC);
                var confolder = login.Navigate<ConferenceFolders>();

                //Case-1
                confolder.CreateToplevelFolder(topfoldername1, foldermanager: userC5, description: description1);
                confolder.CreateSubFolder(topfoldername1, subfoldername11, Description: description1);
                folderpath1 = topfoldername1 + "/" + subfoldername11;

                //Case-2
                confolder.CreateToplevelFolder(topfoldername2, foldermanager: userC4, description: description2);
                confolder.CreateSubFolder(topfoldername2, subfoldername21, Description: description2);
                folderpath2 = topfoldername2 + "/" + subfoldername21;
                executedsteps++;
                #endregion Step-3-Precondition Folder Creation

                //Step-4 - Already Automated in Step-2
                executedsteps++;

                //Step-5(Step-52) - connect roleC1 to rdm.ea and roleC2 to pacs
                executedsteps++;

                //Step-6(Step-53) - Login as userC1 and load a study which is not accessible to userC4
                login.Logout();
                login.LoginIConnect(userC1, userC1);
                var studies  = login.Navigate<Studies>();
                studies.SearchStudy(AccessionNo: arraccession[0], Datasource:datasource1, rdm: true, RDM_PrefixName:Config.rdm);                
                studies.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();
                executedsteps++;

                //Step-7(Step-54) - Grant access to that study to userC4
                viewer.SelectToolInToolBar(IEnum.ViewerTools.GrantAccesstoStudy);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div#StudySharingControl_StudySharingDialogDiv")));
                viewer.ShareStudy(false, new string[] {userC4}, domainName: domainC, ReviewTool:true);
                viewer.CloseStudy();
                var outbounds = login.Navigate<Outbounds>();
                outbounds.SearchStudy("Accession", arraccession[0]);
                var study = outbounds.GetMatchingRow("Accession", arraccession[0]);
                if(study!=null)                
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-8(Step-55) - Login as userC4 and add that study to conference folder
                login.Logout();
                login.LoginIConnect(userC4, userC4);
                var inbounds = login.Navigate<Inbounds>();
                inbounds.SearchStudy("Accession", arraccession[0]);
                inbounds.SelectStudy("Accession", arraccession[0]);
                viewer = studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath2, notes:notes2);
                viewer.CloseStudy();
                var conffolder = login.Navigate<ConferenceFolders>();                
                conffolder.SelectStudy("Accession", arraccession[0]);
                bool isNotes8 = conffolder.GetConferenceStudyNotes().Equals(notes2);
                if(isNotes8 && BasePage.GetSearchResults().Count==1)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }


                //Step-9(Step-56) - Launch study in conference tab
                conffolder.LaunchStudy(isConferenceTab: true);
                viewer.CloseStudy();
                executedsteps++;

                //Step-10(Step-57) - Grant access to a study (not accessible to roleC1) to userC1
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[1]);
                studies.SelectStudy("Accession", arraccession[1]);
                viewer = studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.GrantAccesstoStudy);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div#StudySharingControl_StudySharingDialogDiv")));
                viewer.ShareStudy(false, new string[] {userC1}, domainName: domainC, ReviewTool: true);
                viewer.CloseStudy();
                executedsteps++;

                //Step-11(Step-58) - From outbounds add the study to conference folder.
                login.Navigate<Outbounds>();
                outbounds.SearchStudy("Accession", arraccession[1]);
                outbounds.SelectStudy("Accession", arraccession[1]);
                outbounds.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath2, notes:notes2);
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                var study11 = conffolder.GetMatchingRow("Accession", arraccession[1]);
                conffolder.SelectStudy("Accession", arraccession[1]);
                bool isNotes11 = conffolder.GetConferenceStudyNotes().Equals(notes2);
                if(isNotes11 && study11!=null)
                {
                    result.steps[++executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[executedsteps].description);
                }
                else
                {
                    result.steps[++executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[executedsteps].description);
                    result.steps[executedsteps].SetLogs();
                }

                //Step-12(Step-59) - From conference tab grant access to userC1 to which userC1 doesn't have access to
                login.Navigate<Studies>();
                studies.SearchStudy("Accession", arraccession[2]);
                studies.SelectStudy("Accession", arraccession[2]);
                studies.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(folderpath2, notes: notes2);
                viewer.CloseStudy();
                login.Navigate<ConferenceFolders>();
                conffolder.SelectStudy("Accession", arraccession[2]);
                conffolder.LaunchStudy(isConferenceTab: true);
                viewer.SelectToolInToolBar(IEnum.ViewerTools.GrantAccesstoStudy);
                BasePage.wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div#StudySharingControl_StudySharingDialogDiv")));
                viewer.ShareStudy(false, new string[] { userC1 }, domainName: domainC, ReviewTool: true);
                viewer.CloseStudy();
                executedsteps++;

                //Step-13(Step-60) - Login as non-conference user userC1 and check the study in inbounds.
                login.Logout();
                login.LoginIConnect(userC1, userC1);
                login.Navigate<Inbounds>();
                inbounds.SearchStudy("Accession", arraccession[1]);
                inbounds.SelectStudy("Accession", arraccession[1]);
                inbounds.LaunchStudy();
                viewer.CloseStudy();
                inbounds.SearchStudy("Accession", arraccession[2]);
                inbounds.SelectStudy("Accession", arraccession[2]);
                inbounds.LaunchStudy();
                viewer.CloseStudy();
                executedsteps++;

                //Logout   
                login.Logout();

                //Return Result
                result.FinalResult(executedsteps);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Conference Lists - GUI Verification in Conference Tab
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_98703(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;                
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");               
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String LDAPDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainName");
                String LDAP_Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Users");
                String[] LDAPUsers = LDAP_Users.Split('=');
                String userid = LDAPUsers[0]; //Conference Userid
                String userid2 = LDAPUsers[1]; //Conference Userid
                String userid3 = LDAPUsers[2]; //Non Conference Userid
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Firstname");
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String user1 = LDAPUsernames[0]; //Conference Userid
                String user2 = LDAPUsernames[1]; //Conference Userid
                String user3 = LDAPUsernames[2]; //Non Conference Userid
                String DomainAdmin_Userid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainAdmin");
                String DomainAdmin_Pwd = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Password");
                String LDAP_Password = DomainAdmin_Pwd;
                Random random = new Random();
                String topfoldername = "2Top1" + random.Next(1, 10000);
                String subfoldername1 = "Sub01" + random.Next(1, 10000);
                String subfoldername2 = "Sub02" + random.Next(1, 10000);               
                String StudyNotes = "StudyNotes_" + random.Next(1, 1000);
                String Description = "Description_" + random.Next(1, 1000);
                String topfoldername2 = "2Top2" + random.Next(1, 10000);
                String sub2 = "sub2" + random.Next(1, 10000);
                String folderpath1 = topfoldername + "/" + subfoldername1;
                String folderpath2 = topfoldername + "/" + subfoldername2;
                String FolderPath_2 = topfoldername2 + "/" + sub2;



                //Step-1:Pre-conditions--1. iCA build under testing is a fresh installation.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Mixed data base is used; Ldap user data base is configured (Server- ica.ldap.merge.ad IP- 10.4.38.27, Account Name- ica.administrator)-4. HTML5 viewer is enabled
                Executedsteps++;

                //Step-2:Pre-conditions--Configure Domains, Roles, Groups are configured according to steps in test cases under LDAP/MultipleDomain Ldap Image Sharing (Test 27680 - Main PreSetup, Test 27681 - Setup Domain that are mapped in LDAP, Test 27682 - Create Roles that are configured in the LDAP, -Test 27683 - Create the Groups).
                Executedsteps++;

                //Step-3:-Pre-conditions--Ensure that Conference Lists in Domain Management tab and Conference User in Role Management tab are enabled for super admin and domain admin.-Ensure there is a user role under a domain with Conference User enabled; and another role with the option disabled-Ensure that there are Conference Users and non-Conference users in the same domain               
                Executedsteps++;


                //Step-4:Login iCA as a super admin, navigate to the Conference Folders tab. Verify the display of the tab
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool IsDomainDropdownExist = conffolder.IsElementVisible(By_DomainSelector());
                bool IsFolderBrowserSectionExist = conffolder.IsElementVisible(conffolder.By_LeftPane());
                bool IsConferenceStudySectionExist = conffolder.IsElementVisible(conffolder.By_MidPane());
                bool IsCommentsSectionExist = conffolder.IsElementVisible(conffolder.By_RightPane());

                if (IsDomainDropdownExist && IsFolderBrowserSectionExist && IsConferenceStudySectionExist && IsCommentsSectionExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-5:Verify the Folder Browser - Archive sub-tab in left pane
                bool IsArchiveFolderBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveFolder());
                bool IsDeleteFolderBtnExist = conffolder.IsElementPresent(conffolder.Btn_DeleteFolderBy());
                bool IsCreateFolderBtnExist = conffolder.IsElementPresent(conffolder.By_CreateFolderButton());
                bool IsManageTopLevelFoldersBtnExist = conffolder.IsElementPresent(conffolder.By_ManageTopLevelFolders());
                bool IsActiveModeBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_ActiveMode());
                bool IsArchiveModeBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveMode());

                if (IsArchiveFolderBtnExist && IsDeleteFolderBtnExist && IsCreateFolderBtnExist && IsManageTopLevelFoldersBtnExist && IsArchiveModeBtnExist &&
                    IsActiveModeBtnExist && conffolder.Btn_ActiveMode().GetAttribute("style").Contains("opacity: 1"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6:Select Archive sub-tab, verify the Folder Browser - Archive sub-tab              
                conffolder.NavigateToArchiveMode();
                bool IsUndoArchiveFolderBtnExist = conffolder.Btn_UndoArchiveFolder().Enabled;
                bool IsDeleteFolderBtnExist6 = conffolder.Btn_DeleteFolder().Enabled;
                bool IsCreateFolderBtnExist6 = conffolder.CreateFolderButton().Enabled;
                bool IsManageTopLevelFoldersBtnExist6 = conffolder.ManageTopLevelFolders().Enabled;
                bool IsArchiveSelected = conffolder.Btn_ArchiveMode().GetAttribute("style").Contains("opacity: 1");
                bool IsActiveDeSelected = conffolder.Btn_ActiveMode().GetAttribute("style").Contains("opacity: 0.6");

                if (IsArchiveSelected && IsActiveDeSelected && !IsUndoArchiveFolderBtnExist && !IsDeleteFolderBtnExist6 &&
                    !IsManageTopLevelFoldersBtnExist6 && !IsCreateFolderBtnExist6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7:Verify the middle pane
                //As a precondition
                //Create Top Level and Sub level folder                
                conffolder.NavigateToActiveMode();
                conffolder.CreateToplevelFolder(topfoldername, user1, LDAPDomain, Description);
                conffolder.CreateSubFolder(topfoldername, subfoldername1, LDAPDomain, Description);
                conffolder.CreateSubFolder(topfoldername, subfoldername2, LDAPDomain);
                conffolder.CreateToplevelFolder(topfoldername2, domain: LDAPDomain);
                conffolder.CreateSubFolder(topfoldername2, sub2, LDAPDomain);
                login.Logout();
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                var studies = login.Navigate<Studies>();
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accession, StudyNotes: "Notes_7");
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath_2, Accession, StudyNotes: "Notes_71");
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);

                //Verify the UI
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath1, LDAPDomain);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accession);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool IsFoldernameExist = conffolder.IsElementPresent(conffolder.By_FolderPathDiv());
                bool IsFolderdescAreaExist = conffolder.IsElementPresent(conffolder.By_EditDesc_Emptydesc());
                bool IsEditBtnExist = conffolder.IsElementPresent(conffolder.By_EditDesc_Button());
                bool IsGroupByExist = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsStudyGridExist = conffolder.IsElementPresent(conffolder.By_StudyGrid());
                bool IsColumnHeadersExist = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist = conffolder.IsElementPresent(conffolder.By_ChooseColumns());
                bool IsResetExist = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist = conffolder.IsElementPresent(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist = conffolder.IsElementPresent(conffolder.By_ViewStudyBtn());
                bool IsRecordSummaryExist = conffolder.RecordSummaryText().Equals("View 1 - 1 of 1");

                if (IsFoldernameExist && IsFolderdescAreaExist && IsEditBtnExist && IsGroupByExist && IsStudyGridExist &&
                    IsColumnHeadersExist && IsChooseColumnExist && IsResetExist && IsDeleteBtnExist && IsViewBtnExist && IsRecordSummaryExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Verify NOTES / COMMENTS in right pane
                bool IsStudyNoteTimeExist = conffolder.IsElementPresent(conffolder.By_StudyNoteTime());
                bool IsStudyNotesExist = conffolder.GetConferenceStudyNotes().Equals("Notes_7");
                bool IsEditStudyNotesBtnExist = conffolder.IsElementPresent(conffolder.By_Btn_EditStudyNotes());

                if (IsStudyNoteTimeExist && IsStudyNotesExist && IsEditStudyNotesBtnExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9:Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-10:Login iCA as domain admin or a super admin. Navigate to the Conference Folders tab. Repeat the same steps as the super admin logged cases, verify the display of the page.
                login.Logout();
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool IsDomainDropdownExist_10 = conffolder.IsElementPresent(By_DomainSelector());
                bool IsFolderBrowserSectionExist_10 = conffolder.IsElementVisible(conffolder.By_LeftPane());
                bool IsConferenceStudySectionExist_10 = conffolder.IsElementVisible(conffolder.By_MidPane());
                bool IsCommentsSectionExist_10 = conffolder.IsElementVisible(conffolder.By_RightPane());
                bool IsArchiveFolderBtnExist_10 = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveFolder());
                bool IsDeleteFolderBtnExist_10 = conffolder.IsElementPresent(conffolder.Btn_DeleteFolderBy());
                bool IsCreateFolderBtnExist_10 = conffolder.IsElementPresent(conffolder.By_CreateFolderButton());
                bool IsManageTopLevelFoldersBtnExist_10 = conffolder.IsElementPresent(conffolder.By_ManageTopLevelFolders());
                bool IsActiveModeBtnExist_10 = conffolder.IsElementPresent(conffolder.By_Btn_ActiveMode());
                bool IsArchiveModeBtnExist_10 = conffolder.IsElementPresent(conffolder.By_Btn_ArchiveMode());
                conffolder.NavigateToArchiveMode();
                bool IsUndoArchiveFolderBtnExist_10 = conffolder.Btn_UndoArchiveFolder().Enabled;
                bool IsDeleteFolderBtnExist1_10 = conffolder.Btn_DeleteFolder().Enabled;
                bool IsCreateFolderBtnExist1_10 = conffolder.CreateFolderButton().Enabled;
                bool IsManageTopLevelFoldersBtnExist1_10 = conffolder.ManageTopLevelFolders().Enabled;
                bool IsArchiveSelected_10 = conffolder.Btn_ArchiveMode().GetAttribute("style").Contains("opacity: 1");
                bool IsActiveDeSelected_10 = conffolder.Btn_ActiveMode().GetAttribute("style").Contains("opacity: 0.6");
                conffolder.NavigateToActiveMode();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accession);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool IsFoldernameExist_10 = conffolder.IsElementPresent(conffolder.By_FolderPathDiv());
                bool IsFolderdescAreaExist_10 = conffolder.IsElementPresent(conffolder.By_EditDesc_Emptydesc());
                bool IsEditBtnExist_10 = conffolder.IsElementPresent(conffolder.By_EditDesc_Button());
                bool IsGroupByExist_10 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsStudyGridExist_10 = conffolder.IsElementPresent(conffolder.By_StudyGrid());
                bool IsColumnHeadersExist_10 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_10 = conffolder.IsElementPresent(conffolder.By_ChooseColumns());
                bool IsResetExist_10 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist_10 = conffolder.IsElementPresent(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist_10 = conffolder.IsElementPresent(conffolder.By_ViewStudyBtn());
                bool IsRecordSummaryExist_10 = conffolder.RecordSummaryText().Equals("View 1 - 1 of 1");

                if (!IsDomainDropdownExist_10 && IsFolderBrowserSectionExist_10 && IsConferenceStudySectionExist_10 && IsCommentsSectionExist_10 &&
                    IsArchiveFolderBtnExist_10 && IsDeleteFolderBtnExist_10 && IsCreateFolderBtnExist_10 && IsManageTopLevelFoldersBtnExist_10 && IsActiveModeBtnExist_10 && IsArchiveModeBtnExist_10 &&
                    !IsUndoArchiveFolderBtnExist_10 && !IsDeleteFolderBtnExist1_10 && !IsCreateFolderBtnExist1_10 && !IsManageTopLevelFoldersBtnExist1_10 && IsArchiveSelected_10 && IsActiveDeSelected_10 &&
                    IsFoldernameExist_10 && IsFolderdescAreaExist_10 && IsEditBtnExist_10 && IsGroupByExist_10 && IsStudyGridExist_10 && IsColumnHeadersExist_10 && IsChooseColumnExist_10 &&
                    IsResetExist_10 && IsDeleteBtnExist_10 && IsViewBtnExist_10 && IsRecordSummaryExist_10)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-11:Login iCA as a Conference User. Navigate to the Conference Folders tab. Repeat the same steps, verify the display of the page.
                login.LoginIConnect(userid, LDAP_Password);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                bool IsCreateFolderBtnExist_11 = conffolder.IsElementPresent(conffolder.By_CreateFolderButton());
                bool IsGroupByExist_11 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsStudyGridExist_11 = conffolder.IsElementPresent(conffolder.By_StudyGrid());
                bool IsColumnHeadersExist_11 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_11 = conffolder.IsElementPresent(conffolder.By_ChooseColumns());
                bool IsResetExist_11 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist_11 = conffolder.IsElementPresent(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist_11 = conffolder.IsElementPresent(conffolder.By_ViewStudyBtn());
                bool IsEditBtnExist_11 = conffolder.IsElementPresent(conffolder.By_EditDesc_Button());
                bool IsDeleteFolderBtnExist1_11 = conffolder.IsElementVisible(conffolder.Btn_DeleteFolderBy());//conffolder.Btn_DeleteFolder().Enabled;
                bool IsManageTopLevelFoldersBtnExist_11 = conffolder.IsElementVisible(conffolder.By_ManageTopLevelFolders());//conffolder.ManageTopLevelFolders().Enabled;
                bool IsArchiveTabExist11 = conffolder.IsElementVisible(conffolder.By_Btn_ArchiveMode());
                bool IsActiveTabExist11 = conffolder.IsElementVisible(conffolder.By_Btn_ActiveMode());

                if (IsCreateFolderBtnExist_11 && IsGroupByExist_11 && IsStudyGridExist_11 && IsColumnHeadersExist_11 &&
                    IsChooseColumnExist_11 && IsResetExist_11 && IsDeleteBtnExist_11 && IsViewBtnExist_11 && IsEditBtnExist_11 &&
                    !IsDeleteFolderBtnExist1_11 && !IsManageTopLevelFoldersBtnExist_11 && !IsArchiveTabExist11 && !IsActiveTabExist11)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-12:Select a top level folder that is not managed by the logged folder manager. Verify the display of the page.
                conffolder.ExpandAndSelectFolder(topfoldername2);
                bool IsCreateFolderBtnExist_12 = conffolder.CreateFolderButton().Enabled;
                conffolder.ExpandAndSelectFolder(FolderPath_2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accession);
                bool IsDeleteFolderBtnExist1_12 = conffolder.DeleteStudyBtn().Enabled;
                bool IsEditBtnExist_12 = conffolder.Btn_EditStudyNotes().Enabled;

                if (!IsCreateFolderBtnExist_12 && !IsDeleteFolderBtnExist1_12 && !IsEditBtnExist_12)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-13:Login iCA as a Conference User. Navigate to the Conference Folders tab. Repeat the same steps, verify the display of the page.
                login.LoginIConnect(userid2, LDAP_Password);
                conffolder = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accession);
                bool IsGroupByExist_13 = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsColumnHeadersExist_13 = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist_13 = conffolder.IsElementPresent(conffolder.By_ChooseColumns());
                bool IsResetExist_13 = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsViewBtnExist_13 = conffolder.ViewStudyBtn().Enabled;
                bool IsEditBtnExist_13 = conffolder.Btn_EditStudyNotes().Enabled;
                bool IsCreateFolderBtnExist_13 = conffolder.IsElementVisible(conffolder.By_CreateFolderButton());
                bool IsArchiveTabExist13 = conffolder.IsElementVisible(conffolder.By_Btn_ArchiveMode());
                bool IsActiveTabExist13 = conffolder.IsElementVisible(conffolder.By_Btn_ActiveMode());

                if (IsGroupByExist_13 && IsColumnHeadersExist_13 && IsChooseColumnExist_13 && IsResetExist_13 && IsViewBtnExist_13 &&
                    !IsEditBtnExist_13 && !IsCreateFolderBtnExist_13 && !IsArchiveTabExist13 && !IsActiveTabExist13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();


                //Step-14:Login iCA as a non-Conference User. Attempt to navigate to the Conference Folders tab.
                login.LoginIConnect(userid3, LDAP_Password);
                Boolean istabpresent = login.IsTabPresent("Conference Folders");
                if (!istabpresent)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Conference Lists - Delete Conference Study (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96224(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables           
            DomainManagement domainmanagement;
            //RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferenceFolders;
            Studies studies;
            StudyViewer studyViewer;
            Patients patient;

            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDs = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] PatientID = PatientIDs.Split(':');
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = AccessionIDList.Split(':');
                String PatientNames = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] PatientName = PatientNames.Split(':');
                Random random = new Random();
                int limit = Math.Abs((int)DateTime.Now.Ticks);
                limit = Int32.Parse(limit.ToString().Substring(0, 4));
                //String roleC1 = "Role1C" + random.Next(1, limit);

                //Domain Admin
                String daB = "daB_96224_" + random.Next(1, limit);
                //String daB = "Administrator";
                String daC = "daC_96224_" + random.Next(1, limit);

                //Roles                
                String roleB1 = "roleB1_96224_1_" + random.Next(1, limit);
                String PhysicianRole = "Physician_96224_1_" + random.Next(1, limit);
                String ArchivistRole = "Archivist_96224_1_" + random.Next(1, limit);
                String roleC1 = "roleC1_96224_1_" + random.Next(1, limit);


                //Users
                String userB1 = "userB1_96224_" + random.Next(1, limit);
                String ph = "Ph_96224_" + random.Next(1, limit);
                String DoctorA = "DoctorB_96224_" + random.Next(1, limit);
                String ar = "ar_96224_" + random.Next(1, limit);
                String userC1 = "userC1_96224_" + random.Next(1, limit);
                String userC2 = "userC2_96224_" + random.Next(1, limit);


                //Folders
                String TopFolderB1 = "Monthly Oncology Tumor Boards_96224_" + random.Next(1, 100);
                String SubFolderB1_Level2_1 = "From Patient Record_" + random.Next(1, 100);//with no description
                String SubFolderB1_Level2_2 = "Hybrid, XDS only and DICOM only_" + random.Next(1, 100);
                String SubFolderB1_Level3 = "XDS sub-tab_" + random.Next(1, 100);
                String TopFolderB2 = "Pediatric Bone Marrow Transplant_96224_" + random.Next(1, 100);
                String SubFolderB2_Level2 = "Image sharing #1_" + random.Next(1, 100);
                String TopFolderC1 = "Cutaneous T-cell Lymphoma_96224_" + random.Next(1, 100);
                String SubFolderC1_Level2 = "Level 2 sub1";
                String TopFolderC2 = "Head and Neck_96224_" + random.Next(1, 100);
                String SubFolderC2_Level2 = "Studies from related view";
                String StudyNotes = "StudyNotes_" + new System.DateTime().Millisecond + new Random().Next(100, 1000);
                String StudyFolderPathB1 = TopFolderB1 + "/" + SubFolderB1_Level2_1 + "/" + SubFolderB1_Level3;
                String StudyFolderPathB2 = TopFolderB1 + "/" + SubFolderB1_Level2_2;
                String ImagesharingFolderPath = TopFolderB2 + "/" + SubFolderB2_Level2;
                String StudyFolderPathC1 = TopFolderC1 + "/" + SubFolderC1_Level2;
                String StudyFolderPathC2 = TopFolderC2 + "/" + SubFolderC2_Level2;
                String holdingpen = login.GetHostName(Config.HoldingPenIP);
                String destpacs = login.GetHostName(Config.DestinationPACS);

                //Step 1 - Precondition
                Executedsteps++;

                //Step 2 - Precondition
                login.LoginIConnect(adminUserName, adminPassword);

                //2.1 DomainB and DomainC - Conference Lists enabled

                //DomainB
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                var domainattr = domainmanagement.CreateDomainAttr();
                String DomainB = domainattr[DomainManagement.DomainAttr.DomainName];
                String domainNameB = domainattr[DomainManagement.DomainAttr.UserID];
                domainmanagement.CreateDomain(domainattr, isconferenceneeded: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(30);
                bool bDomainB = domainmanagement.IsDomainExist(DomainB);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(daB, DomainB)) usermanagement.CreateDomainAdminUser(daB, DomainB, 0, "", 0, "", 1);//Domain admin

                //Roles: RoleB, Physician, Archivist.
                //Create RoleB1 with only XDS Data Sources -- Conference enabled
                var rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(DomainB, roleB1, "Conference", Config.xds1 + "=" + Config.xds2 + "=" + Config.xds3);
                //Create Physcian Role (RoleB2-Conference enabled)
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(DomainB, PhysicianRole, "Conference=Physician", holdingpen + "=" + destpacs);
                //Create Archivist Role (RoleB2-Conference enabled) 
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(DomainB, ArchivistRole, "Conference=Archivist", holdingpen + "=" + destpacs);
                bool broleB1 = rolemanagement.RoleExists(roleB1, DomainB);
                bool broleB2 = rolemanagement.RoleExists(PhysicianRole, DomainB);

                //Users: userB, physician ,DoctorA, archivist.
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userB1, DomainB)) usermanagement.CreateUser(userB1, DomainB, roleB1); //Folder Manager               
                if (!usermanagement.SearchUser(ph, DomainB)) usermanagement.CreateUser(ph, DomainB, PhysicianRole); //Conference User
                if (!usermanagement.SearchUser(DoctorA, DomainB)) usermanagement.CreateUser(DoctorA, DomainB, ArchivistRole); //Conference User 
                if (!usermanagement.SearchUser(ar, DomainB)) usermanagement.CreateUser(ar, DomainB, ArchivistRole); //Conference User 
                bool bdaB = usermanagement.SearchUser(daB, DomainB);
                bool buserB1 = usermanagement.SearchUser(userB1, DomainB);
                bool buserB2 = usermanagement.SearchUser(ar, DomainB);
                bool buserB3 = usermanagement.SearchUser(ph, DomainB);
                bool buserB4 = usermanagement.SearchUser(DoctorA, DomainB);

                //DomainC
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                var domainattr1 = domainmanagement.CreateDomainAttr();
                String DomainC = domainattr1[DomainManagement.DomainAttr.DomainName];
                String domainNameC = domainattr1[DomainManagement.DomainAttr.UserID];
                domainmanagement.CreateDomain(domainattr1, isconferenceneeded: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool bDomainC = domainmanagement.IsDomainExist(DomainC);
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(daC, DomainC)) usermanagement.CreateDomainAdminUser(daC, DomainC, 0, "", 0, "", 1);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool bdaC = usermanagement.SearchUser(daC, DomainC);

                //Role: RoleC
                rolemanagement = login.Navigate<RoleManagement>();
                if (!rolemanagement.RoleExists(roleC1, DomainC)) rolemanagement.CreateConfListRole(DomainC, roleC1);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                bool broleC1 = rolemanagement.RoleExists(roleC1, DomainC);

                //Users: UserC1, UserC2
                usermanagement = (UserManagement)login.Navigate("UserManagement");
                if (!usermanagement.SearchUser(userC1, DomainC)) usermanagement.CreateUser(userC1, DomainC, roleC1); //Conference User
                if (!usermanagement.SearchUser(userC2, DomainC)) usermanagement.CreateUser(userC2, DomainC, roleC1); //Conference User               
                bool buserC1 = usermanagement.SearchUser(userC1, DomainC);
                bool buserC2 = usermanagement.SearchUser(userC2, DomainC);

                if (bDomainB && bDomainC && bdaB && bdaC && broleB1 && broleB2 && broleC1 &&
                    buserB1 && buserB2 && buserB3 && buserB4 && buserC1 && buserC2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    Logger.Instance.ErrorLog("bDomainB && bDomainC && bdaB && bdaC && broleB1 && broleB2 " + bDomainB + " - " + bDomainC + " - " + bdaB + " - " + bdaC + " - " + broleB1 + " - " + broleB2 );
                    Logger.Instance.ErrorLog("&& broleC1 && buserB1 && buserB2 && buserB3 && buserB4 && buserC1 && buserC2 " + broleC1 + " - " + buserB1 + " - " + buserB2 + " - " + buserB3 + " - " + buserB4 + " - " + buserC1 + " - " + buserC2);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 3 - Create Top Level Folders, Sub-Folders and Level3 Sub-Folders (if not done yet)
                login.LoginIConnect(adminUserName, adminPassword);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                if (!conferenceFolders.IsTopLevelFolderExist(DomainB, TopFolderB1))
                    conferenceFolders.CreateToplevelFolder(TopFolderB1, userB1, DomainB, TopFolderB1 + " Description");//TopFolder
                conferenceFolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_1, DomainB);//Subfolder-level2
                conferenceFolders.CreateSubFolder(TopFolderB1, SubFolderB1_Level2_2, DomainB);//Subfolder-level2                
                conferenceFolders.CreateSubFolder(TopFolderB1 + "/" + SubFolderB1_Level2_1,
                                  SubFolderB1_Level3, DomainB, SubFolderB1_Level3 + " Description");//SubFolder-level3

                if (!conferenceFolders.IsTopLevelFolderExist(DomainB, TopFolderB2)) conferenceFolders.CreateToplevelFolder(TopFolderB2, ph + "-" + ar, null, TopFolderB2 + " Description");//Topfolder2 ph + "-" + ar
                conferenceFolders.CreateSubFolder(TopFolderB2, SubFolderB2_Level2, DomainB, SubFolderB2_Level2 + " Description");

                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopFolderC1)) conferenceFolders.CreateToplevelFolder(TopFolderC1, userC2, null, TopFolderC1 + " Description");//TopFolder3
                conferenceFolders.CreateSubFolder(TopFolderC1, SubFolderC1_Level2, DomainC, SubFolderC1_Level2 + " Description");//Subfolder-level2
                if (!conferenceFolders.IsTopLevelFolderExist(DomainC, TopFolderC2)) conferenceFolders.CreateToplevelFolder(TopFolderC2, userC1, null, TopFolderC2 + " Description");//TopFolder3
                conferenceFolders.CreateSubFolder(TopFolderC2, SubFolderC2_Level2, DomainC, SubFolderC2_Level2 + " Description");//Subfolder-level2
                login.Logout();

                login.LoginIConnect(daB, daB);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studyViewer = studies.LaunchStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                login.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Date" }, new string[] { "unknown" });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.studyPanel(2).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathB1, notes: StudyNotes);
                studyViewer.CloseStudy();

                //PatientName[0]=Burton, PQA
                //Accession[16] ="ACC1962" -- hybrid
                patient = (Patients)login.Navigate("Patients");
                patient.InputData(PatientName[0].Split(',')[0].ToLower().Trim());
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                patient.LoadStudyInPatientRecord(PatientName[0].Trim());
                try
                {
                    studyViewer = patient.LaunchStudy(Patients.PatientColumns.Accession, Accessions[0]);
                }
                catch (Exception e)
                {
                    Logger.Instance.InfoLog("Exception while weaiting for Image-" + e.Message);
                    BasePage.Driver.FindElement(By.CssSelector("#m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_cineBtnStop"));
                }
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                login.NavigateToHistoryPanel();
                //studies.ChooseColumns(new string[] { "Data Source", "Accession" });                               
                studyViewer.OpenPriors(new string[] { "Study Date" }, new string[] { "unknown" });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.studyPanel(2).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathB1, notes: StudyNotes);
                studyViewer.CloseStudy();
                patient.ClosePatientRecord();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                login.Logout();


                //xds
                login.LoginIConnect(daB, daB);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studyViewer = studies.LaunchStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                login.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Date" }, new string[] { "unknown" });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.studyPanel(2).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathB2, notes: StudyNotes);
                studyViewer.CloseStudy();

                //hybrid
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[0]);
                studies.SelectStudy("Accession", Accessions[0]);
                try
                {
                    studyViewer = studies.LaunchStudy();
                }
                catch (Exception e)
                {
                    Logger.Instance.InfoLog("Exception while weaiting for Image-" + e.Message);
                    BasePage.Driver.FindElement(By.CssSelector("#m_studyPanels_m_studyPanel_1_ctl03_SeriesViewer_1_1_cineBtnStop"));
                }
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathB2, notes: StudyNotes);
                studyViewer.CloseStudy();
                //dicom
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy("Accession", Accessions[2]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathB2, notes: StudyNotes);
                studyViewer.CloseStudy();
                //hybrid
                studies.SearchStudy("Accession", Accessions[1]);
                studies.SelectStudy("Accession", Accessions[1]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathB2, notes: StudyNotes);
                studyViewer.CloseStudy();
                login.Logout();


                //6 Imagesharing
                login.LoginIConnect(daB, daB);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy("Accession", Accessions[2]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(ImagesharingFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();

                studies.SearchStudy("Accession", Accessions[3]);
                studies.SelectStudy("Accession", Accessions[3]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(ImagesharingFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();

                studies.SearchStudy("Accession", Accessions[4]);
                studies.SelectStudy("Accession", Accessions[4]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(ImagesharingFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();

                studies.SearchStudy("Accession", Accessions[5]);
                studies.SelectStudy("Accession", Accessions[5]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(ImagesharingFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();

                studies.SearchStudy("Accession", Accessions[6]);
                studies.SelectStudy("Accession", Accessions[6]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(ImagesharingFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();

                studies.SearchStudy("Accession", Accessions[7]);
                studies.SelectStudy("Accession", Accessions[7]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(ImagesharingFolderPath, notes: StudyNotes);
                studyViewer.CloseStudy();
                login.Logout();

                //DomainC: 
                //1study
                login.LoginIConnect(daC, daC);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy("Accession", Accessions[2]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathC1, notes: StudyNotes);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.CloseStudy();
                //3 studies
                studies.SearchStudy("Accession", Accessions[7]);
                studies.SelectStudy("Accession", Accessions[7]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathC2, notes: StudyNotes);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.CloseStudy();
                studies.SearchStudy("Accession", Accessions[8]);
                studies.SelectStudy("Accession", Accessions[8]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathC2, notes: StudyNotes);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.CloseStudy();
                studies.SearchStudy("Accession", Accessions[9]);
                studies.SelectStudy("Accession", Accessions[9]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(StudyFolderPathC2, notes: StudyNotes);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.CloseStudy();
                Executedsteps++;
                login.Logout();


                //Step 4 - Login iCA as a Folder Manager (userB in DomainB), navigate to the Conference Folders tab,
                //select Active sub-tab in folder browser, select the top level folder that is managed by the user
                //(e.g. Monthly Oncology Tumor Boards), browse to the study folder that contains 2 studies one has notes,
                //the one does not  have notes .     
                login.LoginIConnect(userB1, userB1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathB1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                if (BasePage.GetSearchResults().Count == 2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 5 & 6 - Select the study that has conference notes, click the Delete Study button.                
                conferenceFolders.SelectStudy("Patient ID", PatientID[0]);
                BasePage.Driver.FindElement(conferenceFolders.Btn_DeleteStudyBy()).Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                BasePage.wait.Until<Boolean>(d => conferenceFolders.Div_Confirmation().FindElement(By.CssSelector("div>span"))
                .GetAttribute("innerHTML").ToLower().Contains("delete studies"));
                IWebElement Dialogbox = BasePage.Driver.FindElement(By.CssSelector("div#ConfirmationDiv"));
                var dialog = Dialogbox.Displayed;
                conferenceFolders.Btn_OKConfirmationDiv().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (dialog == true && BasePage.GetSearchResults().Count == 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                Executedsteps++;

                //Step 7 - Select the other conference study that does not have conference notes.
                //Delete the selected study.
                conferenceFolders.DeleteStudy("Patient ID", PatientID[1]);
                if (BasePage.GetSearchResults().Count == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step 8 - Select a study folder contains more than one conference studies with or without
                //conference notes(e.g. Monthly Oncology Tumor Boards --- Hybrid, XDS only & DICOM only); 
                //select all conference studies in the study folder, delete them. 
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathB2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy1("Patient ID", PatientID[1], true);
                conferenceFolders.SelectStudy1("Accession", Accessions[0], true);
                conferenceFolders.SelectStudy1("Accession", Accessions[2], true);
                conferenceFolders.SelectStudy1("Accession", Accessions[1], true);
                BasePage.Driver.FindElement(conferenceFolders.Btn_DeleteStudyBy()).Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                BasePage.wait.Until<Boolean>(d => conferenceFolders.Div_Confirmation().FindElement(By.CssSelector("div>span"))
                .GetAttribute("innerHTML").ToLower().Contains("delete studies"));
                conferenceFolders.Btn_OKConfirmationDiv().Click();
                conferenceFolders.SwitchtoConferenceFrame();
                if (BasePage.GetSearchResults().Count == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 9 - Login as a conference user belongs to the domain (e.g. DoctorA in DomainB), navigate
                //to the Conference Folders tab, browse to the folders where their studies been deleted. 
                //(e.g. Monthly Oncology Tumor Boards -->From Patient Record --> XDS sub-tab,
                //and Monthly Oncology Tumor Boards --> Hybrid, XDS only & DICOM only), verify the studies listed
                //in the conference studies list.
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathB1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int folder1 = BasePage.GetSearchResults().Count;
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathB2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                int folder2 = BasePage.GetSearchResults().Count;
                if (folder1 == 0 && folder2 == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 10 - Login iCA as the Folder Manager (userB in DomainB), select a top level folder that is
                //not managed by this Folder Manager (e.g. Pediatric Bone Marrow Transplant), browse to the study
                //folder (e.g. Pediatric Bone Marrow Transplant --- Image sharing #1), select a study, attempt to delete a study.
                login.LoginIConnect(userB1, userB1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[2]);
                var deleteBtn = BasePage.Driver.FindElement(conferenceFolders.Btn_DeleteStudyBy()).GetAttribute("disabled");
                if (deleteBtn.Equals("true"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 11 - Login as a conference user belongs to the domain (e.g. DoctorA in DomainB), navigate
                //to the Conference Folders tab, browse to the same study folder (Pediatric Bone Marrow Transplant
                //--- Image sharing #1), verify the studies listed in the conference studies list.
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.SelectStudy("Accession", Accessions[2]);
                if (BasePage.GetSearchResults().Count == 6)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 12 - Login as the Domain Admin (daB in DomainB), navigate to the Conference Folders tab, 
                //from the folder browser Active sub-tab, select a study folder in the domain (e.g. Pediatric 
                //Bone Marrow Transplant --- Image sharing #), delete a conference study.
                login.LoginIConnect(daB, daB);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.DeleteStudy("Accession", Accessions[2]);
                if (BasePage.GetSearchResults().Count == 5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step - 13 Login as a conference user belongs to the domain (e.g. DoctorA in DomainB), navigate
                //to the Conference Folders tab, browse to the same folder (Pediatric Bone Marrow Transplant --- 
                //Image sharing #1), verify the studies listed in the conference studies list.
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                if (conferenceFolders.GetMatchingRow("Accession", Accessions[2]) == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step - 14 Login as the Domain Admin (daB in DomainB), navigate to the Conference Folders tab,
                //from the folder browser Active sub-tab, attempt to delete a conference study that is under a 
                //domain that is not managed by this Domain Admin (e.g. a study in DomainC under folder Cutaneous
                //T-cell Lymphoma --- Level 2 sub1 - test  Active Folder Status)
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                IWebElement folder = conferenceFolders.ExpandAndSelectFolder(StudyFolderPathC1);
                if (folder == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();


                //Step 15 - Login as a conference user belongs to the domain (e.g. userC1 in DomainC), navigate 
                //to the Conference Folders tab, browse to the same folder  (e.g. a study in DomainC under folder
                //Cutaneous T-cell Lymphoma --- Level 2 sub1 - test  Active Folder Status), verify the studies listed in the conference studies list.
                login.LoginIConnect(userC1, userC1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathC1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                if (BasePage.GetSearchResults().Count == 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 16 - Login iCA as a Super Admin, navigate to the Conference Folders tab, select a domain 
                //(e.g. DomainC), from the folder browser Active sub-tab browse to a study folder (e.g.  Cutaneous
                //T-cell Lymphoma --- Level 2 sub1 - test  Active Folder Status), delete a study
                login.LoginIConnect(Config.adminUserName, Config.adminUserName);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathC1, DomainC);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.DeleteStudy("Accession", Accessions[2]);
                if (BasePage.GetSearchResults().Count == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();


                //Step 17 - Login as a conference user belongs to the domain (e.g. userC1 in DomainC), navigate 
                //to the Conference Folders tab, browse to the same folder  (e.g. a study in DomainC under folder
                //Cutaneous T-cell Lymphoma --- Level 2 sub1 - test  Active Folder Status), verify the studies 
                //listed in the conference studies list.
                login.LoginIConnect(userC1, userC1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathC1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                if (BasePage.GetSearchResults().Count == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();


                //Step 18 - Login as Super admin, Select a different domain (e.g. DomainB), from the folder browser Active sub-tab browser
                //to a study folder (e.g. Pediatric Bone Marrow Transplant --- Image sharing #1), delete a conference
                //study in the study folder.
                login.LoginIConnect(Config.adminUserName, Config.adminUserName);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath, DomainB);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conferenceFolders.DeleteStudy("Accession", Accessions[3]);
                if (BasePage.GetSearchResults().Count == 4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();



                //Step 19 - Login as a conference user belongs to the domain (e.g. DoctorA in DomainB), navigate
                //to the Conference Folders tab, browse to the same folder (Pediatric Bone Marrow Transplant --- 
                //Image sharing #1), verify the studies listed in the conference studies list.
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                if (conferenceFolders.GetMatchingRow("Accession", Accessions[3]) == null && BasePage.GetSearchResults().Count == 4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 20 - Login iCA as the Super Admin, from the Conference Folders tab select a domain (DomainB),
                //from folder browser Active sub-tab, attempt to delete a conference study that is under a different
                //domain from the selected one (e.g. a  conference study in DomainC under folder Head and Neck --- 
                //Studies from related view --- 3 studies1) 
                login.LoginIConnect(Config.adminUserName, Config.adminUserName);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.DomainSelector().SelectByText(DomainB);
                IWebElement folder3 = conferenceFolders.ExpandAndSelectFolder(StudyFolderPathC1);
                if (folder3 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 21 - Login iCA as a conference user belongs to the domain (e.g. userC1 in DomainC), navigate
                //to the Conference Folders tab, browse to the same folder (e.g. a study in DomainC under folder Head 
                //and Neck --- Studies from related view --- 3 studies1), verify the studies listed in the conference studies list.
                login.LoginIConnect(userC1, userC1);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(StudyFolderPathC2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference(10);
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(20);
                if (BasePage.GetSearchResults().Count == 3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step 22 - Login iCA as a conference user (e.g. DoctorA in DomainB), navigate to the Conference 
                //Folders tab, browse to a study folder (e.g. Pediatric Bone Marrow Transplant ---Image sharing #1),
                //attempt to delete a conference study.
                login.LoginIConnect(DoctorA, DoctorA);
                conferenceFolders = (ConferenceFolders)login.Navigate("ConferenceFolders");
                conferenceFolders.ExpandAndSelectFolder(ImagesharingFolderPath);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                IWebElement deleteBtn1 = BasePage.Driver.FindElement(conferenceFolders.Btn_DeleteStudyBy());
                if (!deleteBtn1.Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }



                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout                
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - Delete Folder (Desktop only)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_96225(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = null;
            DomainManagement domain;
            RoleManagement role1;
            UserManagement user;
            Studies study;
            Outbounds outbounds;
            StudyViewer viewer;
            ConferenceFolders conference;
            TestCaseResult result;

            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;


            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                string EA_91 = "VMSSA-5-38-91";
                string RDM_EA_131 = Config.rdm+".VMSSA-4-38-131";
                string RDM = Config.rdm;
                string XDS = "XDS_DS";
                string EA_116 = "EA-116";
                string EA_46 = "EA-46";
                //string Datasource_Image = "DATASOURCE1";
                String holdingpen = login.GetHostName(Config.HoldingPenIP);
                //string PACS_A3 = "PA-A3-WS8";
                String destpacs = login.GetHostName(Config.DestinationPACS);
                string PACS_A7 = "PA-A7-WS8";
                string RDM_PACS_A6 = Config.rdm + ".PA-A6-WS8";

                //int random_No = 2990;
                int random_No = new Random().Next(1000);


                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step-1

                //Pre-conditions:
                //1. iCA build under testing is installed on the main iCA server.
                //2. Image Sharing, XDS, Remote Data source Manager are configured on the main sever
                //3. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\
                //General sub tab on iCA server under testing
                //4. Domains and Roles with Conference Lists and Conference User enabled
                //5. Other iCA configurations under testing are specified in Test Assignments 
                //and PQA Test Plan for the release. (e.g., version of remote iCA server, HTTP or HTTPS, 
                //HTML4 viewer or HTML5 viewer etc...)


                taskbar = new Taskbar();
                taskbar.Hide();
                ServiceTool servicetool = new ServiceTool();

                //**##- uncomment
                //servicetool.LaunchServiceTool();
                //servicetool.NavigateToEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.ModifyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //servicetool.EnableConferenceLists(0);
                //wpfobject.WaitTillLoad();
                //servicetool.ApplyEnableFeatures();
                //wpfobject.WaitTillLoad();
                //wpfobject.ClickOkPopUp();
                //wpfobject.WaitTillLoad();
                //servicetool.RestartService();
                //wpfobject.WaitTillLoad();
                //servicetool.CloseServiceTool();
                taskbar.Show();


                //Enable ConferenceLists Check Box in Super Admin Domain

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.ClickSaveNewDomain();
                login.Logout();

                Executedsteps++;

                //Stpe-2
                //Pre-conditions:
                //Use existing (or create new) domains, roles and Conference User settings e.g.
                //-----> DomainC:  Domain Admin: daC
                //Role: roleC1; User: userC1, userC5
                //-----> DomainB   Domain Admin: daB
                //Role: roleB, User: userB
                //The following image sharing roles are not able to access data sources in role daB
                //Role: Physician; User: ph, doctorA
                //Role: Archivist, User: ar

                String DomainC = "DomainC_96225_" + random_No;
                String daC = DomainC;
                String roleC1 = "roleC1_96225_" + random_No; //connect to all data source

                String userC1 = "userC1_96225_" + random_No; //GroupC1 users
                String userC5 = "userC5_96225_" + random_No; //GroupC1 users

                // DomainB has XDS and Imagesharing enabled
                String DomainB = "DomainB_96225_" + random_No;
                String daB = DomainB;

                String roleB = "roleB_96225_" + random_No; //PQA XDS test data sources: EA-46, EA-116, XDS_DS
                String userB = "userB_96225_" + random_No; //roleB

                String Physician = "Physician_96225_" + random_No;
                String ph = "ph_96225_" + random_No;
                String doctorA = "doctorA_96225_" + random_No;

                String Archivist = "Archivist_96225_" + random_No;
                String ar = "ar_96225_" + random_No;

                //-------------------DomainC

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainC, DomainC, datasources: new String[] { EA_91, PACS_A7, RDM }); //4 DS
                //Enable conference list and grant access check box
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.ClickSaveNewDomain();


                role1 = (RoleManagement)login.Navigate("RoleManagement");
                //Role: roleC1, connect to all data source
                role1.CreateRole(DomainC, roleC1, "conference");

                user = (UserManagement)login.Navigate("UserManagement");

                //userC1, userC5
                user.CreateUser(userC1, DomainC, roleC1);
                user.CreateUser(userC5, DomainC, roleC1);
                //user.CreateUserForGroup(GroupC1, userC1Manager, DomainC, roleC1); //Fro Grant Access

                bool uC1 = user.SearchUser(userC1, DomainC);
                bool uC5 = user.SearchUser(userC5, DomainC);
                // bool uC1Manager = user.SearchUser(userC1Manager, DomainC);

                //------DomainB has XDS and Imagesharing enabled
                domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(DomainB, DomainB, datasources: new String[] { XDS, EA_46, EA_116, holdingpen, destpacs });
                //Enable conference list and grant accessand image sharing check box 
                domain.SetCheckBoxInEditDomain("conferencelists", 0);
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.SetCheckBoxInEditDomain("imagesharing", 0);
                domain.ClickSaveNewDomain();

                role1 = (RoleManagement)login.Navigate("RoleManagement");
                //role1.CreateRole(DomainC, roleC1, "conference", new String[] { XDS, EA_46, EA_116 });
                role1.CreateRole(DomainB, roleB, "conference", XDS + "=" + EA_46 + "=" + EA_116); //have to update code
                PageLoadWait.WaitForPageLoad(20);
                role1.CreateRole(DomainB, Physician, "conference=physician", destpacs);
                PageLoadWait.WaitForPageLoad(20);
                role1.CreateRole(DomainB, Archivist, "conference=archivist");
                PageLoadWait.WaitForPageLoad(20);

                user = (UserManagement)login.Navigate("UserManagement");
                user.CreateUser(userB, DomainB, roleB);
                user.CreateUser(ph, DomainB, Physician);
                user.CreateUser(doctorA, DomainB, Physician);
                user.CreateUser(ar, DomainB, Archivist);

                bool uB = user.SearchUser(userB, DomainB);
                bool uPh = user.SearchUser(ph, DomainB);
                bool udoctorA = user.SearchUser(doctorA, DomainB);
                bool uar = user.SearchUser(ar, DomainB);

                if (uB && uPh && udoctorA && uar &&
                    uC1 && uC5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-3

                ////Use existing Conference Folders, Folder Managers and Study Folders or create new ones as the following e.g.
                //----> DomainB:
                //1) Top Level Folder Name: Monthly Oncology Tumor Boards; Folder Manager: userB
                //1.1) a folder contains No conference study e.g.
                //Monthly Oncology Tumor Boards --> From Patient Record --> XDS sub-tab--> 0 study
                //Monthly Oncology Tumor Boards -->Hybrid, XDS only & DICOM only --> 0 study
                //1.2) a study folder contains more than one conference studies with or without conference notes e.g.
                //Monthly Oncology Tumor Boards\MIME types --> more than 12 studies with/without notes
                //2) Top Level Folder Name: Pediatric Bone Marrow Transplant; Folder Manager: ar, ph
                //2.1) a study folder contains more than one conference studies with or without conference notes e.g.
                //Pediatric Bone Marrow Transplant --> Image sharing #1 --> more than 1 studies

                //DomainB
                String Monthly_Oncology = "Monthly Oncology Tumor Boards_96225_" + random_No; //TopFloder 
                String From_Patient_Record_L2 = "From Patient Record or XDS sub-tab_96225_" + random_No; //Level2
                String XDS_sub_tab_L3 = "XDS sub-tab_96225_" + random_No; //Level_3
                String Hybrid_XDS_DICOM_L2 = "Hybrid, XDS only, DICOM only_96225_" + random_No; // Level 2
                String MIME_types_L2 = "MIME types_96225_" + random_No; //Level2
                String Pediatric_Bone = "Pediatric Bone Marrow Transplant_96225_" + random_No;//TopFloder   
                String Image_sharing_L2 = "Image sharing #1_96225_" + random_No; //Level2

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);
                conference = login.Navigate<ConferenceFolders>();

                //Monthly Oncology Tumor Boards
                bool Top1 = conference.CreateToplevelFolder(Monthly_Oncology, userB, DomainB); //TopFloder   
                bool sub1 = conference.CreateSubFolder(Monthly_Oncology, From_Patient_Record_L2, DomainB); //Level2
                bool sub2 = conference.CreateSubFolder(Monthly_Oncology + "/" + From_Patient_Record_L2, XDS_sub_tab_L3, DomainB); //Level3
                bool sub3 = conference.CreateSubFolder(Monthly_Oncology, Hybrid_XDS_DICOM_L2, DomainB); //Level2
                bool sub4 = conference.CreateSubFolder(Monthly_Oncology, MIME_types_L2, DomainB); //Level2

                //TopFloder -Pediatric Bone Marrow Transplant
                bool Top2 = conference.CreateToplevelFolder(Pediatric_Bone, ar + "-" + ph, DomainB);
                bool sub5 = conference.CreateSubFolder(Pediatric_Bone, Image_sharing_L2, DomainB); //Level2
                login.Logout();

                login.DriverGoTo(login.url);
                login.LoginIConnect(DomainB, DomainB);

                study = (Studies)login.Navigate("Studies");

                //More than 12 MIME type studies..
                //ACC19552:ACC1962:ACC145:ACC146:ACC148:ACCFR10:ACC1940
                //Accession[0] - Accession[6]

                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[0], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[1], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[2], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[3], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[4], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[5], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, Accession[6], EA_46);

                //Accession[7]:Accession[8]
                //ACC1957:ACC1958:

                study.SearchStudy(AccessionNo: Accession[7], Datasource: EA_46);
                study.SelectStudy("Accession", Accession[7]);
                viewer = study.LaunchStudy();
                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2);

                viewer.NavigateToHistoryPanel();
                viewer.ChooseColumns(new string[] { "Accession" });
                viewer.OpenPriors(new string[] { "Accession" }, new string[] { Accession[8] });

                PageLoadWait.WaitForThumbnailsToLoad(60);
                PageLoadWait.WaitForAllViewportsToLoad(60);
                viewer.Thumbnails(2)[0].Click();

                viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                viewer.AddStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2);

                //ACC1959:ACC1960:ACC1961:ACC1970
                //Accession[9]-Accession[12]
                for (int i = 9; i <= 12; i++)
                {
                    viewer.NavigateToHistoryPanel();
                    viewer.OpenPriors(new string[] { "Accession" }, new string[] { Accession[i] });

                    PageLoadWait.WaitForThumbnailsToLoad(60);
                    PageLoadWait.WaitForAllViewportsToLoad(60);
                    viewer.Thumbnails(3)[0].Click();

                    viewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                    viewer.AddStudyToStudyFolder(Monthly_Oncology + "/" + MIME_types_L2, notes:"study added from History Panel");
                }
                study.CloseStudy();

                //more than 1 studies
                //U-ID179490:7817811 ---EA 46 /A3- not consists
                //Accession[13]:Accession[14]
                study.AddDatasourceSpecificStudyToStudyFolder(Pediatric_Bone + "/" + Image_sharing_L2, Accession[13], EA_46);
                study.AddDatasourceSpecificStudyToStudyFolder(Pediatric_Bone + "/" + Image_sharing_L2, Accession[14], EA_46);

                login.Logout();


                if (Top1 && Top2 && sub1 && sub2 && sub3 && sub4 && sub5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-4
                //Pre-conditions:
                //-----> DomainC:
                //3) Top Level Folder Name: Cutaneous T-cell Lymphoma; Folder Manager: userC5
                //3.1) a folder does not contain a study, e.g.
                //Cutaneous T-cell Lymphoma --> Level 2 sub1 - test Active Folder Status --> references to 0 conference study
                //3.2) a study folder contains 1 study e.g.
                //Cutaneous T-cell Lymphoma --> Level 2 sub2 - test Active Folder Status --> Level3 sub2/1 --> 1 study
                //3.3) a study folder contains more than one studies
                //Cutaneous T-cell Lymphoma --> Level2 sub3 - from different data sources --> more than 1 studies
                //3.4) a top level folder contains multiple study folders, e.g.
                //Head and Neck
                //Head and Neck --> Different Modalities --> meeting for week1 --> more then 1 study
                //Head and Neck --> Different Modalities --> meeting for week2 --> more then 1 study
                //Head and Neck --> Different Modalities --> meeting for weekn... etc.
                //Head and Neck --> Studies from related view --> 3 studies
                //Head and Neck --> Saved GSPS studies --> 2 studies
                //Head and Neck --> studies from Grant Access --> more than 1 studies

                //DomainC
                String Cutaneous = "Cutaneous T-cell Lymphoma_96225_" + random_No; //Top Folder
                String Level_2_sub1 = "Level 2 sub1_96225_" + random_No;//Level 2.--0
                String Level_2_sub2 = "Level 2 sub2_96225_" + random_No;//Level 2. 
                String Level_3_sub2_1 = "Level 3 sub2_1_96225_" + random_No; //Level_3 --1
                String Level_2_sub3 = "Level 2 sub3_96225_" + random_No; //Level -2.. --more than 1--diff DS

                //Top Folder
                String Head_and_Neck = "Head and Neck_96225_" + random_No;
                String Different_Modalities_L2 = "Different Modalities_96225_" + random_No; //Level 2
                String meeting_for_week1_L_3 = "meeting for week1_L_3_96225_" + random_No;  //Level3
                String meeting_for_week2_L_3 = "meeting for week2_L_3_96225_" + random_No; //Level3
                String Studies_from_related_view_L2 = "Studies from related view_96225_" + random_No;  //Level2
                String Saved_GSPS_studies_L2 = "Saved GSPS studies_96225_" + random_No;  //Level2
                String studies_from_Grant_Access_L2 = "studies from Grant Access_96225_" + random_No;  //Level2

                login.DriverGoTo(login.url);
                login.LoginIConnect(adminusername, adminpassword);

                conference = login.Navigate<ConferenceFolders>();
                //Cutaneous T-cell Lymphoma
                bool Top3 = conference.CreateToplevelFolder(Cutaneous, domain: DomainC, foldermanager: userC5); //TopFloder   
                bool sub6 = conference.CreateSubFolder(Cutaneous, Level_2_sub1, DomainC); //Level 2
                bool sub7 = conference.CreateSubFolder(Cutaneous, Level_2_sub2, DomainC); //Level 2
                bool sub8 = conference.CreateSubFolder(Cutaneous + "/" + Level_2_sub2, Level_3_sub2_1, DomainC); //Level 3
                bool sub9 = conference.CreateSubFolder(Cutaneous, Level_2_sub3, DomainC);

                //Head and Neck.. manager userC1
                bool Top4 = conference.CreateToplevelFolder(Head_and_Neck, foldermanager: userC1, domain: DomainC); //TopFloder   

                bool sub10 = conference.CreateSubFolder(Head_and_Neck, Different_Modalities_L2, Domain_Name: DomainC);  //Level 2
                bool sub11 = conference.CreateSubFolder(Head_and_Neck + "/" + Different_Modalities_L2, meeting_for_week1_L_3, Domain_Name: DomainC);  //Level 3
                bool sub12 = conference.CreateSubFolder(Head_and_Neck + "/" + Different_Modalities_L2, meeting_for_week2_L_3, Domain_Name: DomainC);  //Level 3

                bool sub13 = conference.CreateSubFolder(Head_and_Neck, Studies_from_related_view_L2, DomainC);  //Level 2
                bool sub14 = conference.CreateSubFolder(Head_and_Neck, Saved_GSPS_studies_L2, DomainC);  //Level 2
                bool sub15 = conference.CreateSubFolder(Head_and_Neck, studies_from_Grant_Access_L2, DomainC);  //Level 2                
                login.Logout();


                login.DriverGoTo(login.url);
                login.LoginIConnect(DomainC, DomainC);

                study = (Studies)login.Navigate("Studies");
                study.RDM_MouseHover("rdm");

                //Accession[15] =MS10026 -- EA 91
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1, Accession[15], EA_91);
                //Accession[16] =MS10025 --A7
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[16], PACS_A7);
                //Accession[17] =1105201501 --RDM A6
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[17], RDM_PACS_A6);
                //Accession[18] =40079 --RDM 131
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[18], RDM_EA_131);
                //Accession[19] =U-ID179490 -- EA 91
                study.AddDatasourceSpecificStudyToStudyFolder(Cutaneous + "/" + Level_2_sub3, Accession[19], EA_91);

                //week 1 Different modality
                //Accession[20]:Accession[21]
                //SMS000023:AC8357267: DR:XA:
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3, Accession[20], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week1_L_3, Accession[21], EA_91);

                //week 2 Different modality
                //Accession[22]:Accession[23]
                //537103:8   PT:US
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3, Accession[22], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Different_Modalities_L2 + "/" + meeting_for_week2_L_3, Accession[23], EA_91);

                //3 related study--- //B E
                //Accession[24]:Accession[25]:Accession[26]
                //:1700795:1742901:1211824
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Studies_from_related_view_L2, Accession[24], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Studies_from_related_view_L2, Accession[25], EA_91);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Studies_from_related_view_L2, Accession[26], EA_91);

                //GSPS
                //Accession[27]:Accession[28] =:d60067ea5:14779  -- GSPS --A7
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2, Accession[27], PACS_A7);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + Saved_GSPS_studies_L2, Accession[28], PACS_A7);
                login.Logout();


                login.DriverGoTo(login.url);
                login.LoginIConnect(userC1, userC1);
                study = (Studies)login.Navigate("Studies");
                //Accession[29]:Accession[30] EA 91
                //414953:234234
                study.SearchStudy(AccessionNo: Accession[29], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[29]);
                study.ShareStudy(false, new String[] { userC5 });

                study.SearchStudy(AccessionNo: Accession[30], Datasource: EA_91);
                study.SelectStudy("Accession", Accession[30]);
                study.ShareStudy(false, new String[] { userC5 });
                outbounds = (Outbounds)login.Navigate("Outbounds");

                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + studies_from_Grant_Access_L2, Accession[29]);
                study.AddDatasourceSpecificStudyToStudyFolder(Head_and_Neck + "/" + studies_from_Grant_Access_L2, Accession[30]);
                login.Logout();


                if (Top3 && Top4 && sub6 && sub7 && sub8 && sub9 &&
                    sub10 && sub11 && sub12 && sub13 && sub14 && sub15)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5

                //[Domain Admin deletes folder within the user's domain]  
                //Login iCA as a Domain Admin (daB in DomainB), navigate to the Conference Folders tab,
                //select Active sub-tab in folder browser, select a top level folder,
                //browse to the sub-folder that contains no study 
                //(e.g. Monthly Oncology Tumor Boards --> From Patient Record --> XDS sub-tab), 
                //select a sub-folder contains child sub-folder (From Patient Record), click Delete Folder button.

                login.LoginIConnect(daB, daB);
                conference = login.Navigate<ConferenceFolders>();

                IWebElement ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + From_Patient_Record_L2);

                bool Step5 = ele.GetAttribute("innerHTML").Equals(From_Patient_Record_L2);
                conference.Btn_DeleteFolder().Click();

                //User is presented with an OK/Cancel dialog
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");

                if (conference.Div_Confirmation().Displayed &&
                    conference.Btn_Cancel_ConfirmationDiv().Displayed &&
                    conference.Btn_OKConfirmationDiv().Displayed &&
                    Step5)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6
                //Click OK button.

                conference.Btn_OKConfirmationDiv().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(conference.Div_ConfirmationBy()));
                conference.SwitchtoConferenceFrame();

                //The selected sub-folder contains child sub-folder with no study is deleted.
                //Domain Admins can delete any Folder that is affiliated with the same Domain to which they belong.

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + From_Patient_Record_L2);

                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7

                //Browse to a study folder that contains more than one studies 
                //(Monthly Oncology Tumor Boards ->MIME types),delete folder at the Study Folder level (MIME types)

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + MIME_types_L2);

                bool Step7 = ele.GetAttribute("innerHTML").Equals(MIME_types_L2);
                conference.DeleteFolder(Monthly_Oncology + "/" + MIME_types_L2);

                //The selected study folder contains more than 1 studies is deleted. 
                //Domain Admins can delete any Folder that is affiliated with the same Domain to which they belong.

                //Count we have to add**

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + MIME_types_L2);
                if ((ele == null) && Step7)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8

                //Browse to a top level folder that contains more than one study folders
                //(e.g. Pediatric Bone Marrow Transplant -->Image sharing #1),
                //select the top level folder, delete the folder
                int Total_topFolder = conference.AllTopLevelfolders().Count;
                Logger.Instance.InfoLog("-->Total_topFolder--" + Total_topFolder);
                conference.DeleteFolder(Pediatric_Bone);

                //The selected top level folder contains a study folder with more than 1 studies is deleted. 
                //Domain Admins can delete any Folder that is affiliated with the same Domain to which they belong.

                ele = conference.ExpandAndSelectFolder(Pediatric_Bone);

                if ((ele == null) && conference.AllTopLevelfolders().Count == Total_topFolder - 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    Logger.Instance.InfoLog("-->Total_topFolder--" + conference.AllTopLevelfolders().Count + "VS" + Total_topFolder);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-9

                //Login as a conference user belongs to the domain (e.g. DoctorA in DomainB), 
                //navigate to the Conference Folders tab, browser to folders, 
                //verify folders that have been removed by the domain admin 
                //e.g.  1. deleted folders (From Patient Record --> XDS sub-tab) under folders (Monthly Oncology Tumor Boards)
                //2. deleted folder (MIME types) under folder (Monthly Oncology Tumor Boards)
                //3. deleted top level folder (Pediatric Bone Marrow Transplant)

                login.LoginIConnect(doctorA, doctorA);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + From_Patient_Record_L2);
                bool Step_9_1 = (ele == null);

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + MIME_types_L2);
                bool Step_9_2 = (ele == null);

                ele = conference.ExpandAndSelectFolder(Pediatric_Bone);
                bool Step_9_3 = (ele == null);

                //All these folders (From Patient Record -->XDS sub-tab, MIME types, 
                //and Pediatric Bone Marrow Transplant) are no longer listed in the Folder Browser.

                if (Step_9_1 && Step_9_2 && Step_9_3 && conference.AllTopLevelfolders().Count == Total_topFolder - 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    Logger.Instance.InfoLog("-->Total_topFolder--" + conference.AllTopLevelfolders().Count + "VS" + Total_topFolder);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-10

                //Browse to folder that has not been deleted 
                //(e.g. Monthly Oncology Tumor Boards -->Hybrid, XDS only & DICOM only)

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);

                //The folder remains untouched. (0 study listed)

                if ((ele != null) && ele.GetAttribute("innerHTML").Equals(Hybrid_XDS_DICOM_L2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-11
                //[Domain Admin attempts to delete folder that is not within the user's domain]
                //Login as the Domain Admin (daB in DomainB), navigate to the Conference Folders tab,
                //from the folder browser Active sub-tab, attempt to delete a study folder 
                //that is under a domain not managed by this Domain Admin 
                //(e.g. a study in DomainC under folder Cutaneous T-cell Lymphoma 
                //--> Level 2 sub2 - test  Active Folder Status --> Level3 sub2/1)


                login.LoginIConnect(daB, daB);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);

                bool step_11 = true;
                foreach (IWebElement element in conference.AllTopLevelfolders())
                    if (element.GetAttribute("innerHTML").Equals(Cutaneous))
                    {
                        step_11 = false;
                        break;
                    }


                //The folder is not visible to the Domain Admin, 
                //the user can not delete folder in a domain in which the user is not an Administrator of;
                //Domain Admins can delete any Folder that is affiliated with the same Domain to which they belong.

                if ((ele == null) && step_11 &&
                    conference.IsElementVisible(By_DomainSelector()) == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-12

                //[Super Admin deletes folder within the selected domain]  
                //Login iCA as a Super Admin, navigate to the Conference Folders tab,
                //select a domain (e.g. DomainC), from the folder browser Active sub-tab browse to a study folder
                //(e.g. Cutaneous T-cell Lymphoma --> Level 2 sub2 - test  Active Folder Status --> Level3 sub2/1),
                //delete the study folder (e.g.  Level3 sub2/1).

                login.LoginIConnect(adminusername, adminpassword);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1, DomainC);
                bool step_12 = ele.GetAttribute("innerHTML").Equals(Level_3_sub2_1);

                int TotalVisibleTopAndSubFolder = conference.VisibleTopAndSubLevelfolders().Count;
                conference.DeleteFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);

                //The selected study folder is deleted. 
                //Super Admins have permission to delete any Folder within the selected domain.

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);

                if ((ele == null) && conference.VisibleTopAndSubLevelfolders().Count == TotalVisibleTopAndSubFolder - 1 &&
                    step_12)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13

                //Select a top level folder (e.g. Head and Neck) delete the folder.

                Total_topFolder = conference.AllTopLevelfolders().Count;
                conference.DeleteFolder(Head_and_Neck);

                //The selected top level folder is deleted.
                //Super Admins have permission to delete any Folder within the selected domain.

                ele = conference.ExpandAndSelectFolder(Head_and_Neck);

                bool step_13 = true;
                foreach (IWebElement element in conference.AllTopLevelfolders())
                    if (element.GetAttribute("innerHTML").Equals(Head_and_Neck))
                    {
                        step_13 = false;
                        break;
                    }

                if ((ele == null) && conference.AllTopLevelfolders().Count == Total_topFolder - 1 && step_13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-14
                //Login as a conference user belongs to the domain (e.g. userC1 in DomainC), 
                //navigate to the Conference Folders tab, browse to the deleted folders 
                //e.g.  1) a study folder (Level3 sub2/1) under folders 
                //(Cutaneous T-cell Lymphoma --> Level 2 sub2 - test  Active Folder Status)
                //2) a top level folder (Head and Neck)   
                //verify the folder listed in the selected folders.

                login.LoginIConnect(userC1, userC1);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub2 + "/" + Level_3_sub2_1);
                bool step14_1 = (ele == null);

                ele = conference.ExpandAndSelectFolder(Head_and_Neck);
                bool step14_2 = (ele == null);

                //The study folder ( Level3 sub2/1) and the top level folder (Head and Neck) are no longer listed.

                if (step14_1 && step14_2 && conference.AllTopLevelfolders().Count == 1
                    && conference.AllTopLevelfolders()[0].GetAttribute("innerHTML").Equals(Cutaneous))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-15
                //Login as a Super Admin, navigate to the Conference Folders tab,
                //select a different domain (e.g. DomainB), browser to a sub-folder 
                //(e.g. Monthly Oncology Tumor Boards -->Hybrid, XDS only & DICOM only), 
                //delete the folder (Hybrid, XDS only & DICOM only).

                login.LoginIConnect(adminusername, adminpassword);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2, DomainB);
                bool step_15_1 = (ele != null) && ele.GetAttribute("innerHTML").Equals(Hybrid_XDS_DICOM_L2);

                conference.DeleteFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2, DomainB);
                bool step_15_2 = (ele == null);


                //The selected study folder is deleted. 
                //Super Admins have permission to delete any Folder within the selected domain.

                if (step_15_1 && step_15_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-16
                //Login as a conference user belongs to the domain (e.g. DoctorA in DomainB), 
                //navigate to the Conference Folders tab, browse to the same folder 
                //(Monthly Oncology Tumor Boards), verify the studies listed in the conference studies list.

                login.LoginIConnect(doctorA, doctorA);
                conference = login.Navigate<ConferenceFolders>();

                //The sub-folder (Hybrid, XDS only & DICOM only) deleted by the Super Admin is no longer listed.

                ele = conference.ExpandAndSelectFolder(Monthly_Oncology + "/" + Hybrid_XDS_DICOM_L2);
                //add top folder count

                if ((ele == null) && conference.AllTopLevelfolders().Count == 1
                    && conference.AllTopLevelfolders()[0].GetAttribute("innerHTML").Equals(Monthly_Oncology))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                login.Logout();

                //Step-17

                //[Super Admin attempts to delete Folder outside of the selected domain]
                //Login as the Super Admin logged iCA, in the Conference Folders tab select a domain (DomainB),
                //from folder browser Active sub-tab, 
                //attempt to delete a sub-folder that is under a different domain 
                //(e.g. a study in DomainC under folder Cutaneous T-cell Lymphoma -->Level2 sub3 - from different data sources)

                login.LoginIConnect(adminusername, adminpassword);
                conference = login.Navigate<ConferenceFolders>();

                PageLoadWait.WaitForFrameLoad(10);
                conference.DomainSelector().SelectByText(DomainB);

                //The folder is not visible in the folder browser when a folder is stored under 
                //a different domain than the selected one. 
                //Super Admins have permission to delete any Folder within the selected domain.

                //Extra validation to check top folder is not exist
                bool step_17 = true;
                foreach (IWebElement e in conference.AllTopLevelfolders())
                {
                    if (e.GetAttribute("innerHTML").Contains(Cutaneous))
                    {
                        step_17 = false;
                        break;
                    }
                }

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub3);

                if (step_17 && (ele == null))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-18

                //[Conference User attempts to delete folder within the user's domain]
                //Login as a conference user (e.g. userC1 in DomainC), navigate to the Conference Folders tab,
                //browse to a study folder 
                //(e.g. Cutaneous T-cell Lymphoma -->Level2 sub3 - from different data source),
                //attempt to delete the folder


                login.LoginIConnect(userC1, userC1);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub3);

                //The Delete button is hidden. Conference Users have NOT permission to delete any folder.

                if (conference.Btn_DeleteFolder().Displayed == false &&
                    ele.GetAttribute("innerHTML").Equals(Level_2_sub3))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-19

                //[Folder Manger attempts to delete a sub-folder that is managed by the user]  
                //Login iCA as a folder manager (e.g.userC5 in DomainC), 
                //navigate to the Conference Folders tab, browse to a study folder 
                //(e.g. Cutaneous T-cell Lymphoma -->Level2 sub3 - from different data source), 
                //attempt to delete the folder.

                login.LoginIConnect(userC5, userC5);
                conference = login.Navigate<ConferenceFolders>();

                ele = conference.ExpandAndSelectFolder(Cutaneous + "/" + Level_2_sub3);

                //The Delete button is hidden. Folder Managers have NOT permission to delete any folder.

                if (conference.Btn_DeleteFolder().Displayed == false &&
                      ele.GetAttribute("innerHTML").Equals(Level_2_sub3))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - GUI Verification in Adding Conference Study,Deleting folders and Arcihving Folders
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test4_98703(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionID");
                String LDAPDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainName");
                String LDAP_Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Users");
                String[] LDAPUsers = LDAP_Users.Split('=');
                String userid = LDAPUsers[0]; //Conference Userid
                String userid2 = LDAPUsers[1]; //Conference Userid
                String userid3 = LDAPUsers[2]; //Non Conference Userid
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Firstname");
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String user1 = LDAPUsernames[0]; //Conference Userid
                String user2 = LDAPUsernames[1]; //Conference Userid
                String user3 = LDAPUsernames[2]; //Non Conference Userid
                String DomainAdmin_Userid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainAdmin");
                String DomainAdmin_Pwd = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Password");
                String LDAP_Password = DomainAdmin_Pwd;
                Random random = new Random();
                String topfoldername = "4Top1" + random.Next(1, 10000);
                String subfoldername1 = "Sub01" + random.Next(1, 10000);
                String subfoldername2 = "Sub02" + random.Next(1, 10000);
                String sub2 = "sub2" + random.Next(1, 10000);
                String StudyNotes = "StudyNotes_" + random.Next(1, 1000);
                String Description = "Description_" + random.Next(1, 1000);
                String topfoldername2 = "4Top2" + random.Next(1, 10000);
                String subfolder2 = "sub_2" + random.Next(1, 10000);
                String folderpath1 = topfoldername + "/" + subfoldername1;
                String folderpath2 = topfoldername + "/" + subfoldername2;
                String FolderPath_2 = folderpath2 + "/" + sub2;
                String FolderPath = topfoldername2 + "/" + subfolder2;


                //Step-1:Pre-conditions--1. iCA build under testing is a fresh installation.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Mixed data base is used; Ldap user data base is configured (Server- ica.ldap.merge.ad IP- 10.4.38.27, Account Name- ica.administrator)-4. HTML5 viewer is enabled
                Executedsteps++;

                //Step-2:Pre-conditions--Configure Domains, Roles, Groups are configured according to steps in test cases under LDAP/MultipleDomain Ldap Image Sharing (Test 27680 - Main PreSetup, Test 27681 - Setup Domain that are mapped in LDAP, Test 27682 - Create Roles that are configured in the LDAP, -Test 27683 - Create the Groups).
                Executedsteps++;

                //Step-3:-Pre-conditions--Ensure that Conference Lists in Domain Management tab and Conference User in Role Management tab are enabled for super admin and domain admin.-Ensure there is a user role under a domain with Conference User enabled; and another role with the option disabled-Ensure that there are Conference Users and non-Conference users in the same domain
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, user1, LDAPDomain, Description); //to Folder1
                conffolder.CreateSubFolder(topfoldername, subfoldername1, LDAPDomain, Description); //Level2 with description (study,notes added further)
                conffolder.CreateSubFolder(topfoldername, subfoldername2, LDAPDomain); //Level2
                conffolder.CreateSubFolder(folderpath2, sub2, LDAPDomain); //Level3 without description and with study(no notes)
                conffolder.CreateToplevelFolder(topfoldername2, domain: LDAPDomain);  //Top Folder2 
                conffolder.CreateSubFolder(topfoldername2, subfolder2, LDAPDomain); //Level2 without description and with study(no notes)
                login.Logout();
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                var studies = login.Navigate<Studies>();
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath_2, Accession);   //Level3 without description and with study(no notes)
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath, Accession); //Level2 without description and with study(no notes)
                login.Logout();
                Executedsteps++;

                //Step-4:Login as the domain admin (or a folder manager), navigate to the Studies tab, load any study, click Add to Conference Folder tool from toolbar.
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                studies = login.Navigate<Studies>();
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy("Accession", Accession);
                StudyViewer studyviewer = LaunchStudy();
                studyviewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                if (!studyviewer.AddConferenceStudyContainer().GetAttribute("style").Contains("display: none"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5:Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-6:Click on browse Button.
                studyviewer.BrowseBtn().Click();
                if (!studyviewer.FolderBrowserContainer().GetAttribute("style").Contains("display: none"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7:Select any sub-folder that does not contain any sub-folders.          
                studyviewer.ExpandAndSelectFolder(folderpath1);
                if (studyviewer.SelectFolderBtn().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Click on Select Folder button.                
                studyviewer.SelectFolderBtn().Click();
                if (studyviewer.FolderBrowserContainer().GetAttribute("style").Contains("display: none"))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9:Add study notes, click Add button
                studyviewer.AddStudyNotes().SendKeys("Notes_9");
                studyviewer.AddBtn().Click();
                //Wait till Add folder Dialog Disappears
                BasePage.wait.Until<Boolean>(driver =>
                {
                    if (studyviewer.AddConferenceStudyContainer().GetAttribute("style").Contains("display: none"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                if (!studyviewer.AddConferenceStudyContainer().Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseStudy();

                //Step-10:Reload the study, click the Add to Conference Folder tool from toolbar, attempt add the same study to the same sub-folder.
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy("Accession", Accession);
                studyviewer = LaunchStudy();
                studyviewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyviewer.BrowseBtn().Click();
                studyviewer.ExpandAndSelectFolder(folderpath1);
                if (!studyviewer.SelectFolderBtn().Enabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CancelFolderBtn().Click();
                studyviewer.CancelBtn().Click();
                studyviewer.CloseStudy();

                //Step-11:Load any study, add the study to a sub-folder that is not a bottom level sub-folder.
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy("Accession", Accession);
                studyviewer = LaunchStudy();
                studyviewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyviewer.BrowseBtn().Click();
                studyviewer.ExpandAndSelectFolder(folderpath2);
                if (studyviewer.ErrorMessage_AddFolder().GetAttribute("innerHTML").Equals("Selected folder cannot be top level/intermediate folder."))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CancelFolderBtn().Click();
                studyviewer.CancelBtn().Click();
                studyviewer.CloseStudy();
                login.Logout();

                //Step-12:Login iCA as a conference user, load a study, attempt to add a study to a folder that does not contain any sub-folders.
                login.LoginIConnect(userid2, LDAP_Password);
                studies = login.Navigate<Studies>();
                studies.SearchStudy(AccessionNo: Accession);
                studies.SelectStudy("Accession", Accession);
                studyviewer = LaunchStudy();
                String[] ToolsList = studyviewer.GetStudyToolsinViewer();
                Boolean IsToolExist_8 = ToolsList.Contains("Add To Conference Folder");
                if (!IsToolExist_8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseStudy();
                login.Logout();

                //Step-13:Login as the domain admin, navigate to the Conference Folders tab
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                conffolder = login.Navigate<ConferenceFolders>();
                Executedsteps++;

                //Step-14 & 15:Select a study folder that has Folder Description & select a study that has notes.
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accession);
                Executedsteps++;
                String FolderDesc_14 = conffolder.EditDesc_CurrentDesc().Text;
                String StudyNotes_14 = conffolder.GetConferenceStudyNotes();
                bool IsStudyNoteTimeExist = conffolder.IsElementPresent(conffolder.By_StudyNoteTime());
                if (StudyNotes_14.Equals("Notes_9") && FolderDesc_14.Equals(Description) && IsStudyNoteTimeExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-16:Click Delete Folder button
                conffolder.Btn_DeleteFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool IsDialogExist = conffolder.IsElementPresent(conffolder.Div_ConfirmationBy());
                bool IsOKExist = conffolder.IsElementPresent(conffolder.By_Btn_OKConfirmationDiv());
                bool IsCancelExist = conffolder.IsElementVisible(conffolder.By_Btn_CancelConfirmationDiv());
                if (IsDialogExist && IsOKExist && IsCancelExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-17:Click Cancel
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accession);
                String FolderDesc_17 = conffolder.EditDesc_CurrentDesc().Text;
                String StudyNotes_17 = conffolder.GetConferenceStudyNotes();
                if (StudyNotes_17.Equals("Notes_9") && FolderDesc_17.Equals(Description))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-18:Repeat above step, this time click OK in the dialog.
                conffolder.DeleteFolder(folderpath1);
                IWebElement IsStudyFolderExist = conffolder.ExpandAndSelectFolder(folderpath1);
                if (IsStudyFolderExist == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19:Select any sub-folder, click Delete Folder button. Select Cancel in the dialog.
                conffolder.ExpandAndSelectFolder(folderpath2);
                conffolder.Btn_DeleteFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                IWebElement IsStudyFolderExist_19 = conffolder.ExpandAndSelectFolder(folderpath2);
                if (IsStudyFolderExist_19 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-20:Repeat above step, this time click OK in the dialog.
                conffolder.DeleteFolder(folderpath2);
                IWebElement IsStudyFolderExist_20 = conffolder.ExpandAndSelectFolder(folderpath2);
                if (IsStudyFolderExist_20 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-21:Select a top level folder, click Delete Folder button, click OK in the confirmation dialog.
                conffolder.DeleteFolder(topfoldername);
                IWebElement IsTopFolderExist_21 = conffolder.ExpandAndSelectFolder(topfoldername);
                if (IsTopFolderExist_21 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-22:Repeat above steps, this time click Archive Folder button instead of the Delete Folder button.
                conffolder.ExpandAndSelectFolder(FolderPath);
                conffolder.Btn_ArchiveFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                IWebElement IsStudyFolderExist1_22 = conffolder.ExpandAndSelectFolder(FolderPath);
                conffolder.ArchiveConferenceFolder(FolderPath);
                IWebElement IsStudyFolderExist2_22 = conffolder.ExpandAndSelectFolder(FolderPath);
                if (IsStudyFolderExist1_22 != null && IsStudyFolderExist2_22 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-23:From the Conference Folders tab, the Archive sub-tab,
                conffolder.NavigateToArchiveMode();
                IWebElement IsStudyFolderExist_23 = conffolder.ExpandAndSelectFolder(FolderPath);
                bool IsUndoBtnEnabled = conffolder.Btn_UndoArchiveFolder().Enabled;
                if (IsStudyFolderExist_23 != null && IsUndoBtnEnabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-24:Select an archived folder, click Undo Archive button
                conffolder.ExpandAndSelectFolder(FolderPath);
                conffolder.Btn_UndoArchiveFolder().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool IsDialogExist24 = conffolder.IsElementPresent(conffolder.Div_ConfirmationBy());
                bool IsOKExist24 = conffolder.IsElementPresent(conffolder.By_Btn_OKConfirmationDiv());
                bool IsCancelExist24 = conffolder.IsElementVisible(conffolder.By_Btn_CancelConfirmationDiv());
                if (IsDialogExist24 && IsOKExist24 && IsCancelExist24)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-25:Click Cancel in the dialog
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                IWebElement IsStudyFolderExist_25 = conffolder.ExpandAndSelectFolder(FolderPath);
                if (IsStudyFolderExist_25 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-26:Repeat above steps, this time click OK in the dialog.
                conffolder.UndoArchiveFolder(FolderPath);
                IWebElement IsStudyFolderExist1_26 = conffolder.ExpandAndSelectFolder(FolderPath);
                conffolder.NavigateToActiveMode();
                IWebElement IsStudyFolderExist2_26 = conffolder.ExpandAndSelectFolder(FolderPath);
                if (IsStudyFolderExist1_26 == null && IsStudyFolderExist2_26 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - GUI Verification in Editing studynotes,Study notes in HistoryPanel and ConferenceStudies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test5_98703(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accessions = AccessionIDList.Split(':');
                String LDAPDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainName");
                String LDAP_Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Users");
                String[] LDAPUsers = LDAP_Users.Split('=');
                String userid = LDAPUsers[0]; //Conference Userid
                String userid2 = LDAPUsers[1]; //Conference Userid
                String userid3 = LDAPUsers[2]; //Non Conference Userid
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Firstname");
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String user1 = LDAPUsernames[0]; //Conference Userid
                String user2 = LDAPUsernames[1]; //Conference Userid
                String user3 = LDAPUsernames[2]; //Non Conference Userid
                String DomainAdmin_Userid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainAdmin");
                String DomainAdmin_Pwd = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Password");
                String LDAP_Password = DomainAdmin_Pwd;
                Random random = new Random();
                String topfoldername = "5Top1" + random.Next(1, 10000);
                String subfoldername1 = "Sub01" + random.Next(1, 10000);
                String subfoldername2 = "Sub02" + random.Next(1, 10000);
                String sub2 = "sub2" + random.Next(1, 10000);
                String StudyNotes = "StudyNotes_" + random.Next(1, 1000);
                String Description = "Description_" + random.Next(1, 1000);
                String topfoldername2 = "5Top2" + random.Next(1, 10000);
                String subfolder2 = "sub_2" + random.Next(1, 10000);
                String folderpath1 = topfoldername + "/" + subfoldername1;
                String folderpath2 = topfoldername + "/" + subfoldername2;
                String FolderPath_2 = folderpath2 + "/" + sub2;
                String FolderPath = topfoldername2 + "/" + subfolder2;


                //Step-1:Pre-conditions--1. iCA build under testing is a fresh installation.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Mixed data base is used; Ldap user data base is configured (Server- ica.ldap.merge.ad IP- 10.4.38.27, Account Name- ica.administrator)-4. HTML5 viewer is enabled
                Executedsteps++;

                //Step-2:Pre-conditions--Configure Domains, Roles, Groups are configured according to steps in test cases under LDAP/MultipleDomain Ldap Image Sharing (Test 27680 - Main PreSetup, Test 27681 - Setup Domain that are mapped in LDAP, Test 27682 - Create Roles that are configured in the LDAP, -Test 27683 - Create the Groups).
                Executedsteps++;

                //Step-3:-Pre-conditions--Ensure that Conference Lists in Domain Management tab and Conference User in Role Management tab are enabled for super admin and domain admin.-Ensure there is a user role under a domain with Conference User enabled; and another role with the option disabled-Ensure that there are Conference Users and non-Conference users in the same domain
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.CreateToplevelFolder(topfoldername, user1, LDAPDomain, Description); //to Folder1
                conffolder.CreateSubFolder(topfoldername, subfoldername1, LDAPDomain, Description); //Level2 with description &study,notes 
                conffolder.CreateSubFolder(topfoldername, subfoldername2, LDAPDomain); //Level2
                conffolder.CreateSubFolder(folderpath2, sub2, LDAPDomain); //Level3 without description and with study(no notes)
                conffolder.CreateToplevelFolder(topfoldername2, domain: LDAPDomain);  //Top Folder2 
                conffolder.CreateSubFolder(topfoldername2, subfolder2, LDAPDomain); //Level2 without description and with study(no notes)
                login.Logout();
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                var studies = login.Navigate<Studies>();
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accessions[0], StudyNotes: StudyNotes);  //Level2 with description &study,notes 
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accessions[3]);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accessions[4]);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accessions[5]);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accessions[6]);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(folderpath1, Accessions[7]);  //Level2 with description &study
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath_2, Accessions[1], StudyNotes: StudyNotes);   //Level3 without description and with study(no notes)
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath_2, Accessions[2], StudyNotes: StudyNotes + "Test");
                studies.AddDatasourceSpecificStudyToStudyFolder(FolderPath, Accessions[0]); //Level2 without description and with study(no notes)
                login.Logout();
                Executedsteps++;

                //Step-4:Login as the domain admin user of the same domain (or Folder Manage, or super admin), navigate to the Conference Folders tab, select a study folder contains studies with conference notes.
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accessions[0]);
                String StudyNotes_4 = conffolder.GetConferenceStudyNotes();
                bool IsEditNotesBtnEnabled = conffolder.Btn_EditStudyNotes().Enabled;
                bool IsStudyNoteTimeExist = conffolder.IsElementPresent(conffolder.By_StudyNoteTime());
                if (StudyNotes_4.Equals(StudyNotes) && IsEditNotesBtnEnabled && IsStudyNoteTimeExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5:Without clicking the Edit Study Notes button in the NOTES / COMMENTS pane, attempt to modify the conference notes.
                bool Modify = true;
                try
                {
                    conffolder.TxtArea_StudyNotes().Clear();
                    Modify = false;
                }
                catch (Exception)
                {
                    Modify = true;
                }

                if (Modify)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-6:Click the Edit Study Notes button          
                conffolder.Btn_EditStudyNotes().Click();
                Driver.SwitchTo().DefaultContent();
                Driver.SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("TabContent").SwitchTo().Frame("TabContent");
                bool Okbtn = conffolder.Btn_OkStudyNotes().Enabled;
                bool Cancelbtn = conffolder.Btn_CancelStudyNotes().Enabled;
                if (Okbtn && Cancelbtn)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-7:Enter plain text, press Enter button     
                conffolder.Btn_CancelStudyNotes().Click();
                conffolder.ModifyConferenceStudyNotes("abcdefgh");
                String StudyNotes_7 = conffolder.GetConferenceStudyNotes();
                bool IsStudyNoteTimeExist7 = conffolder.IsElementPresent(conffolder.By_StudyNoteTime());
                if (StudyNotes_7.Equals("abcdefgh") && IsStudyNoteTimeExist7)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Edit the study notes, copy and paste a large text to the area so that it is exceeded the Notes /COMMENTS display area. Press Enter button.               
                PageLoadWait.WaitForPageLoad(30);
                PageLoadWait.WaitForFrameLoad(30);
                string notes = "";
                for (int i = 1; i <= 1250; i++)
                {
                    notes = notes + "abcdefgh";
                }
                conffolder.ModifyConferenceStudyNotes(notes);
                String StudyNotes_8 = conffolder.GetConferenceStudyNotes();
                bool IsStudyNoteTimeExist8 = conffolder.IsElementPresent(conffolder.By_StudyNoteTime());
                if (StudyNotes_8.Equals(notes) && IsStudyNoteTimeExist8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9:Review the notes from beginning to the end.
                //bool IsStudyNotesScrollBarExist=conffolder.IsVerticalScrollBarPresent(Driver.FindElement(By.CssSelector("div#StudyNotesParentDiv")));

                result.steps[++Executedsteps].status = "Not Automated";


                //Step-10:Select a sub-folder that contains study folder, attempt to click the Edit Study Notes button.
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                bool IsEditNotesBtnEnabled_10 = conffolder.Btn_EditStudyNotes().Enabled;
                if (!IsEditNotesBtnEnabled_10)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-11:Login as a conference user, navigate to the Conference Folders, attempt to edit a conference notes of a study.
                login.LoginIConnect(userid2, LDAP_Password);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accessions[0]);
                bool IsEditNoteBtnEnabled = conffolder.Btn_EditStudyNotes().Enabled;
                if (!IsEditNoteBtnEnabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-12:login as a Conference User, navigate to the Conference Folders tab, browse to the folder and load the conference study that has conference notes into study viewer. Open the History fly-out.
                login.LoginIConnect(userid2, LDAP_Password);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accessions[0]);
                StudyViewer studyviewer = LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabEnabled = conffolder.Btn_StudyNotes_HistoryPanel().Enabled;
                studyviewer.NavigateTabInHistoryPanel("StudyNotes");
                bool IsStudyNotesExist = studyviewer.StudyNotesSection().Text.Equals(notes);
                if (IsStudyNotesTabEnabled && IsStudyNotesExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Logout();

                //Step-13:Login iCA as a Conference User, navigate to the Conference Folders tab, browse to the study folder contains conference studies are priors and having conference notes. Load a study. From the study viewer, open History tab.
                login.LoginIConnect(userid2, LDAP_Password);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(FolderPath_2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.SelectStudy("Accession", Accessions[1]);
                studyviewer = LaunchStudy(isConferenceTab: true);
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabEnabled_13 = conffolder.Btn_StudyNotes_HistoryPanel().Enabled;
                studyviewer.NavigateTabInHistoryPanel("StudyNotes");
                bool IsStudyNotesExist_13 = studyviewer.StudyNotesSection().Text.Equals(StudyNotes);
                if (IsStudyNotesTabEnabled_13 && IsStudyNotesExist_13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-14:Select the prior which is a conference study with conference notes in the History fly-out priors list.
                studyviewer.ChooseColumns(new string[] { "Accession" });
                studyviewer.SelectStudy("Accession", Accessions[2]);
                studyviewer.NavigateTabInHistoryPanel("StudyNotes");
                bool IsStudyNotesExist_14 = studyviewer.StudyNotesSection().Text.Equals(StudyNotes + "Test");
                if (IsStudyNotesExist_14)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();

                //Step-15:Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-16:Navigate to Studies tab, load a study that was added to the conference list. Open the History fly-out, verify the Study Notes button.
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy("Accession", Accessions[2]);
                studyviewer = studies.LaunchStudy();
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabExist = conffolder.IsElementVisible(conffolder.By_Btn_StudyNotes_HistoryPanel());
                if (!IsStudyNotesTabExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Logout();

                //Step-17:Login as a non-conference user. From Studies tab, load a study into study viewer, open History fly-out, verify the Study Notes button.
                login.LoginIConnect(userid3, LDAP_Password);
                studies = login.Navigate<Studies>();
                studies.SearchStudy("Accession", Accessions[2]);
                studies.SelectStudy("Accession", Accessions[2]);
                studyviewer = studies.LaunchStudy();
                studyviewer.NavigateToHistoryPanel();
                bool IsStudyNotesTabExist_17 = conffolder.IsElementVisible(conffolder.By_Btn_StudyNotes_HistoryPanel());
                if (!IsStudyNotesTabExist_17)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyviewer.CloseHistoryPanel();
                studyviewer.CloseStudy();
                login.Logout();

                //Step-18:Login as a Conference user, navigate to the Conference Folders tab. Browse folders and select a study folder contains multiple studies.
                login.LoginIConnect(userid2, LDAP_Password);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(FolderPath_2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                Dictionary<string, string> Studylist_1 = conffolder.GetMatchingRow("Accession", Accessions[1]);
                Dictionary<string, string> Studylist_2 = conffolder.GetMatchingRow("Accession", Accessions[2]);
                if (Studylist_1 != null && Studylist_2 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19:Verify the conference studies list display area.
                bool IsGroupByExist = conffolder.IsElementPresent(conffolder.By_GroupByConferenceStudyListLayoutInTab());
                bool IsColumnHeadersExist = conffolder.IsElementPresent(conffolder.By_ColumnHeaders());
                bool IsChooseColumnExist = conffolder.IsElementPresent(conffolder.By_ChooseColumns());
                bool IsResetExist = conffolder.IsElementPresent(conffolder.By_Reset());
                bool IsDeleteBtnExist = conffolder.IsElementVisible(conffolder.Btn_DeleteStudyBy());
                bool IsViewBtnExist = conffolder.IsElementVisible(conffolder.By_ViewStudyBtn());
                bool IsRecordSummaryExist = conffolder.RecordSummaryText().Equals("View 1 - 2 of 2");

                if (IsGroupByExist && IsColumnHeadersExist && IsChooseColumnExist && IsResetExist && IsRecordSummaryExist && IsViewBtnExist &&
                    !IsDeleteBtnExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-20:Select each filter in the Group By drop down.
                conffolder.SelectGroupByInStudiesTab("Patient DOB", 1);
                PageLoadWait.WaitForPageLoad(5);
                bool step20_1 = conffolder.IsGroupedBy("Patient DOB", 1);
                bool step20_2 = BasePage.GetColumnValues("Patient ID").All<String>(columnvalue => columnvalue.Equals(PatientID));
                conffolder.SelectGroupByInStudiesTab("Accession", 1);
                PageLoadWait.WaitForPageLoad(5);
                bool step20_3 = conffolder.IsGroupedBy("Accession", 1);
                if (step20_1 && step20_2 && step20_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-21:Sort each column headers.
                conffolder.SelectGroupByInStudiesTab("No Grouping", 1);
                bool sortresult = conffolder.CheckSortInPatientHistory(1);
                if (sortresult == true)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-22:Click Choose Columns button
                conffolder.ClickChooseColumns("Others");
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.By_ChooseColumnDialog()));
                if (conffolder.ChooseColumnDialog().Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-23:Add and remove columns, click Cancel button
                conffolder.SelectColumns(new string[] { "Patient Name" }, "Add", isConferenceTab: true, isRerarrange: false);
                conffolder.SelectColumns(new string[] { "Patient Name" }, "Remove", isConferenceTab: true, isRerarrange: false);
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.CancelButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsPatientNameExist23 = BasePage.GetColumnNames().Any(columnname => columnname.Equals("Patient Name"));
                if (!IsPatientNameExist23)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-24:Click Choose Columns button, Add and remove columns, click Ok button
                conffolder.ClickChooseColumns("Others");
                conffolder.SelectColumns(new string[] { "Patient Name", "Gender" }, "Add", isConferenceTab: true, isRerarrange: false);
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.OKButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsGenderExist1 = BasePage.GetColumnNames().Any(columnname => columnname.Equals("Gender"));
                conffolder.ClickChooseColumns("Others");
                conffolder.SelectColumns(new string[] { "Gender" }, "Remove", isConferenceTab: true, isRerarrange: false);
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.OKButton_ChooseColumns().Click();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsPatientNameExist = BasePage.GetColumnNames().Any(columnname => columnname.Equals("Patient Name"));
                bool IsGenderExist2 = BasePage.GetColumnNames().Any(columnname => columnname.Equals("Gender"));
                if (IsPatientNameExist && IsGenderExist1 && !IsGenderExist2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-25:Click Reset button
                PageLoadWait.WaitForFrameLoad(10);
                conffolder.ResetColumns();
                PageLoadWait.WaitForFrameLoad(10);
                bool IsPatientNameExist_25 = BasePage.GetColumnNames().Any(columnname => columnname.Equals("Patient Name"));
                if (!IsPatientNameExist_25)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-26:Select/de-select studies in the Conference studies list, verify the View button
                conffolder.ExpandAndSelectFolder(FolderPath_2);
                bool IsViewBtnEnabled_1 = conffolder.ViewStudyBtn().Enabled;
                conffolder.SelectStudy("Accession", Accessions[2]);
                bool IsViewBtnEnabled_2 = conffolder.ViewStudyBtn().Enabled;
                if (!IsViewBtnEnabled_1 && IsViewBtnEnabled_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-27:Select a study and click View button.
                studyviewer = conffolder.LaunchStudy(isConferenceTab: true);
                String Patientinfo = studyviewer.PatientInfoTab(1);
                String Studyinfo = studyviewer.StudyInfo(1);
                if (Patientinfo.Contains(PatientID) && Studyinfo.Contains(Accessions[2]))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //Step-28:Login as a Folder Manager, navigate the Conference Folders tab, select a study folder that is under a top level folder managed by the user.
                login.LoginIConnect(userid, LDAP_Password);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                bool IsDeletestudyBtnExists_28 = conffolder.IsElementVisible(conffolder.Btn_DeleteStudyBy());
                if (IsDeletestudyBtnExists_28)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-29:Select/de-select studies in the Conference studies list, verify the Delete button
                bool IsDeletestudyBtnEnabled_1 = conffolder.DeleteStudyBtn().Enabled;
                conffolder.SelectStudy("Accession", Accessions[0]);
                bool IsDeletestudyBtnEnabled_2 = conffolder.DeleteStudyBtn().Enabled;
                if (!IsDeletestudyBtnEnabled_1 && IsDeletestudyBtnEnabled_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-30:Without select any conference study, attempt to click Delete button to select studies.
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                bool IsDeletestudyBtnEnabled_30 = conffolder.DeleteStudyBtn().Enabled;
                if (!IsDeletestudyBtnEnabled_30)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-31:Select a study, click Delete.
                conffolder.SelectStudy("Accession", Accessions[0]);
                conffolder.DeleteStudyBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool CaptionInDialog = conffolder.DeleteStudies_Caption().Equals("Delete Studies");
                if (CaptionInDialog)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-32:Click Cancel in the dialog
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                Dictionary<string, string> Studylist_32 = conffolder.GetMatchingRow("Accession", Accessions[0]);
                if (Studylist_32 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-33:Select a study, click Delete, this time click OK in the dialog.                
                conffolder.DeleteStudy("Accession", Accessions[0]);
                Dictionary<string, string> Studylist_33 = conffolder.GetMatchingRow("Accession", Accessions[0]);
                if (Studylist_33 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-34:Repeat above steps Delete/Cancel and Delete/OK, this time by selecting more than 1 studies.
                conffolder.SelectStudy1("Accession", Accessions[3], true);
                conffolder.SelectStudy1("Accession", Accessions[4], true);
                conffolder.DeleteStudyBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                Dictionary<string, string> Studylist34_1 = conffolder.GetMatchingRow("Accession", Accessions[3]);
                Dictionary<string, string> Studylist34_2 = conffolder.GetMatchingRow("Accession", Accessions[4]);
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.DeleteStudy("Accession", ctrlclick: true, values: new string[] { Accessions[3], Accessions[4] });
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                Dictionary<string, string> Studylist1_34 = conffolder.GetMatchingRow("Accession", Accessions[3]);
                Dictionary<string, string> Studylist2_34 = conffolder.GetMatchingRow("Accession", Accessions[4]);
                if (Studylist34_1 != null && Studylist34_2 != null && Studylist1_34 == null && Studylist2_34 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-35:Repeat above steps Delete/Cancel and Delete/OK, this time by selecting all studies in the conference studies list.
                conffolder.SelectStudy1("Accession", Accessions[5], true);
                conffolder.SelectStudy1("Accession", Accessions[6], true);
                conffolder.SelectStudy1("Accession", Accessions[7], true);
                conffolder.DeleteStudyBtn().Click();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                conffolder.Btn_Cancel_ConfirmationDiv().Click();
                Dictionary<string, string> Studylist35_1 = conffolder.GetMatchingRow("Accession", Accessions[5]);
                Dictionary<string, string> Studylist35_2 = conffolder.GetMatchingRow("Accession", Accessions[6]);
                Dictionary<string, string> Studylist35_3 = conffolder.GetMatchingRow("Accession", Accessions[7]);
                conffolder.ExpandAndSelectFolder(folderpath1);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(10);
                conffolder.DeleteStudy("Accession", ctrlclick: true, values: new string[] { Accessions[5], Accessions[6], Accessions[7] });
                int studycount = BasePage.GetSearchResults().Count;
                if (Studylist35_1 != null && Studylist35_2 != null && Studylist35_3 != null && studycount == 0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Conference Lists - GUI Verification in Top Folders
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test3_98703(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;              
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String LDAP_Users = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Users");
                String[] LDAPUsers = LDAP_Users.Split('=');
                String userid = LDAPUsers[0]; //Conference Userid
                String userid2 = LDAPUsers[1]; //Conference Userid
                String userid3 = LDAPUsers[2]; //Non Conference Userid
                String LDAP_Firstname = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Firstname");
                String[] LDAPUsernames = LDAP_Firstname.Split(':');
                String[] unames = LDAPUsernames[2].Split('=');
                String user1 = LDAPUsernames[0]; //Conference Userid
                String user2 = LDAPUsernames[1]; //Conference Userid
                String user3 = unames[0];        //Non Conference Userid
                String[] LDAPFMs = LDAP_Firstname.Split('=');
                String[] LDAPnames=LDAPFMs[1].Split(':');
                String USER1 = LDAPnames[0];
                String USER2 = LDAPnames[1];
                String USER3 = LDAPnames[2];
                String DomainAdmin_Userid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP DomainAdmin");
                String DomainAdmin_Pwd = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LDAP Password");                
                Random random = new Random();
                String topfoldername = "3Top1" + random.Next(1, 10000);
                String subfoldername1 = "Sub01" + random.Next(1, 10000);
                String subfoldername2 = "Sub02" + random.Next(1, 10000);
                String sub2 = "sub2" + random.Next(1, 10000);
                String rolename = "Role_1" + random.Next(1, 1000);
                String rolename2 = "Role_2" + random.Next(1, 1000);        
                String StudyNotes = "StudyNotes_" + random.Next(1, 1000);
                String Description = "Description_" + random.Next(1, 1000);
                String topfoldername2 = "3Top2" + random.Next(1, 10000);
                String topfoldername3 = "3Top3" + random.Next(1, 10000);
                String topfoldername4 = "3Top4" + random.Next(1, 10000);
                
                //Step-1:Pre-conditions--1. iCA build under testing is a fresh installation.-
                //2. Ensure 'Enable Conference Lists' is enabled in the iCA Service Tool\Enable Features tab\General sub tab on iCA server under testing-
                //3. Mixed data base is used; Ldap user data base is configured (Server- ica.ldap.merge.ad IP- 10.4.38.27, Account Name- ica.administrator)-4. HTML5 viewer is enabled
                Executedsteps++;

                //Step-2:Pre-conditions--Configure Domains, Roles, Groups are configured according to steps in test cases under LDAP/MultipleDomain Ldap Image Sharing (Test 27680 - Main PreSetup, Test 27681 - Setup Domain that are mapped in LDAP, Test 27682 - Create Roles that are configured in the LDAP, -Test 27683 - Create the Groups).
                Executedsteps++;

                //Step-3:-Pre-conditions--Ensure that Conference Lists in Domain Management tab and Conference User in Role Management tab are enabled for super admin and domain admin.-Ensure there is a user role under a domain with Conference User enabled; and another role with the option disabled-Ensure that there are Conference Users and non-Conference users in the same domain             
                Executedsteps++;

                //Step-4:Login as the domain admin (or super admin), navigate to the Conference Folders (if logged as a superadmin, select a domain), from Folder Browser Active sub-tab, click the Manage Top Level Folders button
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                var conffolder = login.Navigate<ConferenceFolders>();
                conffolder.NavigateToActiveMode();
                conffolder.OpenManageTopLevelFolder();
                bool IsAddTopFolderBtnExist = conffolder.AddFolderBtn().Displayed;
                bool IsAddFoldermanagerInputExist = conffolder.FolderManagerTextBox().Displayed;
                bool IsSaveBtnExist = conffolder.SaveFolderBtn().Displayed;
                bool IsDeleteBtnExist = conffolder.DeleteFolderManagerBtn().Displayed;
                bool IsCancelBtnExist = conffolder.CancelFolderBtn().Displayed;
                if (IsAddTopFolderBtnExist && IsAddFoldermanagerInputExist && IsSaveBtnExist && IsDeleteBtnExist && IsCancelBtnExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-5:Resize the browser window.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-6:From the Manage Top Level Folders dialog, without adding any top level folder and folder manager, click Cancel button in the dialog.
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("input#ConferenceFolderManagementControl_Cancel")));
                conffolder.CancelFolderBtn().Click();
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(conffolder.By_FolderConfigurationdiv()));
                bool IsManageTopFolderDialogExist = conffolder.IsElementVisible(conffolder.By_FolderConfigurationdiv());
                IWebElement IsTopFolderExist6 = conffolder.ExpandAndSelectFolder(topfoldername2);
                if (!IsManageTopFolderDialogExist && IsTopFolderExist6 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                               

                //Step-7:From the Manager Top Level Folders dialog, click the Add Top Level Folder button.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList_7 = conffolder.GetToplevelFolders();
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                bool IsInputFolderExist = conffolder.InputFolder().Displayed;
                if (IsInputFolderExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-8:Without entering folder name, press Enter key on the keyboard
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys("");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                IList<IWebElement> TopFolderList_8 = conffolder.GetToplevelFolders();
                if (TopFolderList_8.Count == TopFolderList_7.Count)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-9:Enter a folder name, press Enter key on the keyboard
                conffolder.AddFolderBtn().Click();
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys(topfoldername);
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();                
                BasePage.wait.Until<Boolean>(d =>
                {
                    var folders = d.FindElements(By.CssSelector("div#divFolderManagement div#divtopLevelFolder>div"));
                    if (folders.Any(folder => folder.GetAttribute("innerHTML").Contains(topfoldername)))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                IList<IWebElement> TopFolderList = conffolder.GetToplevelFolders();
                if (TopFolderList.Any(folder => folder.GetAttribute("innerHTML").Contains(topfoldername)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-10:From the Manage Top Level Folders dialog without selecting any top level folder, search users in the user search text box.
                bool IsTextboxDisabled ;
                try
                {
                    if(conffolder.FolderManagerTextBox().GetAttribute("disabled").Contains(""))
                    IsTextboxDisabled= true;
                    else 
                    IsTextboxDisabled = false;
                }
                catch(Exception)
                {
                    IsTextboxDisabled= false;
                }

                if (IsTextboxDisabled)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-11 & 12:Select the newly added top level folder, search users in the user search text box. and Select and Add a Folder Manager to the created top level folder.
                bool IsFolderManageradded = conffolder.AddFolderManager(topfoldername, user1, isLDAPuser: true, LDAPusername:USER1);
                Executedsteps++;
                if (IsFolderManageradded)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-13:Repeat above step to add the same user to the same folder as a folder manager.
                conffolder.AddFolderManager(topfoldername, user1, isLDAPuser: true, LDAPusername: USER1);
                wait.Until(ExpectedConditions.ElementExists(conffolder.By_ErrorMessageLabel()));
                bool IsErrorMsgExist14 = conffolder.ErrorMessageLabel().Text.Equals("The selected user is already a folder manager for the selected folder");
                if (IsErrorMsgExist14)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-14:Click Save button in the dialog.Click OK button to close the confirmation dialog. 
                conffolder.SaveFolderBtn().Click();
                wait.Until(ExpectedConditions.InvisibilityOfElementLocated(conffolder.By_FolderConfigurationdiv()));
                conffolder.SwitchtoConferenceFrame();
                wait.Until(ExpectedConditions.ElementExists(conffolder.By_ManageFolderOkBtn()));                
                bool IsMsgExist = conffolder.FolderSaveDialog().Text.Equals("Folder configuration saved successfully");
                if (IsMsgExist)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-15:Open the Manage Top Level Folders dialog, repeat above steps, add a new top level folder with a folder manager assigned to it, this time click Cancel button in the dialog.                
                conffolder.ManageFolderOkBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                IWebElement IsTopFolderExist1_16 = conffolder.ExpandAndSelectFolder(topfoldername);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys(topfoldername2);
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                BasePage.wait.Until<Boolean>(d =>
                {
                    var folders = d.FindElements(By.CssSelector("div#divFolderManagement div#divtopLevelFolder>div"));
                    if (folders.Any(folder => folder.GetAttribute("innerHTML").Contains(topfoldername2)))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                conffolder.AddFolderManager(topfoldername2, user1, isLDAPuser: true, LDAPusername: USER1);
                conffolder.CancelFolderBtn().Click();
                IWebElement IsTopFolderExist2_16 = conffolder.ExpandAndSelectFolder(topfoldername2);
                if (IsTopFolderExist1_16 != null && IsTopFolderExist2_16 == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-16:Open the Manage Top Level Folders dialog, verify the top level folder added in above step is not saved
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList17 = conffolder.GetToplevelFolders();
                if (!(TopFolderList17.Any(folder => folder.GetAttribute("innerHTML").Contains(topfoldername2))))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();

                //Step-17:Open the Manage Top Level Folders dialog, click Add Top Level Folders button, add more top level folders, some with different folder managers assigned and some without folder manager , Save changes.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddTopFolder(topfoldername2);
                conffolder.AddFolderManager(topfoldername2, user1, isLDAPuser: true, LDAPusername: USER1);
                conffolder.AddTopFolder(topfoldername3);
                conffolder.AddFolderManager(topfoldername2, user3, isLDAPuser: true, LDAPusername: USER3);
                conffolder.AddTopFolder(topfoldername4);
                conffolder.SaveTopLevelfolder();
                IWebElement IsTopFolderExist1_18 = conffolder.ExpandAndSelectFolder(topfoldername2);
                IWebElement IsTopFolderExist2_18 = conffolder.ExpandAndSelectFolder(topfoldername3);
                IWebElement IsTopFolderExist3_18 = conffolder.ExpandAndSelectFolder(topfoldername4);
                if (IsTopFolderExist1_18 != null && IsTopFolderExist2_18 != null && IsTopFolderExist3_18 != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-18:Repeat above steps, keep creating top level folders until the scroll bar displays in Manage Folder Categories box, Save changes.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                String name;
                IList<String> Folders_List = new List<String>();
                for (int i = 1; i <= 20; i++)
                {
                    name = "Top_" + i + "";
                    conffolder.AddTopFolder(name);
                    Folders_List.Add(name);
                }
                conffolder.SaveTopLevelfolder();               
                bool flag = true;
                foreach (String folder in Folders_List)
                {
                   if(conffolder.ExpandAndSelectFolder(folder)==null)
                   {
                       flag = false;
                       break;
                   }              
                    
                }
                if (flag)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-19:From the Mange Top Level Folders dialog, create a top level folder with its name is 256 characters, Save changes.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                string text = "";
                for (int i = 1; i <= 32; i++)
                {
                    text = text + "abcdefgh";
                }
                conffolder.AddTopFolder(text);
                conffolder.SaveTopLevelfolder();
                IList<IWebElement> TopFolderList20 = conffolder.AllTopLevelfolders();
                if (TopFolderList20.Any(folder => folder.Text.Equals(text)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }                


                //Step-20:From the Mange Top Level Folders dialog, perform boundary validation in the folder name field, Save changes.
                string text21 = "";
                for (int i = 1; i <= 32; i++)
                {
                    text21 = text21 + "abcdefghi";
                }
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys(text21);
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                Thread.Sleep(2000);
                bool IsErrorMsgExist20 = conffolder.ErrorMessageLabel().Text.Equals("Folder name should be less than 256 characters");
                if (IsErrorMsgExist20)               
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();
                

                //Step-21:From the Mange Top Level Folders dialog, enter special characters in the folder name field (e.g. -, &, #), Save changes.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);               
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys("~Top>/");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.By_SaveFolderBtn()));
                conffolder.SaveTopLevelfolder();
                IList<IWebElement> TopFolderList22 = conffolder.AllTopLevelfolders();
                if (TopFolderList22.Any(folder => folder.Text.Equals("~Top>/")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
               

                //Step-22:Repeat above test all special characters in Top level Folder name field. Save changes.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddFolderBtn().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.InputFolder()));
                conffolder.InputFolder().Click();
                conffolder.InputFolder().SendKeys("~!@#$%^&*()_+{}|<>/");
                new Actions(BasePage.Driver).SendKeys(Keys.Enter).Perform();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.By_SaveFolderBtn()));
                conffolder.SaveTopLevelfolder();
                IList<IWebElement> TopFolderList23 = conffolder.AllTopLevelfolders();
                if (TopFolderList23.Any(folder => folder.Text.Equals("~!@#$%^&*()_+{}|<>/")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-23:From the Mange Top Level Folders dialog Manage Folder Categories box, move the scroll bar up and down to browse through the top level folders in the list.
                result.steps[++Executedsteps].status = "Not Automated";

                //Step-24:Select different top level folders that have been assigned with different folder managers.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.SelectTopFolderInConfigDiv(topfoldername);
                IList<IWebElement> FolderManagers = conffolder.FolderManagerListed();
                bool Manager1 = FolderManagers.Any(manager => manager.Text.Contains(user1));
                conffolder.SelectTopFolderInConfigDiv(topfoldername2);
                IList<IWebElement> FolderManagers1 = conffolder.FolderManagerListed();
                bool Manager2 = FolderManagers1.Any(manager => manager.Text.Contains(user3));
                if (Manager1 && Manager2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();
                login.Logout();

                //Step-25:Login as the domain admin, from the Manage Top level Folders dialog, perform a user search as such it will return users exceeded the length of the Add Folder Manages box and a scroll bar appears (e.g. search J*)
                login.LoginIConnect(DomainAdmin_Userid, DomainAdmin_Pwd);
                conffolder = login.Navigate<ConferenceFolders>();
                conffolder.NavigateToActiveMode();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.SelectTopFolderInConfigDiv(Folders_List[2]);
                conffolder.FolderManagerTextBox().Click();
                new Actions(BasePage.Driver).Click(conffolder.FolderManagerTextBox()).SendKeys("user").Build().Perform();
                conffolder.SwitchtoConferenceFrame();
                PageLoadWait.WaitForFrameLoad(30);
                PageLoadWait.WaitForSuggestionToLoad();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.FolderManager_Suggestion()));
                IList<IWebElement> Users26 = conffolder.AutoCompleteDiv();
                if (Users26.Count > 1 && Users26.Any(User => User.Text.Contains("user")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();

                //Step-26:Move the scroll bar up and down in the Add Folder Manager box to browse users listed.
                result.steps[++Executedsteps].status = "Not Automated";


                //Step-27:Add folder managers to serval top level folders. Click Save button.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                bool FM_1 = conffolder.AddFolderManager(Folders_List[2], user1, isLDAPuser: true, LDAPusername: USER1);
                bool FM_2 = conffolder.AddFolderManager(Folders_List[6], user3, isLDAPuser: true, LDAPusername: USER3);
                bool FM_3 = conffolder.AddFolderManager(Folders_List[11], user1, isLDAPuser: true, LDAPusername: USER1);
                conffolder.SaveTopLevelfolder();
                if (FM_1 && FM_2 && FM_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }               

                //Step-28:Re-open the Manager Top Level Folders dialog, verify folder manages added in these folders.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.SelectTopFolderInConfigDiv(Folders_List[2]);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div[id='divFolderManagers']>div")));
                IList<IWebElement> FolderManagers1_29 = conffolder.FolderManagerListed();
                bool Manager1_29 = FolderManagers1_29.Any(manager => manager.GetAttribute("innerHTML").Contains(user1));
                conffolder.SelectTopFolderInConfigDiv(Folders_List[6]);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div[id='divFolderManagers']>div")));
                IList<IWebElement> FolderManagers2_29 = conffolder.FolderManagerListed();
                bool Manager2_29 = FolderManagers2_29.Any(manager => manager.GetAttribute("innerHTML").Contains(user3));
                conffolder.SelectTopFolderInConfigDiv(Folders_List[11]);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementIsVisible(By.CssSelector("div[id='divFolderManagers']>div")));
                IList<IWebElement> FolderManagers3_29 = conffolder.FolderManagerListed();
                bool Manager3_29 = FolderManagers3_29.Any(manager => manager.GetAttribute("innerHTML").Contains(user1));

                if (Manager1_29 && Manager2_29 && Manager3_29)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();

                //Step-29:Select a top level folder and assign folder managers it. Click Cancel button. Reopen the dialog and verify folder managers listed in the same folder.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddFolderManager(Folders_List[4], user1, isLDAPuser: true, LDAPusername: USER1);
                conffolder.CancelFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.SelectTopFolderInConfigDiv(Folders_List[4]);
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> FolderManagers30 = conffolder.FolderManagerListed();
                if (FolderManagers30.Count==0)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();

                //Step-30:Repeat above steps from the Manage Top level Folders dialog by adding a top level folder with a folder manager, then click Cancel button. Verify the top level folder and its folder manager.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.AddTopFolder("TOPFolder_1");
                conffolder.AddFolderManager("TOPFolder_1", user1, isLDAPuser: true, LDAPusername: USER1);
                conffolder.CancelFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList31 = conffolder.GetToplevelFolders();
                bool InDialog = TopFolderList31.Any(folder => folder.GetAttribute("innerHTML").Contains("TOPFolder_1"));
                conffolder.CancelFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> TopFolderList2_31 = conffolder.AllTopLevelfolders();
                bool InFolderBrowser = TopFolderList2_31.Any(folder => folder.Text.Equals("TOPFolder_1"));
                if (!InDialog && !InFolderBrowser)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }                

                //Step-31:From the Manage Top Level Folders dialog, enter special characters in the user search text input box (e.g. a period, hyphen, single quote, double quotes, ...etc.),
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.SelectTopFolderInConfigDiv(Folders_List[2]);
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.FolderManagerTextBox().Click();
                new Actions(BasePage.Driver).Click(conffolder.FolderManagerTextBox()).SendKeys("_").Build().Perform();
                conffolder.SwitchtoConferenceFrame();
                PageLoadWait.WaitForFrameLoad(30);
                PageLoadWait.WaitForSuggestionToLoad();
                wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.FolderManager_Suggestion()));
                IList<IWebElement> Users = conffolder.AutoCompleteDiv();
                if (Users.Count >= 1 )//&& Users.All(User => User.Text.Contains("_")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //Step-32:From the Manage Top Level Folders dialog, select a top level folder that is not the first one in the list and it has more than one folder managers assigned to it, select a folder manager, click the Remove Folder Manager button
                conffolder.AddFolderManager(Folders_List[2], user3, isLDAPuser: true, LDAPusername: USER3);
                conffolder.SaveTopLevelfolder();
                PageLoadWait.WaitForFrameLoad(30);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(30);
                conffolder.SelectTopFolderInConfigDiv(Folders_List[2]);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("div[id='divFolderManagers']>div")));

                if (conffolder.FolderManager_Name().Equals(USER1))
                {
                    wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("div[id='divFolderManagers']>div")));
                    Driver.FindElement(By.CssSelector("div[id='divFolderManagers']>div")).Click();
                }
                conffolder.DeleteFolderManagerBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);               
                bool CaptionInDialog = conffolder.DeleteFManager_Caption().Equals("Delete Folder Manager");
                if (CaptionInDialog)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-33:Click Cancel button in the Confirmation dialog. Verify the selected folder manage is not removed.
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.FManager_CancelBtn().Click();
                if (conffolder.FolderManager_Name().Equals(USER1))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conffolder.CancelFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);

                //Step-34:Repeat above step, this time click OK button
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.RemoveFolderManager(Folders_List[2], user1, USER1);
                if (!(conffolder.FolderManager_Name().Equals(USER1)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-35:Click Cancel in the dialog. Verify the selected folder manage is not removed.
                conffolder.CancelFolderBtn().Click();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.OpenManageTopLevelFolder();
                PageLoadWait.WaitForFrameLoad(20);
                conffolder.SelectTopFolderInConfigDiv(Folders_List[2]);
                PageLoadWait.WaitForFrameLoad(20);
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("div[id='divFolderManagers']>div")));
                if (conffolder.FolderManager_Name().Equals(USER1))
                {          
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step-36:Repeat above steps, this time click OK in the confirmation dialog and then Save in the Manage Top Level Folders dialog. Verify the selected folder manager is removed from the list.
                conffolder.RemoveFolderManager(Folders_List[2], user1, USER1);
                conffolder.SaveTopLevelfolder();
                conffolder.OpenManageTopLevelFolder();
                conffolder.SelectTopFolderInConfigDiv(Folders_List[2]);
                //wait.Until(ExpectedConditions.ElementToBeClickable(conffolder.FolderManager(user3)));
                //conffolder.FolderManager(user3).Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(By.CssSelector("div[id='divFolderManagers']>div")));
                if (!IsElementPresent(conffolder.By_FolderManager(user1)))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                conffolder.SaveTopLevelfolder();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout 
                login.Logout();

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Automate Conference List Feature Workflows and Testcases
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Task_3455(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            Taskbar taskbar = new Taskbar();
            ServiceTool servicetool = new ServiceTool();
            DomainManagement domainmanagement;
            RoleManagement rolemanagement;
            UserManagement usermanagement;
            ConferenceFolders conferencefolders;
            Studies studies;
            StudyViewer studyViewer;
            Patients patient;
            TestCaseResult result;
            result = new TestCaseResult(stepcount);

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            int Executedsteps = -1;

            try
            {
                //Fetch required Test data
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String DatasourceList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Datasource");
                String[] Datasource = DatasourceList.Split(':');
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String PatientNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientName");
                String[] PatientName = PatientNameList.Split(':');
                String ModalityList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Modality");
                String[] Modality = ModalityList.Split(':');
                String DescriptionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Description");
                String[] Description = DescriptionList.Split(':');
                String StudyDateList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyDate");
                String[] StudyDate = StudyDateList.Split('>');

                //FolderNames for TestdomainA
                String topfoldername = "Role2_ONCOLOGY_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String topfoldername2 = "top level folder 1 in DomainA_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername1 = "Role2_Head_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername2 = "Role2_Sublvl3_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String subfoldername3 = "Role2_Sublvl4_" + new System.DateTime().Millisecond + new Random().Next(100, 10000);
                String folderpath = topfoldername + "/" + subfoldername1 + "/" + subfoldername2;


                String studynotes1 = "related2";
                String studynotes2 = "related3";
                String studynotes3 = "1 study added from studies tab to a different sub-folder";
                String studynotes4 = "1 study added from studies tab to a different sub-folder_updated";
                String studynotes5 = "";


                //Step 1 - Pre-conditions
                String TestdomainA = "Task455_DomainA_" + new Random().Next(1, 1000);
                String TestdomainAdminA = "Task455_DomainAdminA_" + new Random().Next(1, 1000);
                String TestroleA1 = "Task455_RoleA1_" + new Random().Next(1, 1000);
                String TestroleA2 = "Task455_RoleA2_" + new Random().Next(1, 1000);
                String TestuserA1 = "Task455_UserA1_" + new Random().Next(1, 1000);
                String TestuserA2 = "Task455_UserA2_" + new Random().Next(1, 1000);
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.CreateDomain(TestdomainA, TestdomainAdminA, new string[] { Datasource[0], Datasource[1], Datasource[2], Datasource[3], Datasource[4] });
                domainmanagement.ClickSaveNewDomain();
                bool step1_1 = domainmanagement.SearchDomain(TestdomainA);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.CreateRole(TestdomainA, TestroleA1, "any");
                bool step1_2 = rolemanagement.RoleExists(TestroleA1, TestdomainA);
                usermanagement = login.Navigate<UserManagement>();
                usermanagement.CreateUser(TestuserA1, TestdomainA, TestroleA1);
                bool step1_3 = usermanagement.SearchUser(TestuserA1, TestdomainA);
                if (step1_1 && step1_2 && step1_3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                    throw new Exception("Conference Lists feature is not enabled is Service tool");
                }
                login.Logout();                 

                //Step-2:Enable Conference Lists checkbox in Service Tool
                taskbar = new Taskbar();
                taskbar.Hide();
                servicetool = new ServiceTool();
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableConferenceLists();
                CheckBox ConferenceLists = wpfobject.GetAnyUIItem<Panel, CheckBox>(wpfobject.GetCurrentPane(), "Enable Conference Lists", 1);
                bool IsConferenceChecked = ConferenceLists.Checked;
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartService();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                taskbar.Show();
                if (IsConferenceChecked == true)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                    throw new Exception("Conference Lists feature is not enabled is Service tool");
                }

                //Step 3
                login.LoginIConnect(adminusername, adminpassword);
                domainmanagement = login.Navigate<DomainManagement>();
                domainmanagement.SearchDomain(TestdomainA);
                domainmanagement.SelectDomain(TestdomainA);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("conferencelists", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool step3_1 = domainmanagement.ConferenceListsCB().Selected;
                domainmanagement.ClickSaveEditDomain();
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectDomainfromDropDown(TestdomainA);
                rolemanagement.SearchRole(TestroleA1);
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                rolemanagement.SetCheckboxInEditRole("conferenceuser", 0);
                PageLoadWait.WaitForFrameLoad(5);
                bool step3_2 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                if (step3_1 && step3_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 4
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectDomainfromDropDown(TestdomainA);
                rolemanagement.ClickNewRoleBtn();
                rolemanagement.CreateRole(TestdomainA, TestroleA2, 6, 1, 0, 0);
                rolemanagement = login.Navigate<RoleManagement>();
                rolemanagement.SelectDomainfromDropDown(TestdomainA);
                rolemanagement.SearchRole(TestroleA1);
                rolemanagement.SelectRole(TestroleA1);
                rolemanagement.ClickEditRole();
                PageLoadWait.WaitForFrameLoad(5);
                bool step4_1 = rolemanagement.ConferenceUserCB().Selected;
                rolemanagement.ClickSaveEditRole();
                usermanagement = login.Navigate<UserManagement>();
                usermanagement.SelectDomainFromDropdownList(TestdomainA);
                usermanagement.CreateUser(TestuserA2, TestroleA2);
                bool step4_2 = usermanagement.SearchUser(TestuserA2, TestdomainA);
                if (step4_1 && step4_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 5
                login.LoginIConnect(TestdomainA, TestdomainA);
                conferencefolders = login.Navigate<ConferenceFolders>();
                bool step5_1 = conferencefolders.CreateToplevelFolder(topfoldername, TestuserA2); //Top level folder
                bool step5_2 = conferencefolders.CreateSubFolder(topfoldername, subfoldername1); //Level 2 sub-folder
                bool step5_3 = conferencefolders.CreateSubFolder(topfoldername + "/" + subfoldername1, subfoldername2); //Level 3 sub-folder
                bool step5_4 = conferencefolders.CreateSubFolder(topfoldername + "/" + subfoldername1, subfoldername3); //Level 3 sub-folder
                if (step5_1 && step5_2 && step5_3 && step5_4)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 6
                login.Logout();
                login.LoginIConnect(adminusername, adminpassword);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.DomainSelector().SelectByText(TestdomainA);
                conferencefolders.OpenManageTopLevelFolder();
                if (IsElementPresent(conferencefolders.By_FolderConfigurationdiv()))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.TopLevelFolderCancelButton().Click();

                //step 7
                bool step7 = conferencefolders.CreateToplevelFolder(topfoldername2, TestuserA1); //Top level folder
                if (step7)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 8
                login.LoginIConnect(TestuserA2, TestuserA2);
                patient = login.Navigate<Patients>();
                patient.InputData(PatientName[0]);
                patient.ClickPatientSearch();
                PageLoadWait.WaitForPatientsLoadingMsg(15);
                patient.LoadStudyInPatientRecord(PatientName[1].Trim());
                studyViewer = patient.LaunchStudy(Patients.PatientColumns.ID, PatientID);
                studyViewer.NavigateToHistoryPanel();
                int priorcount5 = BasePage.GetSearchResults().Count;
                if (priorcount5 == 8)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 9
                studyViewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[1] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.NavigateToHistoryPanel();
                studyViewer.OpenPriors(new string[] { "Study Description" }, new string[] { Description[2] });
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                studyViewer.studyPanel(1).Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                if (studyViewer.studyPanel(1).Displayed && studyViewer.studyPanel(2).Displayed && studyViewer.studyPanel(3).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 10
                var priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_2_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2, notes: studynotes1);
                if (studyViewer.studyPanel(3).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //Step 11
                studyViewer.studyPanel(2).Click();
                priorviewer = BasePage.Driver.FindElement(By.Id("m_studyPanels_m_studyPanel_3_ctl03_SeriesViewer_1_1_viewerImg"));
                priorviewer.Click();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2, notes: studynotes2);
                if (studyViewer.studyPanel(2).Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                studyViewer.CloseStudy();
                login.Logout();
                login.LoginIConnect(TestuserA2, TestuserA2);

                //step 12
                studies = login.Navigate<Studies>();
                studies.SelectAllDateAndData();
                studies.SearchStudy("Accession", Accession[3]);
                studies.SelectStudy("Accession", Accession[3]);
                studyViewer = studies.LaunchStudy();
                studyViewer.SelectToolInToolBar(IEnum.ViewerTools.AddToConferenceFolder);
                studyViewer.AddStudyToStudyFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3, notes: studynotes3);
                studyViewer.CloseStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                IWebElement studylist = BasePage.Driver.FindElement(By.CssSelector("#gview_gridTableStudyList"));
                if (studylist.Displayed == true)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 13
                conferencefolders = login.Navigate<ConferenceFolders>();
                bool step13 = conferencefolders.IsElementVisible(By.CssSelector("#m_resultsSelectorControl_m_selectorList"));
                if (!step13)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 14
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                int StudyCount_14 = BasePage.GetSearchResults().Count;
                if (StudyCount_14 == 3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 15
                conferencefolders.SelectStudy("Accession", Accession[0]);
                var whitespace = conferencefolders.GetConferenceStudyNotes();
                    if (String.IsNullOrWhiteSpace(whitespace))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 16
                    conferencefolders.SelectStudy("Description", Description[1]);
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes1))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 17
                conferencefolders.SelectStudy("Description", Description[2]);
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes2))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 18
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername3);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                int StudyCount_18 = BasePage.GetSearchResults().Count;
                if (StudyCount_18 == 1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 19
                conferencefolders.SelectStudy("Accession", Accession[3]);
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes3))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 20
                conferencefolders.Btn_EditStudyNotes().Click();
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes3))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.Btn_OkStudyNotes().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.Btn_EditStudyNotes()));

                //step 21
                conferencefolders.ModifyConferenceStudyNotes(studynotes4);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes4))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 22
                conferencefolders.Btn_EditStudyNotes().Click();
                if (conferencefolders.GetConferenceStudyNotes().Equals(studynotes4))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                conferencefolders.Btn_OkStudyNotes().Click();
                wait.Until(ExpectedConditions.ElementToBeClickable(conferencefolders.Btn_EditStudyNotes()));

                //step 23
                conferencefolders.ModifyConferenceStudyNotes(studynotes5);
                conferencefolders.SelectStudy("Accession", Accession[3]);
                if (String.IsNullOrWhiteSpace(whitespace))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 24
                conferencefolders.SelectStudy("Accession", Accession[3]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                login.NavigateToHistoryPanel();
                bool step24_1 = studyViewer.StudyNotesTab().Enabled;
                if (!step24_1)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 25
                studyViewer.CloseStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                conferencefolders.SelectStudy("Description", Description[1]);
                studyViewer = conferencefolders.LaunchStudy(isConferenceTab: true);
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                PageLoadWait.WaitForFrameLoad(10);
                var viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                bool step25 = login.CompareImage(result.steps[Executedsteps], viewport);
                if (step25)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                
                //step 26
                login.NavigateToHistoryPanel();
                bool step26_1 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step26_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes1);
                if (step26_1 && step26_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 27
                //BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");

                studyViewer.SelectStudy("Study Description", Description[2]);
                //studyViewer.SelectStudy("Description", Description[2]);
                bool step27_1 = studyViewer.StudyNotesTab().Displayed;
                studyViewer.StudyNotesTab().Click();
                bool step27_2 = studyViewer.StudyNotesSection().Text.Equals(studynotes2);
                if (step27_1 && step27_2)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 28
                //BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                    studyViewer.SelectStudy("Study Description", Description[0]);
                bool step28 = studyViewer.StudyNotesTab().Enabled;
                if (!step28)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 29
                studyViewer.CloseStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                if (!IsElementPresent(By.CssSelector("#m_resultsSelectorControl_m_selectorList")))
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 30
                conferencefolders = login.Navigate<ConferenceFolders>();
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                conferencefolders.ClickElement(conferencefolders.Btn_ArchiveFolder());
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                bool step30 = BasePage.wait.Until<Boolean>(driver =>
                {
                    if (conferencefolders.Div_Confirmation().FindElement(By.CssSelector("div#ConfirmationDiv>div:nth-of-type(1)>span")).GetAttribute("innerHTML").ToLower().Equals("archive folder"))
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
                if (conferencefolders.Div_Confirmation().Displayed &&
                    conferencefolders.Btn_Cancel_ConfirmationDiv().Displayed &&
                    conferencefolders.Btn_OKConfirmationDiv().Displayed)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 31
                conferencefolders.Btn_OKConfirmationDiv().Click();
                BasePage.wait.Until(ExpectedConditions.InvisibilityOfElementLocated(conferencefolders.Div_ConfirmationBy()));
                conferencefolders.SwitchtoConferenceFrame();
                BasePage.wait.Until<Boolean>(driver => driver.FindElements(By.CssSelector("table#gridTableConferenceStudyRecords tr")).Count == 1);
                IWebElement ele = conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 32
                ele = conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 33
                login.LoginIConnect(TestdomainA, TestdomainA);
                conferencefolders = login.Navigate<ConferenceFolders>();
                ele = conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                if (ele == null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 34
                conferencefolders.NavigateToArchiveMode();
                if (conferencefolders.AddFolderBtn().GetAttribute("style").Contains("opacity: 1") == false && conferencefolders.ManageTopLevelFolders().Enabled == false)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }


                //step 35
                ele = conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                if (ele != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 36
                conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                PageLoadWait.WaitForLoadingDivToAppear_Conference();
                PageLoadWait.WaitForLoadingDivToDisAppear_Conference(30);
                int StudyCount_36 = BasePage.GetSearchResults().Count;
                if (StudyCount_36 == 3)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                        //step 37, 38
                conferencefolders.UndoArchiveFolder(folderpath);
                bool isFolderRemoved = false;
                try { isFolderRemoved = conferencefolders.ExpandAndSelectFolder(folderpath).Text.Equals(subfoldername2); }
                catch (Exception) { isFolderRemoved = false; }
                conferencefolders.NavigateToActiveMode();
                bool isFolderRestored = conferencefolders.ExpandAndSelectFolder(folderpath).Text.Equals(subfoldername2);
                if (!isFolderRemoved && isFolderRestored)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test Step Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                login.Logout();

                //step 39
                login.LoginIConnect(TestuserA2,TestuserA2);
                conferencefolders = login.Navigate<ConferenceFolders>();
                ele = conferencefolders.ExpandAndSelectFolder(topfoldername + "/" + subfoldername1 + "/" + subfoldername2);
                if (ele != null)
                {
                    result.steps[++Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[++Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }

                //step 40
                conferencefolders.SelectStudy("Accession", Accession[0]);
                conferencefolders.LaunchStudy(isConferenceTab: true);
                //conferencefolders.LaunchStudy();
                PageLoadWait.WaitForPageLoad(20);
                PageLoadWait.WaitForFrameLoad(20);
                result.steps[++Executedsteps].SetPath(testid, Executedsteps);
                PageLoadWait.WaitForFrameLoad(10);
                viewport = BasePage.Driver.FindElement(By.Id(Locators.ID.viewer));
                bool step40 = login.CompareImage(result.steps[Executedsteps], viewport);
                if (step40)
                {
                    result.steps[Executedsteps].status = "Pass";
                    Logger.Instance.InfoLog("Test Step Passed--" + result.steps[Executedsteps].description);
                }
                else
                {
                    result.steps[Executedsteps].status = "Fail";
                    Logger.Instance.ErrorLog("Test case Failed--" + result.steps[Executedsteps].description);
                    result.steps[Executedsteps].SetLogs();
                }
                //Logout 
                login.Logout();

                //Report Result
                result.FinalResult(Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, Executedsteps);
                Logger.Instance.ErrorLog("Overall Test status--" + result.status);

                //Logout
                login.Logout();

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Cleanup script to close browser
        /// </summary>
        public void Test_Cleanup()
        {
            login.CloseBrowser();
        }

    }
}
