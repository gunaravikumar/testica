using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using Selenium.Scripts.Pages;
using Selenium.Scripts.Reusable.Generic;
using System.IO;
using OpenQA.Selenium;
using OpenQA.Selenium.Remote;
using OpenQA.Selenium.Interactions;
using OpenQA.Selenium.Internal;
using OpenQA.Selenium.Support.UI;
using Selenium.Scripts.Pages.HoldingPen;
using Selenium.Scripts.Pages.MPAC;
using Selenium.Scripts.Pages.Putty;
using System.Globalization;
using Selenium.Scripts.Pages.iConnect;
using System.Runtime.Serialization;
using System.Diagnostics;
using System.Windows.Forms;
using System.Runtime.InteropServices;
using Accord;
using Selenium.Scripts.Pages.MergeServiceTool;
using TestStack.White.UIItems.TabItems;
using ComboBox = TestStack.White.UIItems.ListBoxItems.ComboBox;
using System.Xml;
using Selenium.Scripts.Pages.eHR;

namespace Selenium.Scripts.Tests
{
    class BasicToolBluRing
    {
        public Login login { get; set; }
        public MpacLogin mpaclogin { get; set; }
        public HPLogin hplogin { get; set; }
        public Configure configure { get; set; }
        public HPHomePage hphomepage { get; set; }
        public string filepath { get; set; }
        public EHR ehr { get; set; }
        public ServiceTool  servicetool {get; set;}
        public BasicToolBluRing(String classname)
        {
            login = new Login();
            login.DriverGoTo(login.url);
            configure = new Configure();
            hphomepage = new HPHomePage();
            filepath = Config.TestSuitePath + Path.DirectorySeparatorChar + classname + ".xls";
        }

        /// <summary>
        /// Pan Tool - Verify the user can pan or reposition the images within a viewport
        /// </summary>
        public TestCaseResult Test_161237(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;            
            int ExecutedSteps = -1;
          
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);                

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1, 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Search                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image.                            
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5, 6, 7
                //Step-5--User able to open tool box
                var step6 = viewer.SelectViewerTool(BluRingTools.Pan);
                ExecutedSteps++;  
                
                //Step-6 -- Verify Tool Tip           
                if(step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                Thread.Sleep(5000);

                //Step-7-- Check cursor type after selecting pan tool                
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("move"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }                
                

                //Step 8 and 9  - Click LMB on viewport and drag cursor and Release the LMB
                viewer.ApplyTool_Pan();                
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Draw Ellipse Tool - Verify the user able to draw an ellipse over the desired region
        /// </summary>
        public TestCaseResult Test_161247(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1,2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Search                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image.             
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);               
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 and 6 and 7 - Select Ellipse tool
                
                //Step-5 - Open Tool Box   
                var step6 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                ExecutedSteps++;

                //Step6 - Validate ToolName and Caption
                if(step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Validate cursor type
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 and 9
                viewer.ApplyTool_DrawEllipse();                
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Invert Tool -Verify the Image grayscale to provide a negative image display
        /// </summary>
        public TestCaseResult Test_161239(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result=null;
            int ExecutedSteps = -1;
            result = new TestCaseResult(stepcount);        
                        
            try
            {
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Login iCA as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;               

                //Step-3 -   Navigate to studies tab             
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step-4 - Load a study
                studies.SearchStudy(patientID: PatientID[0], Datasource: studies.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;
            
                //Step 4, 5 and 6 and 7 -- Select Invert tool
                //Step-5 - Open Tool Box
                var step6 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(1000);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step-6 - Validate ToolName
                if(step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_7 = studies.CompareImage(result.steps[ExecutedSteps],
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Click the invert tool again.
                viewer.SelectViewerTool(BluRingTools.Invert);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_8 = studies.CompareImage(result.steps[ExecutedSteps],
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Apply various tools (W/L, Zoom, Pan, etc.)
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();                
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(5000);             
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps],
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 10 - Apply the invert tool.
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_10 = studies.CompareImage(result.steps[ExecutedSteps],
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Apply various tools (W/L, Zoom, Pan, etc.)
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();                
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(5000);                
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_11 = studies.CompareImage(result.steps[ExecutedSteps],
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 12 - Apply the invert tool.
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_12 = studies.CompareImage(result.steps[ExecutedSteps],
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_12)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Close study and Logout
                viewer.CloseBluRingViewer();
                login.Logout();                

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Free Draw Tool - Verify the user able to draw nonlinear annotations on an image by moving the pointer
        /// </summary>
        public TestCaseResult Test_161248(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            //bool isDefaultTool = false;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Precondition 2  Ensure that the Draw Rectangle tool configured in the Floating Toolbox.
                /*login.LoginIConnect(adminUserName, adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain("");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("edge"))
                {
                    BasePage.Driver.SwitchTo().Window(BasePage.Driver.CurrentWindowHandle);
                    PageLoadWait.WaitForFrameLoad(10);
                }
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var precond2 = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond2.Contains("Free Draw")))
                {
                    isDefaultTool = true;
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Free Draw", group1);
                    domainmanagement.AddToolsToToolbox(dictionary);
                    domainmanagement.SaveButton().Click();
                    Logger.Instance.InfoLog("Draw Rectangle is configured in the ToolBox");
                }
                login.Logout();*/

                //Step 1 and 2 - Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 -  Navigate to Studies Tab   
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step-4 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image. 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5, 6 and 7 - Select Free Draw tool    
                //Step-5                
                var step6 = viewer.SelectInnerViewerTool(BluRingTools.Free_Draw, BluRingTools.Add_Text);
                ExecutedSteps++;

                //Step-6
                if(step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 Free Draw Tool Slected
                ExecutedSteps++;              

                //Step 8 and 9 
                viewer.ApplyTool_FreeDraw();                
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_8 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            /*finally
            {
                if(isDefaultTool)
                {
                    login.LoginIConnect("Administrator", "Administrator");
                    DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                    domainmanagement.SelectDomain("SuperAdminGroup");
                    domainmanagement.ClickEditDomain();
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                    SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                              (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                    Modality.SelectByText("default");
                    Thread.Sleep(1000);
                    IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                    if (revertButton.Enabled)
                        revertButton.Click();
                    domainmanagement.ClickSaveEditDomain();
                    login.Logout();
                }
            }*/
        }

        /// <summary>
        /// ANGLE MEASUREMENT Tool
        /// </summary>
        public TestCaseResult Test_161250(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image.     
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Launch the Study in BluRing viewer
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5, 6-Select Free Draw tool  
                var step6 = viewer.SelectViewerTool(BluRingTools.Angle_Measurement);
                ExecutedSteps++;

                //Step-6
                if(step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Validate cursor stays as cross
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 and 9
                viewer.ApplyTool_AngleMeasurement();
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_8 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Interactive Window Width/level - Verify the user able to adjust an image's window/level
        /// </summary>
        public TestCaseResult Test_161252(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            result = new TestCaseResult(stepcount);
            result.SetTestStepDescription(teststeps);
            BasePage.MultiDriver.Clear();
            BasePage.MultiDriver.Add(BasePage.Driver);
            string BrowserType = Config.BrowserType;
            string[] SupportedBrowsers = Enumerable.Repeat(string.Empty, 2).ToArray();
            BluRingViewer viewer = new BluRingViewer();
            try
            {
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image.     
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Launch the Study in BluRing viewer
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step5, 6-Select Window Level tool  
                var step5 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                ExecutedSteps++;                
                if(step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }            

                //Step-7 - Validate cursor stays as Move
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("pointer"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(
                                BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer), pixelTolerance: 10);
                if (step_9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step 9 and 10
                viewer.ApplyTool_WindowWidth();
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_10 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)), pixelTolerance: 10);
                if (step_10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step11 - Verify the default window level [Width and Length] values from all viewports in all supported browsers 
                viewer.CloseBrowser();
                if(BasePage.SBrowserName.ToLower().Contains("chrome"))
                {
                    SupportedBrowsers[0] = "firefox";
                    SupportedBrowsers[1] = "internet explorer";
                }
                else if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    SupportedBrowsers[0] = "chrome";
                    SupportedBrowsers[1] = "internet explorer";
                }
                else
                {
                    SupportedBrowsers[0] = "chrome";
                    SupportedBrowsers[1] = "firefox";
                }
                //SupportedBrowsers[0]
                Logger.Instance.InfoLog("First Supported Browser is = "+SupportedBrowsers[0]);
                BasePage.MultiDriver.Add(login.InvokeBrowser(SupportedBrowsers[0]));
                //Config.BrowserType = SupportedBrowsers[0];
                login.SetDriver(BasePage.MultiDriver[1]);
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step11_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(
                                BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer), pixelTolerance: 10);
                //SupportedBrowser[1]
                Logger.Instance.InfoLog("Second Supported Browser is = " + SupportedBrowsers[1]);
                BasePage.MultiDriver.Add(login.InvokeBrowser(SupportedBrowsers[1]));
                //Config.BrowserType = SupportedBrowsers[1];
                login.SetDriver(BasePage.MultiDriver[2]);
                login.DriverGoTo(login.url);
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step11_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(
                                BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer), pixelTolerance: 10);
                if (step11_1 && step11_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                BasePage.Driver = BasePage.MultiDriver[0];
                viewer.closeallbrowser();
                Config.BrowserType = BrowserType;
                login.InvokeBrowser(Config.BrowserType);
                login.DriverGoTo(login.url);
            }
        }

        /// <summary>
        /// COBB ANGLE Tool
        /// </summary>
        public TestCaseResult Test_161249(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image.     
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Launch the Study in BluRing viewer
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5, 6-Select cobb angle tool  
                var step6 = viewer.SelectInnerViewerTool(BluRingTools.Cobb_Angle, BluRingTools.Angle_Measurement);
                ExecutedSteps++;
                if(step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }              

                //Step-7 - Validate cursor stays as cross
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 and 9 and 10
                viewer.ApplyTool_CobbAngle();
                ExecutedSteps++;
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_8 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Help Tool - Verify the user shall open the online help system
        /// </summary>
        public TestCaseResult Test_161254(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 and 4 - Launch Study and Hover Help ICon
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step-4 Launch study
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step-5 - Check if Online Help available
                var helpelement = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_HelpTool);
                if (helpelement!= null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6 -- Verify ToolTip
                if(helpelement.GetAttribute("title").Equals("Help"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Select Help tool                
                var help = viewer.OpenOnlineHelp();
                var windows = BasePage.Driver.WindowHandles;
                BasePage.Driver.SwitchTo().Window(windows[1]);
				if(BasePage.Driver.Title.Equals("IBM iConnect Access 7.1 Online Help"))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

                //Close Help Tool
                //BasePage.Driver.Close();
              /*  BasePage.Driver.SwitchTo().Window(windows[0]);
                PageLoadWait.WaitForFrameLoad(20);

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();*/

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                login.CreateNewSesion();
                login.DriverGoTo(login.url);
            }
        }

        /// <summary>
        /// Pixel Value Tool - Verify the pixel value shall appear when user drag the mouse on an image
        /// </summary>
        public TestCaseResult Test_161253(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies Tab
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select a study with multiple series that contain multiple images and click on View 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5, 6, 7 and 8
                //Step-5 - Right click and open rools box & Step-6 - Validate Tool Tip &                 
                var step6 = viewer.SelectViewerTool(BluRingTools.Get_Pixel_Value);
                ExecutedSteps++;
                
                //Step-6 - Validate Tool name and tool tip
                if (step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - validate Cursor Type
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }                

                //Step-8 -- Drag and view the Pixel value
                viewer.ApplyTool_PixelValue();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-9 -- Release Mouse - Pixel value disappears 
                if (BasePage.SBrowserName.ToLower().Contains("firefox") || BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.Release();
                    actions.Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).Release().Build().Perform();
                }                
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9= studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
              

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// SHOW/HIDE Tool- Verify the user able to hide or show the overlay text on an image
        /// </summary>
        public TestCaseResult Test_161246(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies Tab
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select a study with multiple series that contain multiple images and click on View 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5-Verify Show/Hode Tool is present
                var step5 = false;
                IWebElement showhide = null;
                try
                {
                   showhide =  viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_ShowHideTool);
                   step5 = showhide.Displayed;
                }
                catch (Exception)                
                {
                    step5 = false;
                }
                if(step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6-Valiadted in above step                 
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Select Show/Hide Tool                
                viewer.ClickElement(showhide);
                ExecutedSteps++;

                //Step-8-DropDown Menu Displayed                
                var step8 = false;
                var dropdown = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_ShowHideDropdown)).
                Single<IWebElement>(element => element.GetAttribute("innerHTML").Contains("Hide Image Text"));               
                var menuname  = dropdown.GetAttribute("innerHTML").Trim();
                step8 = menuname.ToLower().Equals("hide image text");
                if (step8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step9
                IList<IWebElement> showHideDropdown = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_ShowHideDropdown));
                bool step9 = true;
                foreach (IWebElement element in showHideDropdown)
                {
                    string title = element.GetAttribute("title");
                    if (!string.IsNullOrEmpty(title))
                    {
                        step9 = false;
                        break;
                    }
                }
                if (step9)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10 - Select Hide Image Text
                viewer.ClickElement(dropdown);                
                Thread.Sleep(Config.ms_medTimeout);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_10 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step_10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				//Step-11 - Select a prior
				viewer.OpenPriors(0);
				if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step-12 - Click on 'Show/Hide' tool and select ''Show Image Text'' from the dropdown menu				
				bool step12 = viewer.SelectShowHideValue("Show Image Text");
				Thread.Sleep(Config.minTimeout);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 110);
                bool step12_1 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_compositeViewer)));
				result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 111);
				bool step12_2 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer)));
				if (step12 && step12_1 && step12_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				//Step-13 - Click on 'Show/Hide' tool and select 'Hide Image Text' from the dropdown menu				
				bool step13 = viewer.SelectShowHideValue("Hide Image Text");
				Thread.Sleep(Config.minTimeout);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 119);
                bool step13_1 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_compositeViewer)));
				result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps +120 );
				bool step13_2 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer)));
				if (step13 && step13_1)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				//Step-14 - Again click on 'Show/Hide' tool and select 'Show Image Text' option from the 'Show/Hide' dropdown menu				
				bool step14 = viewer.SelectShowHideValue("Show Image Text");
				Thread.Sleep(Config.minTimeout);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 128);
                bool step14_1 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer)));
				result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 129);
				bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_compositeViewer)));
				if (step14 && step14_1 && step14_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				//Step-15 -- Draw Ellipse					
				viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
				viewer.ApplyTool_DrawEllipse();				
				bool step15 = viewer.SelectShowHideValue("Hide Image Text");
				Thread.Sleep(Config.minTimeout);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step15_1 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step15 && step15_1)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-16 Load a study with related study and perform the same to select 'Show/Hide' tool on or off with different forms of layout as well as with annotations on.
                viewer.SelectShowHideValue("Show Image Text");
                viewer.ChangeViewerLayout("2x3");
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement();
                viewer.SelectShowHideValue("Hide Image Text");
                Thread.Sleep(Config.minTimeout);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step16= studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if(step16)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Stacked tool shall opens vertically
        /// </summary>
        public TestCaseResult Test_161265(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies Tab
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select a study with multiple series that contain multiple images and click on View 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Setp-5 - Open Viewer Tools //Step-6 -- Open Stacked tools
                var step6 = viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse);              
                ExecutedSteps++;
                if(step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Open prioris
                viewer.OpenPriors(0);
                viewer.SetViewPort(0, 2);
                ExecutedSteps++;

                //Step-8 - Open stacked tool in another study panel
                var step8 = viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse, panel:2);
                if (step8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Orientation tools - Verify the user able to rotate and flip the selected image
        /// </summary>
        public TestCaseResult Test_161243(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
                String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies Tab
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select a study with multiple series that contain multiple images and click on View 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_4 = viewer.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5 - Open viewer toolbox
                viewer.OpenViewerToolsPOPUp();
                ExecutedSteps++;

                //Step-6 Click on orientation tool
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.ContextClickUsingJS(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.GetToolCss(BluRingTools.Flip_Horizontal)));
                }
                else
                {
                    new Actions(BasePage.Driver).ContextClick(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.GetToolCss(BluRingTools.Flip_Horizontal))).Build().Perform();
                }
                BasePage.wait.Until<Boolean>((d) =>
                {
                   By tool1 = By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Flip_Vertical));
                   By tool2 = By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Rotate_Clockwise));
                   By tool3 = By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Rotate_Counterclockwise));
                   By tool4 = By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Flip_Horizontal));

                  if (d.FindElement(tool1)!=null && d.FindElement(tool2)!=null && d.FindElement(tool3)!=null && d.FindElement(tool4)!=null)
                  {
                        return true;
                  }
                  else
                  {
                        return false;      
                  }
                });
                ExecutedSteps++;

                //Step-7 - Line Measurement applied
                //viewer.OpenViewerToolsPOPUp();  
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                    viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                }
                else
                {
                    try
                    {
                        viewer.SelectViewerTool(BluRingTools.Line_Measurement, isOpenToolsPOPup: false);
                    }
                    catch (Exception)
                    {
                        new SimulateAction(BasePage.Driver).ContextClick(viewer.Activeviewport);
                        viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                    }
                }
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                viewer.ApplyTool_LineMeasurement(ele.Size.Width / 3, ele.Size.Height / 3, ele.Size.Width / 5, ele.Size.Height / 5);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_7 = viewer.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-8  - Verify tool tip
                var step8 = viewer.ApplyTool_RotateClockwise();                
                if(step8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9 - Verify Orientation marker
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), totalImageCount: 4, IsFinal: 1);

                if(step_9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-10
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if(step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-11
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step-12 and 13
                var step12 = viewer.SelectInnerViewerTool(BluRingTools.Rotate_Counterclockwise, BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                if (step12)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }



                //step-14 and 15
                bool step14 = false;
                bool step15 = true;
                try
                {
                    //step14 = viewer.SelectInnerViewerTool(BluRingTools.Flip_Horizontal, BluRingTools.Rotate_Counterclockwise);
                    step14 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                    Thread.Sleep(1000);
                }
                catch (Exception) { step14 = false; step15 = false; }
                if(step14)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                if (step15)
                step15 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step15)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //step-16 and 17
                bool step16 = false;
                bool step17 = true;
                try
                {
                    step16 = viewer.SelectInnerViewerTool(BluRingTools.Flip_Vertical, BluRingTools.Flip_Horizontal);
                    Thread.Sleep(1000);
                }
                catch (Exception) { step16 = false; step17 = false; }
                if (step16)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                step17 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step17)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the date in view port section
        /// </summary>
        public TestCaseResult Test_136302(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String Date = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Date");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');
                String[] date = Date.Split('/');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies Tab
                var studies = (Studies)login.Navigate("Studies");

                //Search and select a study
                studies.SearchStudy(patientID: PatientID[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 4 -  Verify the date in Exam List panel
                DateTime dt = new DateTime(Int32.Parse(date[2]), Int32.Parse(date[0]), Int32.Parse(date[1]));
                String FormattedDate = String.Format("{0:dd-MMM-yyyy}", dt);
                if (FormattedDate.Equals(viewer.GetElementAttribute("cssselector", BluRingViewer.div_examListPanelDate, "innerHTML")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 5 -  Verify the date in view port                
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the Border/outline around the expanded stacked tools and Cursor type
        /// </summary>
        public TestCaseResult Test_161278(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1,2 - Launch application and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study in bluRing Viewer
                studies.SearchStudy(patientID: PatientID[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 & Step 6 - Open toolbox and Select stacked tool            
                IWebElement StackedTool = viewer.OpenStackedTool(BluRingTools.Draw_Ellipse);
                ExecutedSteps ++;

                // Validate stacked tool is opened 
                if (StackedTool != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 - Cursor is not available on Stacked toolbox when open it through scripts. So couldn't get the cursor type.                
                result.steps[++ExecutedSteps].status = "Not Automated";

                // Step 8 Verify Border/outline around the expanded stacked tools 
                if (viewer.VerifyStackedToolBorder())
                {
					result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);                   
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Draw Ellipse - Verify the area units of 'Draw Ellipse' measurement on the selected image
        /// </summary>
        public TestCaseResult Test_161258(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                // Step 1 - Launch the iCA application with a client browser
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a non-calibrated data which has multiple images in one series 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 and 7  - Open Tool Box and Select Draw tool 
                var step6_1 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false);
                ExecutedSteps++;

                //Validate ToolName, Caption and cursor
                bool step6_2 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step6_1 && step6_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8, Step 9 and Step 10 - Draw Ellipse and verify the Area units
                viewer.ApplyTool_DrawEllipse();
                ExecutedSteps += 2;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 11 - Open Tool Box and Select Calibrate tool                      
                var step11_1 = viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement);

                // Validate ToolName, cursor and Caption
                bool step11_2 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step11_1 && step11_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 12, Step 13, Step 14 & Step 15- Apply calibration and verify Ellipse area units
                viewer.ApplyTool_Calibration(10);
                ExecutedSteps += 3;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_14 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_14)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        // <summary>
        /// Line Measurement - Verify the units of 'Line measurement' on the selected image
        /// </summary>
        public TestCaseResult Test_161259(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                // Step 1 - Launch the iCA application with a client browser
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a non-calibrated data which has multiple images in one series 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 & Step 7  - Open Tool Box and Select Draw tool   
                var step7_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement, isOpenToolsPOPup: false);
                ExecutedSteps++;

                // Validate ToolName, Caption and cursor                
                bool step7_2 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step7_1 && step7_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8, Step 9 and Step 10 - Draw Line Measurement and verify the units
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                viewer.Draw_LineMeasurement((ele.Size.Width / 2) - 25, (ele.Size.Height / 2) - 25, ele.Size.Width / 4, ele.Size.Height / 4);
                ExecutedSteps += 2;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                // Step 11 - Open Tool Box and Select Calibrate                 
                var step11_1 = viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement);

                // Validate ToolName, Caption and cursor
                bool step11_2 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step11_1 && step11_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 12, Step 13, Step 14 & Step 15- Apply calibration and enter the value as 100mm and verify Line meaurement unit                
                viewer.ApplyTool_Calibration(100);
                ExecutedSteps += 3;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step14)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

	///  <summary>
        /// Line Measurement Tool- Verify the user shall able to draw the line measurement on an image
        ///  <summary>
        public TestCaseResult Test_161251(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Select a study with multiple series that contain multiple images and click on View (button name TBD?)                
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Select Line Measurement tool 
                var step6 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                ExecutedSteps++;

                //Step-6 - Verify when cursor is hover the Measurement tool, the tool tip for Measurement tool is displayed as 'Line Measurement'
                if (step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Validate cursor stays as cross
                if (BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 and 9 - Draw a line from one point to another point
                viewer.Draw_LineMeasurement();
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the Border/outline displayed around the entire toolbox
        /// </summary>
        public TestCaseResult Test_161280(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select a study and open study in bluering viewer
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                ExecutedSteps++;

                // Step 6 - Verify the Border/Outline should be displayed around the entire toolbox                
                bool step6 = viewer.verifyBackgroundColor(viewer.GetElement("cssselector", BluRingViewer.div_Toolbox), "rgba(42, 42, 42, 1)");                
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6 && step_6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
		
		/// <summary>
        /// Verify "X" icon on the top right corner of the "Study" panel
        /// </summary>
        public TestCaseResult Test_161273(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1, 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Search and select study and click "BluRing View" button                
                var studies = (Studies)login.Navigate("Studies");                           
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // step -4 Single click the study info area under Results list to open up the prior study in the viewer.
                viewer.OpenPriors(0);
                Thread.Sleep(10000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")));
                if (step4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-5: Click on "X" icon of the 'Study' panel.
                viewer.CloseStudypanel(2);
                PageLoadWait.WaitForFrameLoad(10);
                if (!viewer.IsElementPresent(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_closestudypanel)))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

        }

        /// <summary>
        /// Delete Annotation
        /// </summary>
        public TestCaseResult Test_161241(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String[] Accession = AccessionList.Split(':');
            String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
            String[] PatientID = PatientIDList.Split(':');

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                // Pre-Condition - Draw an annotation and creating PR image
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.ClickSaveNewDomain();
                domain.SearchDomain(domain1);
                domain.SelectDomain(domain1);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                new UserManagement().CreateUser(rad1, domain1, role1);
                login.Logout();

                login.LoginIConnect(rad1, rad1);
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, isOpenToolsPOPup: true);
                IWebElement element1 = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width1 = element1.Size.Width;
                int height1 = element1.Size.Height;
                viewer.ApplyTool_LineMeasurement(width1 / 4, height1 / 3, width1 / 2, height1 / 3);
                viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text);
                viewer.CloseBluRingViewer();
                login.Logout();

                //Step 1 and 2 - Launch and Login as Administrator
                login.LoginIConnect(rad1, rad1);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Select any study with PR and click on View Exam button.
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.OpenViewerToolsPOPUp(width / 2 + width / 10, height / 2 + height / 10);
                viewer.SelectViewerTool(BluRingTools.Angle_Measurement, isOpenToolsPOPup: false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                Actions action = new Actions(BasePage.Driver);
                if (BasePage.SBrowserName.Contains("firefox"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width / 4, height / 3).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(element, width / 4, height / 3).Release().Build().Perform();
                    new Actions(BasePage.Driver).MoveToElement(element, width / 4, height / 3).Release().Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step7 - Click the Right Mouse Button on a drawn measurement.                                
                if (BasePage.SBrowserName.Contains("firefox"))
                {
                    var actions = new TestCompleteAction();
                    actions.ContextClick().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.ContextClick().Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step8 - Select any series viewport and draw any measurement 
                viewer.OpenViewerToolsPOPUp(width / 2 + width / 10, height / 2 + height / 10);
                viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false);
                viewer.ApplyTool_DrawEllipse(0, height / 2, width / 4, height / 4);

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step9 - Hover on an drawn annotation, the annotation lights up
                if (BasePage.SBrowserName.Contains("firefox"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, 0, height / 4).Release().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, height / 4).Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step10 - Click the Right Mouse Button on a drawn measurement.
                if (BasePage.SBrowserName.Contains("firefox"))
                {
                    var actions = new TestCompleteAction();
                    actions.ContextClick().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.ContextClick().Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //step11 - Draw few more measurements and delete each measurement and then verify the drawn measurements should be deleted
                viewer.OpenViewerToolsPOPUp(width / 2 + width / 10, height / 2 + height / 10);
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, isOpenToolsPOPup: false);
                viewer.ApplyTool_LineMeasurement(0, height / 2, width / 4, height / 2);
                if (BasePage.SBrowserName.Contains("firefox"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, 0, height / 2).Release();
                    actions.ContextClick().Perform();

                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.MoveToElement(element, 0, height / 2).Click().Build().Perform();
                    action.ContextClick().Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("PatientID", PatientID[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeletePaticularModality("PR");

                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }

        /// <summary>
        /// Performed tools shall retain when the user pulls another series from thumbnails
        /// </summary>
        public TestCaseResult Test_161271(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                
                //Step 1,2 - Launch and Login as Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Select a study with multiple series and then load in BlueRing viewer
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step-5 - Open the toolbox in first view port and selecting the Line Measurement tool
                viewer.SetViewPort(0, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Click().Perform();
                }
                var step_5 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                if (step_5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6 - Drawing line measurement and verifying drawed line
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_6 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                if (step_6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Double click on any other series and verify the active viewport updated with this series
                IWebElement element = (BasePage.Driver).FindElement(By.CssSelector("div.thumbnails div:nth-of-type(3) div[class*='thumbnailInnerDiv']"));
                if (BasePage.SBrowserName.ToLower().Equals("firefox"))
                {
                    TestCompleteAction action = new TestCompleteAction();
                    action.DoubleClick(element).Perform();
                }
                else if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(element).DoubleClick().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).DoubleClick(element).Build().Perform();
                }
                BluRingViewer.WaitforViewports();
				PageLoadWait.WaitForFrameLoad(40);
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_7 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                if (step_7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step-8 - Draw a measurement on newly selected series
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_8 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                if (step_8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step9 - Drag a series thumbnail from thumbnail bar or thumbnail preview and drop it to any viewport
                viewer.SetViewPort(1, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Click().Perform();
                }
                else
                {
                    BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).Click();
                }
                Thread.Sleep(2000);
                element = (BasePage.Driver).FindElement(By.CssSelector("div.thumbnails div:nth-of-type(4) div[class*='thumbnailInnerDiv']"));
                if(BasePage.SBrowserName.ToLower().Equals("firefox"))
                {
                    TestCompleteAction action = new TestCompleteAction();
                    action.DoubleClick(element).Perform();                   
                }
                else if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(element).DoubleClick().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).DoubleClick(element).Build().Perform();
                }
                BluRingViewer.WaitforViewports();
                PageLoadWait.WaitForFrameLoad(40);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step10 - Verify the tool selected in step5 should be worked on the newly selected series in the current active viewport which is droped series thumbnail from the thumbnail
                Thread.Sleep(2000);
                viewer.ApplyTool_LineMeasurement();
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step11 - Single click the study info area under Results list to open up the study in the viewer
                viewer.OpenPriors(0);
                ExecutedSteps++;

                //Step12 - Repeat the step from 5 to 10 in the newly opened study panel and verify the selected viewport and other remaining view ports
                viewer.SetViewPort(0, 2);
				if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Click().Perform();
                }
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, 2, 1);
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step12_1 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                IList<IWebElement> StudyPanels = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_StudyPanel));
                element = StudyPanels[1].FindElement(By.CssSelector("div.thumbnails div:nth-of-type(3) div[class*='thumbnailInnerDiv']"));
                if (BasePage.SBrowserName.ToLower().Equals("firefox"))
                {
                    TestCompleteAction action = new TestCompleteAction();
                    action.DoubleClick(element).Perform();
                }
                else if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(element).DoubleClick().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).DoubleClick(element).Build().Perform();
                }
                BluRingViewer.WaitforViewports();
                PageLoadWait.WaitForFrameLoad(40);               
                viewer.ApplyTool_LineMeasurement();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step12_2 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)));
                if (step12_1 && step12_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Closing delays for opened toolbox shall be 500ms
        /// </summary>
        public TestCaseResult Test_161267(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1,2 - Launch application and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load study 
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 & 6 - Open tool box and Select Line Meaurement tool from toolbox
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                Thread.Sleep(500);

                // Validate toolbox 
                var step6 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolsSetContainer));
                ExecutedSteps += 2;

                if (!step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 Open study again
                viewer.OpenPriors(0);               
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step12 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_viewport)));
                if (step12)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.SetViewPort(0, 2);

                //Step 8 - Repeat step 5 & step 6  
                //viewer.SelectViewerToolSeqPanel(2, BluRingTools.Line_Measurement);
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, 2, 1);
                Thread.Sleep(500);
                var step8 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2)));
                ExecutedSteps++;

                // Validate toolbox 
                if (!step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the floating toolbox shall not resized when user opened the Stacked tool
        /// </summary>
        public TestCaseResult Test_161272(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1,2 - Launch application and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study in BluRing Viewer
                studies.SearchStudy(patientID: PatientID[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Open Tool Box 
                viewer.OpenViewerToolsPOPUp();

                // Get Height and Width of the toolbox
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
                int width = element.Size.Width;
                int height = element.Size.Height;

                // Validate toolbox is opened
                if (width > 0 && height > 0)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6 - Open stacked tool and verify toolbox size
                if (viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, false) != null)
                {
                    IWebElement element1 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));                   
                    if ((width == element1.Size.Width) && (height == element1.Size.Height))
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
		
		/// <summary>
        /// Floating toolbox  Get dimmed when user open the stacked tool from the floating toolbox
        /// </summary>
        public TestCaseResult Test_161277(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                // Step 1 - Launch the iCA application with a client browser
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Navigate to Search and Load a study with multiple series that contain multiple images       
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 4 - Click Right Mouse Button on view port
                viewer.OpenViewerToolsPOPUp();
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolboxComponent));
                string Toolboxstyle = element.GetCssValue("background-color");
                bool step5 = viewer.verifyBackgroundColor(element, "rgba(42, 42, 42, 1)");                
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6- Click and hold  stacked tool from the floating toolbox
                var step6 = viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, false, false);
                Thread.Sleep(2000);
                if (step6 !=null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step-7 Verify the Floating Toolbox should get dimmed  
                IWebElement ele = viewer.GetElement("cssselector", BluRingViewer.div_viewportToolboxComponent);                
                bool step7 = element.GetCssValue("background-color").Equals("rgba(42, 42, 42, 0.2)");
                if (step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Calibration Tool
        /// </summary>
        public TestCaseResult Test_161240(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String PatientId = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] Accession = AccessionList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 -  Load non calibrated data with multiple images in one series
                studies.SearchStudy(patientID: PatientId);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 5 Select Line Measurement tool 
                var step5 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6  - Draw a line measurement 
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = ele.Size.Width;
                int height = ele.Size.Height;
                viewer.ApplyTool_LineMeasurement((width / 2) - 25, (height / 2) - 25, width / 4, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7, 8, 9 Select Calibration tool from toolbox and verify the cursor type                
                var step8 = viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement);

                // Verify the cursor type
                bool step9 = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).GetCssValue("cursor").Equals("crosshair");
                if (step8 && step9)
                {
                    ExecutedSteps += 3;
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    ExecutedSteps += 3;
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step- 10 Draw Calibration                               
                viewer.ApplyTool_Calibration(100, 0, (height / 2), (height / 3), (width / 3));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step - 11 Select Calibration and draw it again but Cancel it by pressing Esc key           
                viewer.ApplyTool_Calibration(50, (width / 2) - 5, (height / 2) - 5, (width / 3), height / 3, false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 12 - Scroll through the series the calibrated image belongs and verify all the images.
                var Actions = new TestCompleteAction();
                Actions.MouseScroll(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), "down").Perform(); ;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step12 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if(step12)                    
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 13 - Draw a calibration line with the same length as the previous calibration line, but enter a new value for its length (e.g.50) and hit enter	
                Actions = new TestCompleteAction();
                Actions.MouseScroll(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), "up").Perform();
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    viewer.ApplyTool_Calibration(50, 0, (height / 4), (width / 8), (height / 4));
                else
                    viewer.ApplyTool_Calibration(50, (width / 4), (height / 3), (height / 3), (width / 4));
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step - 14 Select and Draw Ellipse measurement.
                bool step14_1 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                if (step14_1)
                {
                    viewer.ApplyTool_DrawEllipse();
                    result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                    bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                    if (step14_2)
                    {
                        result.steps[ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }                

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the user performing any Tool action in active viewport shall not affect the another series viewport
        /// </summary>
        public TestCaseResult Test_161270(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] PatientID = PatientIDList.Split(':');
                String[] Accession = AccessionList.Split(':');

                //Step 1,2 - Launch application and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps += 2;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study in BluRing Viewer
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(40);
                ExecutedSteps++;

                // Viewport 1
                //  Step 5 & 6 - Open Tool Box and Select "Pan" tool
                var step6 = viewer.SelectViewerTool(BluRingTools.Pan, 1, 1);
                ExecutedSteps++;
                if (step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Click Left Mouse Button on viewport1 and drag cursor and Release the Left Mouse Button 
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Move to Viewport 2
                viewer.SetViewPort(1, 1);

                //Step 8 - Open Tool Box and Select "WW/WL" tool        
                var step8 = viewer.SelectViewerTool(BluRingTools.Window_Level, 1, 2);
                if (step8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Click Left Mouse Button on viewport2 and drag cursor and Release the Left Mouse Button 
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Move to Viewport 3
                viewer.SetViewPort(2, 1);

                //Step 10 - Open Tool Box and Select "Magnifier" tool                
                var step10 = viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom, panel: 1, viewport: 3);
                if (step10)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 11 - Click Left Mouse Button on viewport3 and drag cursor and Release the Left Mouse Button 
                Thread.Sleep(2000);
                viewer.ApplyTool_Magnifier(false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Move to Viewport 4
                viewer.SetViewPort(3, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Perform();
                }
                //Step 12 - Open Tool Box and Select "Line measurement" tool
                var step12 = viewer.SelectViewerTool(BluRingTools.Line_Measurement, 1, 4);
                if (step12)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 13 - Click Left Mouse Button on viewport4 and drag cursor and Release the Left Mouse Button 
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    var actions = new TestCompleteAction();
                    actions.ClickAndHold(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Perform();
                    Thread.Sleep(3000);
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 4, attributes["height"] / 4).Release().Perform();
                    Thread.Sleep(3000);
                }
                else
                {
                    viewer.ApplyTool_LineMeasurement();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel));
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step14 - Single click the study info area under Results list to open up the study in the viewer
                viewer.OpenPriors(0);
                ExecutedSteps++;

                //Step15 - Repeat the step from 5 to 13 in the newly opened study panel and verify the selected viewport and other remaining viewports
                viewer.SetViewPort(0, 2);
                viewer.SelectViewerTool(BluRingTools.Pan, 2, 1);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step15_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                viewer.SetViewPort(1, 2);
                viewer.SelectViewerTool(BluRingTools.Window_Level, 2, 2);
                viewer.ApplyTool_WindowWidth();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step15_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                viewer.SetViewPort(2, 2);
                viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom, panel: 2, viewport: 3);
                Thread.Sleep(2000);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    var actions = new TestCompleteAction();
                    actions.ClickAndHold(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Perform();
                    Thread.Sleep(3000);
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 4, attributes["height"] / 4).Perform();
                    Thread.Sleep(3000);
                }
                else
                {
                    viewer.ApplyTool_Magnifier(false);
                }
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step15_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                viewer.SetViewPort(3, 2);
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, 2, 4);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    var actions = new TestCompleteAction();
                    actions.ClickAndHold(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Perform();
                    Thread.Sleep(3000);
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 4, attributes["height"] / 4).Release().Perform();
                    Thread.Sleep(3000);
                }
                else
                {
                    viewer.ApplyTool_LineMeasurement();
                }
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step15_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                if (step15_1 && step15_2 && step15_3 && step15_4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///Floating toolbox shall dismiss/close
        /// </summary>
        public TestCaseResult Test_161262(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1,2 - Launch application and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study
                studies.SearchStudy(patientID: PatientID[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Open toolbox
                bool Step5 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.OpenViewerToolsPOPUp(js: false);
                    Step5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss()));
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                    Step5 = viewer.IsElementVisible((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                }

                // Validate toolbox is opened 
                if (Step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 6 - Move cursor away from the selected viewport
                bool step6 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnailcontainer));
                    Thread.Sleep(1000);
                    step6 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss()));
                }
                else
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnails));
                    Thread.Sleep(1000);
                    step6 = viewer.IsElementVisible((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                }
                if (!step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 Open study again
                viewer.OpenPriors(0);
                bool step7 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    step7 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                }
                else
                {
                    step7 = viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_viewport));
                }
                // Validate new study is opened 

                if (step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.SetViewPort(0, 2);

                //Step 8 - Repeat step 5 & step 6  
                bool Step8 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.OpenViewerToolsPOPUp(js: false);
                    Step8 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2)));
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                    Step8 = viewer.IsElementVisible(By.CssSelector(viewer.GetToolBoxCss(2)));
                }
                if (Step8)
                {
                    // Move cursor away from the selected viewport
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnailcontainer));
                    Thread.Sleep(1000);

                    // Validate toolbox 
                    bool step8 = false;
                    if (BasePage.SBrowserName.ToLower().Contains("edge"))
                    {
                        step8 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2)));
                    }
                    else
                    {
                        step8 = viewer.IsElementVisible(By.CssSelector(viewer.GetToolBoxCss(2)));
                    }
                    if (!step8)
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
		
		/// <summary>
        /// Verify the Exam List dropdown boxes shall expanded automatically when 'Modality' and 'Site' filters text values with a long size
        /// </summary>
        public TestCaseResult Test_136455(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String TestValues = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Test Values");
                String[] Accession = AccessionList.Split(':');
                String[] Values = TestValues.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - 	Search for the study which have long text for site, select the study and then click on 'BluRing View' button.
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Select the value from 'Site' drop down.                          
                String site2OptionsText = viewer.GetText("cssselector", BluRingViewer.select_Siteoption);
                viewer.SelectFromList(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.select_Site)), site2OptionsText);
                String siteDropdownValue = viewer.GetText("cssselector", BluRingViewer.select_Site);
                if (siteDropdownValue.EndsWith("." + "." + "."))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6 - Verifying the site tooltip
                String siteTooltip = viewer.GetElementAttribute("cssselector", BluRingViewer.div_site, "title");               
                if (siteTooltip.Equals(site2OptionsText))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step  7, 8 - Verifing the modality dropdown values
                String[] modality = viewer.GetValuesfromDropDown("cssselector", BluRingViewer.select_Modality);
                String modality1Tooltip = viewer.GetElementAttribute("cssselector", BluRingViewer.select_Modality+ " option:nth-of-type(1)", "title");
                String modality2Tooltip = viewer.GetElementAttribute("cssselector", BluRingViewer.select_Modality + " option:nth-of-type(2)", "title");
                ExecutedSteps++;           
                if ((modality.Contains(modality1Tooltip) && (modality.Contains(modality2Tooltip))))
                {
                    if (modality1Tooltip.Equals(Values[0]) && modality2Tooltip.Equals(Values[1]))
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                else
                {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }                

                // Step 9-Click on "Sort By" drop down.
                String[] sortby  = viewer.GetValuesfromDropDown("cssselector", BluRingViewer.select_sortby);                
                if ((sortby[0].Equals(Values[2]) && (sortby[1].Equals(Values[3]) && (sortby[2].Equals(Values[4])))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step10 - Verify the Ellipses '...' should not be displayed in the "Sort By" field when the user selects the "Sort By" drop down.
                String sortbyToolTip = viewer.GetElementAttribute("cssselector", BluRingViewer.select_sortby, "value");               
                if (sortbyToolTip.Equals(Values[2]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 11, 12 - Get ToolTip and comparing it with actual
                String newest = viewer.GetElementAttribute("cssselector", BluRingViewer.select_sortby + " option:nth-of-type(1)", "title");
                String oldest = viewer.GetElementAttribute("cssselector", BluRingViewer.select_sortby + " option:nth-of-type(2)", "title");
                String modalityType = viewer.GetElementAttribute("cssselector", BluRingViewer.select_sortby + " option:nth-of-type(3)", "title");
                ExecutedSteps++;
                if (newest.Equals(Values[2]) && oldest.Equals(Values[3]) && modalityType.Equals(Values[4]))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
		
		/// <summary>
        /// Caliper Measurement color - Verify the caliper measurement color shall displayed as 'white'
        /// </summary>
        public TestCaseResult Test_161260(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;                
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');                

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load study and click on View button.
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

				// Step 5, 6 - Verifying caliper measurement colour displayed as white                 
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 - open another study panel
                viewer.OpenPriors(0);
                bool Step7 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    Step7 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                }
                else
                {
                    Step7 = viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                }
                if (Step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				//Step 8 - Verify the caliper measurement is displayed in a new study panel.				
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2,0)));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step - 9 - verify caliper measurement is displayed as white in third study panel
                viewer.OpenPriors(0);
                bool Step9 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    Step9 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(3)"));
                }
                else
                {
                    Step9 = viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(3)"));
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(3, 0)));
                if (Step9 && step9_1)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Edit Annotation
        /// </summary>
        public TestCaseResult Test_161242(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1,2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select any study  and click on View Exam button
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;


                //step4 - Select any series viewport and draw any measurement.
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width_1 = element.Size.Width;
                int height_1 = element.Size.Height;
                viewer.OpenViewerToolsPOPUp();
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, isOpenToolsPOPup: false);
                viewer.ApplyTool_LineMeasurement(0, height_1 / 2, width_1 / 4, height_1 / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step5 - Hover on an drawn annotation, the annotation lights up.    
                Actions action = new Actions(BasePage.Driver);
                if (BasePage.SBrowserName.Contains("firefox") || BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width_1 / 5, height_1 / 2).Release().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width_1 / 5, height_1 / 2).Build().Perform();
                }

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //step6 - Click and hold Left Mouse Button on a drawn annotation, drag it to another location, and then release the Left Mouse Button.
                if (BasePage.SBrowserName.Contains("firefox") || BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.ClickAndHold();
                    actions.MoveToElement(element, width_1 / 5, height_1 / 3).Release().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.ClickAndHold().Build().Perform();
                    action.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width_1 / 5, height_1 / 3).Release().Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step7 - Perform Pan/Window Level operation on viewport.                
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step8 - Single click the study info area under Results list to open up the study in the viewer.
                viewer.OpenPriors(0);
                bool step8 = viewer.GetStudyPanelCount().Equals(2);
                if (step8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //step9 - Hover on an drawn annotation, the annotation lights up.
                viewer.SetViewPort(0, 2);
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width_1 = element.Size.Width;
                height_1 = element.Size.Height;
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, 2, 1);
                viewer.ApplyTool_LineMeasurement(0, height_1 / 2, width_1 / 4, height_1 / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step9_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)));
                if (BasePage.SBrowserName.Contains("firefox") || BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width_1 / 6, height_1 / 2).Release().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width_1 / 6, height_1 / 2).Build().Perform();
                }
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)));
                if (step9_1 && step9_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step10 - Draw few more measurements.
                viewer.SetViewPort(0, 2);
                viewer.SelectViewerTool(BluRingTools.Line_Measurement, 2, 1);
                viewer.ApplyTool_LineMeasurement(0, height_1 / 4, width_1 / 2, height_1 / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step11 and step12 - Click and hold Left Mouse Button on a measurement, and drag it to another location on viewport.                
                if (BasePage.SBrowserName.Contains("firefox") || BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width_1 / 4, height_1 / 4).Release();
                    actions.ClickAndHold();
                    actions.MoveToElement(element, 0, height_1 / 6).Release().Perform();
                }
                else
                {
                    action = new Actions(BasePage.Driver);
                    action.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width_1 / 4, height_1 / 4).Build().Perform();
                    action.ClickAndHold();
                    action.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, height_1 / 6).Release().Build().Perform();
                }                
                result.steps[ExecutedSteps += 2].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Transition Animation - fast fade/fade out applies on the viewports' toolboxes
        /// </summary>
        public TestCaseResult Test_161257(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1,2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Studies tab                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search for a study and load in BlueRing viewer            
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step-5 - Opening the related study in another panel
                viewer.OpenPriors(0);
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6 - Open the toolbox in second view port and then verify toolbox is opened or not
                viewer.SetViewPort(0, 2);
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Select a tool               
                bool step7 = viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement, false, panel:2, viewport:1);
                if (step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                Thread.Sleep(500);

                //Step-8 - verifying the toolbox is fade out
                if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-9 - Open the toolbox in second view port again and then verify toolbox is opened or not
                viewer.SetViewPort(0, 2);
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //Step-10 -  Move mouse away from the Toolbox
                viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnailcontainer));
                Thread.Sleep(1000);
                ExecutedSteps++;

                //Step-11 - verifying the toolbox is fade out without selecting tool
                if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-12,13 - Open stacked tool and Select the innertool
                bool step13 = viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse, panel: 2);
                Thread.Sleep(500);
                ExecutedSteps++;
                if (step13)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-14 - verifying the toolbox is fade out after selecting a stacked tool
                if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step-15 and 16 - Open the related study for third study panel and verify the toolbox fadeout without any delay in all view ports
                viewer.OpenPriors(0);
                viewer.SetViewPort(0, 3);
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(3))))
                {
                    viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement, false, panel:3, viewport:1);
                    Thread.Sleep(500);
                    if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(3))))
                    {
                        viewer.OpenViewerToolsPOPUp();
                        if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(3))))
                        {
                            viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnailcontainer));
                            Thread.Sleep(1000);
                            if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(3))))
                            {
                                viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse, panel: 3);
                                Thread.Sleep(1000);
                                if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(3))))
                                {
                                    ExecutedSteps++;
                                    result.steps[++ExecutedSteps].status = "Pass";
                                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                                }
                                else
                                {
                                    ExecutedSteps++;
                                    result.steps[++ExecutedSteps].status = "Fail";
                                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                                    result.steps[ExecutedSteps].SetLogs();
                                }

                            }
                            else
                            {
                                ExecutedSteps++;
                                result.steps[++ExecutedSteps].status = "Fail";
                                Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                                result.steps[ExecutedSteps].SetLogs();
                            }
                        }
                        else
                        {
                            ExecutedSteps++;
                            result.steps[++ExecutedSteps].status = "Fail";
                            Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                            result.steps[ExecutedSteps].SetLogs();
                        }

                    }
                    else
                    {
                        ExecutedSteps++;
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    ExecutedSteps++;
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Multiple toolboxes shall not get open
        /// </summary>
        public TestCaseResult Test_161281(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1,2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Search                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study with multiple series that contain multiple images           
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step-5 - Open the toolbox in first view port
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp(js: false);
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                }
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1,1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6 - Open the toolbox in second view port
                viewer.SetViewPort(1, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp(js: false);
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                }
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1, 2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-7 - Verify toolbox dismiss in first viewport
                Thread.Sleep(1000);                
                if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1, 1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step8 - Single click the study info area under Results list to open up the study in the viewer
                viewer.OpenPriors(0);
                ExecutedSteps++;

                //Step9 - Click Right Mouse Button on another viewport (e.g. viewport1) in the newly opened study panel and verify that the user shall open the toolbox
                viewer.SetViewPort(0, 2);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp(js: false);
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                }
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2, 1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                    viewer.HoverElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_ActiveExamPanel)));

                //Step10 - Load another study panel from Exam List and Click Right Mouse Button on another viewport (e.g. viewport2) in the newly opened study panel and verify that the user shall open the toolbox
                viewer.OpenPriors(0);
                viewer.SetViewPort(1, 3);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp(js: false);
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                }
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(3, 2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step11 - Verify the previously opened toolbox on series viewport (e.g. viewport1) in the different study panel shall get dismiss.               
                Thread.Sleep(1000);
                if (!viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2, 1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the stacked tools shall get opened when the user clicking and holding on the stacked tools
        /// </summary>
        public TestCaseResult Test_161279(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1,2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to Search                
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search for a study and load in BluRing viewer
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step-5 - Open the toolbox
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-6 - Open Stackedtool by click and hold
                IWebElement step6 = viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, false, false);
                if (step6 != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>  
        /// Merge LOGO shall displayed when user launch the Study in BlueRing Viewer.  
        /// </summary>  
        public TestCaseResult Test_161274(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables  
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator  
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select a study with multiple series that contain multiple images and click on BlueRing view button.  
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 4 - Selected study should be loaded  
                BluRingViewer.WaitforViewports();
                ExecutedSteps++;

                // Step 5 - Verify the Merge LOGO should be displayed.  
                viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_mergeLogo));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6 - Single click the study info area under Results list to open up the study in the viewer.  
                viewer.OpenPriors(0);
                if (viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 - Make sure that Merge LOGO should be displayed.  
                bool step_7 = viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_mergeLogo));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
                if (step_7 && step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8 - User Settings should contains UI - LARGE , UI - MEDIUM and UI-SMALL.                  
                 if(((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer"))
                     viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.userSettings_Icon));
                 else
                    viewer.GetElement("cssselector", BluRingViewer.userSettings_Icon).Click();
                bool Step8_1 = viewer.UserSettings("displayed", "ui - large");
                bool Step8_2 = viewer.UserSettings("displayed", "ui - medium");
                bool Step8_3 = viewer.UserSettings("displayed", "ui - small");
                if (Step8_1 && Step8_1 && Step8_1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 9 - Select any user control tool UI- LARGE from the User Settings.                                 
                viewer.UserSettings("select", "ui - large");                
                bool step9_1 = viewer.UserSettings("checked", "ui - large");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
                if (step9_1 && step9_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
        }

        /// <summary>
        /// Stacked tools shall get close based on a time out of 300ms  
        /// </summary>
        public TestCaseResult Test_161264(String testid, String teststeps, int stepcount)
		{

			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);
				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String DefaultDomain = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "DomainName");
				String DefaultRoleName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "RoleName");
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String[] Accession = AccessionList.Split(':');

				//Step 1 and 2 - Launch and Login as Administrator 
				login.LoginIConnect(adminUserName, adminPassword);
				ExecutedSteps++;
				ExecutedSteps++;

				//Step 3 - Select Studies tab.
				var studies = (Studies)login.Navigate("Studies");
				ExecutedSteps++;

				//Step 4 - 	Search and select a study and open in bluring viewer
				studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps++;

                //Step 5, 6, - open stacked tool and select Draw Ellipse                
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                    viewer.OpenViewerToolsPOPUp(js: false);
                    viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false, js: false);
                }
                else
                {
                    viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, Contextclick: false);
                }
                Thread.Sleep(2000);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step6)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Step 7 - Move the cursor away from the selected stacked menu tool without closing the floating toolbox in the series viewport.                
				int firstStudyWidth = viewer.GetElement("cssselector", viewer.Activeviewport).Size.Width;
				viewer.MouseMoveByOffset(firstStudyWidth, 0);
                bool Step7 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    Step7 = !viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_expandedtoolsContainer));
                }
                else
                {

                    Step7 = !viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_expandedtoolsContainer));
                }
                if (Step7)
                {
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 8 - Single click the study info area under Results list to open up the study in the viewer.
				viewer.OpenPriors(0);
                bool Step8 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    Step8 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                }
                else
                {
                    Step8 = viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)"));
                }
                if (Step8)
                {
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 9 - Repeat the step from 5 to 7 and verify the stacked tools is dismissed when the user has moved the cursor away from the selected stacked menu tool without closing the floating toolbox in the series viewport.
				viewer.SetViewPort(0, 2);
				int secondStudyWidth = viewer.GetElement("cssselector", viewer.Activeviewport).Size.Width;
                bool Step9 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                    viewer.OpenViewerToolsPOPUp(js: false);
                    viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false, panel: 2, js: false);
                    viewer.MouseMoveByOffset(secondStudyWidth, 0);
                    Step9 = !viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_expandedtoolsContainer));
                }
                else
                {
                    viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, panel: 2);
                    viewer.MouseMoveByOffset(secondStudyWidth, 0);
                    Step9 = !(viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_expandedtoolsContainer)));
                }
                if (Step9)
                {
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}
			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

        /// <summary>
        /// Floating toolbox shall not dismiss/close when user return back within 300ms
        /// </summary>
        public TestCaseResult Test_161266(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables   
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - 	Search and select a study with multiple series that contain multiple images and click BluRingViewer
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 5 - open the toolbox
                viewer.OpenViewerToolsPOPUp();
                bool step5 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolsSetContainer));
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                // Step 6 - Leave the cursor away from the selected series viewport to another viewport and come back to the previous selected viewport within 300ms                               
                bool step6 = false;
                if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                {
                    viewer.HoverElement(By.CssSelector(viewer.GetViewportCss(1, 1)));
                    try
                    {
                        IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.GetToolBoxCss(1)));
                        step6 = true;
                    }
                    catch (Exception e)
                    {
                        step6 = false;
                    }
                }
                else
                {
                    viewer.HoverElement(By.CssSelector(viewer.GetViewportCss(1, 1)));
                    viewer.HoverElement(By.CssSelector(viewer.Activeviewport));
                    step6 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(1)));
                }
                if (step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Single click the study info area under Results list to open up the study in the viewer.
                viewer.OpenPriors(0);
                if (viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step8 - Repeat the step from 5 to 6 and verify the toolbox is not dismissed/closed from the selected viewport
                viewer.SetViewPort(0, 2);
                viewer.OpenViewerToolsPOPUp();
                bool step7 = false;
                if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                {
                    viewer.HoverElement(By.CssSelector(viewer.GetViewportCss(2, 1)));
                    try
                    {
                        IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.GetToolBoxCss(2)));
                        step7 = true;
                    }
                    catch (Exception e)
                    {
                        step7 = false;
                    }
                }
                else
                {
                    viewer.HoverElement(By.CssSelector(viewer.GetViewportCss(2, 1)));
                    viewer.HoverElement(By.CssSelector(viewer.Activeviewport));
                    step7 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetToolBoxCss(2)));
                }
                if (step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Opened toolbox shall not get dismiss/close when user return back within 300 ms
        /// </summary>
        public TestCaseResult Test_161263(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;                
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                
                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - 	Search and select a study with multiple series that contain multiple images and click BluRing View
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]); 
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on selected series viewport and verify that the user shall open the toolbox.
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisible(By.CssSelector(viewer.GetToolBoxCss(1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6 - In selected series viewport,Leave the cursor away from the opened toolbox and return back to the opened toolbox within 300ms and verify that the the toolbox is not dismissed/closed.
                viewer.HoverElement(viewer.GetElement("cssselector", viewer.Activeviewport));
                viewer.HoverElement(viewer.GetElement("cssselector", BluRingViewer.div_toolboxContainer));
                                                             
                if (viewer.IsElementVisible(By.CssSelector(viewer.GetToolBoxCss(1))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 7 - Single click the study info area under Results list to open up the study in the viewer.
                viewer.OpenPriors(0);
                if (viewer.IsElementVisible(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step8 - Repeat the step from 5 to 6 in the newly opened study panel and verify the toolbox is not dismissed/closed from the selected viewport                
                viewer.SetViewPort(0, 2);
                viewer.OpenViewerToolsPOPUp();               
                viewer.HoverElement(viewer.GetElement("cssselector", viewer.Activeviewport));
                viewer.HoverElement(viewer.GetElement("cssselector", BluRingViewer.div_toolboxContainer));                              
                if (viewer.IsElementVisible(By.CssSelector(viewer.GetToolBoxCss(2))))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Distance Calibration Tool Text Field: Verify the user shall not able to enter the text on an input field
        /// </summary>
        public TestCaseResult Test_161275(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1 and 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps += 2;

                //Step 3 - Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - 	Search and select a study 
                studies.SearchStudy(AccessionNo: Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 5,6 Select Calibration tool from toolbox and verify the cursor type
                //var step6 = viewer.SelectViewerTool(BluRingTools.Calibration_Tool);
                var step6 = viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement);
                ExecutedSteps++;

                // Verify the cursor type
                bool step6_1 = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).GetCssValue("cursor").Equals("crosshair");
                if (step6 && step6_1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step- 7,8 - Draw Calibration with text
                viewer.ApplyTool_Calibration("Test");
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 9 - User should be in BluRing Viewer page and should not be redirected to login page
                if (viewer.IsElementVisibleInUI(By.CssSelector(viewer.Activeviewport)))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
		

        /// <summary>
        /// Verify the stacked menu tools dropdown shall get open downward when user opens the toolbox on the top half of an active series viewport and expanding a stacked tool
        /// </summary>
        public TestCaseResult Test_161283(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            Studies studies = new Studies();
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String MRN = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");

                //Step 1 - Launch the BlueRing application with a client browser 
                //(http://<BR IP>/WebAccess/) and hit enter
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step 2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Studies tab.
                studies = login.Navigate<Studies>();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                if (studies.ClearSearchBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - "Search and select multiple studies that contain huge number of related studies with same patient IDs and click on BluRing View button
                studies.ChooseColumns(new string[] { "Study ID" });
                studies.SearchStudy("Patient ID", MRN);
                studies.SelectStudy("Study ID", StudyID);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on the top half of an active series viewport and verify that the user shall open the toolbox
                //Step 6 - Right click on stacked tool and verify the stacked tool should open the tools in a downward opening dropdown
                // Step5 - Verify the floating toolbox should appear in the viewport, approximately centered over the location by clicking right mouse button.
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                viewer.OpenStackedTool(BluRingTools.Flip_Horizontal, false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                ExecutedSteps++;

                //Step 7 - Single click the study info area in the Results List under Exam List Panel to open up the prior study in the viewer.
                viewer.OpenPriors(0);
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Click Right Mouse Button on the top half of an active series viewport and verify that the user shall open the toolbox.
                viewer.SetViewPort(0, 2);
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = element.Size.Width;
                height = element.Size.Height;
                viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                ExecutedSteps++;

                //Step 9 - Right click on stacked tool and verify the stacked tool should open the tools in a downward opening dropdown
                viewer.OpenStackedTool(BluRingTools.Flip_Horizontal, false, panel: 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the stacked menu tools dropdown shall get open upward when user opens the toolbox on the bottom half of an active series viewport and expanding a stacked tool
        /// </summary>
        public TestCaseResult Test_161284(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            Studies studies = new Studies();
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String MRN = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                int width = 0;
                int height = 0;
                TestCompleteAction testcompleteAction = new TestCompleteAction();
                //Step 1 - Launch the BlueRing application with a client browser 
                //(http://<BR IP>/WebAccess/) and hit enter
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step 2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Studies tab.
                studies = login.Navigate<Studies>();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                if (studies.ClearSearchBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                Thread.Sleep(3000);

                //Step 4 - "Search and select multiple studies that contain huge number of related studies with same patient IDs and click on BluRing View button
                studies.ChooseColumns(new string[] { "Study ID" });
                studies.SearchStudy("Patient ID", MRN);
                studies.SelectStudy("Study ID", StudyID);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on the bottom half of an active series viewport and verify that the user shall open the toolbox
                //Step 6 - Right click on stacked tool
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    height = Convert.ToInt32(((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return arguments[0].getBoundingClientRect().bottom", element));
                    width = Convert.ToInt32(((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return arguments[0].getBoundingClientRect().right", element));
                    viewer.OpenViewerToolsPOPUp(width, height);
                    viewer.OpenStackedTool(BluRingTools.Add_Text, false, true);
                }
                else
                {
                    width = element.Size.Width;
                    height = element.Size.Height;
                    viewer.OpenViewerToolsPOPUp(width / 2 + width / 4, height / 2 + height / 4);
                    testcompleteAction = new TestCompleteAction();
                    if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    {
                        String csstool = BluRingViewer.GetToolCss(BluRingTools.Add_Text);
                        IWebElement outerelement = BasePage.Driver.FindElement(By.CssSelector(csstool));
                        testcompleteAction.MoveToElement(outerelement).ContextClick(outerelement).Perform();
                    }
                    else
                    {
                        viewer.OpenStackedTool(BluRingTools.Add_Text, false, false);
                    }
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenPriors(0);
                    viewer.CloseStudypanel(1);
                    PageLoadWait.WaitForFrameLoad(20);
                    viewer.SetViewPort(0, 1);
                }
                else
                {
                    viewer.SelectViewerTool(BluRingTools.Add_Text, isOpenToolsPOPup: false);
                }
                Thread.Sleep(2000);

                //Step 7 - Click Right Mouse Button on the top half of an active series viewport and verify that the user shall open the toolbox
                //Step 8 - Right click on stacked tool
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp();
                    viewer.OpenStackedTool(BluRingTools.Window_Level, false, true);
                }
                else
                {
                    width = element.Size.Width;
                    height = element.Size.Height;
                    viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                    if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                        viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                    testcompleteAction = new TestCompleteAction();
                    if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    {
                        String csstool = BluRingViewer.GetToolCss(BluRingTools.Window_Level);
                        IWebElement outerelement = BasePage.Driver.FindElement(By.CssSelector(csstool));
                        testcompleteAction.MoveToElement(outerelement).ContextClick(outerelement).Perform();
                    }
                    else
                    {
                        viewer.OpenStackedTool(BluRingTools.Window_Level, false, false);
                    }
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 9 - Single click the study info area in the Results List under Exam List Panel to open up the prior study in the viewer.
                viewer.OpenPriors(0);
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 10 - Click Right Mouse Button on the bottom half of an active series viewport in the newly opened study panel
                viewer.SetViewPort(0, 2);
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    height = Convert.ToInt32(((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return arguments[0].getBoundingClientRect().bottom", element));
                    width = Convert.ToInt32(((IJavaScriptExecutor)BasePage.Driver).ExecuteScript("return arguments[0].getBoundingClientRect().right", element));
                    viewer.OpenViewerToolsPOPUp(width, height);
                }
                else
                {
                    width = element.Size.Width;
                    height = element.Size.Height;
                    viewer.OpenViewerToolsPOPUp(width / 2 + width / 4, height / 2 + height / 4);
                    //if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                    //    viewer.OpenViewerToolsPOPUp(width / 2 + width / 4, height / 2 + height / 4);
                }
                ExecutedSteps++;

                //Step 11 - Right click on stacked tool in the newly opened study panel
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenStackedTool(BluRingTools.Add_Text, false, true, panel: 2);
                }
                else
                {
                    testcompleteAction = new TestCompleteAction();
                    if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    {
                        String csstool = BluRingViewer.GetToolCss(BluRingTools.Add_Text);
                        IWebElement outerelement = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) div.compositeViewerComponent div.viewerContainer:nth-of-type(1) " + csstool));
                        testcompleteAction.MoveToElement(outerelement).ContextClick(outerelement).Perform();
                    }
                    else
                    {
                        viewer.OpenStackedTool(BluRingTools.Add_Text, false, false, panel: 2);
                    }
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.CloseStudypanel(2);
                    PageLoadWait.WaitForFrameLoad(20);
                    viewer.OpenPriors(0);
                    viewer.SetViewPort(0, 2);
                }
                else
                {
                    if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                        viewer.SelectViewerTool(BluRingTools.Add_Text, isOpenToolsPOPup: false);
                    else
                    {
                        IWebElement moveElement = viewer.GetElement("cssselector", BluRingViewer.div_studypaneltime);
                        new TestCompleteAction().MoveToElement(moveElement).Release().Perform();
                    }
                }
                Thread.Sleep(3000);

                // Step 12 - Click Right Mouse Button on the top half of an active series viewport in the newly opened study panel
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp();
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                    if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                        viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                }
                ExecutedSteps++;

                // Step 13 - Right click on stacked tool in the newly opened study panel
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenStackedTool(BluRingTools.Window_Level, false, true, panel: 2);
                }
                else
                {
                    testcompleteAction = new TestCompleteAction();
                    if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    {
                        String csstool = BluRingViewer.GetToolCss(BluRingTools.Window_Level);
                        IWebElement outerelement = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) div.compositeViewerComponent div.viewerContainer:nth-of-type(1) " + csstool));
                        testcompleteAction.MoveToElement(outerelement).ContextClick(outerelement).Perform();
                    }
                    else
                    {
                        viewer.OpenStackedTool(BluRingTools.Window_Level, false, false, panel: 2);
                    }
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.CloseStudypanel(2);
                    PageLoadWait.WaitForFrameLoad(20);
                    viewer.OpenPriors(0);
                    viewer.SetViewPort(0, 2);
                }
                else
                {

                    if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                        viewer.SelectViewerTool(BluRingTools.Window_Level, isOpenToolsPOPup: false);
                    else
                    {
                        IWebElement moveElement = viewer.GetElement("cssselector", BluRingViewer.div_studypaneltime);
                        new TestCompleteAction().MoveToElement(moveElement).Release().Perform();
                    }   
                }
                Thread.Sleep(3000);

                // step 14 - Verify the floating toolbox should not resized when user opened the Stacked tool
                viewer.SetViewPort(0, 2);
                viewer.OpenViewerToolsPOPUp();
                if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                    viewer.OpenViewerToolsPOPUp(); ;

                // Get Height and Width of the toolbox
                element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
                width = element.Size.Width;
                height = element.Size.Height;

                // Open stacked tool and verify toolbox size
                testcompleteAction = new TestCompleteAction();
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    String csstool = BluRingViewer.GetToolCss(BluRingTools.Draw_Ellipse);
                    IWebElement outerelement = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) div.compositeViewerComponent div.viewerContainer:nth-of-type(1) " + csstool));
                    testcompleteAction.MoveToElement(outerelement).ContextClick(outerelement).Perform();

                    IWebElement element1 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
                    if ((width == element1.Size.Width) && (height == element1.Size.Height))
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else if (viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, false, panel: 2) != null)
                {
                    IWebElement element1 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
                    if ((width == element1.Size.Width) && (height == element1.Size.Height))
                    {
                        result.steps[++ExecutedSteps].status = "Pass";
                        Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                    }
                    else
                    {
                        result.steps[++ExecutedSteps].status = "Fail";
                        Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                        result.steps[ExecutedSteps].SetLogs();
                    }
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Verify the stacked Tool shall open the tools dropdown upward or downward based on the position of the user mouse on an active series viewport
        /// </summary>
        public TestCaseResult Test_161285(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            Studies studies = new Studies();
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String MRN = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");

                //Step 1 - Launch the BlueRing application with a client browser 
                //(http://<BR IP>/WebAccess/) and hit enter
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step 2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Studies tab.
                studies = login.Navigate<Studies>();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                if (studies.ClearSearchBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - "Search and select multiple studies that contain huge number of related studies with same patient IDs and click on BluRing View button
                studies.ChooseColumns(new string[] { "Study ID" });
                studies.SearchStudy("Patient ID", MRN);
                studies.SelectStudy("Study ID", StudyID);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

				//Step 5 - Point any position on an active series viewport and click Right Mouse Button then verify that the user shall open the toolbox.
				//Step 6 - Right click on stacked tool and verify the stacked tool should open the tools in a downward or upward opening dropdown based on the position of the user mouse.				
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
				int width = element.Size.Width;
				int height = element.Size.Height;
				viewer.OpenViewerToolsPOPUp(width / 2 - width / 5, height / 2 - height / 5);
                viewer.OpenStackedTool(BluRingTools.Add_Text, false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                ExecutedSteps++;

                //Step 7 - Single click the study info area in the Results List under Exam List Panel to open up the prior study in the viewer.
                viewer.OpenPriors(0);
				if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 8 - Point any position on an active series viewport and click Right Mouse Button then verify that the user shall open the toolbox.
				viewer.SetViewPort(0, 2);
				element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
				width = element.Size.Width;
				height = element.Size.Height;
				viewer.OpenViewerToolsPOPUp(width / 2 + width / 4, height / 2 + height / 4);
				ExecutedSteps++;

                //Step 9 - Right click on stacked tool and verify the stacked tool should open the tools in a downward or upward opening dropdown based on the position of the user mouse.
                viewer.OpenStackedTool(BluRingTools.Add_Text, false, panel: 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Image quality while scrolling the mouse wheel on the images
        /// </summary>
        public TestCaseResult Test_161268(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables               
			TestCaseResult result = null;
			int ExecutedSteps = -1;
			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);
				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String[] Accession = AccessionList.Split(':');
				String[] PatientID = PatientIDList.Split(':');

				//Step 1,2 - Launch application and Login as Administrator 
				login.LoginIConnect(adminUserName, adminPassword);
				ExecutedSteps++;
				ExecutedSteps++;

				//Step 3 - Navigate to Studies tab                
				var studies = (Studies)login.Navigate("Studies");
				ExecutedSteps++;

                //Step 4 - Load a study in BluRing Viewer
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps++;

				//Step 5 - Scroll down the mouse wheel and verify the next image is displayed with high quality
				// Scroll down mouse wheel by using TestComplete
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
				var action = new TestCompleteAction();
				action.MouseScroll(element, "down", "1");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step5)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 6 - Scroll up the mouse wheel and verify the previous image is displayed with high quality
				// Scroll up mouse wheel by using TestComplete     
				action.MouseScroll(element, "up", "1");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step6)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 7 - Scroll down the mouse wheel multiple times quickly and verify the next images are displayed without flickering
				// Scroll down mouse wheel 3 times by using TestComplete
				action.MouseScroll(element, "down", "3");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step7)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 8 - Scroll up the mouse wheel multiple times quickly and verify the previous images are displayed without flickering
				// Scroll up mouse wheel 3 times by using TestComplete                                
				action.MouseScroll(element, "up", "3");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 9 - Open another study panel
				viewer.OpenPriors(0);

				// Validation for new study panel
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_viewport));
				if (step9)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				viewer.SetViewPort(0, 2);
				element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));

				//Step 10 - In newly opened study panel, Scroll down the mouse wheel and verify the next image is displayed with high quality
				// Scroll down mouse wheel by using TestComplete                              
				action.MouseScroll(element, "down", "1");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step10)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 11 - Scroll up the mouse wheel and verify the previous image is displayed with high quality
				// Scroll up mouse wheel by using TestComplete                                              
				action.MouseScroll(element, "up", "1");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step11)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 12 - Scroll down the mouse wheel multiple times quickly and verify the next images are displayed without flickering
				// Scroll down mouse wheel 3 times by using TestComplete
				action.MouseScroll(element, "down", "3");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step12 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step12)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

                //Step 13 - Scroll up the mouse wheel multiple times quickly and verify the previous images are displayed without flickering
                // Scroll up mouse wheel 3 times by using TestComplete                                
                action.MouseScroll(element, "up", "3");
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step13)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Logout 
				viewer.CloseBluRingViewer();
				login.Logout();
                action.Perform();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}
			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

        /// <summary>
        /// To verify IBM Logo and Toolbar icon inside the viewer
        /// </summary>
        public TestCaseResult Test_161286(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;
			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);
				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String[] Accession = AccessionList.Split(':');

                // Step 1 - Launch the iCA application with a client browser
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // step 3 - Verify the "IBM iConnect Access" LOGO or custom brand logo is displayed on top left corner of the iCA webaccess page after logged in.
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                var brandlogo = login.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(login.By_Brandlogo));
                if (brandlogo)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 4 - Search and select a study  and load into viewer
                var studies = (Studies)login.Navigate("Studies");
				studies.SearchStudy(AccessionNo: Accession[0]);
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				ExecutedSteps++;				

				// Step 5 - Verify the merge logo displayed correctly
				var step5_1 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_mergeLogo));
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
				if (step5_1 && step5_2)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

                // Step 6 - Change the User settings [UI- Small, UI-Medium, UI-Large] one by one and Ensure that there is no change in IBM iConnect Access Logo for user settings.
                viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.userSettings_Icon));
                Thread.Sleep(2000);
                viewer.UserSettings("select", "ui - large");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
                viewer.UserSettings("select", "ui - medium");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step6_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
                viewer.UserSettings("select", "UI - SMALL");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step6_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_mergeLogo));
                if (step6_1 && step6_2 && step6_3)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                // Step 7 - Select a loaded series and Click Right Mouse Button on viewport.
                viewer.OpenViewerToolsPOPUp();
				bool step7 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_Toolbox));
				if (step7)
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 8 - Verify configured tool item's icons in the toolbox
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}
			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

		/// <summary>
		/// US Series with multiple measurement regions
		/// </summary>
		public TestCaseResult Test_161287(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);

				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
				String[] PatientID = PatientIDList.Split(':');
				String[] MeasurementTools = { "Line Measurement", "Calibration Tool", "Angle Measurement", "Cobb Angle" };

				//Step 1 - Launch the BlueRing application with a client browser 				
				login.DriverGoTo(login.url);
				ExecutedSteps++;

				//Step 2 - Login to WebAccess site with any privileged user.
				login.LoginIConnect(adminUserName, adminPassword);
				if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 3 - In the Studies tab, search and select for the US modality study which has multiple measurement regions.
				//Step 4 - Load the study in the BluRing viewer
				var studies = (Studies)login.Navigate("Studies");
				studies.SearchStudy(patientID: PatientID[0]);
				studies.SelectStudy("Patient ID", PatientID[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps += 2;

				// Step5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
				viewer.OpenViewerToolsPOPUp();
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
				if (element.Size.Width > 0 && element.Size.Height > 0)
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}
                Thread.Sleep(7000);
                // Step6 - Verify the all configured measurement tools should be disabled as soon as the toolbox is displayed.
                IList<IWebElement> availableTools = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper));
                bool isEnabled = false;
                bool isVerified = false;
                foreach (IWebElement ele in availableTools)
                {
                    isVerified = true;
                    string tooltip = ele.GetAttribute("title");
                    var index = Array.FindIndex(MeasurementTools, x => x == tooltip);
                    var className = ele.GetAttribute("class");
                    if (index > -1 && (!className.Contains("tool-disabled")))
                    {
                        isEnabled = true;
                        Logger.Instance.ErrorLog("Measurement Tool " + tooltip + " is enabled, but it should be in disabled state");
                    }
                }

                if (!isEnabled && isVerified)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				// Step7 & Step8 Apply various tools (WW/WL, Pan, Magnifier,Invert) and verify Image is not blurred
				viewer.SelectViewerTool(BluRingTools.Pan, 1, 1, false);
				viewer.ApplyTool_Pan();
				viewer.SelectViewerTool(BluRingTools.Window_Level);
				viewer.ApplyTool_WindowWidth();
				Thread.Sleep(5000);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
				Thread.Sleep(5000);
				viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
				viewer.ApplyTool_Magnifier(false);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps],
								viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}

			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

		/// <summary>
		/// US Series with Single measurement region with unit values other than 0x3 (cm) or 0x0 (none)
		/// </summary>
		public TestCaseResult Test_161288(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);

				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String LastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
				String[] Accession = AccessionList.Split(':');
				String[] LastName = LastNameList.Split(':');
				String[] MeasurementTools = { "Line Measurement", "Calibration Tool", "Angle Measurement", "Cobb Angle" };

				//Step 1 - Launch the BlueRing application with a client browser 				
				login.DriverGoTo(login.url);
				ExecutedSteps++;

				//Step 2 - Login to WebAccess site with any privileged user.
				login.LoginIConnect(adminUserName, adminPassword);
				if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 3 - In the Studies tab, search and select for the US Series with Single measurement region with unit values other than 0x3 (cm) or 0x0 (none)
				//Step 4 - Load the study in the BluRing viewer
				var studies = (Studies)login.Navigate("Studies");
				studies.SearchStudy("LastName", LastName[0]);
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps += 2;

				// Step5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
				viewer.OpenViewerToolsPOPUp();
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
				if (element.Size.Width > 0 && element.Size.Height > 0)
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}
                Thread.Sleep(7000);
                // Step6 - Verify the all configured measurement tools should be disabled as soon as the toolbox is displayed.
                IList<IWebElement> availableTools = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper));
                bool isEnabled = false;
                bool isVerified = false;
                foreach (IWebElement ele in availableTools)
                {
                    isVerified = true;
                    string tooltip = ele.GetAttribute("title");
                    var index = Array.FindIndex(MeasurementTools, x => x == tooltip);
                    var className = ele.GetAttribute("class");
                    if (index > -1 && (!className.Contains("tool-disabled")))
                    {
                        isEnabled = true;
                        Logger.Instance.ErrorLog("Measurement Tool " + tooltip + " is enabled, but it should be in disabled state");
                    }
                }

                if (!isEnabled && isVerified)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				// Step7 & Step8 Apply various tools (WW/WL, Pan, Magnifier,Invert) and verify Image is not blurred
				viewer.SelectViewerTool(BluRingTools.Pan, 1, 1, false);
				viewer.ApplyTool_Pan();
				viewer.SelectViewerTool(BluRingTools.Window_Level);
				viewer.ApplyTool_WindowWidth();
				Thread.Sleep(5000);
				viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
				Thread.Sleep(5000);
				viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
				viewer.ApplyTool_Magnifier(false);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps],
								viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}

			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}


		/// <summary>
		/// US Series with Single measurement region with unit value as 0x3 (cm)
		/// </summary>
		public TestCaseResult Test_161289(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);

				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String LastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
				String[] Accession = AccessionList.Split(':');
				String[] LastName = LastNameList.Split(':');
				String[] MeasurementTools = { "Line Measurement", "Calibration Tool", "Angle Measurement", "Cobb Angle" };

				//Step 1 - Launch the BlueRing application with a client browser 				
				login.DriverGoTo(login.url);
				ExecutedSteps++;

				//Step 2 - Login to WebAccess site with any privileged user.
				login.LoginIConnect(adminUserName, adminPassword);
				if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 3 - In the Studies tab, search and select for the US Series with Single measurement region with unit value as 0x3 (cm)
				//Step 4 - Load the study in the BluRing viewer
				var studies = (Studies)login.Navigate("Studies");
				studies.SearchStudy("LastName", LastName[0]);
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps += 2;

				// Step5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
				viewer.OpenViewerToolsPOPUp();
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
				if (element.Size.Width > 0 && element.Size.Height > 0)
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}
                Thread.Sleep(7000);
                // Step6 - Verify the all configured measurement tools should be enabled.
                IList<IWebElement> availableTools = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper));
                bool isEnabled = false;
                bool isVerified = false;
                foreach (IWebElement ele in availableTools)
                {
                    isVerified = true;
                    string tooltip = ele.GetAttribute("title");
                    var index = Array.FindIndex(MeasurementTools, x => x == tooltip);
                    var className = ele.GetAttribute("class");
                    if (index > -1 && (className.Contains("tool-disabled")))
                    {
                        isEnabled = true;
                        Logger.Instance.ErrorLog("Measurement Tool " + tooltip + " is disabled, but it should be in enabled state");
                    }
                }

                if (!isEnabled && isVerified)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				// Step7 & Step8 Apply various tools (WW/WL, Pan, Magnifier,Invert) and verify Image is not blurred
				viewer.SelectViewerTool(BluRingTools.Pan, 1, 1, false);
				viewer.ApplyTool_Pan();
				viewer.SelectViewerTool(BluRingTools.Window_Level);
				viewer.ApplyTool_WindowWidth();
				Thread.Sleep(5000);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(5000);
				viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
				viewer.ApplyTool_Magnifier(false);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps],
								viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}

			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

		/// <summary>
		///  US Series with Single measurement region with unit value as 0x0 (none)
		/// </summary>
		public TestCaseResult Test_161290(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);

				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String LastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
				String[] Accession = AccessionList.Split(':');
				String[] LastName = LastNameList.Split(':');
				String[] MeasurementTools = { "Line Measurement", "Calibration Tool", "Angle Measurement", "Cobb Angle" };

				//Step 1 - Launch the BlueRing application with a client browser 				
				login.DriverGoTo(login.url);
				ExecutedSteps++;

				//Step 2 - Login to WebAccess site with any privileged user.
				login.LoginIConnect(adminUserName, adminPassword);
				if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 3 - In the Studies tab, search and select for the US Series with Single measurement region with unit value as 0x0 (cm)
				//Step 4 - Load the study in the BluRing viewer
				var studies = (Studies)login.Navigate("Studies");
				studies.SearchStudy("LastName", LastName[0]);
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps += 2;

				// Step5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
				viewer.OpenViewerToolsPOPUp();
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
				if (element.Size.Width > 0 && element.Size.Height > 0)
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}
                Thread.Sleep(7000);

                // Step6 - Verify the all configured measurement tools should be enabled.
                IList<IWebElement> availableTools = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper));
                bool isEnabled = false;
                bool isVerified = false;
                foreach (IWebElement ele in availableTools)
                {
                    isVerified = true;
                    string tooltip = ele.GetAttribute("title");
                    var index = Array.FindIndex(MeasurementTools, x => x == tooltip);
                    var className = ele.GetAttribute("class");
                    if (index > -1 && (className.Contains("tool-disabled")))
                    {
                        isEnabled = true;
                        Logger.Instance.ErrorLog("Measurement Tool " + tooltip + " is disabled, but it should be in enabled state");
                    }
                }

                if (!isEnabled && isVerified)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				// Step7 & Step8 Apply various tools (WW/WL, Pan, Magnifier,Invert) and verify Image is not blurred
				viewer.SelectViewerTool(BluRingTools.Pan, 1, 1, false);
				viewer.ApplyTool_Pan();
				viewer.SelectViewerTool(BluRingTools.Window_Level);
				viewer.ApplyTool_WindowWidth();
				Thread.Sleep(5000);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(5000);
				viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
				viewer.ApplyTool_Magnifier(false);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps],
								viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}

			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

		/// <summary>
		///  US Series with No measurement regions
		/// </summary>
		public TestCaseResult Test_161291(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);

				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String LastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
				String[] Accession = AccessionList.Split(':');
				String[] LastName = LastNameList.Split(':');
				String[] MeasurementTools = { "Line Measurement", "Calibration Tool", "Angle Measurement", "Cobb Angle" };

				//Step 1 - Launch the BlueRing application with a client browser 				
				login.DriverGoTo(login.url);
				ExecutedSteps++;

				//Step 2 - Login to WebAccess site with any privileged user.
				login.LoginIConnect(adminUserName, adminPassword);
				if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				//Step 3 - In the Studies tab, search and select for the US Series with no measurement regions
				//Step 4 - Load the study in the BluRing viewer
				var studies = (Studies)login.Navigate("Studies");
				studies.SearchStudy("LastName", LastName[0]);
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps += 2;

				// Step5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
				viewer.OpenViewerToolsPOPUp();
				IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
				if (element.Size.Width > 0 && element.Size.Height > 0)
				{
					result.steps[++ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[++ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}
                Thread.Sleep(7000);

                // Step6 - Verify the all configured measurement tools should be disabled as soon as the toolbox is displayed
                IList<IWebElement> availableTools = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper));
                bool isEnabled = false;
                bool isVerified = false;
                foreach (IWebElement ele in availableTools)
                {
                    isVerified = true;
                    string tooltip = ele.GetAttribute("title");
                    var index = Array.FindIndex(MeasurementTools, x => x == tooltip);
                    var className = ele.GetAttribute("class");
                    if (index > -1 && (!className.Contains("tool-disabled")))
                    {
                        isEnabled = true;
                        Logger.Instance.ErrorLog("Measurement Tool " + tooltip + " is enabled, but it should be in disabled state");
                    }
                }

                if (!isEnabled && isVerified)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

				// Step7 & Step8 Apply various tools (WW/WL, Pan, Magnifier,Invert) and verify Image is not blurred
				viewer.SelectViewerTool(BluRingTools.Pan, 1, 1, false);
				viewer.ApplyTool_Pan();
				viewer.SelectViewerTool(BluRingTools.Window_Level);
				viewer.ApplyTool_WindowWidth();
				Thread.Sleep(5000);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(5000);
				viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
				viewer.ApplyTool_Magnifier(false);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step8 = studies.CompareImage(result.steps[ExecutedSteps],
								viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step8)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}

			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

        /// <summary>
		///  Viewport Toolbar
		/// </summary>
		public TestCaseResult Test_161292(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] Accession = AccessionList.Split(':');
                String[] PatientID = PatientIDList.Split(':');

                //Step 1 - Launch the BlueRing application with a client browser 				
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step 2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Studies tab.				
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select study and click "BluRing View" button
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step5 - Verify the floating toolbox should appear in the viewport, approximately centered over the location by clicking right mouse button.
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width / 2 + width / 10, height / 2 + height / 10);
                    actions.ContextClick().Perform();
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp(width / 2 + width / 10, height / 2 + height / 10);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), pixelTolerance: 10);
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step6 - Verify the floating toolbox should appear within the viewport when the user right mouse clicked near an edge of the viewport.
                //Step 7 - Verify the configured tools appear in the floating toolbox with their corresponding images.
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnailcontainer));
                }
                else
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnails));
                }
                Thread.Sleep(1000);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width - width / 10, height - height / 4);
                    actions.ContextClick().Perform();
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp(width - width / 10, height - height / 4);
                }
                ++ExecutedSteps;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6_7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), pixelTolerance: 10);
                if (step6_7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 8 - Move cursor away from the selected viewport
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnailcontainer));
                }
                else
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnails));
                }
                Thread.Sleep(10000);

                // Validate toolbox 
                var step8 = viewer.IsElementVisibleInUI((By.CssSelector(BluRingViewer.div_toolboxContainer)));
                if (!step8)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step9 - Verify the viewport should be active when the user right-clicks in a viewport.
                viewer.SetViewPort(1, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.OpenViewerToolsPOPUp(js: false);
                }
                else
                {
                    viewer.OpenViewerToolsPOPUp();
                }
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).FindElement(By.XPath(".."));
                bool step9_1 = element.GetAttribute("class").Contains("activeViewportContainer selected");
                bool step9_2 = viewer.VerifyBordorColor(element, "rgba(90, 170, 255, 1)");
                if (step9_1 && step9_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step10 - Select any tool from the floating toolbox (e.g. Invert or Interactive WW/WL) and verify that the floating toolbox disappears when the user selects any tool from the toolbox.
                viewer.SelectViewerTool(BluRingTools.Window_Level, 1, 2, false);
                Thread.Sleep(10000);

                // Validate toolbox 
                var step10 = viewer.IsElementVisibleInUI((By.CssSelector(BluRingViewer.div_toolboxContainer)));
                if (!step10)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step11 - User selected tool action should be applied to the viewport.
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Stacked tools open and close based on user mouse movement
        /// </summary>
        public TestCaseResult Test_161276(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');


                //Step 1 - Launch the BlueRing application with a client browser 				
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step 2 - Login to WebAccess site as Administrator.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Click on 'Studies' tab.				
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step4 - Select a study and click on BluRing view button
                studies.SearchStudy("Accession", Accession[0]);
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step5 - Select a viewport and right click on the selected viewport.
                viewer.OpenViewerToolsPOPUp();
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (element.Size.Width > 0 && element.Size.Height > 0)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step6 Stacked tools open and close based on user mouse movement
                IWebElement StackedTool = viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, false);
                if (StackedTool != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step7 - Ensure that stacked menu should be closed but not floating toolbox when the user quickly move mouse outside viewport and back to viewport, but NOT stacked menu area
                viewer.HoverElement(By.CssSelector(BluRingViewer.div_StudyPanel));
                viewer.HoverElement(By.CssSelector(BluRingViewer.div_toolboxContainer));
                Thread.Sleep(2000);
                var step7_1 = StackedTool.Displayed;
                var step7_2 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (!step7_1 && step7_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step8 - Select another viewport,open the floating toolbox and stack menu tool
                viewer.SetViewPort(1, 1);
                StackedTool = viewer.OpenStackedTool(BluRingTools.Window_Level, viewport: 2);
                if (StackedTool != null)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step9 - Verify that floating toolbox and stacked menu should not closed when the user quickly move mouse outside viewport and back to stacked menu area
                viewer.HoverElement(By.CssSelector(BluRingViewer.div_StudyPanel));
                viewer.HoverElement(StackedTool);
                var step9_1 = StackedTool.Displayed;
                var step9_2 = viewer.IsElementVisibleInUI(By.CssSelector("div.viewerContainer:nth-of-type(2) " + BluRingViewer.div_Toolbox));
                if (step9_1 && step9_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step10- Select another viewport,open the floating toolbox and stack tool
                viewer.SetViewPort(2, 1);
                StackedTool = viewer.OpenStackedTool(BluRingTools.Draw_Ellipse, viewport:3);
                if (StackedTool != null)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step11 - Verify that floating toolbox and stacked menu should not closed when the user quickly move mouse outside stacked menu area, but still IN viewport, and then back to stacked menu area
                Thread.Sleep(3000);
                viewer.HoverElement(By.CssSelector(BluRingViewer.div_viewportToolboxComponent));                
                viewer.HoverElement(By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Draw_ROI)));                              
                if(StackedTool.Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Joint Commission findings - User drawn measurement decimal shall display based on Joint Commission findings
        /// </summary>
        public TestCaseResult Test_161261(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step 1, 2 - Launch and Login as Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                ExecutedSteps++;

                //Step 3 - Navigate to studies tab               
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Load a study with multiple series that contain multiple images.                            
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step-5,6 - Open the toolbox and Select the line measurement tool
                var step6 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                ExecutedSteps++;
                if (step6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step-7-Drawn line measurement shouldn't show the decimal value
                IWebElement element = (BasePage.Driver).FindElement(By.CssSelector(BluRingViewer.div_viewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    viewer.ApplyTool_LineMeasurement(0, height / 2, width / 3, height / 3);
                }
                else if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("chrome") ||
                    ((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("explorer"))
                {
                    viewer.ApplyTool_LineMeasurement(0, height / 2, width / 11, height / 2);
                }
                else
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, 0, height / 2).ClickAndHold();
                    Thread.Sleep(2000);
                    actions.MoveToElement(element, width / 9, height / 10);
                    Thread.Sleep(2000);
                    actions.Release().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                // Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
		/// SHOW/HIDE Thumbnails from Study Panel
		/// </summary>
		public TestCaseResult Test_161293(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            UserManagement usermanagement = new UserManagement();
            DomainManagement domain = new DomainManagement();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);
                String FirstName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String LastName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //Precondition                              
                //Create new user
                login.LoginIConnect(adminUserName, adminPassword);
                login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                string[] Mod = { "CT", "MR", "CR" };
                for (int i = 0; i < Mod.Length; i++)
                {
                    domain.ModalityDropDown().SelectByText(Mod[i]);
                    if (Mod[i] == "CT" || Mod[i] == "MR")
                    {
                        domain.SelectRadioBtn("ThumbSplitRadioButtons", "Series");
                    }
                    else
                    {
                        domain.SelectRadioBtn("ThumbSplitRadioButtons", "Image");
                    }
                }
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                login.Logout();

                //Step 1 - Launch application and Login as Administrator 
                login.LoginIConnect(rad1, rad1);
                if (login.IsTabPresent("Studies"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 2 - Navigate to Studies tab 
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                }
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(LastName: LastName, FirstName: FirstName, Datasource: login.GetHostName(Config.EA91));
                bool step2 = false;
                IList<IWebElement> Modalities = BasePage.Driver.FindElements(By.CssSelector(".ui-widget-content.jqgrow.ui-row-ltr td[aria-describedby='gridTableStudyList_modality']")).ToList();
                foreach (IWebElement element in Modalities)
                {
                    var modalityText = element.GetAttribute("innerHTML");
                    if (modalityText.Equals("MR") || modalityText.Equals("CT") || modalityText.Equals("CR"))
                    {
                        step2 = true;
                    }
                }
                if (step2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - select the study and load in the bluring viewer              
                studies.SelectStudy("Accession", AccessionList);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                var step3_1 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_ShowHideTool));
                String[] StudyCaption = viewer.GetStudyPanelThumbnailCaption();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer));
                if (step3_1 && step3_2 && StudyCaption[0].Equals("S6") && StudyCaption[1].Equals("S7"))
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 4 - Click on the Thumbnail Preview Icon for the Primary study 
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                }
                else
                {
                    viewer.Click("cssselector", BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                }
                BluRingViewer.WaitforThumbnails();
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy)); ;
                var ExamListThumbnailCount = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_examListThumbnailImageComponent)).Count();
                var step4_1 = ExamListThumbnailCount.Equals(BluRingViewer.NumberOfThumbnailsInStudyPanel());
                if (step4_1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 5 - Click on SHOW/HIDE and select HIDE THUMBNAILS
                var viewport = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.viewportContainer);
                int HeightBefore = viewport.Size.Height;                
                viewer.SelectShowHideValue("HIDE THUMBNAILS", true);
                int HeightAfter = viewport.Size.Height;                
                bool step5_1 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_Studythumbnail));
                bool step5_2 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_examListThumbnailImages));
                bool step5_3 = HeightAfter > HeightBefore;
                if ((!step5_1) && step5_2 && step5_3)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6 - Click on the SHOW/HIDE and select SHOW THUMBNAILS
                viewer.SelectShowHideValue("SHOW THUMBNAILS", true);
                var HeightAftershow = viewport.Size.Height;                                
                bool step6_1 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_Studythumbnail));
                bool step6_2 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_examListThumbnailImages));
                var step6_3 = HeightBefore.Equals(HeightAftershow);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_studypanel + " " + BluRingViewer.div_compositeViewer));
                if (step6_1 && step6_2 && step6_3 && step6_4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // step 7 - Open another study (24-Feb-2000) in second study panel
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(103)"));
                viewer.OpenPriors(102);
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                bool step7_1 = viewer.GetElement("cssselector", viewer.GetViewportCss(2, 0)).GetAttribute("class").Equals("viewportDiv activeViewportDiv");
                bool step7_2 = BluRingViewer.NumberOfThumbnailsInStudyPanel(2).Equals(7);
                if (step7_1 && step7_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8 - Open another study (19-Aug-2004) in third study panel
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(34)"));
                viewer.OpenPriors(33);
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                bool step8_1 = viewer.GetElement("cssselector", viewer.GetViewportCss(3, 0)).GetAttribute("class").Equals("viewportDiv activeViewportDiv");
                bool step8_2 = BluRingViewer.NumberOfThumbnailsInStudyPanel(3).Equals(1);
                if (step8_1 && step8_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 9 -  Click on SHOW/HIDE and select HIDE THUMBNAILS
                viewport = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.viewportContainer);
                HeightBefore = viewport.Size.Height;                
                viewer.SelectShowHideValue("HIDE THUMBNAILS", true);
                HeightAfter = viewport.Size.Height;
                bool step9_1 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(1) " + BluRingViewer.div_Studythumbnail));
                bool step9_2 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_Studythumbnail));
                bool step9_3 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(3) " + BluRingViewer.div_Studythumbnail));
                bool step9_4 = true;
                bool step9_7 = HeightAfter > HeightBefore;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome"))
                {
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(133) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                    step9_4 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(133) " + BluRingViewer.div_examListThumbnailImages));
                }
                else if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox"))
                {
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(133) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                    step9_4 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(133) " + BluRingViewer.div_examListThumbnailImages));
                }
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(103) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer") || ((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("edge"))
                    viewer.ClickElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(103) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy)));
                else
                    viewer.Click("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(103) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                BluRingViewer.WaitforThumbnails();
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                bool step9_5 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(103) " + BluRingViewer.div_examListThumbnailImages));
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(34) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer") || ((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("edge"))
                    viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(34) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                else
                    viewer.Click("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(34) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                BluRingViewer.WaitforThumbnails();
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                bool step9_6 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(34) " + BluRingViewer.div_examListThumbnailImages));
                if ((!step9_1) && (!step9_2) && (!step9_3) && step9_4 && step9_5 && step9_6 && step9_7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // step10 - While the Thumbnail bars are hidden for all Study Panels, from the Exam List Panel load another related study in COMPARISON study panel.
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(34)"));
                viewer.OpenPriors(33);
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                var ThumbnailList = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_Studythumbnail));
                bool step10_1 = ThumbnailList[0].Displayed && ThumbnailList[1].Displayed && ThumbnailList[2].Displayed && ThumbnailList[3].Displayed;                
                if ((!step10_1))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 11 -  Click on SHOW/HIDE and select SHOW THUMBNAILS
                viewer.SelectShowHideValue("SHOW THUMBNAILS", true);
                bool step11_1 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(1) " + BluRingViewer.div_Studythumbnail));
                bool step11_2 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2) " + BluRingViewer.div_Studythumbnail));
                bool step11_3 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(3) " + BluRingViewer.div_Studythumbnail));
                bool step11_4 = true;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome"))
                {
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(133) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                    viewer.Click("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(133) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                    BluRingViewer.WaitforThumbnails();
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                    step11_4 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(133) " + BluRingViewer.div_examListThumbnailImages));
                }
                else if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox"))
                {
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(133) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                    viewer.Click("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(133) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                    BluRingViewer.WaitforThumbnails();
                    viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                    step11_4 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(133) " + BluRingViewer.div_examListThumbnailImages));
                }
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(103) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer") || ((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("edge"))
                    viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(103) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                else
                    viewer.Click("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(103) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                BluRingViewer.WaitforThumbnails();
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                bool step11_5 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(103) " + BluRingViewer.div_examListThumbnailImages));
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(34) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer") || ((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("edge"))
                    viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.div_relatedStudyPanel + ":nth-of-type(34) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy));
                else
                    viewer.Click("cssselector", BluRingViewer.div_relatedStudy + ":nth-of-type(34) " + BluRingViewer.div_thumbnailpreviewIconActiveStudy);
                BluRingViewer.WaitforThumbnails();
                viewer.ScrollIntoView(viewer.GetElement("cssselector", BluRingViewer.div_closeStudy));
                bool step11_6 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_relatedStudy + ":nth-of-type(34) " + BluRingViewer.div_examListThumbnailImages));
                if (step11_1 && step11_2 && step11_3 && step11_4 && step11_5 && step11_6)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

		/// 
		/// Magnifier Tool - Verify the user able to magnifies an area of an image
		/// 
		public TestCaseResult Test_161238(String testid, String teststeps, int stepcount)
		{
			//Declare and initialize variables         
			TestCaseResult result = null;
			int ExecutedSteps = -1;

			try
			{
				result = new TestCaseResult(stepcount);
				result.SetTestStepDescription(teststeps);

				String adminUserName = Config.adminUserName;
				String adminPassword = Config.adminPassword;
				String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
				String[] Accession = AccessionList.Split(':');

				//Step 1, 2 - Launch and Login as Administrator 
				login.LoginIConnect(adminUserName, adminPassword);
				ExecutedSteps++;
				ExecutedSteps++;

				//Step 3 - Navigate to Search                
				var studies = (Studies)login.Navigate("Studies");
				ExecutedSteps++;

				//Step 4 - Load a study with multiple series that contain multiple images.Ensure the scope is set to Image.                            
				studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
				studies.SelectStudy("Accession", Accession[0]);
				var viewer = BluRingViewer.LaunchBluRingViewer();
				PageLoadWait.WaitForFrameLoad(20);
				ExecutedSteps++;

				// Step-5,6,7 - Open the toolbox and Verify the Tool tip for Magnifier
				var step6 = viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
				ExecutedSteps += 2;
                Thread.Sleep(2000);

				// To Ensure Maginifier will not appear on viewport after selecting the tool
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step6 & step7)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Claculate Drag ad Drop coordinates
				var element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
				int dragStartX = element.Size.Width / 2;
				int dragStartY = element.Size.Height / 2;
				int dropX = element.Size.Width / 4;
				int dropY = element.Size.Height / 4;

				//Step - 8,9 Move the cursor over the magnifier around the viewport  (2X)
				viewer.ApplyTool_Magnifier(false, dragStartX, dragStartY, dropX, dropY);
				ExecutedSteps++;
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step9)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Step 10 Scroll the mouse wheel forwards one click  (3X)             
				Thread.Sleep(Config.medTimeout);			
				var action = new TestCompleteAction();
				action.MouseScroll(element, "up", "1").Perform();
				ExecutedSteps++;

				// Step 11 Move the magnifier around the viewport.
				int temp = (dropX - dropY) * 1;
				viewer.ApplyTool_Magnifier(true, dragStartX, dragStartY, dropX + temp, dropY + temp);
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step11)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Step 12 Scroll the mouse wheel forwards one click  (4X)   
				Thread.Sleep(Config.medTimeout);
                action = new TestCompleteAction();
                action.MouseScroll(element, "up", "1").Perform();
				ExecutedSteps++;

				// Step 13 Move the magnifier around the viewport.
				temp = (dropX - dropY) * 2;
				viewer.ApplyTool_Magnifier(true, dragStartX, dragStartY, dropX + temp, dropY + temp);
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step13)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Step 14 Scroll the mouse wheel backward one click   (3X)   
				Thread.Sleep(Config.medTimeout);
                action = new TestCompleteAction();
                action.MouseScroll(element, "down", "1").Perform();
				ExecutedSteps++;

				// Step 15 Move the magnifier around the viewport.
				temp = (dropX - dropY) * 3;
				viewer.ApplyTool_Magnifier(true, dragStartX, dragStartY, dropX + temp, dropY + temp);
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step15 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step15)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}

				// Step 16 Scroll the mouse wheel backward one click  (2X)    
				Thread.Sleep(Config.medTimeout);
                action = new TestCompleteAction();
                action.MouseScroll(element, "down", "1").Perform();
				ExecutedSteps++;

				// Step 17 Move the magnifier around the viewport.
				temp = (dropX - dropY) * 4;
				viewer.ApplyTool_Magnifier(true, dragStartX, dragStartY, dropX + temp, dropY + temp);
				result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
				bool step17 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
				if (step17)
				{
					result.steps[ExecutedSteps].status = "Pass";
					Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
				}
				else
				{
					result.steps[ExecutedSteps].status = "Fail";
					Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
					result.steps[ExecutedSteps].SetLogs();
				}
				viewer.ExitTool_Magnifier();

				// Logout Application
				viewer.CloseBluRingViewer();
				login.Logout();

				//Return Result
				result.FinalResult(ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);
				return result;
			}

			catch (Exception e)
			{
				//Log Exception
				Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

				//Report Result
				result.FinalResult(e, ExecutedSteps);
				Logger.Instance.InfoLog("Overall Test status--" + result.status);

				//Return Result
				return result;
			}
		}

        /// <summary>
        /// Pixel value decimal point shall not exceed more than 2 when the user hold the mouse click on SUV images.
        /// </summary>
        public TestCaseResult Test_161294(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         

            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String lastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String firstNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String patientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] LastName = lastNameList.Split(':');
                String[] FirstName = firstNameList.Split(':');
                String[] PatientId = patientIDList.Split(':');

                //Step 1 - Launch the iCA application with a client browser 
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Studies tab.
                Studies studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4 - Search and select study and click "View Exam" button.
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", PatientId[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                var element = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (element)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step6    Select the 'PIXEL VALUE' tool from the floating toolbox.
                var step6_1 = viewer.SelectViewerTool(BluRingTools.Get_Pixel_Value, isOpenToolsPOPup: false);
                if (step6_1)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step7  Hold the mouse click on SUV images and verify the decimal value. 
                IWebElement element1 = (BasePage.Driver).FindElement(By.CssSelector(viewer.Activeviewport));
                int width1 = element1.Size.Width;
                int height1 = element1.Size.Height;
                viewer.ApplyTool_PixelValueByClickAndHold(width1 / 3 - 10, height1 / 3 - 10);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool step_7 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step_7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Caliper height and major/minor tick marks 
        /// </summary>
        public TestCaseResult Test_161295(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         

            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String patientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] Accession = AccessionList.Split(':');
                String[] PatientId = patientIDList.Split(':');
                string StudyID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "StudyID");
                //step1 Login in ICA 7.0 with privileged user
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                //step2 Select any study from studies tab, which has large images(for eg:CT/CR) and click on 'View Exam' button
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //step3 - step4  Verify the size of the caliper for the large image and Verify the Caliper has 2 major tickmarks (top/bottom) and one minor tickmark (halfway point).
                ++ExecutedSteps;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step5  Apply different layouts(for eg:2X2) to the study and verify the size of the caliper
                viewer.ChangeViewerLayout("3x2");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_compositeViewer));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step6  Close the viewer and load a study which has smaller images in it(for eg: eyeball - OP modality)
                viewer.CloseBluRingViewer();
                PageLoadWait.WaitForPageLoad(60);
                PageLoadWait.WaitForFrameLoad(60);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.ClearFields();
                studies.SearchStudy(patientID: PatientId[0]);
                studies.SelectStudy("Patient ID", PatientId[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //step7 - step8 Verify the size of the caliper for the large image and Verify the Caliper has 2 major tickmarks (top/bottom) and one minor tickmark (halfway point)
                ++ExecutedSteps;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)));
                if (step8)
                {

                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step9  Apply different layouts(for eg:3X3) to the study and verify the size of the caliper
                viewer.ChangeViewerLayout("1x3");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_compositeViewer));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step10  Close the viewer.
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                if (login.IsTabPresent("Studies"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step11  Select a study from studies tab, which has a combination of large and small images(for eg:CT/CR) and click on 'View Exam' button.
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                if (!studies.CheckStudy("Accession", Accession[1]))
                {
                    studies.SearchStudy(studyID: StudyID, Datasource: login.GetHostName(Config.EA91));
                }
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //step12 - step13 Verify the size of the caliper for the large and small image and Verify the Caliper has 2 major tickmarks (top/bottom) and one minor tickmark (halfway point).
                ++ExecutedSteps;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_compositeViewer)));
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step14  Apply different layouts(for eg:3X2) to the study and verify the size of the caliper
                viewer.ChangeViewerLayout("1x3");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_compositeViewer));
                if (step14)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step15  Close the viewer.
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                if (login.IsTabPresent("Studies"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>  
        /// Draw ROI Tool  
        /// </summary>  
        public TestCaseResult Test_161299(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables                
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");               

                // Step 1 & 2 - Launch the Application and Login as  a Administrator  
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 3 & 4 - Select the studies tab and Launch the study in the Bluring viewer  
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;
                ExecutedSteps++;

                // Step 5 , 6, 7 - Selecting "Draw Roi" tool from the Floating Toolbox  
                var step7_1 = viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse);
                ExecutedSteps += 2;
                var step7_2 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step7_1 && step7_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8 - Applying the Draw Roi tool in the first viewport  
                viewer.ApplyTool_DrawRoi();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
        }

        /// <summary>  
        /// Draw ROI Tool - second way of applying the tool  
        /// </summary>  
        /// <param name="testid"></param>  
        /// <param name="teststeps"></param>  
        /// <param name="stepcount"></param>  
        /// <returns></returns>  
        public TestCaseResult Test_161302(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables                
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                // Step 1 & 2 - Launch the Application and Login as  a Administrator  
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 3 & 4 - Select the studies tab and Launch the study in the Bluring viewer  
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;
                ExecutedSteps++;

                // Step 5 , 6 - Selecting "Draw Roi" tool from the Floating Toolbox  
                var step6_1 = viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse);
                ExecutedSteps++;
                var step6_2 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step6_1 && step6_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 - Applying the Draw Roi tool in the first viewport  
                viewer.ApplyTool_DrawRoi(isClick: false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
        }

        /// <summary>
        ///  Draw Rectangle Tool 
        /// </summary>
        public TestCaseResult Test_161298(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         

            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String lastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String firstNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String patientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] LastName = lastNameList.Split(':');
                String[] FirstName = firstNameList.Split(':');
                String[] PatientId = patientIDList.Split(':');               

                //Step 1  Launch the iCA application with a client browser 
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed && login.PasswordTxtBox().Displayed && login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2  Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3  Select Studies tab.
                Studies studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4  Search and select study and click "View Exam" button.
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[0]);
                studies.SelectStudy("Patient ID", PatientId[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                bool step5 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step6 - step7 Verify when cursor is hover the Draw Rectangle tool, the tool tip for DRAW is displayed as 'Draw Rectangle' and Select the 'Draw Rectangle' tool from the floating toolbar.
                bool step6 = viewer.SelectInnerViewerTool(BluRingTools.Draw_Rectangle, BluRingTools.Draw_Ellipse, false);
                bool step7 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step6 && step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step8 - step9  Press and hold the left mouse button to draw a rectangle over the desired region. As drag the cursor, four rectangle points appeared.  Release the Left Mouse Button
                viewer.ApplyTool_DrawRectangle();
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool compare = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (compare)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Draw Rectangle Tool - second way of applying the tool 
        /// </summary>
        public TestCaseResult Test_161301(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         

            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String lastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String firstNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String patientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] LastName = lastNameList.Split(':');
                String[] FirstName = firstNameList.Split(':');
                String[] PatientId = patientIDList.Split(':');

                //Step 1  Launch the iCA application with a client browser 
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed && login.PasswordTxtBox().Displayed && login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2  Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3  Select Studies tab.
                Studies studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4  Search and select study and click "View Exam" button.
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[0]);
                studies.SelectStudy("Patient ID", PatientId[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                bool step5 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step6  Select the ''Draw Rectangle' tool from the floating toolbox and cerify the cursor stays as a cross.
                bool step6 = viewer.SelectInnerViewerTool(BluRingTools.Draw_Rectangle, BluRingTools.Draw_Ellipse, false);
                bool step7 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step6 && step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step7 - step8 Click Left Mouse Button on viewport and drag the mouse pointer to draw a rectangle over the desired region and again click left mouse button.
                viewer.ApplyTool_DrawRectangle(isClick: false);
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool compare = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (compare)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }

            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>  
        ///  Reset Tool  
        /// </summary>  
        public TestCaseResult Test_161303(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables 
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            bool isDefaultTool = false;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String lastNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String firstNameList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");
                String patientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] LastName = lastNameList.Split(':');
                String[] FirstName = firstNameList.Split(':');
                String[] PatientId = patientIDList.Split(':');

                //Precondition 2  Ensure that the Draw Rectangle tool configured in the Floating Toolbox.  
                login.LoginIConnect(adminUserName, adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain("SuperAdminGroup");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var precond2 = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond2.Contains("Reset")))
                {
                    isDefaultTool = true;
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(10)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Reset", group1);
                    domainmanagement.AddToolsToToolbox(dictionary);
                    domainmanagement.SaveButton().Click();
                    Logger.Instance.InfoLog("Reset tool  is configured in the ToolBox");
                }
                login.Logout();

                //Step 1 - Launch the iCA application with a client browser  
                login.DriverGoTo(login.url);
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2 - Login to WebAccess site with any privileged user.  
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step 3 - Select Studies tab.  
                Studies studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //Step 4  Search and select study and click "View Exam" button.  
                studies.SearchStudy(LastName: LastName[0], FirstName: FirstName[0]);
                studies.SelectStudy("Patient ID", PatientId[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox  
                viewer.OpenViewerToolsPOPUp();
                bool step5 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step 6 - Click on invert tool from the floating toolbox.  
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, false);
                Thread.Sleep(5000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step 7 - Click the invert tool again.  
                viewer.SelectViewerTool(BluRingTools.Invert);
                Thread.Sleep(5000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step 8 - Apply various tools (Window/Level, Zoom, Pan, Rotate, Flip, Grayscale Inversion.etc.)  
                viewer.SelectInnerViewerTool(BluRingTools.Window_Level, BluRingTools.Invert);
                viewer.ApplyTool_WindowWidth();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step 9 - Apply the invert tool.  
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(5000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step 10 - Apply various tools (Window/Level, Zoom, Pan, Rotate, Flip, Grayscale Inversion.etc.).  
                viewer.SelectInnerViewerTool(BluRingTools.Window_Level, BluRingTools.Invert);
                viewer.ApplyTool_WindowWidth();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step11 Verify when cursor is hover the 'Reset' tool, the tool tip for Reset tool is displayed as 'Reset'  
                //step12 Apply the reset tool.  
                viewer.SelectViewerTool(BluRingTools.Reset);
                ExecutedSteps++;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step12 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step12)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step13  Apply a few measurements(e.g. Line Measurement or Angle Measurement ) to the current image.  
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                IWebElement element1 = (BasePage.Driver).FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element1.Size.Width;
                int height = element1.Size.Height;
                viewer.ApplyTool_LineMeasurement(width / 10 - 5, height / 4 - 5, width / 3, height / 3);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step14 Select Reset tool from floating toolbox.  
                viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step14)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseBluRingViewer();

                //Step15 - Navigate to Studies tab, search and load RF modality into the Universal viewer     
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.SearchStudy(patientID: PatientId[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", PatientId[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //Step16 - Open floating toolbox,select Calibration tool and Draw a measurement on one of the images (e.g. line). 
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step16 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step16)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step17 - Calibrate the image. Enter a value for the calibration line's length (e.g. 100 mm). Accept the calibration
                viewer.HoverElement(By.CssSelector(BluRingViewer.div_thumbnails));
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = ele.Size.Width;
                height = ele.Size.Height;
                viewer.OpenViewerToolsPOPUp(width / 2 + width / 4, height / 2 + height / 4);
                //if (BasePage.SBrowserName.ToLower().Contains("explorer"))
                //    viewer.OpenViewerToolsPOPUp(width / 2 + width / 4, height / 2 + height / 4);
                viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement, false);
                viewer.ApplyTool_Calibration(50, 0, height / 3 + 10, width / 5, height / 5);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step17)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step18 - Open floating toolbox ,click reset button and Ensure that clicking reset should not be reset the calibration nor the line length
                viewer.OpenViewerToolsPOPUp(width / 2 - width / 3, height / 2 - height / 3);
                viewer.SelectViewerTool(BluRingTools.Reset, isOpenToolsPOPup: false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step18 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step18)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }

            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
            finally
            {
                if (isDefaultTool)
                {
                    login.LoginIConnect("Administrator", "Administrator");
                    DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                    domainmanagement.SearchDomain("SuperAdminGroup");
                    domainmanagement.SelectDomain("SuperAdminGroup");
                    domainmanagement.ClickEditDomain();
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                    SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                              (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                    Modality.SelectByText("default");
                    Thread.Sleep(1000);
                    IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                    if (revertButton.Enabled)
                        revertButton.Click();
                    domainmanagement.ClickSaveEditDomain();
                    login.Logout();
                }
            }
        }

        /// <summary>
        /// Add Text Tool
        /// </summary>
        public TestCaseResult Test_161300(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");               

                // Step 1 & 2 - Launch the Application and Login as  a Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 3 & 4 - Select the studies tab and Launch the study in the Universal viewer
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;
                ExecutedSteps++;

                // Step 5 , 6, 7 - Selecting "Add Text" tool from the Floating Toolbox
                var step5 = viewer.SelectViewerTool(BluRingTools.Add_Text);
                ExecutedSteps += 2;
                var step7 = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair");
                if (step5 && step7)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8, 9, 10 - Applying the Add Text tool in the first viewport
                viewer.ApplyTool_AddText("test");
                ExecutedSteps += 2;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 11 - click outside the viewport   
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(viewer.GetElement("cssselector", BluRingViewer.div_thumbnailcontainer)).Perform();
                    Thread.Sleep(2000);
                    new TestCompleteAction().Click().Perform();
                    Thread.Sleep(2000);
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(viewer.GetElement("cssselector", BluRingViewer.div_thumbnailcontainer)).Build().Perform();
                    Thread.Sleep(2000);
                    new Actions(BasePage.Driver).Click().Build().Perform();
                    Thread.Sleep(2000);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step12 
                var step12 = viewer.SelectViewerTool(BluRingTools.Add_Text);
                ExecutedSteps++;

                //Step13
                viewer.ApplyTool_AddText("d");
                viewer.OpenShowHideDropdown();
                var dropdown = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_ShowHideDropdown)).
                Single<IWebElement>(element => element.GetAttribute("innerHTML").ToLower().Contains("hide image text"));
                var menuname = dropdown.GetAttribute("innerHTML").Trim();
                bool step13 = menuname.ToLower().Equals("hide image text");
                if (step13)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Selected tool shall retain in another series viewport/study panels
        /// </summary>
        public TestCaseResult Test_161304(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                // Step 1 & 2 - Launch the Application and Login as  a Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 3 & 4 - Select the studies tab and Launch the study in the Bluring viewer
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps += 2;

                // Step 5 - select draw Ellipse in the second viewport
                viewer.SetViewPort(1, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                var step5 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, viewport: 2);
                if (step5)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 6 - Apply the Draw Ellipse tool in the second viewport
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 7 - Select the third Viewport and Apply the Draw Ellipse tool                 
                viewer.SetViewPort(2, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 8 - select  Invert Greyscale Image tool and apply in the third viewport
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, panel: 1, viewport: 3);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 9 - Verify that the default tool is Draw Ellipse tool in third viewport 
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                viewer.ApplyTool_DrawEllipse(ele.Size.Width / 4, ele.Size.Height / 4, ele.Size.Width / 5, ele.Size.Height / 5);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 10 - Verify that the default tool is Draw Ellipse tool in Second and third viewport                
                viewer.SetViewPort(0, 1);
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                viewer.ApplyTool_DrawEllipse(ele.Size.Width / 4, ele.Size.Height / 4, ele.Size.Width / 2, ele.Size.Height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step10_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SetViewPort(1, 1);
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                viewer.ApplyTool_DrawEllipse(ele.Size.Width / 4, ele.Size.Height / 4, ele.Size.Width / 5, ele.Size.Height / 5);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), totalImageCount: 2, IsFinal: 1);
                if (step10_1 && step10_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 11, 12, - close the viewer and open study with multiple prior in new viewer
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[1]);
                BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps += 2;

                // Step 13 - Open another study panel
                viewer.OpenPriors(1);
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(2)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 14 - Apply WW/WL in the First viewport of the second study    
                viewer.SetViewPort(0, 2);
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                viewer.ApplyTool_WindowWidth(ele.Size.Width / 4, ele.Size.Height / 4, ele.Size.Width / 5, ele.Size.Height / 5);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step14)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // step 15 - Select Draw ellipse in the second viewport of the second study
                viewer.SetViewPort(1, 2);
                bool step15 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, 2, 2, true);
                if (step15)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 16 - Apply Draw Ellipse in the second viewport of the second studypanel
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step16 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step16)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 17 - Apply Draw Ellipse in the third viewport of the third studypanel
                viewer.SetViewPort(2, 2);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    actions.ClickAndHold(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 4, attributes["height"] / 4).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_DrawEllipse();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step17)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 18 - select  Invert Greyscale Image tool and apply in the third viewport of second study panel
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, panel: 2, viewport: 3);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step18 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step18)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 19 - Verify that the default tool is Draw Ellipse tool in third viewport  of second study panel
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    actions.ClickAndHold(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 3, attributes["height"] / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_DrawEllipse(ele.Size.Width / 2, ele.Size.Height / 2, ele.Size.Width / 3, ele.Size.Height / 3);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step19 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step19)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 20 - Verify that the default tool is Draw Ellipse tool in Second and first viewport  of second study panel             
                viewer.SetViewPort(0, 2);
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    actions.ClickAndHold(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 3, attributes["height"] / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_WindowWidth(ele.Size.Width / 2, ele.Size.Height / 2, ele.Size.Width / 3, ele.Size.Height / 3);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step20_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SetViewPort(1, 2);
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var actions = new TestCompleteAction();
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    actions.ClickAndHold(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 3, attributes["height"] / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_DrawEllipse(ele.Size.Width / 2, ele.Size.Height / 2, ele.Size.Width / 3, ele.Size.Height / 3);
                }
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step20_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport), totalImageCount: 2, IsFinal: 1);
                if (step20_1 && step20_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 21 - open another study panel by clicking in the exam list
                viewer.OpenPriors(0);
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_studypanel + ":nth-of-type(3)")))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                // Step 22 - Apply Draw ellipse in the first viewport of the third study panel
                viewer.SetViewPort(0, 3);
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step22 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step22)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Window level shall be the default tool
        /// </summary>
        public TestCaseResult Test_161296(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            DomainManagement domain = new DomainManagement();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String SuperAdminGroup = Config.adminGroupName;
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Step1- Launch iCA then login as Administrator and navigate to Studies tab
                login.LoginIConnect(adminUserName, adminPassword);               
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step2 - Select any study which has multiple images / Series after searching and click no " Universal " button
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();                
                ExecutedSteps++;

                //Step3 - Select any series viewport and verify that any one of the interactive tools (ex: Zoom or Pan or W/L) is in the first position of the toolbox by default tool
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                String cursorname = ele.GetCssValue("cursor");
                bool Step3_1 = ele.GetCssValue("cursor").Equals("pointer");
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (Step3_1 && step3_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step4 - Close the Study viewe
                viewer.CloseBluRingViewer();
                ExecutedSteps++;

                //Step5 - Configure non-interactive tool (ex: flip/invert, etc.) in the first position of the toolbox also configure the interactive tools under the non-interactive tool at Domain and Role levels
                login.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                                (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                var ToolsToBeRemoved = new List<String>();
                ToolsToBeRemoved.Add(BluRingViewer.GetToolName(BluRingTools.Window_Level));
                ToolsToBeRemoved.Add(BluRingViewer.GetToolName(BluRingTools.AutoWL));
                ToolsToBeRemoved.Add(BluRingViewer.GetToolName(BluRingTools.Interactive_Zoom));
                ToolsToBeRemoved.Add(BluRingViewer.GetToolName(BluRingTools.Magnifier));
                domain.RemoveToolsFromConfiguredSection(ToolsToBeRemoved);
                domain.ClickSaveEditDomain();
                ExecutedSteps++;

                //Step6 - Load the same study in Universal viewer from Studies tab
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //Step7 - Ensure that the first interactive tool of the toolbox is selected by default tool.
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                bool Step7_1 = ele.GetCssValue("cursor").Equals("move");
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool Step7_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (Step7_1 && Step7_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseBluRingViewer(); 

                //Step8 - Configure Zoom in the first position, Pan in the second position and W/L in third position of the toolbox or configure it in stacked tool at Domain and Role levels
                login.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                Modality = new SelectElement(BasePage.Driver.FindElement
                                                (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                ToolsToBeRemoved = new List<String>();                
                ToolsToBeRemoved.Add(BluRingViewer.GetToolName(BluRingTools.Invert));               
                domain.RemoveToolsFromConfiguredSection(ToolsToBeRemoved);
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(1)"));
                IWebElement group2 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(2)"));
                var dictionary = new Dictionary<String, IWebElement>();
                string Zoom = BluRingViewer.GetToolName(BluRingTools.Interactive_Zoom);               
                string WindowLevel = BluRingViewer.GetToolName(BluRingTools.Window_Level);
                dictionary.Add(Zoom, group1);
                dictionary.Add(WindowLevel, group2);                
                bool step_3 = domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveEditDomain();
                ExecutedSteps++;

                //Step9 - Load any study in Universal from Studies tab
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //Step10 - Verify that Zoom tool is selected by default
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                bool Ste107_1 = ele.GetCssValue("cursor").Equals("n-resize");
                viewer.ApplyTool_Zoom();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool Step10_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (Step7_1 && Step7_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
         
                //Logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {               
                login.LoginIConnect("Administrator", "Administrator");
                login.NavigateToDomainManagementTab();
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");               
                Thread.Sleep(1000);
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                if (ele.Enabled)
                    ele.Click();               
                domain.ClickSaveEditDomain();
                login.Logout();
            }
        }

        /// <summary>
        /// Interactive Zoom Tool
        /// </summary>
        public TestCaseResult Test_161307(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables               
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            UserPreferences userPrefer = new UserPreferences();
            DomainManagement domainManagement = new DomainManagement();
            bool isDefaultTool = false;
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //Precondition 1  Ensure that the Draw Zoom tool configured in the Floating Toolbox.  
                login.LoginIConnect(adminUserName, adminPassword);
                domainManagement = (DomainManagement)login.Navigate("DomainManagement");
                domainManagement.SearchDomain(Config.adminGroupName);
                domainManagement.SelectDomain(Config.adminGroupName);
                domainManagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var precond = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond.Any(pc=> pc.Contains("Zoom"))))
                {
                    isDefaultTool = true;
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(1)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add(BluRingTools.Interactive_Zoom.ToString(), group1);
                    domainManagement.AddToolsToToolbox(dictionary);
                    domainManagement.SaveButton().Click();
                    Logger.Instance.InfoLog("Zoom tool  is configured in the ToolBox");
                }

                //Precondition 2- Ensure Viewing scope is Series for all modalities
                UserPreferences userPreferences = login.OpenUserPreferences();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("m_preferenceFrame");
                PageLoadWait.WaitForPageLoad(20);
                var options = userPreferences.ModalityDropDown().Options;
                foreach (IWebElement modality in options)
                {
                    userPreferences.ModalityDropDown().SelectByText(modality.Text);
                    PageLoadWait.WaitForPageLoad(10);
                    userPreferences.SelectRadioBtn("ScopeRadioButtons", "Series");
                    PageLoadWait.WaitForPageLoad(10);
                }
                userPreferences.CloseUserPreferences();
                PageLoadWait.WaitForPageLoad(10);
                login.Logout();

                //Step1 - From Administrator, Load any study into the viewer
                login.LoginIConnect(adminUserName, adminPassword);
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step2 - Click on right mouse button to open the floating toolbox
                viewer.OpenViewerToolsPOPUp();
                bool step2 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (step2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step3 - Verify the tool tip for 'Zoom' tool is displayed as 'Interactive Zoom'
                //Step4 - Select the ''Zoom' tool from the floating toolbox.
                bool step4 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, isOpenToolsPOPup: false);
                if (step4)
                {
                    ++ExecutedSteps;
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    ++ExecutedSteps;
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step5 - Place cursor on any point of the image inside viewport ,click and hold the left mouse button then move the mouse upward.
                IWebElement ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                int width = ele.Size.Width;
                int height = ele.Size.Height;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width/2, height/2 - height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height/2, width / 2, height / 4);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step6 - Place cursor on any point of the image inside viewport ,click and hold the left mouse button then move the mouse downward
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 + height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 4, width / 2, height / 2);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step7 - Select pan Tool to pan through the image.
                bool step7_1 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7_1 && step7_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step8 - Close study by clicking on the "X" button
                viewer.CloseBluRingViewer();
                if (login.IsTabPresent("Studies"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step9 - In Studies tab, load any study which has multiple images in same series into the viewer and click on right mouse button to open the floating toolbox                
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                bool step9 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (step9)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step10 - Select "Zoom" tool from the floating toolbox
                bool step10_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, isOpenToolsPOPup: false);                
                bool step10_2 = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport).GetCssValue("cursor").Equals("n-resize");
                if (step10_1 && step10_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step11 - Place cursor on any point of the first image ,click and hold the left mouse button then move the mouse upward.
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = ele.Size.Width;
                height = ele.Size.Height;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 - height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 3, width / 2, height / 8);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step11)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step12 - Use scroll to scroll through all the images in the series.
                TestCompleteAction action = new TestCompleteAction();
                action.MouseScroll(ele, "down");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step12_1 = studies.CompareImage(result.steps[ExecutedSteps], ele, 1);
                action.MouseScroll(ele, "down");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step12_2 = studies.CompareImage(result.steps[ExecutedSteps], ele, 2);
                action.MouseScroll(ele, "down");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step12_3 = studies.CompareImage(result.steps[ExecutedSteps], ele, 3);
                action.MouseScroll(ele, "down").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step12_4 = studies.CompareImage(result.steps[ExecutedSteps], ele, 4, 1);
                if (step12_1 && step12_2 && step12_3 && step12_4)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step13 - Place cursor on any point of the last image inside viewport ,click and hold the left mouse button then move the mouse downward.
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = ele.Size.Width;
                height = ele.Size.Height;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 + height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 8, width / 2, height / 3);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step13)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //stpe14 - Select pan Tool to pan through the image.
                bool step14_1 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step14_1 && step14_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step15 - Close study by clicking on the "X" button
                viewer.CloseBluRingViewer();
                if (login.IsTabPresent("Studies"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step16 - In Studies tab, load any study with different modalities which has multiple images and click on right mouse button to open the floating toolbox.
                studies.SearchStudy(AccessionNo: Accession[2], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[2]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                bool step16 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer));
                if (step16)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step17 - Select "Zoom" tool from the floating toolbox
                bool step17_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, isOpenToolsPOPup: false);
                bool step17_2 = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport).GetCssValue("cursor").Equals("n-resize");
                if (step17_1 && step17_2)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step18 - Place cursor on any point of the first image ,click and hold the left mouse button then move the mouse upward.
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = ele.Size.Width;
                height = ele.Size.Height;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 - height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 3, width / 2, height / 8);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step18 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step18)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step19 - Use scroll to scroll through the images in the series.
                action = new TestCompleteAction();
                action.MouseScroll(ele, "down").Perform();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step19 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step19)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step20 - Place cursor on any point of the last image inside viewport ,click and hold the left mouse button then move the mouse downward.
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = ele.Size.Width;
                height = ele.Size.Height;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 + height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 8, width / 2, height / 3);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step20 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step20)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step21 - Select pan tool from floating toolbox and drag the last image inside the series view port                
                bool step21_1 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step21_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step21_1 && step21_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step22 - Close study by clicking on the "X" button
                viewer.CloseBluRingViewer();
                if (login.IsTabPresent("Studies"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step23 - Select and load any study which has multiple images in same series or study with different modalities which has multiple images
                studies.SearchStudy(AccessionNo: Accession[2], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[2]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step24 - Using layout selection tool,change the sizes of the viewports e.g. 1x1 or 2x2 or 3x4
                viewer.ChangeViewerLayout();
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step24 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step24)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step25 - Select Zoom tool from toolbox and place cursor on any point of the image inside viewport ,click and hold the left mouse button then move the mouse upward.
                width = ele.Size.Width;
                height = ele.Size.Height;
                bool step25_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 - height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 3, width / 2, height / 8);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step25_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step25_1 && step25_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step26 - Place cursor on any point of the last image inside viewport ,click and hold the left mouse button then move the mouse downward.
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 + height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 8, width / 2, height / 3);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step26 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step26)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.ChangeViewerLayout("2x2");

                //step27 - Close study by clicking on the "X" button
                viewer.CloseBluRingViewer();
                result.steps[++ExecutedSteps].StepPass();

                //step28 - Select and load any study with PR series
                studies.SearchStudy(AccessionNo: Accession[3], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[3]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //Step29 - Select Zoom tool from toolbox and place cursor on any point of the image inside viewport ,click and hold the left mouse button then move the mouse upward.
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = ele.Size.Width;
                height = ele.Size.Height;
                bool step29_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 - height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 3, width / 2, height / 8);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step29_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step29_1 && step29_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step30 - Place cursor on any point of the last image inside viewport ,click and hold the left mouse button then move the mouse downward.
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 + height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 8, width / 2, height / 3);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step30 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step30)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }
                viewer.CloseBluRingViewer();

                //step31 - Select and load any study and select any measurement tool (eg: Line Measurement)or non-measurement tool(eg: Magnifier) from the floating toolbox and apply it.
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = ele.Size.Width;
                height = ele.Size.Height;
                bool step31_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(width / 2 - 20, height / 2 - 20, width / 4, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step31_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step31_1 && step31_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step32 - Apply zoom tool and verify that the user able to apply tool
                bool step32_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().ClickAndHold(ele).MoveToElement(ele, width / 2, height / 2 - height / 3).Release().Perform();
                }
                else
                {
                    viewer.ApplyTool_Zoom(width / 2, height / 3, width / 2, height / 8);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step32_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step32_1 && step32_2)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                viewer.CloseBluRingViewer();
                login.Logout(); 

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                if (isDefaultTool)
                {
                    login.LoginIConnect(adminUserName, adminPassword);
                    domainManagement = (DomainManagement)login.Navigate("DomainManagement");
                    domainManagement.SearchDomain(Config.adminGroupName);
                    domainManagement.SelectDomain(Config.adminGroupName);
                    domainManagement.ClickEditDomain();
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                    SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                              (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                    Modality.SelectByText("default");
                    Thread.Sleep(1000);
                    IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                    if (revertButton.Enabled)
                        revertButton.Click();
                    domainManagement.ClickSaveEditDomain();
                    login.Logout();
                }
            }
        }

        /// <summary>
        ///  Image or Series Scope Tool
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test1_161308(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            UserManagement usermanagement = new UserManagement();
            var studies = new Studies();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                // Precondition:
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.ClickSaveNewDomain();
                domain.SearchDomain(domain1);
                domain.SelectDomain(domain1);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(4)"));                
                var dictionary = new Dictionary<String, IWebElement>();                
                dictionary.Add("Series Scope", group1);                                
                domain.AddToolsToToolbox(dictionary);
                dictionary.Add("Image Scope", group1);
                domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                login.Logout();


                //Step 1 - Login as Administrator and Launch the Enterprise viewer
                login.LoginIConnect(rad1, rad1);                                
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", AccessionList);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 2 - Right click on Viewport and Open the Floating Toolbox
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer)))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 3 , 4, and 5 - Select Image Scope from floating Toolbox
                var step5 = viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement, false);
                ExecutedSteps += 2;
                if (step5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                //Step 6 - Change the layout to 1x1                
                var step6_1 = viewer.ChangeViewerLayout();
                var step6_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step6_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step6_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step6_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step6_1 && step6_2 && !step6_3 && !step6_4 && !step6_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 7 - Apply W/L to the Active viewport
                var step7 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step7_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SetViewPort(0, 1);
                IWebElement Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                TestCompleteAction action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step7_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step7_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "2");
                if (step7 && step7_1 && step7_2 && step7_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 8 - Apply Invert tool to the Active Viewport                 
                var step8 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step8_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step8_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "2").Perform();
                if (step8 && step8_1 && step8_2 && step8_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 9 - Apply zoom in/out  in the Active viewport
                var step9 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step9_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step9_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9 && step9_1 && step9_2 && step9_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 10 - select different image in the same series and apply pan                                
                var step10 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step10_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step10_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step10 && step10_1 && step10_2 && step10_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 11 - Apply Rotate Clockwise tool                 
                var step11 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step11_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step11_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step11_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step11 && step11_1 && step11_2 && step11_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 12 - Apply Rotate counter clockwise tool
                var step12 = viewer.SelectInnerViewerTool(BluRingTools.Rotate_Counterclockwise, BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step12_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step12_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step12_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step12 && step12_1 && step12_2 && step12_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 13 - Apply Horizontal flip tool to the image                
                var step13 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step13_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step13_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step13_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step13 && step13_1 && step13_2 && step13_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 14 - Apply Vertical flip tool to the image
                var step14 = viewer.SelectInnerViewerTool(BluRingTools.Flip_Vertical, BluRingTools.Flip_Horizontal);                
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step14_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step14_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step14_1 && step14_2 && step14_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 15 - Apply two or more interaction tools(Ex: Pan,W/L) to an image in the active series viewport.
                bool step15 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                bool step15_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step15_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step15_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step15_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step15 && step15_1 && step15_2 && step15_3 && step15_4)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 16 - Apply two or more interaction tools(Ex: Pan,W/L, Zoom) to an image in the active series viewport.
                bool step16 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                bool step16_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                bool step16_2 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step16_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step16_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step16_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step16 && step16_1 && step16_2 && step16_3 && step16_4 && step16_5)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 17 - select Reset tool and observe the viewport
                bool step17 = viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step17 && step17_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 18 , 19 - verify the tool tip of "Series Scope" tool                
                IWebElement expandedtoolsContainer = viewer.OpenStackedTool(BluRingTools.Line_Measurement);
                IWebElement seriesscope = expandedtoolsContainer.FindElement(By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Series_Scope))).FindElement(By.XPath(".."));
                var serisScopeTitle = seriesscope.GetAttribute("title");
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Pan)));
                    Thread.Sleep(1000);
                    viewer.HoverElement(By.CssSelector(viewer.GetStudyPanelThumbnailCss(1)));
                }
                else
                {
                    action = new TestCompleteAction();
                    action.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.GetToolCss(BluRingTools.Pan)));
                    Thread.Sleep(1000);
                    action.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1))).Perform();
                }
                Thread.Sleep(2000);
                if (serisScopeTitle.Equals("Series Scope"))
                {
                    result.steps[ExecutedSteps += 2].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps += 2].StepFail();
                }

                // Step 20 - Select any image that have one ore more tools applied to it and change the scope from image to series.
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "2").Perform();
                bool step20 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Line_Measurement);
                Thread.Sleep(1000);
                if (step20)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 21 - select Reset tool and observe the viewport
                bool step21 = viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step21_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step21_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step21_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step21 && step21_1 && step21_2 && step21_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Close Bluring viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();                

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Image or Series Scope Tool
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_161308(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            UserManagement usermanagement = new UserManagement();
            var studies = new Studies();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                // Precondition:
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.ClickSaveNewDomain();
                domain.SearchDomain(domain1);
                domain.SelectDomain(domain1);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(4)"));                
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Series Scope", group1);
                domain.AddToolsToToolbox(dictionary);
                dictionary.Add("Image Scope", group1);
                domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                login.Logout();

                login.LoginIConnect(rad1, rad1);                 
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", AccessionList);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);

                // Step 22 - Apply the W/L tool to one of the images.   
                IWebElement Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                bool step22 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                TestCompleteAction action = new TestCompleteAction();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step22_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step22_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step22_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step22 && step22_1 && step22_2 && step22_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 23 - Apply Invert tool
                bool step23 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step23_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step23_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step23_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                if (step23 && step23_1 && step22_2 && step22_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 24 - Apply the Zoom tool to an image.
                bool step24 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step24_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "2");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step24_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step24_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step24 && step24_1 && step24_2 && step24_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Step 25 - Apply the Pan tool to a different image.
                bool step25 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step25_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step25_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step25_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step25 && step25_1 && step25_2 && step25_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Step 26 - Apply the Rotate Clockwise tool to an image.
                bool step26 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step26_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step26_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step26_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1").Perform();
                if (step26 && step26_1 && step26_2 && step26_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 27 - Apply the Rotate Counter Clockwise
                bool step27 = viewer.SelectInnerViewerTool(BluRingTools.Rotate_Counterclockwise, BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step27_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step27_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step27_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1").Perform();
                if (step27 && step27_1 && step27_2 && step27_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 28 - Apply the Horizontal Flip tool to an image.
                bool step28 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step28_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step28_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step28_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1").Perform();
                if (step28 && step28_1 && step28_2 && step28_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 29 - Apply the Vertical Flip tool to an image.
                bool step29 = viewer.SelectInnerViewerTool(BluRingTools.Flip_Vertical, BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step29_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "up", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step29_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "2");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step29_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "1").Perform();
                if (step29 && step29_1 && step29_2 && step29_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 30 - Select 1x2 layout from the layout selection grid using layout selection tool
                var step30_1 = viewer.ChangeViewerLayout("1x2");
                var step30_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step30_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step30_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step30_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step30_1 && step30_2 && step30_3 && !step30_4 && !step30_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 31 - Select any thumbnail and load into second series view port.
                viewer.SetViewPort(1, 1);
                viewer.Click("cssselector", viewer.GetViewportCss(1, 1));
                var element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(3));
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).DoubleClick(element).Build().Perform();
                }
                else
                {
                    TestCompleteAction TCActions = new TestCompleteAction();
                    TCActions.DoubleClick(element).Perform();
                }
                Thread.Sleep(2000);
                ExecutedSteps++;

                // step 32 - 	Double click on second series viewport
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                action = new TestCompleteAction();
                action.DoubleClick(element).Perform();
                Thread.Sleep(2000);
                ExecutedSteps++;

                // Step 33 - Apply various tools (W/L, Zoom, Pan, Rotate, Flip, Invert, Reset) to different images in second series.                
                viewer.SetViewPort(1, 1);
                bool step33 = viewer.SelectViewerTool(BluRingTools.Window_Level, viewport: 2);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                bool step33_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, viewport: 2);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 1));
                bool step33_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                bool step33_3 = viewer.SelectViewerTool(BluRingTools.Pan, viewport: 2);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                bool step33_4 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, viewport: 2);
                Thread.Sleep(2000);
                bool step33_5 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal, viewport: 2);
                Thread.Sleep(2000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step33_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                bool step33_7 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, viewport: 2);
                bool step33_8 = viewer.SelectViewerTool(BluRingTools.Reset, viewport: 2);
                Thread.Sleep(2000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step33_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step33 && step33_1 && step33_2 && step33_3 && step33_4 && step33_5 && step33_6 && step33_7
                    && step33_8 && step33_9)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 34 - Select the first series that was originally displayed.
                var step34_1 = viewer.ChangeViewerLayout("1x1");
                var step34_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step34_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step34_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step34_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step34_1 && step34_2 && !step34_3 && !step34_4 && !step34_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                // Step 35 - Apply various tools to the first series (W/L, Zoom, Pan, Rotate, Flip, Invert, Reset)
                viewer.SetViewPort(0, 1);
                bool step35 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                bool step35_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                bool step35_2 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                bool step35_3 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                bool step35_4 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                bool step35_5 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                bool step35_6 = viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(2000);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step35_7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step35_8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step35_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step35_1 && step35_2 && step35_3 && step35_4 && step35_5 && step35_6 && step35_7 && step35_8 && step35_9)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 36 - Change the scope to Image for first series viewport.
                if (viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 37 - Re-select the second series.
                var step37_1 = viewer.ChangeViewerLayout("2x2");
                var step37_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step37_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step37_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step37_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                viewer.SetViewPort(1, 1);
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                action = new TestCompleteAction();
                action.DoubleClick(element).Perform();
                Thread.Sleep(2000);
                if (step37_1 && step37_2 && step37_3 && step37_4 && step37_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                // Step 38 - Apply various tools (W/L, Zoom, Pan, Rotate, Flip, Invert, Reset)
                bool step38 = viewer.SelectViewerTool(BluRingTools.Window_Level, viewport: 2);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(20000);
                bool step38_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, viewport: 2);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(20000);
                bool step38_2 = viewer.SelectViewerTool(BluRingTools.Pan, viewport: 2);
                viewer.ApplyTool_Pan();
                Thread.Sleep(20000);
                bool step38_3 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, viewport: 2);
                Thread.Sleep(20000);
                bool step38_4 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal, viewport: 2);
                Thread.Sleep(2000);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step38_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step38_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step38_7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step38_1 && step38_2 && step38_3 && step38_4 && step38_5 && step38_6)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 39 -  	Change layout to 2x2.
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                action = new TestCompleteAction();
                action.DoubleClick(element).Perform();
                Thread.Sleep(3000);
                var step39_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step39_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step39_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step39_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step39_2 && step39_3 && step39_4 && step39_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 40 - Load 2 series from a different study into the bottom of two viewports using drag and drop/double click
                viewer.SetViewPort(2, 1);
                viewer.Click("cssselector", viewer.GetViewportCss(1, 2));
                IList<IWebElement> priors = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_priorsBlock));
                viewer.ClickExamListThumbnailIcon(priors[1]);
                IWebElement ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetExamListThumbnailCss(2, 1));
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).DoubleClick(ele).Build().Perform();
                }
                else
                {
                    action = new TestCompleteAction();
                    action.DoubleClick(ele).Perform();
                }
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step40_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SetViewPort(3, 1);
                viewer.Click("cssselector", viewer.GetViewportCss(1, 3));
                Thread.Sleep(2000);
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetExamListThumbnailCss(2, 2));
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).DoubleClick(ele).Build().Perform();
                }
                else
                {
                    action = new TestCompleteAction();
                    action.DoubleClick(ele).Perform();
                }
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step40_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step40_1 && step40_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }


                // step 41 -Select any series viewport and change the scope to 'image'                
                bool step41 = viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement, viewport: 4);
                if (step41)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }
                // Step 42 - Apply tools (eg: Pan) to one image in each series. 
                bool step42 = viewer.SelectViewerTool(BluRingTools.Pan, viewport: 4);
                viewer.ApplyTool_Pan();
                Thread.Sleep(5000);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 3));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step42_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step42_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step42_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "2").Perform();
                if (step42 && step42_1 && step42_2 && step42_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 43 - With one of the images that tools were applied to selected, change the scope to series.
                viewer.OpenViewerToolsPOPUp();
                Thread.Sleep(10000);
                bool step43 = false;
                var toolsinforthgrid = viewer.GetToolsInToolBoxByGrid(4);                
                string[] firsttool = toolsinforthgrid[0].Split(',');
                if (firsttool[0] == "Image Scope")
                {
                    step43 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Image_Scope, false, viewport: 4);
                }
                else
                {
                    step43 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Line_Measurement, false, viewport: 4);
                }                
                if (step43)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 44 - Begin to apply a tool to a modified image in another series.                
                viewer.SetViewPort(2, 1);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 2));
                bool step44 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, viewport: 3);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step44_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step44_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step44_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "2").Perform();
                if (step44 && step44_1 && step44_2 && step44_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 45 - Switch back and forth between image and series scope while applying tools to all of the loaded series.
                bool step45 = viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement, viewport: 3);
                Thread.Sleep(4000);
                bool step45_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, viewport: 3);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step45_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action = new TestCompleteAction();
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step45_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step45_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "up", "2");
                bool step45_5 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Line_Measurement, viewport: 3);
                Thread.Sleep(3000);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, viewport: 3);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step45_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1");
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step45_7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                action.MouseScroll(Activeviewport, "down", "1").Perform();
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 6);
                bool step45_8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step45_1 && step45_2 && step45_3 && step45_4 && step45_5 && step45_6 && step45 && step45_7 && step45_8)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Close Bluring viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();                

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Remove All Annotations - Keyboard shortcut for scrolling up/down
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161309(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         

            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //Step-1 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                //Step 2 - Select a study from a patient that has multiple studies with multiple series that contain multiple images and click on "Universal" viewer button.
                Studies studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 3 - Click on any series and scroll up/down the mouse wheel	
                TestCompleteAction actions = new TestCompleteAction();
                var activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                actions.MouseScroll(activeViewport, "down", "1");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 4 - Press the keyboard up/down arrows.
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step4_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step4_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step4_1 && step4_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }                        

                // step 5 - Drag and drop or Double click any thumbnail from thumbnail bar and verify that the user able to view the next/previous images from the series using keyboard down/up arrows
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    viewer.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(3, 1)));
                }
                else
                {
                    actions.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(3, 1)));
                }
                //viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport).SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step5_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.Up);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step5_1 && step5_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 6 - Drag and drop or Double click any thumbnail from Thumbnail preview for the study and verify that the user able to view the next/previous images from the series using keyboard down/up arrows
                IList<IWebElement> priors = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_priorsBlock));
                viewer.ClickExamListThumbnailIcon(priors[0]);
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    viewer.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetExamListThumbnailCss(1, 2)));
                }
                else
                {
                    actions.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetExamListThumbnailCss(1, 2)));
                }

                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.Up);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step6_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step6_1 && step6_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 7 - Single click on the study info area under Results list and Verify the study should be opened in the viewer.
                viewer.OpenPriors(0);
                var isAnotherStudyPanel = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_StudyPanel + ":nth-of-type(2)"));
                if (isAnotherStudyPanel)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 8 - Verify that the user able to view the next/previous images from the series using keyboard down/up arrows                
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)).SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)));
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)).SendKeys(OpenQA.Selenium.Keys.Up);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step8_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(2, 0)));
                if (step8_1 && step8_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 9 - Open more than 3 related studies into the study panels and ensure that the user able to view the next/previous images from the series using keyboard down/up arrows
                viewer.OpenPriors(0);
                viewer.OpenPriors(0);
                viewer.OpenPriors(0);
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(5, 0)).SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step9_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(5, 0)));
                viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(5, 0)).SendKeys(OpenQA.Selenium.Keys.Up);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(5, 0)));
                if (step9_1 && step9_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }
                actions.Perform();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Remove All Annotations
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161245(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         

            TestCaseResult result = null;
            int ExecutedSteps = -1;
            bool isDefaultTool = false;
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            DomainManagement domainmanagement = null;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);


                String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //Precondition:  Ensure that the Remove All Annotations and Interactive Zoom tools are configured in the Floating Toolbox.
                login.LoginIConnect(adminUserName, adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain("SuperAdminGroup");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var precond = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond.Contains("Remove All Annotations")) && !(precond.Contains("Zoom")))
                {
                    isDefaultTool = true;
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(2)"));
                    IWebElement group2 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(8)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Remove All Annotations", group1);
                    dictionary.Add("Zoom", group2);
                    domainmanagement.AddToolsToToolbox(dictionary);
                    domainmanagement.SaveButton().Click();
                    Logger.Instance.InfoLog("Remove All Annotations and Zoom  is configured in the ToolBox");
                }
                login.Logout();

                // Step 1 - launch the ica Application
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step-2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //Step 3 - Select any study which has annotations (eg: PR study) and click on Universal button
                Studies studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //Step 4 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                bool step4 = false;
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    step4 = viewer.IsElementVisibleInUI((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                }
                else
                {
                    step4 = viewer.IsElementVisible((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                }
                if (step4)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 5 & 6 - Select the 'Remove All Annotations' tool from the toolbox.	
                var step5_1 = viewer.SelectInnerViewerTool(BluRingTools.Remove_All_Annotations, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                Thread.Sleep(2000);
                result.steps[ExecutedSteps += 2].SetPath(testid, ExecutedSteps + 1);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5_1 && step5_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 7 - Perform Pan/Zoom/Window Level operation on viewport
                var step7_1 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                var step7_2 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                var step7_3 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7_1 && step7_2 && step7_3 && step7_4)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 8 - Select the Remove All tool from the floating box.
                var step8_1 = viewer.SelectInnerViewerTool(BluRingTools.Remove_All_Annotations, BluRingTools.Add_Text);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8_1 && step8_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 9 - Select any annotations and drawn on selected image
                var step9_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                var ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                var width = ele.Size.Width;
                var height = ele.Size.Height;
                viewer.ApplyTool_LineMeasurement(width / 2 - 20, height / 2 - 20, width / 4, height / 4);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9_1 && step9_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 10 - Select the 'Remove All Annotations' tool from the toolbox.	
                var step10_1 = viewer.SelectInnerViewerTool(BluRingTools.Remove_All_Annotations, BluRingTools.Add_Text);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10_1 && step10_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Logout Application
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                if (isDefaultTool)
                {
                    login.LoginIConnect(adminUserName, adminPassword);
                    domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                    domainmanagement.SearchDomain(Config.adminGroupName);
                    domainmanagement.SelectDomain(Config.adminGroupName);
                    domainmanagement.ClickEditDomain();
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                    SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                              (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                    Modality.SelectByText("default");
                    Thread.Sleep(1000);
                    IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                    if (revertButton.Enabled)
                        revertButton.Click();
                    domainmanagement.ClickSaveEditDomain();
                    Logger.Instance.InfoLog("Toolbox reverted successfully");
                    login.Logout();
                }
            }
        }

        /// <summary>
        ///  Edit Text - Verify the user able to edit the added text on an image 
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161255(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            UserManagement usermanagement = new UserManagement();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //step-1  Launch the iCA application with a client browser 
                login.DriverGoTo(login.url);
                BasePage.Driver.SwitchTo().DefaultContent();
                if (login.UserIdTxtBox().Displayed &&
                    login.PasswordTxtBox().Displayed &&
                    login.LoginBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Step-2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Patients") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[++ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }


                //step-3  Select Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                //step-4  Select any study and click on View Exam button.
                studies.SearchStudy(AccessionNo: AccessionList);
                studies.SelectStudy("Accession", AccessionList);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                //step-5  Hover over an existing text, the text lights up
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, height / 2).Build().Perform();                    
                }
                else
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, (height / 2));
                    actions.Release().Perform();
                    Thread.Sleep(2000);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step-6  Click the Left Mouse Button on an existing text
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome"))
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, height / 2).Build().Perform();
                    Thread.Sleep(2000);
                    new Actions(BasePage.Driver).Click().Build().Perform();
                }
                else
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, (height / 2));
                    actions.Release();
                    Thread.Sleep(2000);
                    actions.Click().Perform();
                }
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //step-7  Add new text on an image and verify that user able to edit the newly added text on the series viewport.
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).FindElement(By.CssSelector("input[type='text']"));
                Thread.Sleep(5000);
                ele.SendKeys("TestingEnvironment-134565");
                BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).SendKeys(OpenQA.Selenium.Keys.Enter);
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome"))
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 0, (height / 2)).Build().Perform();
                    Thread.Sleep(2000);
                    new Actions(BasePage.Driver).Click().Build().Perform();
                }
                else
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), 5, (height / 2));
                    Thread.Sleep(2000);
                    actions.Release();
                    Thread.Sleep(2000);
                    actions.Click().Perform();
                }
                Thread.Sleep(3000);
                BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).FindElement(By.CssSelector("input[type='text']")).SendKeys("QATestingForEditText");
                BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)).SendKeys(OpenQA.Selenium.Keys.Enter);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step7_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7 && step7_1)
                {
                    result.steps[ExecutedSteps].status = "Pass";
                    Logger.Instance.InfoLog("-->Test Step Passed--" + result.steps[ExecutedSteps].description);
                }
                else
                {
                    result.steps[ExecutedSteps].status = "Fail";
                    Logger.Instance.ErrorLog("-->Test case Failed--" + result.steps[ExecutedSteps].description);
                    result.steps[ExecutedSteps].SetLogs();
                }

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Cursor for Basic Tools: Verify the cursor shall display for the active BlueRing Tools
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161269(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            Studies studies = new Studies();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String TestDomain = "TestDomain161269_" + new Random().Next(1, 1000);
                String Role = "Role161269_" + new Random().Next(1, 1000);
                String DomainAdmin = "DomainAdmin161269_" + new Random().Next(1, 1000);

                // Precondition
                login.LoginIConnect(adminUserName, adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.CreateDomain(TestDomain, TestDomain, TestDomain, DomainAdmin, null, DomainAdmin, DomainAdmin, DomainAdmin, Role, Role);
                domainmanagement.SearchDomain(TestDomain);
                domainmanagement.SelectDomain(TestDomain);
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var ConfiguredTools = login.GetConfiguredToolsInToolBoxConfig();
                if (!(ConfiguredTools.Contains("Zoom")) && !(ConfiguredTools.Contains("Free Draw")))
                {
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(1)"));
                    IWebElement group2 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(2)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Zoom", group1);
                    dictionary.Add("Free Draw", group2);
                    domainmanagement.AddToolsToToolbox(dictionary);
                    domainmanagement.ClickElement(domainmanagement.SaveButton());
                    Logger.Instance.InfoLog("Zoom and free draw are configured in the ToolBox");
                }
                login.Logout();

                //Step 1 - Launch the BlueRing application with a client browser 
                //(http://<iCA IP>/WebAccess/) and hit enter
                login.DriverGoTo(login.url);
                ExecutedSteps++;

                //Step 2 - Login to WebAccess site with any privileged user.
                login.LoginIConnect(DomainAdmin, DomainAdmin);
                if (login.IsTabPresent("Studies") && login.IsTabPresent("Domain Management"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //Step 3 - Select Studies tab.
                studies = login.Navigate<Studies>();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(studies.ClearSearchBtn()));
                if (studies.ClearSearchBtn().Displayed)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //Step 4 - Search and select study and click " View Exam" button
                studies.SearchStudy(patientID: PatientID, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", PatientID);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 5 - Click Right Mouse Button on viewport and verify that the user shall open the toolbox
                viewer.OpenViewerToolsPOPUp();
                var step5 = viewer.IsElementVisibleInUI((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                if (step5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 6 - Select Window Level tool from the floating toolbox
                bool step6 = viewer.SelectViewerTool(BluRingTools.Window_Level, isOpenToolsPOPup: false);
                if (step6 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("move"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 7 - Select Magnifier tool from the floating toolbox
                bool step7 = viewer.SelectInnerViewerTool(BluRingTools.Magnifier, BluRingTools.Interactive_Zoom);
                Thread.Sleep(2000);
                if (step7 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("default"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 8 - Select Pan tool from the floating toolbox
                bool step8 = viewer.SelectViewerTool(BluRingTools.Pan);
                Thread.Sleep(2000);
                if (step8 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("pointer"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 9 - Select Line Measurement tool from the floating toolbox
                bool step9 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                if (step9 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 10 - Select Calibration tool from the floating toolbox
                bool step10 = viewer.SelectInnerViewerTool(BluRingTools.Calibration_Tool, BluRingTools.Line_Measurement);
                if (step10 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 11 - Select Angle Measurement tool from the floating toolbox
                bool step11 = viewer.SelectViewerTool(BluRingTools.Angle_Measurement);
                if (step11 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 12 - Select Edit Text tool from the floating toolbox                
                result.steps[++ExecutedSteps].status = "Not Automated";

                // step 13 - Select Free Draw tool from the floating toolbox
                bool step13 = viewer.SelectInnerViewerTool(BluRingTools.Free_Draw, BluRingTools.Add_Text);
                if (step13 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 14 - Select Draw Ellipses tool from the floating toolbox.
                bool step14 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                if (step14 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 15 - Select Pixel Value tool from the floating toolbox
                bool step15 = viewer.SelectViewerTool(BluRingTools.Get_Pixel_Value);
                if (step11 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 16 - Select Draw Rectangle tool from the floating toolbox
                bool step16 = viewer.SelectInnerViewerTool(BluRingTools.Draw_Rectangle, BluRingTools.Draw_Ellipse);
                if (step16 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 17 - Select Cobb Angle tool from the floating toolbox	
                Thread.Sleep(2000);
                bool step17 = viewer.SelectInnerViewerTool(BluRingTools.Cobb_Angle, BluRingTools.Angle_Measurement);
                if (step17 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 18 - Select Draw ROI tool from the floating toolbox	
                Thread.Sleep(2000);
                bool step18 = viewer.SelectInnerViewerTool(BluRingTools.Draw_ROI, BluRingTools.Draw_Ellipse);
                if (step18 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 19 - Select Add Text tool from the floating toolbox	
                bool step19 = viewer.SelectViewerTool(BluRingTools.Add_Text);
                if (step19 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("crosshair"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 20 - Select Zoom tool from the floating toolbox	
                bool step20 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                if (step20 && BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport)).GetCssValue("cursor").Equals("n-resize"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Close the viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Auto Window Level 
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161694(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            UserManagement usermanagement = new UserManagement();
            bool isDefaultTool = false;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");

                // Step 1 - Login to application as an Administrator.                
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                // Step 2 -Navigate to domain management page, select SuperAdminGroup and click on Edit button
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain("SuperAdminGroup");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                ExecutedSteps++;

                // step 3 - In Toolbox configuration section, Drag and Drop "AutoWL" from Avaiable section to Configurable section.
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var ConfiguredTools = login.GetConfiguredToolsInToolBoxConfig();
                if (!(ConfiguredTools.Contains("AutoWL")))
                {
                    isDefaultTool = true;
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(8)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("AutoWL", group1);
                    domainmanagement.AddToolsToToolbox(dictionary);
                    if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    {
                        domainmanagement.ClickElement(domainmanagement.SaveButton());
                    }
                    else
                    {
                        domainmanagement.SaveButton().Click();
                    }

                    Logger.Instance.InfoLog("AutoWL is configured in the ToolBox");
                }
                else
                {
                    Logger.Instance.InfoLog("AutoWL is already configured in the ToolBox, so closing the domainmanagement page");
                    domainmanagement.ClickCloseEditDomain();
                }
                ExecutedSteps++;

                // Step 4 - Navigate to Studies tab.
                var studies = (Studies)login.Navigate("Studies");
                ExecutedSteps++;

                // Step 5 -  Select any study and click on View Exam button.
                studies.SearchStudy(patientID: PatientID, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", PatientID);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 6 - Right click on any viewport.
                viewer.OpenViewerToolsPOPUp();
                var step6 = viewer.IsElementVisibleInUI((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                if (step6)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 7 and 8 - Mouse hover on Auto WL tool and Click on Auto WL tool
                var Step8_1 = viewer.SelectInnerViewerTool(BluRingTools.AutoWL, BluRingTools.Window_Level, false);
                ExecutedSteps++;
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool Step8_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (Step8_1 && Step8_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 9 - Click on Auto WL tool again
                var Step9_1 = viewer.SelectViewerTool(BluRingTools.AutoWL);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool Step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (Step9_1 && Step9_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Close the viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                if (isDefaultTool)
                {
                    login.LoginIConnect("Administrator", "Administrator");
                    DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                    domainmanagement.SelectDomain("SuperAdminGroup");
                    domainmanagement.ClickEditDomain();
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                    SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                              (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                    Modality.SelectByText("default");
                    Thread.Sleep(1000);
                    IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                    if (revertButton.Enabled)
                        revertButton.Click();
                    domainmanagement.ClickSaveEditDomain();
                    login.Logout();
                }
            }
        }

        /// <summary>
        /// Window leveling changes when releasing mouse
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161223(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            Studies studies = new Studies();
            bool isDefaultTool = false;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientID = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");

                // Precondition
                login.LoginIConnect(adminUserName, adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain("SuperAdminGroup");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent();
                BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                var ConfiguredTools = login.GetConfiguredToolsInToolBoxConfig();
                if (!(ConfiguredTools.Contains("Zoom")))
                {
                    isDefaultTool = true;
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(1)"));
                    IWebElement group2 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(2)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Zoom", group2);
                    domainmanagement.AddToolsToToolbox(dictionary);
                    domainmanagement.ClickElement(domainmanagement.SaveButton());
                    Logger.Instance.InfoLog("Zoom is configured in the ToolBox");
                }
                login.Logout();

                // Step 1 - Log in to iCA with valid credentials.	
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                // Step 2 - Navigate to studies tab, Search and load a study.
                studies = login.Navigate<Studies>();
                studies.SearchStudy(patientID: PatientID, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", PatientID);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 3 - Right click on any viewport 
                viewer.OpenViewerToolsPOPUp();
                var step3 = viewer.IsElementVisibleInUI((By.CssSelector(BluRingViewer.div_toolsSetContainer)));
                if (step3)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                // Step 4 - Click on Window Level tool and apply it
                bool step4_1 = viewer.SelectViewerTool(BluRingTools.Window_Level, isOpenToolsPOPup: false);
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step4_1 && step4_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // step 5 - Without releasing the mouse button, Leave the viewport during the W/L operation.
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.PerformTool(width / 4, height / 4, width / 2, height / 2, false);
                TestCompleteAction action = new TestCompleteAction();
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1, 1)));
                    action.Release().Perform();
                }
                else
                {
                    viewer.HoverElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1, 1)));
                    new Actions(BasePage.Driver).Release().Build().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // step 6 - Return to the viewport again.
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action = new TestCompleteAction();
                    action.MoveToElement(element).Perform();
                }
                else
                {
                    viewer.HoverElement(element);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step6)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // step 7 - Select Zoom tool and apply it.
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 8 - Without releasing the mouse button, Leave the viewport during the Zoom operation.
                viewer.PerformTool(width / 4, height / 4, width / 2, height / 2, false);
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action = new TestCompleteAction();
                    action.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1, 1)));
                    action.Release().Perform();
                }
                else
                {
                    viewer.HoverElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1, 1)));
                    new Actions(BasePage.Driver).Release().Build().Perform();
                }
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 9 - Return to the viewport again.   
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action = new TestCompleteAction();
                    action.MoveToElement(element).Perform();
                }
                else
                {
                    viewer.HoverElement(element);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step9)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 10 - Select Pan tool and apply it
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 11 - Without releasing the mouse button, Leave the viewport during the Pan operation.	
                viewer.PerformTool(width / 4, height / 4, width / 2, height / 2, false);
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action = new TestCompleteAction();
                    action.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1, 1)));
                    action.Release().Perform();
                }
                else
                {
                    viewer.HoverElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1, 1)));
                    new Actions(BasePage.Driver).Release().Build().Perform();
                }
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 12 - Return to the viewport again.  
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action = new TestCompleteAction();
                    action.MoveToElement(element).Perform();
                }
                else
                {
                    viewer.HoverElement(element);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step12 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step12)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 13 - Start applying W/L to the images without leaving the Active viewport and Stop the mouse movement without releasing the mouse button, then release the mouse button after few seconds (2 or 3 sec).
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.PerformTool(0, height / 8, 0, height / 4, false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step13_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Thread.Sleep(3000);
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox")))
                {
                    action = new TestCompleteAction();
                    action.Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).Release().Build().Perform();
                }
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step13_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step13_1 && step13_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Close the viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();                

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                if (isDefaultTool)
                {
                    login.LoginIConnect("Administrator", "Administrator");
                    DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                    domainmanagement.SearchDomain("SuperAdminGroup");
                    domainmanagement.SelectDomain("SuperAdminGroup");
                    domainmanagement.ClickEditDomain();
                    BasePage.Driver.SwitchTo().DefaultContent();
                    BasePage.Driver.SwitchTo().Frame("UserHomeFrame");
                    SelectElement Modality = new SelectElement(BasePage.Driver.FindElement
                                              (By.CssSelector(BasePage.select_toolBoxConfiguration_ModalityDropdown)));
                    Modality.SelectByText("default");
                    Thread.Sleep(1000);
                    IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                    if (revertButton.Enabled)
                        revertButton.Click();
                    domainmanagement.ClickSaveEditDomain();
                    login.Logout();
                }
            }
        }

        /// <summary>
        ///  Callibration value for US image.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161224(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            UserPreferences userpref = new UserPreferences();
            var isImageSplit = " ";
            var isSeriesSplit = " ";
            var isAutoSplit = " ";

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String AccessionId = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                // Preconditions
                login.LoginIConnect(adminUserName, adminPassword);
                userpref.OpenUserPreferences();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("m_preferenceFrame");
                PageLoadWait.WaitForPageLoad(20);
                userpref.ModalityDropDown().SelectByText("US");
                isImageSplit = userpref.ThumbnailSplittingImageRadioBtn().GetAttribute("checked");
                isSeriesSplit = userpref.ThumbnailSplittingSeriesRadioBtn().GetAttribute("checked");
                isAutoSplit = userpref.ThumbnailSplittingAutoRadioBtn().GetAttribute("checked");
                userpref.ClickElement(userpref.ThumbnailSplittingImageRadioBtn());
                PageLoadWait.WaitForFrameLoad(10);
                userpref.CloseUserPreferences();
                PageLoadWait.WaitForPageLoad(20);
                login.Logout();


                // Step 1 - Login to application as an Administrator.                
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                // Step 2 - Navigate to studies tab, search for the same study from Mpacs datasource for which have KO Image
                Studies studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: AccessionId, Datasource: login.GetHostName(Config.SanityPACS));
                studies.SelectStudy("Accession", AccessionId);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 3 - Drag and drop KO image from thumbnail bar to view port.
                // Drag and drop is not required here as the KO image is already visible in viewer
                ExecutedSteps++;

                // Step 4 - draw measurement line on created KO image. Verify the measurement units.	
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement();
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step4)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 5 - Draw measurement line on US image in the other view port.	
                viewer.SetViewPort(1, 1);
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Close the viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {

                login.LoginIConnect(adminUserName, adminPassword);
                userpref.OpenUserPreferences();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("m_preferenceFrame");
                PageLoadWait.WaitForPageLoad(20);
                userpref.ModalityDropDown().SelectByText("US");
                if (!(isSeriesSplit == null))
                {
                    userpref.ClickElement(userpref.ThumbnailSplittingSeriesRadioBtn());
                    Logger.Instance.InfoLog("The Thumbnails splitting is reverted back to series");
                }
                else if (!(isAutoSplit == null))
                {
                    userpref.ClickElement(userpref.ThumbnailSplittingAutoRadioBtn());
                    Logger.Instance.InfoLog("The Thumbnails splitting is reverted back to Auto");
                }
                else if (!(isImageSplit == null))
                {
                    userpref.ClickElement(userpref.ThumbnailSplittingImageRadioBtn());
                    Logger.Instance.InfoLog("The Thumbnails splitting is reverted back to Image");
                }
                PageLoadWait.WaitForFrameLoad(10);
                userpref.CloseUserPreferences();
                PageLoadWait.WaitForPageLoad(20);
                login.Logout();
            }
        }

        /// <summary>
        ///  Scroll Tool 
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164452(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;


            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                //step1  Login to application as an Administrator 
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                //step2  Navigate to studies tab, search for a study which has multiple series and each series has multiple images and load it in universal viewer.
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step3 Press the keyboard down arrow.
                var Slidervalue_1 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                IWebElement element_1 = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(1, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                element_1.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                var Slidervalue_2 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Slidervalue_2 > Slidervalue_1)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step4 Right click on a viewport and mouse hover on Scroll Tool
                viewer.OpenViewerToolsPOPUp();
                IWebElement element = viewer.GetElement("cssselector", "div[class*='tool-container']" + "[title^='Scroll Tool']");
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().MoveToElement(element).Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(element).Build().Perform();
                }
                string tooltip = element.GetAttribute("title");
                if (tooltip == "Scroll Tool")
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step5 Select Scroll tool.
                bool step5 = false;
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox"))
                    step5 = viewer.SelectViewerTool(BluRingTools.Scroll_Tool, isOpenToolsPOPup: false);
                else
                {
                    IWebElement moveElement = viewer.GetElement("cssselector", BluRingViewer.div_studypaneldate);
                    new TestCompleteAction().MoveToElement(moveElement).Release().Perform();
                    step5 = viewer.SelectViewerTool(BluRingTools.Scroll_Tool, isOpenToolsPOPup: true);
                }
                if (step5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step6 Click and hold on Left mouse button on a image and drag it downwards and release the mouse button.
                int width = element_1.Size.Width;
                int height = element_1.Size.Height;
                viewer.PerformTool(width / 4, height / 4, width / 2, height / 2, isInteractivetool: true);
                var Slidervalue_3 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Slidervalue_3 > Slidervalue_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step7  Click and hold on Left mouse button on a image and drag it upwards and release the mouse button.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer"))

                {
                    viewer.PerformTool(width / 4, height / 4, width * 0, height * 0, isInteractivetool: true);
                }
                else
                {
                    viewer.PerformTool(width / 2, height / 2, width / 4, height / 4);
                }
                var Slidervalue_4 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Slidervalue_4 < Slidervalue_3)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step8 Scroll the images again downwards say from Image 1 to Image 10 and apply Pan tool.
                var Actions = new TestCompleteAction();
                Actions.MouseScroll(element_1, "down", "10").Perform();
                var Slidervalue_5 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], element_1);
                if (Slidervalue_5 == Slidervalue_4 + 10 && step8)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step9 Verify the image count shows next to Stack slider.
                var X = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).Location.X;
                var Y = viewer.GetElement(BasePage.SelectorType.CssSelector, ".mat-slider-thumb-label").Location.X;
                if (X > Y && Slidervalue_5 == Slidervalue_4 + 10)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step10 Press the keyboard up/down arrows.
                element_1.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                var Slidervalue_6 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                element_1.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                var Slidervalue_7 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Slidervalue_6 < Slidervalue_5 && Slidervalue_7 > Slidervalue_6)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step11  Close the viewer and load another study with multiple images and each image has multiple frames. 
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step12 Press the keyboard down arrow.
                var Slidervalue_8 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                var activeViewport_1 = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(1, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                activeViewport_1.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                var Slidervalue_9 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Slidervalue_9 > Slidervalue_8)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step13 Right click on a viewport and select Scroll tool.
                bool step13 = viewer.SelectViewerTool(BluRingTools.Scroll_Tool);
                if (step13)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step14 Scroll the viewport up and down quickly and Observe there is any stuck in the viewport
                IWebElement element_2 = (BasePage.Driver).FindElement(By.CssSelector(viewer.Activeviewport));
                Actions = new TestCompleteAction();
                Actions.MouseScroll(element_2, "down", "2");
                Actions.MouseScroll(element_2, "up", "1").Perform();
                var Slidervalue_10 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Slidervalue_10 > Slidervalue_9)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step15 Verify the frame count next to Stack slider.
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step15 = studies.CompareImage(result.steps[ExecutedSteps], element_2);
                if (step15)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step16  Press the keyboard up/down arrows. 
                element_2.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                var Sliderdownvalue_11 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                element_2.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                var Sliderdownvalue_12 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (Sliderdownvalue_11 < Slidervalue_10 && Sliderdownvalue_12 > Sliderdownvalue_11)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  UDI verification from Universal Viewer
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164679(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            string line;
            string build = "";
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String DeviceIdentifierNo = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Device Identifier");

                //step1 Login to iCA as Administrator and load any study on Universal Viewer.
                login.LoginIConnect(adminUserName, adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step2 Click on "?" help icon -> About which is available at the top right corner of the viewer.
                viewer.OpenAboutSplashScreen();
                bool step2 = viewer.GetElement("cssselector", BluRingViewer.div_AboutScreen).Displayed;
                string Version = viewer.GetElement("cssselector", BluRingViewer.div_AboutScreenVersion).Text;
                string[] version = Version.Split(':');
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_AboutScreenlogo));
                if (step2 && Config.buildversion.Contains(version[1]) && step2_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step3 Verify that the UDI [Unique Device Identifier] number is displayed at the bottom of About iConnect Access window. 
                var UdiLocation = viewer.GetElement("cssselector", BluRingViewer.div_AboutScreenUDInumber).Location.X;
                var FooterLocation = viewer.GetElement("cssselector", BluRingViewer.div_AboutScreenFooter).Location.X;
                string UDItext = viewer.GetElement("cssselector", BluRingViewer.div_AboutScreenUDInumber).Text;
                if (UdiLocation > FooterLocation && UDItext.StartsWith("UDI:(01)") && UDItext.Contains("(10)" + Config.buildversion)
                    && UDItext.Contains("(11)"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step4 Verify that the following parts are available in the UDI. 
                String buildDate = BasePage.GetBuildDetails()["Date"];
                DateTime Date = DateTime.ParseExact(buildDate.Split(new String[] { ",", " " }, StringSplitOptions.RemoveEmptyEntries)[1], "mm/dd/yyyy", System.Globalization.CultureInfo.CurrentUICulture);
                String BuildDate = Date.ToString("yymmdd");//Date.Year.ToString().Replace("20", String.Empty) + Date.Month.ToString() + Date.Day;

                //Get Build number 
                string buildno = login.GetBuildID();

                //Verify UDI is displayed in About iConnect Access splash screen with correct details.
                if (UDItext.StartsWith("UDI:(01)" + DeviceIdentifierNo) && UDItext.Contains("(10)" + Config.buildversion + "." + buildno)
                    && UDItext.EndsWith("(11)" + BuildDate))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step5 Verify the build id in 'Batch/Lot Number' in the UDI is consistent to the Build number in "Build.info" file from C:\WebAccess on the iCA server.
                using (StreamReader sr = new StreamReader("C:\\WebAccess\\Build.Info"))
                {
                    while ((line = sr.ReadLine()) != null)
                    {
                        if (line.Contains("Build Number")) { build = line; break; }
                    }
                    build = build.Split(':')[1].Trim();
                }
                if (build.Equals(buildno))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step6 Verify the manufacturing date format in the UDI.
                String[] ManufacturingDate = UDItext.Split(')');
                if (ManufacturingDate[3].Equals(BuildDate))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step7 Click the close button at the bottom to close the About iConnect Access splash screen window.
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.ClickElement(viewer.GetElement("cssselector", BluRingViewer.div_AboutScreen + " " + BluRingViewer.div_AboutScreenCloseButton));
                }
                else
                {
                    viewer.GetElement("cssselector", BluRingViewer.div_AboutScreen + " " + BluRingViewer.div_AboutScreenCloseButton).Click();
                }
                bool step7 = viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_AboutScreen));
                if (!step7)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step8  	Close the study and logout from Administrator
                viewer.CloseBluRingViewer();
                login.Logout();
                bool step8 = viewer.GetElement("cssselector", "input[id$= '_LoginMasterContentPlaceHolder_Username']").Displayed;
                if (step8)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///   Lossy compression tag in viewer for specific studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_162581(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;


            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                

                //step1 Load a study that has Lossy compression text in the viewer.
                login.LoginIConnect(adminUserName, adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession);
                viewer = BluRingViewer.LaunchBluRingViewer();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step2 & step3 Click on "Show/Hide operation" icon from Global toolbar and select "Hide Image Text" option from the drop-down and Verify the position of the Lossy compresion text.
                viewer.SelectShowHideValue("Hide Image Text");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_viewport));
                if (step2)
                {
                    result.steps[ExecutedSteps].StepPass();
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                    result.steps[++ExecutedSteps].StepFail();
                }

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Calibration tool should be in disabled for PR/KO/MR/CT/PT/NM modalities
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164472(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String PatientIdList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] Accession = AccessionList.Split(':');

                // Step 1 - Login to application as an Administrator.                
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                ExecutedSteps++;

                // Step 2 - Navigate to studies tab, search for any MR modality study and load it in Universal Viewer
                Studies studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: PatientIdList, AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                // Step 3 - Right click on a Viewport and observe Calibration tool
                viewer.OpenViewerToolsPOPUp();
                String text = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolbox + " "
                    + BluRingViewer.div_toolWrapper + "[title='Calibration Tool']")).GetAttribute("class");
                bool mr = text.Contains("tool-disabled");
                if (mr)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // STep 4 - Close Universal Viewer and load any study with CT modality
                viewer.CloseBluRingViewer();
                if(BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                PageLoadWait.WaitForPageLoad(60);
                PageLoadWait.WaitForFrameLoad(60);
                studies.SearchStudy(LastName: "*", AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                // Step 5 - Right click on a Viewport and observe Calibration tool
                viewer.OpenViewerToolsPOPUp();
                text = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper + "[title='Calibration Tool']")).GetAttribute("class");
                bool ct = text.Contains("tool-disabled");
                if (ct)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // STep 6 - Verify the Calibration tool state for PR, KO, PT, NM modalities 
                // (PR: 274935, KO: MS10025, PT: 301411930, NM:3453451)
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                // Verifying calibration tool for PR studies.
                studies.SearchStudy(LastName: "*", AccessionNo: Accession[2], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[2]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                text = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper + "[title='Calibration Tool']")).GetAttribute("class");
                bool pr = text.Contains("tool-disabled");

                // Verifying calibration tool for KO studies.
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.SearchStudy(LastName: "*", AccessionNo: Accession[3], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Modality", "MR,KO");
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                text = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper + "[title='Calibration Tool']")).GetAttribute("class");
                bool ko = text.Contains("tool-disabled");

                // Verifying calibration tool for PT studies.
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.SearchStudy(LastName: "*", AccessionNo: Accession[4], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[4]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                text = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper + "[title='Calibration Tool']")).GetAttribute("class");
                bool pt = text.Contains("tool-disabled");

                // Verifying calibration tool for NM studies.
                viewer.CloseBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    login.Navigate("Inbounds");
                    login.Navigate("Studies");
                }
                studies.SearchStudy(LastName: "*", AccessionNo: Accession[5], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[5]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                text = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewportToolbox + " " + BluRingViewer.div_toolWrapper + "[title='Calibration Tool']")).GetAttribute("class");
                bool nm = text.Contains("tool-disabled");

                Logger.Instance.InfoLog("PR: " + pr + " KO: " + ko + " PT: " + pt + " NM: " + nm);
                if (pr && ko && pt && nm)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Close the viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Viewport Stack Slider
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164449(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            var isImageSplit = "";
            UserPreferences userpref = new UserPreferences();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');

                // Preconditions
                login.LoginIConnect(adminUserName, adminPassword);
                userpref.OpenUserPreferences();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("m_preferenceFrame");
                PageLoadWait.WaitForPageLoad(20);
                userpref.ModalityDropDown().SelectByText("US");
                isImageSplit = userpref.ThumbnailSplittingImageRadioBtn().GetAttribute("Checked");
                if (isImageSplit == null)
                    userpref.ClickElement(userpref.ThumbnailSplittingImageRadioBtn());
                PageLoadWait.WaitForFrameLoad(10);
                userpref.CloseUserPreferences();
                PageLoadWait.WaitForPageLoad(20);
                login.Logout();

                //step1 Login to application as an Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                //step2 Navigate to Studies tab, search for a study which has multiple series 
                //and each series has multiple images and load it in Universal Viewer.
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step3 Observe all the viewports. 
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(1, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                bool[] step3 = new bool[4];
                for (int i = 0; i < 4; i++)
                    step3[i] = viewer.GetElement("cssselector", "div.viewerContainer:nth-of-type(" + (i + 1) + ")" + " " + BluRingViewer.div_FullStackSlider).GetCssValue("left").Equals("0px");
                if (step3[0] && step3[1] && step3[2] && step3[3])
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step4 Verify the number shows at top and bottom of the slider.
                bool step4_1 = viewer.GetElement("cssselector", "div.viewerContainer:nth-of-type(1)" + " " + BluRingViewer.div_StackSliderLabel + ":nth-child(1)").GetAttribute("innerHTML").Equals("1");
                bool step4_2 = viewer.GetElement("cssselector", "div.viewerContainer:nth-of-type(1)" + " " + BluRingViewer.div_StackSliderLabel + ":nth-child(3)").GetAttribute("innerHTML").Equals("23");
                if (step4_1 && step4_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step5 Mouse hover on the slider 
                IWebElement element = viewer.GetElement("cssselector", BluRingViewer.div_FullStackSlider);
                var Actions = new TestCompleteAction();
                Actions.MoveToElement(element);
                bool step5 = element.GetCssValue("opacity").Equals("1");
                if (step5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step6 Observe the cursor 
                bool step6 = element.GetCssValue("cursor").Equals("auto");
                if (step6)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step7 Mouse hover on the orange box / slice in the slider and observe the cursor type.
                IWebElement element_1 = viewer.GetElement("cssselector", BluRingViewer.div_StackSliderBox);
                Actions.MoveToElement(element_1);
                bool step7 = element_1.GetCssValue("cursor").Equals("grab");
                if (step7)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step8 In Viewport, Scroll down the mouse wheel once.
                int StackSliderLocation = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                IWebElement element_2 = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                Actions.MouseScroll(element_2, "down", "1");
                int StackSliderLocation_1 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step8 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("2");
                if (step8 && StackSliderLocation_1 > StackSliderLocation)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step9 Press the keyboard up/down arrows
                element_2.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(10000);
                int StackSliderLocation_2 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step9 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("3");
                Logger.Instance.InfoLog("Value after hitting down arrow: " + viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                element_2.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(10000);
                int StackSliderLocation_3 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step9_1 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("2");
                Logger.Instance.InfoLog("Value after hitting down arrow: " + viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (step9 && step9_1 && StackSliderLocation_2 > StackSliderLocation_1 && StackSliderLocation_3 < StackSliderLocation_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step10 Scroll down mouse wheel 5 times from Image 2 to Image 7
                Actions.MouseScroll(element_2, "down", "5");
                int StackSliderLocation_4 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step10 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("7");
                if (step10 && StackSliderLocation_4 > StackSliderLocation_3)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step11 Scroll up mouse wheel once.
                Actions.MouseScroll(element_2, "up", "1");
                int StackSliderLocation_5 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step11 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("6");
                if (step11 && StackSliderLocation_5 < StackSliderLocation_4)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step12 Scroll up mouse wheel 2 times from Image 6 to Image 4 
                Actions.MouseScroll(element_2, "up", "2");
                int StackSliderLocation_6 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step12 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("4");
                if (step12 && StackSliderLocation_6 < StackSliderLocation_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step13 Verify user can able to move the image using slider control by draging the orange box
                int StackSliderValue = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                int width = element.Size.Width;
                int height = element.Size.Height;
                Actions.ClickAndHold(element_1);
                Actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_FullStackSlider)), width / 2, height / 2).Release();
                int StackSliderLocation_7 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step13 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("12");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step13_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (StackSliderLocation_7 > StackSliderLocation_6 && step13 && step13_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step14 Click on the bottom of the slider. 
                Actions.ClickAndHold(element_1);
                Actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_FullStackSlider)), width / 2, height).Release();
                int StackSliderLocation_8 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step14 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("23");
                if (step14 && StackSliderLocation_8 > StackSliderLocation_7)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step15 Press the keyboard up arrow. 
                element_2.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(10000);
                bool step15 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("22");
                if (step15)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step16 Click anywhere in the slider. 
                Actions.ClickAndHold(element_1);
                Actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_FullStackSlider)), width / 2, height / 2).Release();
                int StackSliderLocation_9 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step16 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("12");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step16_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (StackSliderLocation_9 < StackSliderLocation_8 && step16 && step16_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step17 Close the viewer and load a study with multiple frames in universal viewer
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[1]);
                BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step18 Observe all the viewports. 
                bool[] step18 = new bool[4];
                for (int i = 0; i < 4; i++)
                    step18[i] = viewer.GetElement("cssselector", "div.viewerContainer:nth-of-type(" + (i + 1) + ")" + " " + BluRingViewer.div_FullStackSlider).GetCssValue("left").Equals("0px");
                if (step18[0] && step18[1] && step18[2] && step18[3])
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step19 Scroll down mouse wheel by 7 times and verify the Stack slider image count.
                int StackSliderValue_3 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                IWebElement element_3 = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                Actions.MouseScroll(element_3, "down", "7");
                bool step19 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("8");
                if (step19)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step20 Scroll up mouse wheel by 3 times and verify the stack slider image count.
                Actions.MouseScroll(element_3, "up", "3");
                bool step20 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("5");
                if (step20)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step21 Verify user can able to move the image using slider control by draging the orange box
                IWebElement element_4 = viewer.GetElement("cssselector", BluRingViewer.div_StackSliderBox);
                Actions.ClickAndHold(element_4);
                Actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_FullStackSlider)), width / 2, height / 2).Release();
                bool step21 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML")).Equals(22);
                int StackSliderLocation_10 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                if (StackSliderLocation_10 > StackSliderLocation && step21)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step22 Press the keyboard up/down arrows
                element_3.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(10000);
                bool step22 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML")).Equals(21);
                Logger.Instance.InfoLog("Value after hitting down arrow: " + viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                element_3.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(10000);
                bool step22_1 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML")).Equals(22);
                Logger.Instance.InfoLog("Value after hitting Up arrow: " + viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (step22 && step22_1)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step23 Click on the bottom of the slider. 
                Actions.ClickAndHold(element_4);
                Actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_FullStackSlider)), width / 2, height).Release();
                int StackSliderLocation_11 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                bool step23 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("43");
                if (step23 && StackSliderLocation_11 > StackSliderLocation_10)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step24 Click anywhere in the slider
                Actions.ClickAndHold(element_4);
                Actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_FullStackSlider)), width / 2, height / 2).Release().Perform();
                bool step24 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML")).Equals(22);
                int StackSliderLocation_12 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSliderBox).Location.Y;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step24_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (StackSliderLocation_12 < StackSliderLocation_11 && step24 && step24_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step25 Click on Show / Hide in global toolbar.
                bool step25 = viewer.Verify_ShowHideDropdown_Values(Value: "HIDE STACK SLIDER");
                if (step25)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step26 Click on Hide Stack Slider and observe all the viewports
                bool[] step26 = new bool[4];
                bool step26_1 = viewer.SelectShowHideValue("HIDE STACK SLIDER");
                for (int i = 0; i < 4; i++)
                    step26[i] = viewer.IsElementVisible(By.CssSelector("div.viewerContainer:nth-of-type(" + (i + 1) + ")" + " " + BluRingViewer.div_FullStackSlider));
                if (!step26[0] && !step26[1] && !step26[2] && !step26[3] && step26_1)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step27 Click on Show / Hide in global toolbar. 
                bool step27 = viewer.Verify_ShowHideDropdown_Values(Value: "SHOW STACK SLIDER");
                if (step27)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step28 Click on Show Stack Slider and observe all viewports
                bool[] step28 = new bool[4];
                bool step28_1 = viewer.SelectShowHideValue("SHOW STACK SLIDER");
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    for (int i = 0; i < 4; i++)
                    {
                        step28[i] = viewer.IsElementVisibleInUI(By.CssSelector("div.viewerContainer:nth-of-type(" + (i + 1) + ")" + " " + BluRingViewer.div_FullStackSlider));
                    }
                }
                else
                {
                    for (int i = 0; i < 4; i++)
                    {
                        step28[i] = viewer.IsElementVisible(By.CssSelector("div.viewerContainer:nth-of-type(" + (i + 1) + ")" + " " + BluRingViewer.div_FullStackSlider));
                    }
                }
                if (step28[0] && step28[1] && step28[2] && step28[3] && step28_1)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step29 Press the keyboard up arrow. 
                element_3.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(10000);
                bool step29 = Int32.Parse(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML")).Equals(21);
                Logger.Instance.InfoLog("Value after hitting down arrow: " + viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML"));
                if (step29)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step30 Close the Universal viewer 
                viewer.CloseBluRingViewer();
                ExecutedSteps++;

                //step31 Search for a study which has single image and load it Universal viewer.
                studies.SearchStudy(AccessionNo: Accession[2], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[2]);
                BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step32 Observe the viewport. 
                bool step32 = viewer.IsElementVisible(By.CssSelector("div.viewerContainer:nth-of-type(1)" + " " + BluRingViewer.div_FullStackSlider));
                if (!step32)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                login.LoginIConnect(adminUserName, adminPassword);
                userpref.OpenUserPreferences();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame").SwitchTo().Frame("m_preferenceFrame");
                PageLoadWait.WaitForPageLoad(20);
                userpref.ModalityDropDown().SelectByText("US");
                if (isImageSplit == null)
                {
                    userpref.ClickElement(userpref.ThumbnailSplittingSeriesRadioBtn());
                    Logger.Instance.InfoLog("The Thumbnails splitting is reverted back to Series");
                }
                PageLoadWait.WaitForFrameLoad(10);
                userpref.CloseUserPreferences();
                PageLoadWait.WaitForPageLoad(20);
                login.Logout();
            }
        }

        /// <summary>
        /// Image Viewing Series
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161201(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;

            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            DomainManagement domain = new DomainManagement();
            login.LoginIConnect(adminUserName, adminPassword);
            domain = (DomainManagement)login.Navigate("DomainManagement");
            domain.SearchDomain(Config.adminGroupName);
            domain.SelectDomain(Config.adminGroupName);
            domain.ClickEditDomain();
            domain.ModalityDropDown().SelectByText("MR");
            bool domainsel = true;
            IWebElement viewerScope = BasePage.Driver.FindElement(By.CssSelector("span[title = 'Select View Scope'] input[value = 'Image']"));
            domainsel = viewerScope.Selected;
            if (!domainsel)
                viewerScope.Click();
            domain.ClickSaveDomain();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //step1 Load a study with multiple series that contain multiple images into the Universal viewer.
                //Right click on selected series viewport and select Window Level tool from floating toolbox.
                login.LoginIConnect(adminUserName, adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", AccessionList);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(1, 1);
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                }
                IWebElement element = viewer.GetElement("cssselector", viewer.Activeviewport);
                bool step1 = element.GetCssValue("cursor").Equals("pointer");
                if (step1)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //step2 Check how tool affected by layout/reset
                bool step2 = viewer.ChangeViewerLayout("3x2");
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom(width / 2, height / 2, width / 9, height / 9);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step2_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step2 && step2_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step3 Double click or drag and drop on another series thumbnail from thumbnail preview or from Thumbnail bar
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.ClickOnThumbnailsInStudyPanel(1, 2, true, true);
                }
                else
                {
                    viewer.ClickOnThumbnailsInStudyPanel(1, 2, true);
                }
                BluRingViewer.WaitforViewports();
                if (BluRingViewer.VerifyThumbnailsInStudyPanelIsActive(1, 2))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }
                //step4 Double click or drag and drop on previous series thumbnail from thumbnail preview or from Thumbnail bar
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.ClickOnThumbnailsInStudyPanel(1, 1, true, true);
                }
                else
                {
                    viewer.ClickOnThumbnailsInStudyPanel(1, 1, true);
                }
                BluRingViewer.WaitforViewports();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (BluRingViewer.VerifyThumbnailsInStudyPanelIsActive(1, 1) && step4)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step5 Select series layout 1 Series, and view the image that was previously manipulated.
                viewer.ChangeViewerLayout("1x1");
                int viewportcount = viewer.GetViewPortCount(1);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5 && viewportcount == 1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }
                //step6  Scroll to another image in series.
                viewer.ApplyTool_Zoom(width / 2, height / 4, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                TestCompleteAction Actions = new TestCompleteAction();
                Actions.MouseScroll(element, "down", "2");
                bool step6_1 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("3");
                if (step6 && step6_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step7 Scroll back to the image that was previously manipulated.
                Actions.MouseScroll(element, "up", "2");
                bool step7 = viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_StackSlider).GetAttribute("innerHTML").Equals("1");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step7_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step7 && step7_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }


                //step8 Select Reset tool.
                viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step9 Select Zoom tool.
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                bool step9 = element.GetCssValue("cursor").Equals("n-resize");
                if (step9)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step10 Click LMB on viewport and drag cursor.
                viewer.PerformTool(width / 2, height, width / 4, height / 3, false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step10)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }


                //step11 Release the LMB.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("firefox"))
                {
                    new Actions(BasePage.Driver).Release().Build().Perform();
                }
                else
                {
                    new TestCompleteAction().Release().Perform();
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                if (!domainsel)
                {
                    login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                    login.NavigateToDomainManagementTab();
                    domain.SearchDomain(Config.adminGroupName);
                    domain.SelectDomain(Config.adminGroupName);
                    domain.ClickEditDomain();
                    domain.ModalityDropdown().SelectByText("MR");
                    BasePage.Driver.FindElement(By.CssSelector("span[title = 'Select View Scope'] input[value = 'Series']")).Click();
                }
            }

        }


        /// <summary>
        /// W/L operation for Specific CR study
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161221(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //step1 Import the study from the below location to the configured data source.
                //Study Already Available in configured DataSource
                ExecutedSteps++;

                //step2 Load the imported study in the universal viewer.
                login.LoginIConnect(adminUserName, adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", AccessionList);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step3 Verify the WL/WW values on the images.
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //step4 Select the W/L tool from the floating toolbar. Apply WW/WL slowly over the Image.
                IWebElement element = viewer.GetElement("cssselector", viewer.Activeviewport);
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width / 2, height / 2).ClickAndHold();
                    Thread.Sleep(2000);
                    actions.MoveToElement(element, width / 3, height / 2 + Convert.ToInt32(width / 6)).Release();
                    Thread.Sleep(2000);
                }
                else
                    viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer"))
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(element, width / 3, height / 2 + Convert.ToInt32(height / 11)).ClickAndHold();
                    Thread.Sleep(2000);
                    actions.MoveToElement(element, width / 3 + 2, height / 2 + (width / 7)).Release().Perform();
                    Thread.Sleep(2000);
                }
                else
                    viewer.ApplyTool_WindowWidth(width / 2, height / 2, width - Convert.ToInt32(width / 2), height - Convert.ToInt32(height / 2));
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step4_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step4 && step4_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                //Return Result
                return result;
            }
        }

        /// <summary>
        /// Default scope for each modality at domain/role/user preferences level
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164376(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            DomainManagement domainManagement = new DomainManagement();
            RoleManagement roleManagement = new RoleManagement();
            UserManagement userManagement = new UserManagement();
            UserPreferences userPreferences = new UserPreferences();
            ServiceTool servicetool = new ServiceTool();
            WpfObjects wpfObjects = new WpfObjects();
            Studies studies = new Studies();
            int ExecutedSteps = -1;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String ModalityList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "Reason");
                String[] Accession = AccessionList.Split(':');
                String[] Modality = ModalityList.Split(':');
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                //STep 1 
                // From Service tool set the Viewing Scope to 'Series' for MR
                servicetool.InvokeServiceTool();
                wpfObjects.WaitTillLoad();
                servicetool.NavigateToViewerTab();
                wpfObjects.WaitTillLoad();
                servicetool.NavigateSubTab(ServiceTool.Viewer.Name.Protocols_tab);
                wpfObjects.WaitTillLoad();
                servicetool.ClickModifyFromTab();
                var modality = wpfObjects.GetAnyUIItem<ITabPage, ComboBox>(servicetool.GetCurrentTabItem(), ServiceTool.Viewer.ID.ModalityCmbBox);
                modality.SetValue("MR");
                servicetool.ChangeViewerScope("Image");
                servicetool.ClickApplyButtonFromTab();
                wpfObjects.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                wpfObjects.WaitTillLoad();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                //From Domain Management page is set Viewing Scope to 'Image' for MR
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.NavigateToDomainManagementTab();
                domainManagement.CreateDomain(domain1, role1, datasources: null);
                domainManagement.ClickSaveNewDomain();
                domainManagement.SearchDomain(domain1);
                domainManagement.SelectDomain(domain1);
                domainManagement.ClickEditDomain();
                domainManagement.ModalityDropdown().SelectByText("MR");
                domainManagement.ViewerImage().Click();
                domainManagement.SaveButton().Click();
                login.Navigate("UserManagement");
                userManagement.CreateUser(rad1, domain1, role1);

                //From Role Management Page is set Viewing Scope to 'Image' for MR
                login.Navigate("Role Management");
                roleManagement.SearchRole(role1, domain1);
                roleManagement.SelectRole(role1);
                roleManagement.ClickEditRole();
                bool rolesel = roleManagement.UseDomainSetting().Selected;
                if (!rolesel)
                    roleManagement.UseDomainSetting().Click();
                roleManagement.SaveBtn().Click();
                login.Logout();

                //Login ICA as the user with this role
                //login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.LoginIConnect(rad1, rad1);

                //Open an MR study in Universal viewer.
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 2 - Apply W/L on the first image in a series with multiple images.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                var activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step2_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step2_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step2_1 && step2_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 3 - Scroll to next image, apply Zoom on the image.
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step3_1 && step3_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 4 - Scroll to next image, apply Pan on the image.
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step4_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step4_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step4_1 && step4_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 5 - Scroll to next image, apply Rotate on the image.
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step5_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step5_1 && step5_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 6 - Scroll to next image, apply Flip on the image.
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step6_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step6_1 && step6_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 7 - Scroll to next image, apply Grayscale inversion on the image.
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step7_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(5000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step7_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step7_1 && step7_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 8 - Scroll to next image, apply Reset on the image.
                viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step8_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step8_1 && step8_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // STep 9 
                // 1. From Role Management Page set Viewing Scope to 'Series' for MR
                // 2.Login ICA as the user with this role
                // 3.Open a MR study in Universal viewer.
                viewer.CloseBluRingViewer();
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate("Role Management");
                roleManagement.SearchRole(role1, domain1);
                roleManagement.SelectRole(role1);
                roleManagement.ClickEditRole();
                rolesel = roleManagement.UseDomainSetting().Selected;
                if (rolesel)
                    roleManagement.UseDomainSetting().Click();
                roleManagement.ModalityDropdown().SelectByText("MR");
                roleManagement.ViewerSeries().Click();
                roleManagement.SaveBtn().Click();
                login.Logout();
                login.LoginIConnect(rad1, rad1);
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 10 - Apply W/L on an image in a series with multiple images. Scroll to next image.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step10_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step10_1 && step10_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 11 -
                // 1. Return to Service tool and now set the Viewing Scope to 'Series' for MR
                viewer.CloseBluRingViewer();
                login.Logout();
                servicetool.InvokeServiceTool();
                wpfObjects.WaitTillLoad();
                servicetool.NavigateToViewerTab();
                wpfObjects.WaitTillLoad();
                servicetool.NavigateSubTab(ServiceTool.Viewer.Name.Protocols_tab);
                wpfObjects.WaitTillLoad();
                servicetool.ClickModifyFromTab();
                modality = wpfObjects.GetAnyUIItem<ITabPage, ComboBox>(servicetool.GetCurrentTabItem(), ServiceTool.Viewer.ID.ModalityCmbBox);
                modality.SetValue("MR");
                servicetool.ChangeViewerScope("Series");
                servicetool.ClickApplyButtonFromTab();
                wpfObjects.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                wpfObjects.WaitTillLoad();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                // 2.From Domain Management page is set Viewing Scope to 'Image' for MR
                // This setting done in step 1

                // 3.From Role Management Page is set Viewing Scope to 'Series' for MR
                // This setting done in step 9

                // 4.Login ICA as the user with this role
                login.LoginIConnect(rad1, rad1);

                // 5.Open an MR study in Universal viewer.
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 12 - Apply W/L on an image in a series with multiple images. Scroll to next image.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step12_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step12_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step12_1 && step12_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 13
                // i.From iCA Domain Management page set Viewing Scope to 'Image' for MR
                // This is already set in step 1

                // ii.From Role Management page ensure option 'Use Domain Setting'
                viewer.CloseBluRingViewer();
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate("Role Management");
                roleManagement.SearchRole(role1, domain1);
                roleManagement.SelectRole(role1);
                roleManagement.ClickEditRole();
                rolesel = roleManagement.UseDomainSetting().Selected;
                if (!rolesel)
                    roleManagement.UseDomainSetting().Click();
                roleManagement.SaveBtn().Click();
                login.Logout();

                // iii.Login ICA as the user with this role
                login.LoginIConnect(rad1, rad1);

                // iv.Open a MR study in Universal viewer.
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 14 - Apply W/L on an image in a series with multiple images.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step14_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step14_1 && step14_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 15
                //From iCA Domain Management page, set Viewing Scope to 'Series' for MR
                viewer.CloseBluRingViewer();
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.NavigateToDomainManagementTab();
                domainManagement.SearchDomain(domain1);
                domainManagement.SelectDomain(domain1);
                domainManagement.ClickEditDomain();
                domainManagement.ModalityDropdown().SelectByText("MR");
                domainManagement.ViewerSeries().Click();
                domainManagement.SaveButton().Click();
                login.Logout();

                //From Role Management page ensure option 'Use Domain Setting' selected
                // This is already set in step 13

                //Login ICA as the user with this role
                login.LoginIConnect(rad1, rad1);

                //Open a MR study in Universal viewer.
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 16 - Apply W/L on an image in a series with multiple images. Scroll to next image.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step16_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step16_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step16_1 && step16_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 17 - Apply the following tools on different image one at time - 
                // Window / Level, Zoom, Pan, Rotate ,Flip ,Grayscale inversion ,Reset
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(500);
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(500);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(500);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step17_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step17_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step17_3 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step17_4 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step17_1 && step17_2 && step17_3 && step17_4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 18 
                // Set Viewing Scope in Domain Management page to 'Series' for MR
                // This is already set in step 16
                // Role Management page Viewing Scope to 'Image' for MR
                viewer.CloseBluRingViewer();
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate("Role Management");
                roleManagement.SearchRole(role1, domain1);
                roleManagement.SelectRole(role1);
                roleManagement.ClickEditRole();
                rolesel = roleManagement.UseDomainSetting().Selected;
                if (rolesel)
                    roleManagement.UseDomainSetting().Click();
                roleManagement.ModalityDropdown().SelectByText("MR");
                roleManagement.ViewerImage().Click();
                roleManagement.SaveBtn().Click();
                login.Logout();

                // Login ICA as the user with this role
                login.LoginIConnect(rad1, rad1);

                // Open a MR study in Universal viewer..
                //studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 19 - Apply W/L on an image in a series with multiple images.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step19_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step19_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step19_1 && step19_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 20 - Apply the following tools on different image one at time - 
                // Window / Level, Zoom, Pan, Rotate ,Flip ,Grayscale inversion ,Reset 
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(500);
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(500);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(500);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step20_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step20_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step20_3 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step20_4 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step20_1 && step20_2 && step20_3 && step20_4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 21 - Exit the Universal viewer and Open User Preferences and change Viewing Scope to 'Series' for MR,
                // re -open the same MR or open a MR study in Universal viewer.
                viewer.CloseBluRingViewer();
                login.OpenUserPreferences();
                userPreferences.SwitchToUserPrefFrame();
                userPreferences.ModalityDropDown().SelectByText("MR");
                userPreferences.ClickElement(userPreferences.ViewingScopeSeriesRadioBtn());
                userPreferences.CloseUserPreferences();
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 22 - Apply W/L on an image in a series with multiple images. Scroll to next image.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step22_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step22_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step22_1 && step22_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 23 - 
                // Set Viewing Scope in Domain Management page to 'Series' for MR
                // This is already set in step 16
                // Role Management page Viewing Scope to 'Series' for MR.
                viewer.CloseBluRingViewer();
                login.Logout();
                login.LoginIConnect(Config.adminUserName, Config.adminPassword);
                login.Navigate("Role Management");
                roleManagement.SearchRole(role1, domain1);
                roleManagement.SelectRole(role1);
                roleManagement.ClickEditRole();
                rolesel = roleManagement.UseDomainSetting().Selected;
                if (rolesel)
                    roleManagement.UseDomainSetting().Click();
                roleManagement.ModalityDropdown().SelectByText("MR");
                roleManagement.ViewerSeries().Click();
                roleManagement.SaveBtn().Click();
                login.Logout();

                // Login ICA as the user with this role
                login.LoginIConnect(rad1, rad1);

                // Open User Preferences and change Viewing Scope to 'Image' for MR
                // Open a MR study in Universal viewer.
                login.OpenUserPreferences();
                userPreferences.SwitchToUserPrefFrame();
                userPreferences.ModalityDropDown().SelectByText("MR");
                userPreferences.ClickElement(userPreferences.ViewingScopeImageRadioBtn());
                userPreferences.CloseUserPreferences();
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 24 - Apply W/L on an image in a series with multiple images.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step24_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step24_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step24_1 && step24_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 25 - Load a different MR study with multiple series in Universal viewer.
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 26 - Apply W/L on an image in a series with multiple images.
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step26_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step26_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step26_1 && step26_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 27 - Apply the following tools on different image one at time - 
                // Window / Level, Zoom, Pan, Rotate ,Flip ,Grayscale inversion ,Reset 
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(500);
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(500);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(500);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step27_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step27_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step27_3 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step27_4 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step27_1 && step27_2 && step27_3 && step27_4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 28 - Exit the Universal viewer,Open User Preferences and change Viewing Scope to 'Image' for CT, 
                // open a CT study in Universal viewer.
                viewer.CloseBluRingViewer();
                studies.OpenUserPreferences();
                userPreferences.SwitchToUserPrefFrame();
                userPreferences.ModalityDropDown().SelectByText("CT");
                userPreferences.ClickElement(userPreferences.ViewingScopeImageRadioBtn());
                userPreferences.CloseUserPreferences();
                studies.SearchStudy(AccessionNo: Accession[2], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", Accession[2]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 29 - Apply W/L on an image in a series with multiple images.
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(1, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step29_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step29_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step29_1 && step29_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 30  - Apply the following tools on different image one at time - 
                // Window / Level, Zoom, Pan, Rotate ,Flip ,Grayscale inversion ,Reset 
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(500);
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(500);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(500);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step30_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step30_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step30_3 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step30_4 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step30_1 && step30_2 && step30_3 && step30_4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 31 - Exit the Universal viewer ,Open User Preferences and change Viewing Scope to"Series' for CT 
                // and open a CT study in Universal viewer.
                viewer.CloseBluRingViewer();
                studies.OpenUserPreferences();
                userPreferences.SwitchToUserPrefFrame();
                userPreferences.ModalityDropDown().SelectByText("CT");
                userPreferences.ClickElement(userPreferences.ViewingScopeSeriesRadioBtn());
                userPreferences.CloseUserPreferences();
                studies.SelectStudy("Accession", Accession[2]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                if (BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_studypanel)).Count == 1)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 32 - Apply the following tools on different image one at time - 
                // Window / Level, Zoom, Pan, Rotate ,Flip ,Grayscale inversion ,Reset 
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    viewer.SetViewPort(1, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                    viewer.SetViewPort(0, 1);
                    new TestCompleteAction().MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Click().Perform();
                }
                activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(500);
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(500);
                viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(500);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step32_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step32_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step32_3 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step32_4 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                if (step32_1 && step32_2 && step32_3 && step32_4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 33 - Exit the Universal viewer 
                // Open User Preferences and change Viewing Scope to 'Image' for NM, PT, RF, XA. 
                // Load NM study in Universal viewer and apply a tool on an image in a series with multiple images. 
                // Repeat this step for PT, RF and XA studies.
                int passcount = 0;
                int goldimg = 0;
                for (int i = 2; i < Modality.Count(); i++)
                {
                    viewer.CloseBluRingViewer();
                    studies.OpenUserPreferences();
                    userPreferences.SwitchToUserPrefFrame();
                    userPreferences.ModalityDropDown().SelectByText(Modality[i]);
                    userPreferences.ClickElement(userPreferences.ViewingScopeImageRadioBtn());
                    userPreferences.CloseUserPreferences();
                    studies.SearchStudy(AccessionNo: Accession[i + 1], Modality: Modality[i], Datasource: login.GetHostName(Config.EA91));
                    studies.SelectStudy("Accession", Accession[i + 1]);
                    viewer = BluRingViewer.LaunchBluRingViewer();
                    viewer.SelectViewerTool(BluRingTools.Window_Level);
                    viewer.ApplyTool_WindowWidth();
                    Thread.Sleep(2000);
                    activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                    if (i == 2)
                        result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, goldimg++);
                    else
                        result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, goldimg++);
                    bool step33_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                    activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                    Thread.Sleep(3000);
                    result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, goldimg++);
                    bool step33_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                    if (step33_1 && step33_2)
                        passcount++;
                    Logger.Instance.InfoLog("Modality[i] result: " + step33_1 + "And" + step33_2);
                }
                if (passcount == 4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                login.CreateNewSesion();
                login.DriverGoTo(login.url);
                login.LoginIConnect(rad1, rad1);

                // Step 34 - Exit the Universal viewer
                // Open User Preferences and change Viewing Scope to"Series' for NM, PT, RF, XA, Load NM study in Universal viewer
                // and apply a tool on an image in a series with multiple images. Repeat this step for PT, RF and XA studies.
                passcount = 0;
                goldimg = 0;
                for (int i = 2; i < Modality.Count(); i++)
                {
                    //viewer.CloseBluRingViewer();
                    studies.OpenUserPreferences();
                    userPreferences.SwitchToUserPrefFrame();
                    userPreferences.ModalityDropDown().SelectByText(Modality[i]);
                    userPreferences.ClickElement(userPreferences.ViewingScopeSeriesRadioBtn());
                    userPreferences.CloseUserPreferences();
                    studies.SearchStudy(AccessionNo: Accession[i + 1], Datasource: login.GetHostName(Config.EA91));
                    studies.SelectStudy("Accession", Accession[i + 1]);
                    viewer = BluRingViewer.LaunchBluRingViewer();
                    viewer.SelectViewerTool(BluRingTools.Window_Level);
                    viewer.ApplyTool_WindowWidth();
                    Thread.Sleep(2000);
                    activeViewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                    if (i == 2)
                        result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, goldimg++);
                    else
                        result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, goldimg++);
                    bool step34_1 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                    activeViewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                    Thread.Sleep(3000);
                    result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, goldimg++);
                    bool step34_2 = studies.CompareImage(result.steps[ExecutedSteps], activeViewport);
                    if (step34_1 && step34_2)
                        passcount++;
                    Logger.Instance.InfoLog("Modality[i] result: " + step34_1 + "And" + step34_2);
                    viewer.CloseBluRingViewer();
                }
                if (passcount == 4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Close the viewer and logout
                //viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///  Image or Series Scope Tool
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_161308(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            UserManagement usermanagement = new UserManagement();
            var studies = new Studies();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                // Precondition:
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.ClickSaveNewDomain();
                domain.SearchDomain(domain1);
                domain.SelectDomain(domain1);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(4)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Series Scope", group1);
                domain.AddToolsToToolbox(dictionary);
                dictionary.Add("Image Scope", group1);
                domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                login.Logout();


                //Step 1 - Login as Administrator and Launch the Enterprise viewer
                login.LoginIConnect(rad1, rad1);
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", AccessionList);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 2 - Right click on Viewport and Open the Floating Toolbox
                viewer.OpenViewerToolsPOPUp();
                if (viewer.IsElementVisibleInUI(By.CssSelector(BluRingViewer.div_toolboxContainer)))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 3 , 4, and 5 - Select Image Scope from floating Toolbox
                var step5 = viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement, false);
                ExecutedSteps += 2;
                if (step5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                //Step 6 - Change the layout to 1x1                
                var step6_1 = viewer.ChangeViewerLayout();
                var step6_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step6_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step6_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step6_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step6_1 && step6_2 && !step6_3 && !step6_4 && !step6_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 7 - Apply W/L to the Active viewport
                var step7 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step7_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SetViewPort(0, 1);
                IWebElement Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step7_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Thread.Sleep(3000);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step7_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step7 && step7_1 && step7_2 && step7_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 8 - Apply Invert tool to the Active Viewport                 
                var step8 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step8_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step8_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step8 && step8_1 && step8_2 && step8_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 9 - Apply zoom in/out  in the Active viewport
                var step9 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step9_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step9_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9 && step9_1 && step9_2 && step9_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 10 - select different image in the same series and apply pan                                
                var step10 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step10_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step10_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step10 && step10_1 && step10_2 && step10_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 11 - Apply Rotate Clockwise tool                 
                var step11 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step11_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step11_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step11_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(2000);
                if (step11 && step11_1 && step11_2 && step11_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 12 - Apply Rotate counter clockwise tool
                var step12 = viewer.SelectInnerViewerTool(BluRingTools.Rotate_Counterclockwise, BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step12_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step12_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step12_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(2000);
                if (step12 && step12_1 && step12_2 && step12_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 13 - Apply Horizontal flip tool to the image                
                var step13 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step13_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step13_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step13_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step13 && step13_1 && step13_2 && step13_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 14 - Apply Vertical flip tool to the image
                var step14 = viewer.SelectInnerViewerTool(BluRingTools.Flip_Vertical, BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step14_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step14_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step14_1 && step14_2 && step14_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 15 - Apply two or more interaction tools(Ex: Pan,W/L) to an image in the active series viewport.
                bool step15 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                bool step15_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step15_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step15_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step15_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step15 && step15_1 && step15_2 && step15_3 && step15_4)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 16 - Apply two or more interaction tools(Ex: Pan,W/L, Zoom) to an image in the active series viewport.
                bool step16 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                bool step16_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                bool step16_2 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step16_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step16_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step16_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step16 && step16_1 && step16_2 && step16_3 && step16_4 && step16_5)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 17 - select Reset tool and observe the viewport
                bool step17 = viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step17 && step17_1)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 18 , 19 - verify the tool tip of "Series Scope" tool                
                IWebElement expandedtoolsContainer = viewer.OpenStackedTool(BluRingTools.Line_Measurement);
                IWebElement seriesscope = expandedtoolsContainer.FindElement(By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Series_Scope))).FindElement(By.XPath(".."));
                var serisScopeTitle = seriesscope.GetAttribute("title");
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    viewer.HoverElement(By.CssSelector(BluRingViewer.GetToolCss(BluRingTools.Pan)));
                    Thread.Sleep(1000);
                    viewer.HoverElement(By.CssSelector(viewer.GetStudyPanelThumbnailCss(1)));
                }
                else
                {
                    var actions = new TestCompleteAction();
                    actions.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.GetToolCss(BluRingTools.Pan)));
                    Thread.Sleep(1000);
                    actions.MoveToElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1))).Perform();
                }
                Thread.Sleep(2000);
                if (serisScopeTitle.Equals("Series Scope"))
                {
                    result.steps[ExecutedSteps += 2].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps += 2].StepFail();
                }

                // Step 20 - Select any image that have one ore more tools applied to it and change the scope from image to series.
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                bool step20 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Line_Measurement);
                Thread.Sleep(1000);
                if (step20)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // step 21 - select Reset tool and observe the viewport
                bool step21 = viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step21_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step21_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step21_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step21 && step21_1 && step21_2 && step21_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }


                // Step 22 - Apply the W/L tool to one of the images.   
                //IWebElement Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                bool step22 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step22_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step22_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step22_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step22 && step22_1 && step22_2 && step22_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 23 - Apply Invert tool
                bool step23 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step23_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step23_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step23_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                if (step23 && step23_1 && step22_2 && step22_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 24 - Apply the Zoom tool to an image.
                bool step24 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step24_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step24_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step24_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step24 && step24_1 && step24_2 && step24_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Step 25 - Apply the Pan tool to a different image.
                bool step25 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step25_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step25_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step25_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step25 && step25_1 && step25_2 && step25_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Step 26 - Apply the Rotate Clockwise tool to an image.
                bool step26 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step26_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step26_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step26_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step26 && step26_1 && step26_2 && step26_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 27 - Apply the Rotate Counter Clockwise
                bool step27 = viewer.SelectInnerViewerTool(BluRingTools.Rotate_Counterclockwise, BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step27_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step27_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step27_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step27 && step27_1 && step27_2 && step27_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 28 - Apply the Horizontal Flip tool to an image.
                bool step28 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step28_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step28_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step28_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step28 && step28_1 && step28_2 && step28_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 29 - Apply the Vertical Flip tool to an image.
                bool step29 = viewer.SelectInnerViewerTool(BluRingTools.Flip_Vertical, BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step29_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step29_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step29_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step29 && step29_1 && step29_2 && step29_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 30 - Select 1x2 layout from the layout selection grid using layout selection tool
                var step30_1 = viewer.ChangeViewerLayout("1x2");
                var step30_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step30_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step30_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step30_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step30_1 && step30_2 && step30_3 && !step30_4 && !step30_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 31 - Select any thumbnail and load into second series view port.
                viewer.SetViewPort(1, 1);
                viewer.Click("cssselector", viewer.GetViewportCss(1, 1));
                var element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(3));
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).DoubleClick(element).Build().Perform();
                }
                else
                {
                    viewer.DoubleClick(element);
                }
                Thread.Sleep(2000);
                ExecutedSteps++;

                // step 32 - 	Double click on second series viewport
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                var action = new TestCompleteAction();
                action.DoubleClick(element).Perform();
                Thread.Sleep(2000);
                ExecutedSteps++;

                // Step 33 - Apply various tools (W/L, Zoom, Pan, Rotate, Flip, Invert, Reset) to different images in second series.                
                viewer.SetViewPort(1, 1);
                bool step33 = viewer.SelectViewerTool(BluRingTools.Window_Level, viewport: 2);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                bool step33_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, viewport: 2);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 1));
                bool step33_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(2000);
                bool step33_3 = viewer.SelectViewerTool(BluRingTools.Pan, viewport: 2);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                bool step33_4 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, viewport: 2);
                Thread.Sleep(2000);
                bool step33_5 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal, viewport: 2);
                Thread.Sleep(2000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step33_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(2000);
                bool step33_7 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, viewport: 2);
                Thread.Sleep(2000);
                bool step33_8 = viewer.SelectViewerTool(BluRingTools.Reset, viewport: 2);
                Thread.Sleep(2000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step33_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step33 && step33_1 && step33_2 && step33_3 && step33_4 && step33_5 && step33_6 && step33_7
                    && step33_8 && step33_9)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 34 - Select the first series that was originally displayed.
                var step34_1 = viewer.ChangeViewerLayout("1x1");
                var step34_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step34_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step34_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step34_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step34_1 && step34_2 && !step34_3 && !step34_4 && !step34_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                // Step 35 - Apply various tools to the first series (W/L, Zoom, Pan, Rotate, Flip, Invert, Reset)
                viewer.SetViewPort(0, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                }
                bool step35 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(2000);
                bool step35_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(2000);
                bool step35_2 = viewer.SelectViewerTool(BluRingTools.Pan);
                viewer.ApplyTool_Pan();
                Thread.Sleep(2000);
                bool step35_3 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(2000);
                bool step35_4 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(2000);
                bool step35_5 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                bool step35_6 = viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(2000);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 0));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step35_7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step35_8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                //Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                //result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                //bool step35_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step35_1 && step35_2 && step35_3 && step35_4 && step35_5 && step35_6 && step35_7 && step35_8)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 36 - Change the scope to Image for first series viewport.
                if (viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 37 - Re-select the second series.
                var step37_1 = viewer.ChangeViewerLayout("2x2");
                var step37_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step37_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step37_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step37_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                viewer.SetViewPort(1, 1);
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                viewer.DoubleClick(element);
                Thread.Sleep(2000);
                if (step37_1 && step37_2 && step37_3 && step37_4 && step37_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }


                // Step 38 - Apply various tools (W/L, Zoom, Pan, Rotate, Flip, Invert, Reset)
                bool step38 = viewer.SelectViewerTool(BluRingTools.Window_Level, viewport: 2);
                viewer.ApplyTool_WindowWidth();
                Thread.Sleep(20000);
                bool step38_1 = viewer.SelectViewerTool(BluRingTools.Interactive_Zoom, viewport: 2);
                viewer.ApplyTool_Zoom();
                Thread.Sleep(20000);
                bool step38_2 = viewer.SelectViewerTool(BluRingTools.Pan, viewport: 2);
                viewer.ApplyTool_Pan();
                Thread.Sleep(20000);
                bool step38_3 = viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, viewport: 2);
                Thread.Sleep(20000);
                bool step38_4 = viewer.SelectViewerTool(BluRingTools.Flip_Horizontal, viewport: 2);
                Thread.Sleep(2000);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 1));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step38_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step38_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step38_7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step38_1 && step38_2 && step38_3 && step38_4 && step38_5 && step38_6)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 39 - Again,double click on second series viewport.
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                viewer.DoubleClick(element);
                Thread.Sleep(3000);
                var step39_2 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 0)));
                var step39_3 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 1)));
                var step39_4 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 2)));
                var step39_5 = viewer.IsElementVisibleInUI(By.CssSelector(viewer.GetViewportCss(1, 3)));
                if (step39_2 && step39_3 && step39_4 && step39_5)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 40 - Load 2 series from a different study into the bottom of two viewports using drag and drop/double click
                viewer.SetViewPort(2, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                }
                else
                {
                    viewer.Click("cssselector", viewer.GetViewportCss(1, 2));
                }
                IList<IWebElement> priors = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_priorsBlock));
                viewer.ClickExamListThumbnailIcon(priors[1]);
                IWebElement ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetExamListThumbnailCss(2, 1));
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).DoubleClick(ele).Build().Perform();
                }
                else
                {
                    viewer.DoubleClick(ele);
                }
                Thread.Sleep(3000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step40_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SetViewPort(3, 1);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport))).Perform();
                }
                else
                {
                    viewer.Click("cssselector", viewer.GetViewportCss(1, 3));
                }
                Thread.Sleep(2000);
                ele = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetExamListThumbnailCss(2, 2));
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                {
                    new Actions(BasePage.Driver).DoubleClick(ele).Build().Perform();
                }
                else
                {
                    viewer.DoubleClick(ele);
                }
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step40_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step40_1 && step40_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }


                // step 41 -Select any series viewport and change the scope to 'image'                
                bool step41 = viewer.SelectInnerViewerTool(BluRingTools.Image_Scope, BluRingTools.Line_Measurement, viewport: 4);
                if (step41)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 42 - Apply tools (eg: Pan) to one image in each series and then change the scope to series in any one series
                bool step42 = viewer.SelectViewerTool(BluRingTools.Pan, viewport: 4);
                Thread.Sleep(3000);
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    var attributes = viewer.GetElementAttributes(viewer.Activeviewport);
                    var actions = new TestCompleteAction();
                    actions.ClickAndHold(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport)).Perform();
                    Thread.Sleep(3000);
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), attributes["width"] / 4, attributes["height"] / 4).Release().Perform();
                    Thread.Sleep(3000);
                }
                else
                {
                    viewer.ApplyTool_Pan();
                }
                Thread.Sleep(5000);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 3));
                viewer.OpenViewerToolsPOPUp();
                Thread.Sleep(10000);
                bool step42_1 = false;
                var toolsinforthgrid = viewer.GetToolsInToolBoxByGrid(4);
                string[] firsttool = toolsinforthgrid[0].Split(',');
                if (firsttool[0] == "Image Scope")
                {
                    step42_1 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Line_Measurement, false, viewport: 4);
                }
                else
                {
                    step42_1 = viewer.SelectInnerViewerTool(BluRingTools.Series_Scope, BluRingTools.Line_Measurement, false, viewport: 4);
                }
                Thread.Sleep(5000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step42_2 = studies.CompareImage(result.steps[ExecutedSteps], Activeviewport);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step42_3 = studies.CompareImage(result.steps[ExecutedSteps], Activeviewport);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step42_4 = studies.CompareImage(result.steps[ExecutedSteps], Activeviewport);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step42 && step42_1 && step42_2 && step42_3 && step42_4)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 43 - Begin to apply a tool to a modified image in series changed scope to series.               
                viewer.SetViewPort(2, 1);
                Activeviewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetViewportCss(1, 2));
                if (BasePage.SBrowserName.ToLower().Contains("edge"))
                {
                    new TestCompleteAction().Click(Activeviewport).Perform();
                }
                bool step44 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level, viewport: 3);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step44_1 = studies.CompareImage(result.steps[ExecutedSteps], Activeviewport);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step44_2 = studies.CompareImage(result.steps[ExecutedSteps], Activeviewport);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                Thread.Sleep(3000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step44_3 = studies.CompareImage(result.steps[ExecutedSteps], Activeviewport);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                Activeviewport.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                if (step44 && step44_1 && step44_2 && step44_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                //Close Bluring viewer and logout
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }


        /// <summary>
        ///   Verifying default W/L values for specific studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_167923(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            ServiceTool serviceTool = new ServiceTool();
            WpfObjects wpfObject = new WpfObjects();
            String sourceLocation = "C:\\WebAccess\\WebAccess\\Config\\WebAccessConfiguration.xml";
            String backupLocation = "C:\\Users\\Administrator\\Desktop\\WebAccessConfiguration.xml";

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String[] Accession = AccessionList.Split(':');
                String LastNameDetails = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                String[] LastName = LastNameDetails.Split(':');
                String PatientIDList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                String[] PatientID = PatientIDList.Split(':');

                //Take backup Copy
                File.Copy(sourceLocation, backupLocation, true);
                Logger.Instance.InfoLog("Back-up of WebAccessConfiguration.xml taken");

                //Step1 - Set PreferValidWWWLOverVOILUT config item in WebAccessConfiguration.xml to false:
                //        Location: C:\WebAccess\WebAccess\Config
                //        <PreferValidWWWLOverVOILUT> False</ PreferValidWWWLOverVOILUT >
                //        RestartIIS
                XmlDocument webAccessConfigXml = new XmlDocument();
                webAccessConfigXml.Load(sourceLocation);
                XmlNodeList elements = webAccessConfigXml.GetElementsByTagName("SoftcopyPresentationProvider");
                XmlNode node = elements[0].ChildNodes[1];
                node.InnerText = "false";
                webAccessConfigXml.Save(sourceLocation);
                Logger.Instance.InfoLog("WebAccessConfiguration.xml saved successfully");
                serviceTool.InvokeServiceTool();
                wpfObject.WaitTillLoad();
                serviceTool.RestartService();
                wpfObject.WaitTillLoad();
                serviceTool.CloseServiceTool();
                serviceTool.RestartIIS();
                ExecutedSteps++;

                //step2 Login to iCA as Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                if (login.IsTabPresent("Studies"))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //step3 Search for study 'Cramer, Donna' and Load the study in universal viewer
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(LastName: LastName[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //Step4 - Verify that the VOI LUT from the image is used (bottom right demographics should show LUT)
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if(step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step5
                viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step6 - 
                viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();


                //Step7 - Set PreferValidWWWLOverVOILUT config item in WebAccessConfiguration.xml to true:
                //        Location: C:\WebAccess\WebAccess\Config
                //        <PreferValidWWWLOverVOILUT> True</ PreferValidWWWLOverVOILUT >
                //       RestartIIS
                webAccessConfigXml = new XmlDocument();
                webAccessConfigXml.Load(sourceLocation);
                elements = webAccessConfigXml.GetElementsByTagName("SoftcopyPresentationProvider");
                node = elements[0].ChildNodes[1];
                node.InnerText = "True";
                webAccessConfigXml.Save(sourceLocation);
                Logger.Instance.InfoLog("WebAccessConfiguration.xml saved successfully");
                serviceTool.InvokeServiceTool();
                wpfObject.WaitTillLoad();
                serviceTool.RestartService();
                wpfObject.WaitTillLoad();
                serviceTool.CloseServiceTool();
                serviceTool.RestartIIS();
                ExecutedSteps++;

                //Step8 - Search for study 'Cramer, Donna' and Load the study in universal viewer
                login.LoginIConnect(adminUserName, adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(LastName: LastName[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step9 Observe the W/L values
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step9)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step10 Close the study viewer and Search for study Accession# = 3453451 and Load it in the universal viewer.
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step11 Observe the W/L values
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step11)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step12 Close the study viewer and Search for study Accession# = cb7a68cae and Load it in the universal viewer
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: Accession[2], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[2]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step13 Observe the W/L values
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step13)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step14 Close the study viewer and Search for study LastName = AAXFFP and Load it in the universal viewer
                viewer.CloseBluRingViewer();
                studies.SearchStudy(LastName: LastName[1], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Patient ID", PatientID[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step15 Observe the W/L values
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step15 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step15)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step16 Close the study viewer and Search for study PID = VLUT_Pnn and Load it in the universal viewer
                viewer.CloseBluRingViewer();
                studies.SearchStudy(patientID: PatientID[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Patient ID", PatientID[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                //step17 Observe the W/L values
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step17)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                File.Copy(backupLocation, sourceLocation, true);
                Logger.Instance.InfoLog("The Orginal WebAccessConfiguration file was replaced finally");
                serviceTool.InvokeServiceTool();
                wpfObject.WaitTillLoad();
                serviceTool.RestartService();
                wpfObject.WaitTillLoad();
                serviceTool.CloseServiceTool();
            }
        }

        /// <summary>
        ///  Studies with monochrome 1 & monochrome 2 images
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164860(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String[] patientid = null;
            UserManagement usermanagement = new UserManagement();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDLIst = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                patientid = PatientIDLIst.Split(':');
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                // precondition:
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.ClickSaveNewDomain();
                domain.SearchDomain(domain1);
                domain.SelectDomain(domain1);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                login.Logout();

                //Step 1 - 	Import studies that has monochrome 1 and monochrome 2 images to the configured datasource.                
                ExecutedSteps++;

                // Step 2 - Log in to iCA. Navigate to studies tab,Search and load the study that has photo metric interception = Monochrome 1 in universal viewer.	
                login.LoginIConnect(rad1, rad1);
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: patientid[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", patientid[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 3 - Select the Invert option from the toolbar.	
                var step3_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                IWebElement viewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                int width = viewport.Size.Width;
                int height = viewport.Size.Height;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step3_1 && step3_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 4 - Select the reset option from the toolbar.	
                var step4_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step4_1 && step4_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 5 - Select the W/L tool and apply on the image.	
                var step5_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth(0, height / 2, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step5_1 && step5_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 6 - Select the reset option from the toolbar.	
                var step6_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step6_1 && step6_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 7 - Draw few measurements on the image.                                
                var step7_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(0, height / 2, width / 4, height / 2);
                var step7_2 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7_3 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step7_1 && step7_2 && step7_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 8 - Save the series.	
                if (viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 9 and 10 - Select and load the PR series in the active viewport and Select the Invert option from the toolbar..
                viewer.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1)));
                var step10_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step10_1 && step10_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 11 - Close the viewer.	
                viewer.CloseBluRingViewer();
                if (login.IsTabPresent("studies"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 12 - Search and load the study that has photo metric interception = Monochrome 2 in the universal viewer.	
                studies.SearchStudy(patientID: patientid[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", patientid[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                // Step 13 - Select the Invert option from the toolbar.	
                var step13_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                viewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step13_1 && step13_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 14 - Select the reset option from the toolbar.	
                var step14_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step14_1 && step14_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step15 - Select the W/L tool and apply on the image.	
                width = viewport.Size.Width;
                height = viewport.Size.Height;
                var step15_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth(0, height / 2, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step15_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step15_1 && step15_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 16 - Select the reset option from the toolbar.	
                var step16_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step16_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step16_1 && step16_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 17 - Draw few measurements on the image.                
                var step17_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(0, height / 2, width / 4, height / 2);
                var step17_2 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17_3 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step17_1 && step17_2 && step17_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 18 - Save the series.	
                if (viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 19 and 20 - Select and load the PR series in the active viewport and Select the Invert option from the toolbar.
                viewer.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1)));
                var step20_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step20_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step20_1 && step20_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 21 - Close the viewer and Log out iCA.
                viewer.CloseBluRingViewer();
                login.Logout();
                ExecutedSteps++;

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA77 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("PatientID", patientid[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeletePaticularModality("PR");

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("PatientID", patientid[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeletePaticularModality("PR");
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }

            }
        }

        /// <summary>
        ///  Studies with monochrome 1 & monochrome 2 images (Application.EnableWebGLRendering key to true in web.config file.)
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test2_164860(String testid, String teststeps, int stepcount)
        {

            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String[] patientid = null;
            UserManagement usermanagement = new UserManagement();
            ServiceTool serviceTool = new ServiceTool();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String PatientIDLIst = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");
                patientid = PatientIDLIst.Split(':');
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);

                // precondition:
                BasePage basepage = new BasePage();
                basepage.SetWebConfigValue(Config.webconfig, "Application.EnableWebGLRendering", "True");
                serviceTool.RestartIISUsingexe();

                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.ClickSaveNewDomain();
                domain.SearchDomain(domain1);
                domain.SelectDomain(domain1);
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domain.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();
                login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                login.Logout();

                //Step 1 - 	Import studies that has monochrome 1 and monochrome 2 images to the configured datasource.                
                ExecutedSteps++;

                // Step 2 - Log in to iCA. Navigate to studies tab,Search and load the study that has photo metric interception = Monochrome 1 in universal viewer.	
                login.LoginIConnect(rad1, rad1);
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: patientid[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", patientid[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                ExecutedSteps++;

                // Step 3 - Select the Invert option from the toolbar.	
                var step3_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                IWebElement viewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                int width = viewport.Size.Width;
                int height = viewport.Size.Height;
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step3_1 && step3_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 4 - Select the reset option from the toolbar.	
                var step4_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step4_1 && step4_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 5 - Select the W/L tool and apply on the image.	
                var step5_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth(0, height / 2, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step5_1 && step5_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 6 - Select the reset option from the toolbar.	
                var step6_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step6_1 && step6_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 7 - Draw few measurements on the image.                                
                var step7_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(0, height / 2, width / 4, height / 2);
                var step7_2 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7_3 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step7_1 && step7_2 && step7_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 8 - Save the series.	
                if (viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 9 and 10 - Select and load the PR series in the active viewport and Select the Invert option from the toolbar..
                viewer.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1)));
                var step10_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step10_1 && step10_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 11 - Close the viewer.	
                viewer.CloseBluRingViewer();
                if (login.IsTabPresent("studies"))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 12 - Search and load the study that has photo metric interception = Monochrome 2 in the universal viewer.	
                studies.SearchStudy(patientID: patientid[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", patientid[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                // Step 13 - Select the Invert option from the toolbar.	
                var step13_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                viewport = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step13_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step13_1 && step13_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 14 - Select the reset option from the toolbar.	
                var step14_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step14_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step14_1 && step14_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step15 - Select the W/L tool and apply on the image.	
                width = viewport.Size.Width;
                height = viewport.Size.Height;
                var step15_1 = viewer.SelectViewerTool(BluRingTools.Window_Level);
                viewer.ApplyTool_WindowWidth(0, height / 2, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step15_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step15_1 && step15_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 16 - Select the reset option from the toolbar.	
                var step16_1 = viewer.SelectViewerTool(BluRingTools.Reset);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step16_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step16_1 && step16_2)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 17 - Draw few measurements on the image.                
                var step17_1 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(0, height / 2, width / 4, height / 2);
                var step17_2 = viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step17_3 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step17_1 && step17_2 && step17_3)
                {
                    result.steps[ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                }

                // Step 18 - Save the series.	
                if (viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text))
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 19 and 20 - Select and load the PR series in the active viewport and Select the Invert option from the toolbar.
                viewer.DoubleClick(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1)));
                var step20_1 = viewer.SelectInnerViewerTool(BluRingTools.Invert, BluRingTools.Window_Level);
                Thread.Sleep(2000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step20_2 = studies.CompareImage(result.steps[ExecutedSteps], viewport);
                if (step20_1 && step20_2)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 21 - Close the viewer and Log out iCA.
                viewer.CloseBluRingViewer();
                login.Logout();
                ExecutedSteps++;

                //Return Result.
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);


                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA77 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("PatientID", patientid[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeletePaticularModality("PR");

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("PatientID", patientid[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeletePaticularModality("PR");
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }

            }
        }


        /// <summary>
        ///  Zoom functions on US dual Images
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_164863(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                //Step1 - Import study
                ExecutedSteps++;

                //step2 - Login to iCA and load study
                login.LoginIConnect(adminUserName, adminPassword);
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                // From the layout option, Set the layout to 4*2
                viewer.ChangeViewerLayout("4x2");
                ExecutedSteps++;

                //Step4 - Select Zoom tool from floating toolbox         
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(BluRingViewer.div_viewport));
                viewer.SelectViewerTool(BluRingTools.Interactive_Zoom);
                if (ele.GetCssValue("cursor").Equals("n-resize"))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step5 - Place the cursor on center of the image, Click and hold the left mouse button then drag upwards               
                int width = ele.Size.Width;
                int height = ele.Size.Height;
                viewer.ApplyTool_Zoom(width / 2, height / 2, width / 2, 0);
                viewer.ApplyTool_Zoom(width / 2, height / 2, width / 2, 0);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step6 - Place the cursor on center of the image, Click and hold the left mouse button then drag downwards
                viewer.ApplyTool_Zoom(width / 2, height / 2, width / 2, height);
                viewer.ApplyTool_Zoom(width / 2, height / 2, width / 2, height);
                viewer.ApplyTool_Zoom(width / 2, height / 2, width / 2, height);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step6)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();


                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>  
        /// Joint Lines toolbar configuration
        /// </summary>  
        /// <param name="testid"></param>  
        /// <param name="teststeps"></param>  
        /// <param name="stepcount"></param>  
        /// <returns></returns>  
        public TestCaseResult Test_168730(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables                
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            DomainManagement domain = new DomainManagement();
            BluRingViewer viewer = new BluRingViewer();
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            String SuperAdminGroup = Config.adminGroupName;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String jointTool = BluRingViewer.GetToolName(BluRingTools.Joint_Line_Measurement);
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");

                // Step 1 
                ExecutedSteps++;  // part of environment setup execution

                //Step2 - Login to Webacess and Navigate to Domain Management.  Verify Joint Lines available in the Universal Toolbox configuration section.
                login.LoginIConnect(adminUserName, adminPassword);
                domain.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                if (revertButton.Enabled)
                    revertButton.Click();
                if (domain.GetConfiguredToolsInToolBoxConfig().Contains(jointTool))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step3 - Remove Joint lines from Configuration section
                var ToolsToBeRemoved = new List<String>();
                ToolsToBeRemoved.Add(jointTool);
                domain.RemoveToolsFromConfiguredSection(ToolsToBeRemoved);
                Thread.Sleep(3000);
                bool step3_1 = domain.GetConfiguredToolsInToolBoxConfig().Contains(jointTool);
                domain.ClickSaveEditDomain();

                //Load Studies in Viewer
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", Patientid);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                bool step3_2 = viewer.GetToolsInViewer().Contains(jointTool);
                if (!step3_1 && !step3_2)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();
                viewer.CloseBluRingViewer();

                //Step4 - Add Joint Lines back and verify in viewer
                domain.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(6)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add(jointTool, group1);
                domain.AddToolsToToolbox(dictionary);
                Thread.Sleep(3000);
                bool step4_1 = domain.GetConfiguredToolsInToolBoxConfig().Contains(jointTool);
                domain.ClickSaveEditDomain();

                //Load studies in viewer
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", Patientid);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                bool step4_2 = viewer.GetToolsInViewer().Contains(jointTool);
                if (step4_1 && step4_2)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step5
                if (viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement, false))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Logout  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
            finally
            {
                login.LoginIConnect(adminUserName, adminPassword);
                domain.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                if (revertButton.Enabled)
                    revertButton.Click();
                domain.ClickSaveEditDomain();
                login.Logout();
            }
        }

        /// <summary>  
        /// Transischial Lines tool configuration
        /// </summary>  
        /// <param name="testid"></param>  
        /// <param name="teststeps"></param>  
        /// <param name="stepcount"></param>  
        /// <returns></returns>  
        public TestCaseResult Test_168758(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables                
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            DomainManagement domain = new DomainManagement();
            BluRingViewer viewer = new BluRingViewer();
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            String SuperAdminGroup = Config.adminGroupName;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String transischialTool = BluRingViewer.GetToolName(BluRingTools.Transischial_Measurement);
                String Patientid = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "PatientID");

                // Step 1 
                ExecutedSteps++;  // part of environment setup execution

                //Step2 - Login to Webacess and Navigate to Domain Management.  Verify Transischial Lines available in the Universal Toolbox configuration section.
                login.LoginIConnect(adminUserName, adminPassword);
                domain.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                if (revertButton.Enabled)
                    revertButton.Click();
                if (domain.GetConfiguredToolsInToolBoxConfig().Contains(transischialTool))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step3 - Remove Transischial lines from Configuration section
                var ToolsToBeRemoved = new List<String>();
                ToolsToBeRemoved.Add(transischialTool);
                domain.RemoveToolsFromConfiguredSection(ToolsToBeRemoved);
                Thread.Sleep(3000);
                bool step3_1 = domain.GetConfiguredToolsInToolBoxConfig().Contains(transischialTool);
                domain.ClickSaveEditDomain();

                //Load Studies in Viewer
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", Patientid);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                bool step3_2 = viewer.GetToolsInViewer().Contains(transischialTool);
                if (!step3_1 && !step3_2)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();
                viewer.CloseBluRingViewer();

                //Step4 - Add Transischial Lines back and verify in viewer
                domain.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(4)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add(transischialTool, group1);
                domain.AddToolsToToolbox(dictionary);
                Thread.Sleep(3000);
                bool step4_1 = domain.GetConfiguredToolsInToolBoxConfig().Contains(transischialTool);
                domain.ClickSaveEditDomain();

                //Load studies in viewer
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(patientID: Patientid, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Patient ID", Patientid);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                bool step4_2 = viewer.GetToolsInViewer().Contains(transischialTool);
                bool step4_3 = viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement, false);
                if (step4_1 && step4_2 && step4_2)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Logout  
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
            finally
            {
                login.LoginIConnect(adminUserName, adminPassword);
                domain.NavigateToDomainManagementTab();
                domain.SearchDomain(SuperAdminGroup);
                domain.SelectDomain(SuperAdminGroup);
                domain.ClickEditDomain();
                IWebElement revertButton = BasePage.Driver.FindElement(By.CssSelector(DomainManagement.btn_revertToDefault));
                if (revertButton.Enabled)
                    revertButton.Click();
                domain.ClickSaveEditDomain();
                login.Logout();
            }
        }

        /// <summary>
        /// Apply Transischial Lines tool to emailed studies.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_168762(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            var servicetool = new ServiceTool();
            var wpfobject = new WpfObjects();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String accessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

                // Precondition
                //setting up the service tool
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();

                // Enabling the studysharing, data transfer, and data download features                
                servicetool.EnableEmailStudy();
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();

                // configuring the email notification 
                servicetool.SetEmailNotification(AdministratorEmail: Config.AdminEmail, SMTPHost: Config.IMAPServer);

                // Close the service tool
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                // Enabling email study in domain 
                login.LoginIConnect(adminUserName, adminPassword);
                DomainManagement domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SearchDomain(Config.adminGroupName);
                domainmanagement.SelectDomain(Config.adminGroupName);
                domainmanagement.ClickEditDomain();
                domainmanagement.SetCheckBoxInEditDomain("emailstudy", 0);
                domainmanagement.ClickSaveEditDomain();

                // Enabling email study in role
                var rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(Config.adminGroupName);
                rolemanagement.SearchRole(Config.adminRoleName);
                rolemanagement.SelectRole(Config.adminRoleName);
                rolemanagement.ClickEditRole();
                rolemanagement.SetPrivelage("emailstudy");
                rolemanagement.ClickSaveEditRole();
                login.Logout();

                // Step 1 - Objective: Verify Transischial Lines functionality when viewing emailed study.
                //Preconditions: ICA installed.
                //Email configured in ICA Service Tool.
                //Universal Viewer set as the default viewer.
                ExecutedSteps++;

                // Step 2 - Login to ICA with any privileged user.
                //Load a study from Studies tab and email to valid recipient.
                login.LoginIConnect(adminUserName, adminPassword);
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accessionList, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accessionList);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.ClickElement(viewer.GetElement(BasePage.SelectorType.CssSelector, BluRingViewer.div_emailstudy));
                viewer.WaitTillEmailWindowAppears();
                Dictionary<string, string> downloadedMail = new Dictionary<string, string>();
                EmailUtils GuestMail = new EmailUtils() { EmailId = Config.CustomUser1Email, Password = Config.CustomUserEmailPassword };
                GuestMail.MarkAllMailAsRead("INBOX");
                viewer.EmailStudy(Config.CustomUser1Email, "test name", "test reason");
                String pinNumber = viewer.FetchPin_BR();
                if (!String.IsNullOrEmpty(pinNumber))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 3 - Recipient opens emailed study.
                //Select Transischial Lines from the floating toolbar.
                //Add / move / delete Transischial Lines from study.
                downloadedMail = GuestMail.GetMailUsingIMAP("no-reply@merge.com", "Emailed Study", MarkAsRead: true, maxWaitTime: 3);
                string link = GuestMail.GetEmailedStudyLink(downloadedMail);
                LaunchEmailedStudy.LaunchStudy<BluRingViewer>(link, pinNumber);
                var element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                var width = element.Size.Width;
                var height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                viewer.ApplyTool_TransischialMeasurement(0, height / 2, width / 2, height / 2, width / 2, height / 4, 0, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    TestCompleteAction actions = new TestCompleteAction();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 8, height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 8, height / 2).Build().Perform();
                }
                viewer.PerformTool(width / 3, height / 2, width / 2, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.DeleteAnnotation(width / 2, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step3_3 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step3_1 && step3_2 && step3_3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 4 - Apply other available tools along with Transischial Line.
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SelectInnerViewerTool(BluRingTools.Line_Measurement, BluRingTools.Transischial_Measurement, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SelectInnerViewerTool(BluRingTools.Line_Measurement, BluRingTools.Transischial_Measurement);
                }
                viewer.ApplyTool_LineMeasurement(0, height / 8, width / 2, height / 8);
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                viewer.ApplyTool_TransischialMeasurement(0, height / 2, width / 2, height / 2, width / 2, height / 4, 0, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // close the emailed study session and opening the regular sesssion
                login.CreateNewSesion();
                login.DriverGoTo(login.url);

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                servicetool.LaunchServiceTool();

                //disabling "Email Study" in config tool 
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                if (wpfobject.IsCheckBoxSelected(ServiceTool.EnableFeatures.Name.EnableEmailStudy, 1))
                {
                    servicetool.ModifyEnableFeatures();
                    wpfobject.WaitTillLoad();
                    wpfobject.UnSelectCheckBox(ServiceTool.EnableFeatures.Name.EnableEmailStudy, 1);
                    wpfobject.WaitTillLoad();
                    servicetool.wpfobject.ClickOkPopUp();
                    servicetool.ApplyEnableFeatures();
                    wpfobject.WaitTillLoad();
                    servicetool.wpfobject.ClickOkPopUp();
                }

                servicetool.CloseServiceTool();
                servicetool.RestartIIS();
            }
        }

        /// <summary>
        /// Apply Joint Lines to shared studies (image sharing).
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_168733(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            var servicetool = new ServiceTool();
            var wpfobject = new WpfObjects();
            String[] accession = null;
            String adminUserName = null;
            String adminPassword = null;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                adminUserName = Config.adminUserName;
                adminPassword = Config.adminPassword;
                String accessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                accession = accessionList.Split(':');
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);
                String rad2 = Config.newUserName + "1" + new Random().Next(1, 100);

                //Precondition Grant Access                
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableStudySharing();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                // Creating a domain with email study and grant access enabled
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.ClickSaveEditDomain();
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.SetCheckBoxInEditDomain("grant", 0);
                var precond2 = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond2.Contains("Save Annotated Images")))
                {
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Save Annotated Images", group1);
                    Thread.Sleep(3000);
                    domain.AddToolsToToolbox(dictionary);
                    Thread.Sleep(3000);
                    if(!(login.GetConfiguredToolsInToolBoxConfig().Contains("Save Annotated Images")))
                        domain.AddToolsToToolbox(dictionary);
                    Logger.Instance.InfoLog("Save annotated images is configured in the ToolBox");
                }
                domain.ClickSaveNewDomain();

                // Enable grant access in Rolemanagement
                var rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(Config.adminGroupName);
                rolemanagement.SearchRole(Config.adminRoleName);
                rolemanagement.SelectRole(Config.adminRoleName);
                rolemanagement.ClickEditRole();
                rolemanagement.GrantAccessRadioBtn().Click();
                rolemanagement.ClickSaveEditRole();
                rolemanagement.SelectDomainfromDropDown(domain1);
                rolemanagement.SearchRole(role1);
                rolemanagement.SelectRole(role1);
                rolemanagement.ClickEditRole();
                rolemanagement.GrantAccessRadioBtn().Click();
                rolemanagement.ClickSaveEditRole();

                // Create a new user for the above domain
                var usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                usermanagement.CreateUser(rad2, domain1, role1);

                // Grant acess to user as a admin
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession[0]);
                studies.GrantAccessToUsers(domain1, rad1);
                login.Logout();

                // sharing study to another user
                login.LoginIConnect(rad1, rad1);
                login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[1]);
                studies.SelectStudy("Accession", accession[1]);
                studies.GrantAccessToUsers(domain1, rad2);
                login.Logout();

                // Step 1 -  Objective: Verify Joint Lines functionality can be applied to shared studies.
                //Preconditions: Install ICA.
                //All testing done in the Universal Viewer.
                //Joint Lines added to floating toolbar.
                //Image Sharing configured in iCA Service Tool, Domain Mgmt., and Roles Mgmt.
                //Studies exists in Inbound and Outbound tabs.
                ExecutedSteps++;

                // Step 2 - Login to ICA with any privileged user. From the Inbounds tab > query and load study with multiple series
                login.LoginIConnect(rad1, rad1);
                var inbounds = (Inbounds)login.Navigate("Inbounds");
                inbounds.SearchStudy(AccessionNo: accession[0], Study_Performed_Period: "All Dates", Study_Received_Period: "All Dates");
                inbounds.SelectStudy("Accession", accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;

                // Step 3 - Select Joint Lines from the floating toolbox and apply it.
                var element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                var width = element.Size.Width;
                var height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                viewer.ApplyTool_JointLines(0, height / 8, width / 2, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 4 - Move Joint Lines.      
                var actions = new TestCompleteAction();
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release().Build().Perform();
                }
                Thread.Sleep(3000);
                viewer.PerformTool(width / 3, height / 2, width / 2, height / 2, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 5 - Delete the Joint Lines                
                viewer.DeleteAnnotation(width / 2, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 6 - Add Joint line again and Select Save Image Annotations from floating toolbox .
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    viewer.ApplyTool_JointLines(0, height / 8, width / 4, height / 4);
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6_1 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step6_2 = inbounds.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.GetStudyPanelThumbnailCss(1)));
                if (step6_1 && step6_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 7 - From the Outbounds tab, query and load study with multiple series and Add Joint Lines
                viewer.CloseBluRingViewer();
                var outbounds = (Outbounds)login.Navigate("Outbounds");
                outbounds.SearchStudy(AccessionNo: accession[1], Study_Performed_Period: "All Dates", Study_Received_Period: "All Dates");
                outbounds.SelectStudy("Accession", accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = element.Size.Width;
                height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                viewer.ApplyTool_JointLines(0, height / 8, width / 2, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step7)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 8 - Move Joint Lines     
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    actions = new TestCompleteAction();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release().Build().Perform();
                }
                Thread.Sleep(3000);
                viewer.PerformTool(width / 3, height / 2, width / 2, height / 2, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step8)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 9 - Delete the Joint Lines                
                viewer.DeleteAnnotation(width / 2, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step9)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 10 - Add Joint line again and Select Save Image Annotations from floating toolbox	                
                viewer.ApplyTool_JointLines(0, height / 8, width / 4, height / 4);
                IList<IWebElement> Thumbnail_list = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnails));
                int beforeSavePr = Thumbnail_list.Count;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                Thumbnail_list = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnails));
                int AfterSavePr = Thumbnail_list.Count;
                if (step10 && AfterSavePr > beforeSavePr)
                    result.steps[ExecutedSteps].StepPass();
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                    Logger.Instance.InfoLog("Thumbnails count before saving PR is " + beforeSavePr + " Thumbnails count before saving PR is " + AfterSavePr);
                }


                // close viewer and logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                //reverting grant access setting for Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("grant", 1);
                domain.ClickSaveEditDomain();
                login.Logout();

                HPLogin hplogin = new HPLogin();
                BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                var hphome = hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                var workflow = (WorkFlow)hphome.Navigate("Workflow");
                workflow.NavigateToLink("Workflow", "Archive Search");
                workflow.HPSearchStudy("Accessionno", accession[0]);
                if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                {
                    //workflow.DeletePaticularModality("PR");
                    workflow.DeleteSpecificModality("PR", true);
                    Logger.Instance.InfoLog("Pre-conditon: All PRs deleted for Accession - " + accession[0] + " from datasource - " + Config.EA91);
                }

                workflow.NavigateToLink("Workflow", "Archive Search");
                workflow.HPSearchStudy("Accessionno", accession[1]);
                if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                {
                    //workflow.DeletePaticularModality("PR");
                    workflow.DeleteSpecificModality("PR", true);
                    Logger.Instance.InfoLog("Pre-conditon: All PRs deleted for Accession - " + accession[1] + " from datasource - " + Config.EA91);
                }
                hplogin.LogoutHPen();
            }
        }

        /// <summary>
        ///  Apply Transischial Lines to shared studies (image sharing).
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_168761(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            var servicetool = new ServiceTool();
            var wpfobject = new WpfObjects();
            String[] accession = null;
            String adminUserName = null;
            String adminPassword = null;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                adminUserName = Config.adminUserName;
                adminPassword = Config.adminPassword;
                String accessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                accession = accessionList.Split(':');
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String rad1 = Config.newUserName + new Random().Next(1, 1000);
                String rad2 = Config.newUserName + "1" + new Random().Next(1, 100);

                //Precondition Grant Access                
                servicetool.LaunchServiceTool();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableStudySharing();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                // Creating a domain with email study and grant access enabled
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("grant", 0);
                domain.ClickSaveEditDomain();
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.SetCheckBoxInEditDomain("grant", 0);
                var precond2 = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond2.Contains("Save Annotated Images")))
                {
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add("Save Annotated Images", group1);
                    Thread.Sleep(3000);
                    domain.AddToolsToToolbox(dictionary);
                    Thread.Sleep(3000);
                    if(!(login.GetConfiguredToolsInToolBoxConfig().Contains("Save Annotated Images")))
                        domain.AddToolsToToolbox(dictionary);
                    Logger.Instance.InfoLog("Save annotated images is configured in the ToolBox");
                }
                domain.ClickSaveNewDomain();

                // Enable grant access in Rolemanagement
                var rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(Config.adminGroupName);
                rolemanagement.SearchRole(Config.adminRoleName);
                rolemanagement.SelectRole(Config.adminRoleName);
                rolemanagement.ClickEditRole();
                rolemanagement.GrantAccessRadioBtn().Click();
                rolemanagement.ClickSaveEditRole();
                rolemanagement.SelectDomainfromDropDown(domain1);
                rolemanagement.SearchRole(role1);
                rolemanagement.SelectRole(role1);
                rolemanagement.ClickEditRole();
                rolemanagement.GrantAccessRadioBtn().Click();
                rolemanagement.ClickSaveEditRole();

                // Create a new user for the above domain
                var usermanagement = (UserManagement)login.Navigate("UserManagement");
                usermanagement.CreateUser(rad1, domain1, role1);
                usermanagement.CreateUser(rad2, domain1, role1);

                // Grant acess to user as a admin
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession[0]);
                studies.GrantAccessToUsers(domain1, rad1);
                login.Logout();

                // sharing study to another user
                login.LoginIConnect(rad1, rad1);
                login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[1]);
                studies.SelectStudy("Accession", accession[1]);
                studies.GrantAccessToUsers(domain1, rad2);
                login.Logout();

                // Step 1 -  Objective: Verify Transischial Lines functionality can be applied to shared studies.
                //Preconditions: Install ICA.
                //All testing done in the Universal Viewer.
                //Transischial Lines added to floating toolbar.
                //Image Sharing configured in iCA Service Tool, Domain Mgmt., and Roles Mgmt.
                //Studies exists in Inbound and Outbound tabs.
                ExecutedSteps++;

                // Step 2 - Login to ICA with any privileged user.
                //From the Inbounds tab > query and load study with multiple series
                //Select Transischial Lines from the floating toolbar.
                //Add / move / delete Transischial Lines from study.
                //Save.
                login.LoginIConnect(rad1, rad1);
                var inbounds = (Inbounds)login.Navigate("Inbounds");
                inbounds.SearchStudy(AccessionNo: accession[0], Study_Performed_Period: "All Dates", Study_Received_Period: "All Dates");
                inbounds.SelectStudy("Accession", accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();
                ExecutedSteps++;
                
                // Step 3 - Select Transischial Lines from the floating toolbar.	
                var element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                var width = element.Size.Width;
                var height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                viewer.ApplyTool_TransischialMeasurement(0, height / 2, width / 2, height / 2, width / 2, height / 4, 0, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 4 - Move Transischial Lines     
                var actions = new TestCompleteAction();
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 8, height / 2).Release();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 8, height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 8, height / 2).Release().Build().Perform();
                }
                viewer.PerformTool(width / 8, height / 2, width / 2, height / 2, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 5 - Delete Transischial Lines	
                viewer.DeleteAnnotation(width / 2, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 6 - Add Transischial Lines again and Select Save Image Annotations from floating toolbox
                viewer.ApplyTool_TransischialMeasurement(0, height / 4, width / 2, height / 4, width / 2, height / 8, 0, height / 8);
                IList<IWebElement> Thumbnail_list = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnails));
                int beforeSavePr = Thumbnail_list.Count;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = inbounds.CompareImage(result.steps[ExecutedSteps], element);
                Thumbnail_list = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnails));
                int AfterSavePr = Thumbnail_list.Count;
                if (step6 && AfterSavePr > beforeSavePr)
                    result.steps[ExecutedSteps].StepPass();
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                    Logger.Instance.InfoLog("Thumbnails count before saving PR is " + beforeSavePr + " Thumbnails count before saving PR is " + AfterSavePr);
                }

                // Step 7 - From the Outbounds tab, query and load study with multiple series and Add Transischial Lines	
                viewer.CloseBluRingViewer();
                var outbounds = (Outbounds)login.Navigate("Outbounds");
                outbounds.SearchStudy(AccessionNo: accession[1], Study_Performed_Period: "All Dates", Study_Received_Period: "All Dates");
                outbounds.SelectStudy("Accession", accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                element = viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport);
                width = element.Size.Width;
                height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                viewer.ApplyTool_TransischialMeasurement(0, height / 2, width / 2, height / 2, width / 2, height / 4, 0, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step7)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 8 - Move Transischial Lines	
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    actions = new TestCompleteAction();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release();
                    actions.MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 3, height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport)), width / 8, height / 2).Release().Build().Perform();
                }
                viewer.PerformTool(width / 3, height / 2, width / 2, height / 2, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step8)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 9 - Delete Transischial Lines	
                viewer.DeleteAnnotation(width / 2, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                if (step9)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 10 - Add Transischial Lines again and Select Save Image Annotations from floating toolbox	
                viewer.ApplyTool_TransischialMeasurement(0, height / 4, width / 2, height / 4, width / 2, height / 8, 0, height / 8);
                Thumbnail_list = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnails));
                beforeSavePr = Thumbnail_list.Count;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text);
                }
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = outbounds.CompareImage(result.steps[ExecutedSteps], element);
                Thumbnail_list = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnails));
                AfterSavePr = Thumbnail_list.Count;
                if (step10 && AfterSavePr > beforeSavePr)
                    result.steps[ExecutedSteps].StepPass();
                else
                {
                    result.steps[ExecutedSteps].StepFail();
                    Logger.Instance.InfoLog("Thumbnails count before saving PR is " + beforeSavePr + " Thumbnails count before saving PR is " + AfterSavePr);
                }

                // close viewer and logout 
                viewer.CloseBluRingViewer();
                login.Logout();

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                //reverting grant access setting for Administrator
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("grant", 1);
                domain.ClickSaveEditDomain();
                login.Logout();

                HPLogin hplogin = new HPLogin();
                BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                var hphome = hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                var workflow = (WorkFlow)hphome.Navigate("Workflow");
                workflow.NavigateToLink("Workflow", "Archive Search");
                workflow.HPSearchStudy("Accessionno", accession[0]);
                if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                {
                    workflow.DeleteSpecificModality("PR", true);
                    Logger.Instance.InfoLog("Pre-conditon: All PRs deleted for Accession - " + accession[0] + " from datasource - " + Config.EA91);
                }

                workflow.NavigateToLink("Workflow", "Archive Search");
                workflow.HPSearchStudy("Accessionno", accession[1]);
                if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                {
                    workflow.DeleteSpecificModality("PR", true);
                    Logger.Instance.InfoLog("Pre-conditon: All PRs deleted for Accession - " + accession[1] + " from datasource - " + Config.EA91);
                }
                hplogin.LogoutHPen();
            }
        }

        /// <summary>
        /// Joint Lines Measurement created in one viewer and opened another viewer.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_168731(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String[] accession = AccessionList.Split(':');

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                DomainManagement domain = new DomainManagement();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;


                //step1 Preconditions covered in Environment Setup
                //Add PR tool to toolbox 
                login.LoginIConnect(adminUserName, adminPassword);
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Annotated Images", group1);
                domain.AddToolsToToolbox(dictionary, addToolAtEnd: true);
                domain.ClickSaveEditDomain();
                ExecutedSteps++;

                //step2 Load a study in the Universal Viewer.  Create a Joint Lines angle.  Save.
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                viewer.ApplyTool_JointLines(0, height / 8, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text);
                IList<IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                bool step2_1 = ThumbnailModality[0].GetAttribute("innerHTML").Equals("PR");
                if (step2 && step2_1)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step3 Open the same series with Joint Lines saved in Enterprise viewer. 
                viewer.CloseBluRingViewer();
                studies.SelectStudy("Accession", accession[0]);
                StudyViewer Viewer = StudyViewer.LaunchStudy();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], Viewer.SeriesViewer_1X1());
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step4 Load a study in the Enterprise Viewer. Create another Joint Lines angle.
                studies.CloseStudy();
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession[1]);
                Viewer = StudyViewer.LaunchStudy();
                IWebElement element_1 = Viewer.SeriesViewer_1X1();
                var width_1 = element_1.Size.Width;
                var height_1 = element_1.Size.Height;
                Viewer.SelectToolInToolBar(IEnum.ViewerTools.JointLineMeasurement);
                Viewer.DrawJointLineMeasurment(element_1, width_1 / 4, height_1 / 4, width_1 / 3, height_1 / 3, width_1 / 2, height_1 / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], Viewer.SeriesViewer_1X1());
                Viewer.SelectToolInToolBar(IEnum.ViewerTools.SaveSeries);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForLoadingIconToAppear_Savestudy();
                PageLoadWait.WaitForLoadingIconToDisAppear_Savestudy();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(Viewer.ThumbnailCaptions()[0]));
                if (step4 && Viewer.ThumbnailCaptions()[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step5 Open the same series with Joint Lines Measurement saved in Universal viewer.
                studies.CloseStudy();
                studies.SelectStudy("Accession", accession[1]);
                BluRingViewer.LaunchBluRingViewer();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }


        /// <summary>
        /// Transischial Lines created in one viewer and opened another viewer.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_168759(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String[] accession = AccessionList.Split(':');

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                DomainManagement domain = new DomainManagement();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;

                //step1 Preconditions covered in Environment Setup
                //Add PR tool to toolbox 
                login.LoginIConnect(adminUserName, adminPassword);
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Annotated Images", group1);
                domain.AddToolsToToolbox(dictionary, addToolAtEnd: true);
                domain.ClickSaveEditDomain();
                ExecutedSteps++;

                //step2 Load a study in the Universal Viewer.Create a Transischial Lines.Save.
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                viewer.ApplyTool_TransischialMeasurement(height / 4, 0, height / 2, width / 3, width / 8, height / 4, width / 6, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SavePresentationState(BluRingTools.Save_Annotated_Image, BluRingTools.Add_Text);
                IList<IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                bool step2_1 = ThumbnailModality[0].GetAttribute("innerHTML").Equals("PR");
                if (step2 && step2_1)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step3 Open the same series with  Transischial Lines saved in Enterprise viewer. 
                viewer.CloseBluRingViewer();
                studies.SelectStudy("Accession", accession[0]);
                StudyViewer Viewer = StudyViewer.LaunchStudy();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], Viewer.SeriesViewer_1X1());
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step4 Load a study in the Enterprise Viewer. Create Transischial  Lines angle.
                studies.CloseStudy();
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession[1]);
                Viewer = StudyViewer.LaunchStudy();
                IWebElement element2 = Viewer.SeriesViewer_1X1();
                width = element2.Size.Width;
                height = element2.Size.Height;
                Viewer.DrawTransischialMeasurement(element2, (width / 4) * 3, height / 4, (width / 4) * 3, (height / 4) * 3, width / 4, (height / 4) + (height / 10), width / 4, ((height / 4) * 3) - (height / 10));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], Viewer.SeriesViewer_1X1());
                Viewer.SelectToolInToolBar(IEnum.ViewerTools.SaveSeries);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForLoadingIconToAppear_Savestudy();
                PageLoadWait.WaitForLoadingIconToDisAppear_Savestudy();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(Viewer.ThumbnailCaptions()[0]));
                if (step4 && Viewer.ThumbnailCaptions()[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step5 Open the same series with Transischial Lines saved in Universal viewer.	
                studies.CloseStudy();
                studies.SelectStudy("Accession", accession[1]);
                BluRingViewer.LaunchBluRingViewer();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }

        /// <summary>  
        /// Apply Transischial Lines to studies in integrated mode.
        /// </summary>  
        /// <param name="testid"></param>  
        /// <param name="teststeps"></param>  
        /// <param name="stepcount"></param>  
        /// <returns></returns>  
        public TestCaseResult Test_168760(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables                
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            DomainManagement domain = new DomainManagement();
            BluRingViewer viewer = new BluRingViewer();
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            String SuperAdminGroup = Config.adminGroupName;
            EHR ehr = new EHR();
            WpfObjects wpfObjects = new WpfObjects();
            Studies studies = new Studies();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);

                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String LastName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");

                // Step 1 
                ExecutedSteps++;  // part of environment setup execution

                //Step2 - From TestEHR, enter in parameters and launch the URL in web browser. 
                //         Load a study in the Universal Viewer.               
                ehr.LaunchEHR();
                wpfObjects.GetMainWindow("Test WebAccess EHR");
                wpfObjects.SelectTabFromTabItems("Image Load");
                wpfObjects.WaitTillLoad();
                ehr.SetCommonParameters("http://" + Config.IConnectIP + "/webaccess", domain: Config.adminGroupName, role: Config.adminRoleName, user: adminUserName, usersharing: "True");
                ehr.SetSearchKeys_Patient("lastname", LastName);
                ehr.SetSearchKeys_Study(Accession);
                String url = ehr.clickCmdLine("ImageLoad");
                ehr.CloseEHR();
                login.CreateNewSesion();
                viewer.NavigateToBluringIntegratorURL(url);
                viewer = (BluRingViewer)login.NavigateToIntegratorFrame(viewer: "bluring");
                BluRingViewer.WaitforViewports();
                BluRingViewer.WaitForPriorsToLoad();
                bool step2_1 = viewer.GetStudyPanelCount().Equals(1);

                // Select Transischial Lines tool. Start at a point and click in three different locations to join all points to form a shape.
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int Height = ele.Size.Height;
                int Width = ele.Size.Width;
                viewer.ApplyTool_TransischialMeasurement(0, Height / 2, Width / 2, Height / 2, Width / 5, Height / 4, Width / 3, Height / 3);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step2_1 && step2_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step3 - Drag the end points of the perpendicular lines to change their length and position on the horizontal line.
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 5, Height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 5, Height / 4).Release().Perform();
                }
                else
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 5, Height / 4).Release().Build().Perform();
                viewer.PerformTool(Width / 5, Height / 4, Width / 6, Height / 3, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();


                //Step4 - Using the left mouse button press-and-drag to rotate, stretch, shorten the horizontal line using the holding points.                               
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, 0, Height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, 0, Height / 2).Release().Perform();
                }
                else
                    new Actions(BasePage.Driver).MoveToElement(ele, 0, Height / 2).Release().Build().Perform();
                viewer.PerformTool(0, Height / 2, Width / 4, Height / 2 + Height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step4_1 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                viewer.PerformTool(Width / 4, Height / 2 + Height / 4, Width / 4, Height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step4_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step4_1 && step4_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step5 - Using the left mouse click, select anywhere on the line (not on the perpendicular line) and move the whole angle including the perpendicular line.
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2).Release().Perform();
                }
                else
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 4, Height / 2).Release().Build().Perform();
                viewer.PerformTool((Width / 4 + Width / 6), Height / 2, Width / 2, Height / 2, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step6 - Rotate the image and observe the Transischial lines.
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, isOpenToolsPOPup: false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step6)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();


                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
        }

        ///<Summary>
        ///Apply Joint Lines to studies in integrated mode.
        ///</Summary>
        ///<param name="testid"></param>
        ///<param name="teststeps"></param>
        ///<param name="stepcount"></param>
        public TestCaseResult Test_168732(String testid, String teststeps, int stepcount)
        {
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            WpfObjects wpfObjects = new WpfObjects();
            EHR eHR = new EHR();
            BluRingViewer viewer = new BluRingViewer();
            Studies studies = new Studies();

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String adminusername = Config.adminUserName;
                String adminpassword = Config.adminPassword;
                String Accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                String LastName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "LastName");
                //String FirstName = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "FirstName");

                //Step 1 -Precondition
                //ICA configured. Universal Viewer enabled.
                //Joint Lines are configured in the toolbox.
                //TestEHR configured.
                ExecutedSteps++;

                //Step 2 - From TestEHR, enter in parameters and launch the URL in web browser. Load a study in the Universal Viewer.
                eHR.LaunchEHR();
                wpfObjects.GetMainWindow("Test WebAccess EHR");
                wpfObjects.SelectTabFromTabItems("Image Load");
                wpfObjects.WaitTillLoad();
                eHR.SetCommonParameters("http://" + Config.IConnectIP + "/webaccess", domain: Config.adminGroupName, role: Config.adminRoleName, user: adminusername, usersharing: "True");
                eHR.SetSearchKeys_Patient("lastname", LastName);
                eHR.SetSearchKeys_Study(Accession);
                String url = eHR.clickCmdLine("ImageLoad");
                eHR.CloseEHR();
                login.CreateNewSesion();
                viewer.NavigateToBluringIntegratorURL(url);
                viewer = (BluRingViewer)login.NavigateToIntegratorFrame(viewer: "bluring");
                if (viewer.GetStudyPanelCount().Equals(1))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 3 - Select Joint Lines Measurement toolfrom floating toolbar
                bool step3 = viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                if (step3)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 4 - Start at a point and click in three different locations to form an angle.
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_JointLines(0, height / 4, width / 3, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 5 - Manipulate the angle: Using the left mouse button press - and hold on any of the three initial points and - drag to rotate, stretch, shorten the Lines
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, 0, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                } 
                viewer.PerformTool(0, height / 4, width / 4, 0);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step5_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.PerformTool(width / 4, 0, width / 4, height / 8, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step5_1 && step5_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 6 - Select the end points of the perpendicular Lines drag and rotate the end points
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                }
                viewer.PerformTool(width / 6, height / 2, width / 4, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.PerformTool(width / 4, height / 2, width / 6, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step6_2 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step6_1 && step6_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 7 - Select the middle of perpendicular Lines and move it left / right.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                }   
                viewer.PerformTool(width / 6, (height / 2 + height / 5), width / 9, (height / 2 + height / 5), isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step7_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step7_1)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 8 - Select anywhere on the Lines and move the whole angle including the perpendicular Lines
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 8, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                }
                viewer.PerformTool(width / 8, height / 2, width / 4, (height / 2 + height / 4), isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step8)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 9 - Rotate the image and observe the joint Lines
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step9)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 10 - Apply other available tools (like Pan, Line Measurement) along with Joint Lines
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(width / 2, (height - height / 10), width / 3, (height - height / 10));
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step10)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Report Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException + Environment.NewLine + e.HelpLink);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return REsult
                return result;
            }
        }

        /// <summary>
        /// Apply Joint Lines tool to emailed studies.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>
        public TestCaseResult Test_168734(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                DomainManagement domain = new DomainManagement();
                RoleManagement role = new RoleManagement();
                ServiceTool servicetool = new ServiceTool();
                WpfObjects wpfobject = new WpfObjects();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;

                //step1 Preconditions
                //Pre-conditions
                //Configure "E-mail Notification" in config tool
                servicetool.LaunchServiceTool();
                servicetool.SetEmailNotification(Config.AdminEmail, SMTPHost: Config.SMTPServer, port: Config.SMTPport);

                //Enable "Email Study" in config tool 
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                if (!wpfobject.IsCheckBoxSelected(ServiceTool.EnableFeatures.Name.EnableEmailStudy, 1))
                {
                    servicetool.ModifyEnableFeatures();
                    wpfobject.WaitTillLoad();
                    wpfobject.SelectCheckBox(ServiceTool.EnableFeatures.Name.EnableEmailStudy, 1);
                    wpfobject.WaitTillLoad();
                    servicetool.wpfobject.ClickOkPopUp();
                    servicetool.ApplyEnableFeatures();
                    wpfobject.WaitTillLoad();
                    servicetool.wpfobject.ClickOkPopUp();
                }
                wpfobject.WaitTillLoad();
                servicetool.RestartIISandWindowsServices();
                wpfobject.WaitTillLoad();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();


                //Enable Email Study in Domain Management page
                login.LoginIConnect(adminUserName, adminPassword);
                login.Navigate("DomainManagement");
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("emailstudy", 0);
                domain.ClickSaveEditDomain();

                //Enable Email Study in Role Management page
                login.Navigate("RoleManagement");
                role.SelectDomainfromDropDown(Config.adminGroupName);
                role.SearchRole(Config.adminRoleName);
                role.SelectRole(Config.adminRoleName);
                role.ClickEditRole();
                role.SetCheckboxInEditRole("email", 0);
                role.ClickSaveEditRole();
                ExecutedSteps++;

                //step2 Login to ICA with any privileged user. Load a study from Studies tab and email to valid recipient.
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession);
                viewer = BluRingViewer.LaunchBluRingViewer();
                Dictionary<string, string> downloadedMail = new Dictionary<string, string>();
                EmailUtils UserMail = new EmailUtils() { EmailId = Config.CustomUser1Email, Password = Config.CustomUserEmailPassword };
                UserMail.MarkAllMailAsRead("INBOX");
                viewer.EmailStudy(Config.CustomUser1Email, "test", "Testing", isOpenEmailWindow: true);
                var pinnumber = viewer.FetchPin_BR();
                if (pinnumber != null)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //step3 Recipient opens emailed study.
                downloadedMail = UserMail.GetMailUsingIMAP("no-reply@merge.com", "Emailed Study", MarkAsRead: true, maxWaitTime: 3);
                string emaillink = UserMail.GetEmailedStudyLink(downloadedMail);
                var Viewer = LaunchEmailedStudy.LaunchStudy<BluRingViewer>(emaillink, pinnumber);
                Viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_JointLines(0, height / 4, width / 3, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, 0, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                }
                viewer.PerformTool(0, height / 4, width / 4, 0);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.PerformTool(width / 4, 0, width / 4, height / 8, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                }
                viewer.PerformTool(width / 6, height / 2, width / 4, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step3_3 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.PerformTool(width / 4, height / 2, width / 6, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step3_4 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                }
                viewer.PerformTool(width / 6, (height / 2 + height / 5), width / 9, (height / 2 + height / 5), isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step3_5 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 8, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                }
                viewer.PerformTool(width / 8, height / 2, width / 4, (height / 2 + height / 4), isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 6);
                bool step3_6 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 7);
                bool step3_7 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step3_1 && step3_2 && step3_3 && step3_4 && step3_5 && step3_6 && step3_7)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step4 
                viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement(width / 2, (height - height / 10), width / 3, (height - height / 10));
                viewer.SelectViewerTool(BluRingTools.Flip_Horizontal);
                Thread.Sleep(1000);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
        /// <summary>
        ///Plumb lines toolbar configuration
        /// </summary>
        public TestCaseResult Test_168039(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            int ExecutedSteps = -1;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            try
            {
                Studies studies = new Studies();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                DomainManagement domainmanagement = new DomainManagement();
                String[] ToolList = { "Vertical Plumb Line Measurement", "Horizontal Plumb Line Measurement" };


                //Step 1 - Universal Viewer enabled
                login.LoginIConnect(adminUserName, adminPassword);
                ExecutedSteps++;

                //Step 2- Navigate to Domain Management Verify Horizontal and Vertical Plumb lines.
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                var availabletools = login.GetConfiguredToolsInToolBoxConfig();
                var verticalPumbLine = BluRingViewer.GetToolName(BluRingTools.Vertical_Plumb_Line);
                var horizontalPumbLine = BluRingViewer.GetToolName(BluRingTools.Horizontal_Plumb_Line);
                bool tools = (availabletools.Contains(verticalPumbLine) && availabletools.Contains(horizontalPumbLine));
                domainmanagement.ClickSaveEditDomain();
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", accession);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.OpenViewerToolsPOPUp();
                BasePage.wait.Until(ExpectedConditions.ElementExists(By.CssSelector(BluRingViewer.div_toolboxContainer)));
                IList<String> totaltools1 = viewer.GetAllToolNamesinViewPort();
                bool ToolsExist = totaltools1.Any(t => t.Equals(ToolList[0])) && totaltools1.Any(t => t.Equals(ToolList[1]));
                if (!ToolsExist && tools)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //Step 3- From the floating toolbar > right click on horizontal/veritical plumb lines icons.
                Thread.Sleep(2000);
                bool step3 = viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement, isOpenToolsPOPup: false);
                Thread.Sleep(1000);
                viewer.SelectViewerTool(BluRingTools.Reset);
                Thread.Sleep(1000);
                bool step3_1 = viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Angle_Measurement);

                if (step3 && step3_1)
                {
                    result.steps[++ExecutedSteps].StepPass();
                }
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }
        /// <summary>
        /// Apply Plumb Lines tool to emailed studies
        /// </summary>


        public TestCaseResult Test_168046(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables 
            ServiceTool servicetool = new ServiceTool();
            WpfObjects wpfobject = new WpfObjects();
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            int ExecutedSteps = -1;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);

            try
            {
                RoleManagement rolemanagement = new RoleManagement();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                DomainManagement domain = new DomainManagement();
                RoleManagement role = new RoleManagement();
                UserManagement usermanagement = new UserManagement();
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");


                //Step 1 -Pre-Condition: Email configured in ICA Service Tool.

                //// configuring the email notification
                servicetool.LaunchServiceTool();
                servicetool.NavigateToTab("E-mail Notification");
                servicetool.NavigateSubTab("General");
                servicetool.SetEmailNotification(AdministratorEmail: Config.AdminEmail, SMTPHost: Config.IMAPServer);
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();

                ////// Enabling "Email Study" and "study sharing"
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableEmailStudy();
                wpfobject.WaitTillLoad();
                servicetool.EnableStudySharing();
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();

                ////// Restart and close the service tool
                servicetool.RestartIISandWindowsServices();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                //// Creating a domain with email study and grant access enabled
                login.LoginIConnect(adminUserName, adminPassword);
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                domain.SetCheckBoxInEditDomain("emailstudy", 0);
                domain.ClickSaveEditDomain();

                //Enable Email Study in Role Management page
                login.Navigate("RoleManagement");
                rolemanagement.ShowRolesFromDomainDropDown();
                rolemanagement.SelectDomainfromDropDown("SuperAdminGroup");
                role.SearchRole(Config.adminRoleName);
                role.SelectRole(Config.adminRoleName);
                role.ClickEditRole();
                role.SetCheckboxInEditRole("email", 0);
                role.ClickSaveEditRole();
                ExecutedSteps++;

                // Step 2 : Login to ICA with any privileged user.
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", AccessionList);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();


                // Click on email study icon from the study control panel and enter the valid mail address, name and reason and Click on "SEND" button
                Dictionary<string, string> downloadedMail = new Dictionary<string, string>();
                EmailUtils Useremail = new EmailUtils() { EmailId = Config.CustomUser1Email, Password = Config.CustomUserEmailPassword };
                Useremail.MarkAllMailAsRead("INBOX");
                viewer.EmailStudy(Config.CustomUser1Email, "test", "Testing", isOpenEmailWindow: true);
                String pinnumber = viewer.FetchPin_BR();
                if (!String.IsNullOrEmpty(pinnumber))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                // Step 3 -Recipient opens emailed study.
                // Go to the destination Email and Check that the "Emailed Study" notification is received.	
                downloadedMail = Useremail.GetMailUsingIMAP("no-reply@merge.com", "Emailed Study", MarkAsRead: true, maxWaitTime: 3);
                string emaillink = Useremail.GetEmailedStudyLink(downloadedMail);
                viewer.CloseBluRingViewer();

                // Click on the link available from email study to view the study. Enter pin number and click on OK.
                viewer = LaunchEmailedStudy.LaunchStudy<BluRingViewer>(emaillink, pinnumber);


                // Select Plumb lines from the floating toolbar.Add / move / delete Plumb Lines(horizontal/ vertical) from study..
                //Add
                viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement);
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //move
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 2, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                }
                viewer.PlumbLineMove(width / 2, height / 4, width / 2, height / 6);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Delete
                viewer.ToDeletAnnotation(element, width / 2, height / 6);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step3_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));


                ////Select Plumb lines from the floating toolbar.Add / move / delete Plumb Lines( vertical) from study..
                Thread.Sleep(1000);
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line);
                }
                viewer.ApplyTool_VerticalPlumbLine(width / 3, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step3_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                //move
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 3, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                }
                viewer.PlumbLineMove(width / 3, height / 2, width / 6, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step3_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Delete
                viewer.ToDeletAnnotation(element, width / 6, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 6);
                bool step3_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                if (step3_1 && step3_2 && step3_3 && step3_4 && step3_5 && step3_6)

                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
        }

        /// <summary>
        ///To verify Plumb lines can be created and saved in one viewer and can be viewed in another viewer.
        /// </summary>
        public TestCaseResult Test_168042(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            int ExecutedSteps = -1;
            String accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            var arraccession = accession.Split(':');
            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);
            try
            {
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                DomainManagement domain = new DomainManagement();
                DomainManagement domainmanagement = new DomainManagement();
                StudyViewer StudyViewer = new StudyViewer();

                //Step 1 - Universal Viewer enabled
                login.LoginIConnect(adminUserName, adminPassword);
                domainmanagement = (DomainManagement)login.Navigate("DomainManagement");
                PageLoadWait.WaitForFrameLoad(20);
                domainmanagement.SearchDomain("SuperAdminGroup");
                domainmanagement.SelectDomain("SuperAdminGroup");
                domainmanagement.ClickEditDomain();
                PageLoadWait.WaitForFrameLoad(20);
                // Add available tools
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domainmanagement.AddToolsToToolbox(dictionary);
                domainmanagement.ClickSaveDomain();
                ExecutedSteps++;

                //Step 2 : //Load a study in the Universal Viewer.
                //Select the horizontal and vertical plumb line icon and click on several location on the image.
                //Save the Series using Save series toolbox option.
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: arraccession[0], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", arraccession[0]);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement);
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step2_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line);
                Thread.Sleep(1000);
                viewer.ApplyTool_VerticalPlumbLine(width / 3, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step2_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                bool isPRCreated = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, 1, 1);
                IList<IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                if (step2_1 && step2_2 && isPRCreated && ThumbnailModality[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();
                viewer.CloseBluRingViewer();

                //Step 3: Open the same series with Plumb lines saved in Enterprise viewer.
                studies.SelectStudy("Accession", arraccession[0]);
                StudyViewer viewerEV = StudyViewer.LaunchStudy();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], StudyViewer.SeriesViewer_1X1());
                if (step3_1 && viewerEV.ThumbnailCaptions()[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();
                viewerEV.CloseStudy();

                // Step 4: //Load a study in the Enterprise Viewer.
                //Select the horizontal and vertical plumb line icon and click on several location on the image.
                //Save the Series using Save series toolbox option.
                studies.SearchStudy(AccessionNo: arraccession[1], Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", arraccession[1]);
                StudyViewer viewerEV1 = StudyViewer.LaunchStudy();
                var element1 = viewerEV1.SeriesViewer_1X1();
                element1.Click();
                viewerEV1.DrawHorizontalPlumbLine(element1, 145, 89);
                viewerEV1.DrawHorizontalPlumbLine(element1, 213, 123);
                viewerEV1.DrawVerticalPlumbLine(element1, 120, 140);
                viewerEV1.DrawVerticalPlumbLine(element1, 160, 180);
                viewerEV1.SelectToolInToolBar(IEnum.ViewerTools.SaveSeries);
                PageLoadWait.WaitForFrameLoad(20);
                PageLoadWait.WaitForLoadingIconToAppear_Savestudy();
                PageLoadWait.WaitForLoadingIconToDisAppear_Savestudy();
                BasePage.wait.Until(ExpectedConditions.ElementToBeClickable(viewerEV1.ThumbnailCaptions()[0]));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4_1 = studies.CompareImage(result.steps[ExecutedSteps], StudyViewer.SeriesViewer_1X1());
                if (step4_1 && viewerEV1.ThumbnailCaptions()[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();
                viewerEV1.CloseStudy();
                //Step 5: Open the same series with Plumb lines saved in Universal viewer.
                studies.SelectStudy("Accession", arraccession[1]);
                BluRingViewer viewerUV = BluRingViewer.LaunchBluRingViewer();
                PageLoadWait.WaitForFrameLoad(20);
                IList<IWebElement> ThumbnailModality1 = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5_1 && ThumbnailModality1[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();
                viewer.CloseBluRingViewer();
                login.Logout();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }

            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", arraccession[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", arraccession[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);

                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }

        /// <summary>
        /// Apply Plumb lines to  studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>

        public TestCaseResult Test_168040(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables 
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            int ExecutedSteps = -1;
            String arraccession = null;
            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);

            try
            {
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                arraccession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                DomainManagement domain = new DomainManagement();

                //Step 1: Pre-Condition:
                login.LoginIConnect(adminUserName, adminPassword);
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domain.AddToolsToToolbox(dictionary, addToolAtEnd: true);
                domain.ClickSaveEditDomain();
                ExecutedSteps++;

                //Step 2: //Login to Webacess.
                //Load a study in the Universal Viewer.
                //Select the horizontal plumb line icon and click on several location on the image
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: arraccession, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", arraccession);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement);
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 3);
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 3 : Select the vertical plumb line icon and click on several location on the image
                Thread.Sleep(1000);
                viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line);
                viewer.ApplyTool_VerticalPlumbLine(width / 2, height / 2);
                Thread.Sleep(3000);
                viewer.ApplyTool_VerticalPlumbLine(width / 2 - width / 11, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 4: //While in the vertical plumb line mode move the cursor over one of the vertical lines, click and hold with the 
                //left mouse button and drag the line.
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 2, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 2).Release().Perform();
                }
                viewer.PlumbLineMove(width / 2, height / 2, width / 2 - width / 9, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 5 : Select other lines and try to move them
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 2, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                }
                viewer.PlumbLineMove(width / 2, height / 4, width / 2, height / 6);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 6: Remove plumb line(s) by right clicking on an existing plumb lines.
                viewer.ToDeletAnnotation(element, width / 2, height / 6);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step6)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 7 : Save the Series using Save series toolbox option.
                bool isPRCreated = false;
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    isPRCreated = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, 1, 1, isOpenToolsPOPup: false);
                }
                else
                {

                    isPRCreated = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, 1, 1);
                }
                IList <IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                if (isPRCreated && ThumbnailModality[0].Text.Contains("PR"))
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();
                viewer.CloseBluRingViewer();

                //Step 8: Close the study and reopen the same study in the Universal viewer
                studies.SelectStudy("Accession", arraccession);
                BluRingViewer viewerUV = BluRingViewer.LaunchBluRingViewer();
                IList<IWebElement> ThumbnailModality_2 = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8 && ThumbnailModality_2[0].Text.Contains("PR"))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 9: 	Apply other available mixed annotation tools (i.e. Circle, Ellipse line , cob bangle etc.) along with Plumb lines.
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = element.Size.Width;
                height = element.Size.Height;
                var step9 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement((width / 2 + width /3), height, (width / 2 + width / 3), height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step_9 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step_9)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 10: Save the Series using Save series toolbox option.
                bool isPRCreated1 = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, 1, 1);
                IList<IWebElement> ThumbnailModality_1 = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                if (isPRCreated1 && ThumbnailModality_1[0].Text.Contains("PR"))

                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", arraccession);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }
        /// <summary>
        /// Apply Plumb lines to studies in integrated mode.
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>

        public TestCaseResult Test_168043(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables 
            ServiceTool servicetool = new ServiceTool();
            WpfObjects wpfobject = new WpfObjects();
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            int ExecutedSteps = -1;
            string accession = null;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);

            try
            {
                ehr = new EHR();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                accession = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                DomainManagement domain = new DomainManagement();
                Studies studies = new Studies();

                login.LoginIConnect(adminUserName, adminPassword);
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domain.AddToolsToToolbox(dictionary, addToolAtEnd: true);
                domain.ClickSaveEditDomain();
                login.Logout();

                //Step 1: //Objective - To verify Plumb Line //functionality in the new viewer.
                //Preconditions 
                //ICA configured.
                //Universal Viewer enabled.
                //Horizontal/Vertical Plumb lines are //configured in the toolbox.
                //TestEHR configured.
                TestFixtures.UpdateFeatureFixture("usersharing", value: "Always enabled");
                servicetool.LaunchServiceTool();
                servicetool.RestartIISandWindowsServices();
                servicetool.CloseServiceTool();
                ExecutedSteps++;

                //Step: 2 
                //From TestEHR, enter in parameters and launch the URL in web browser.
                //Load a study in the Universal Viewer.
                //Select the horizontal plumb line icon and click on several location on the image
                ehr.LaunchEHR();
                ehr.SetCommonParameters();
                ehr.SetSearchKeys_Study(accession);
                ehr.SetSearchKeys_Study(login.GetHostName(Config.EA91), "Datasource");
                String url = ehr.clickCmdLine("ImageLoad");
                ehr.CloseEHR();
                login.CreateNewSesion();
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer(mode: "Integrator", url: url);
                viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement);
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 3);
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step: 3 
                //Select the vertical plumb line icon and click on several location on the image
                viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line);
                viewer.ApplyTool_VerticalPlumbLine(width / 3, height / 2);
                viewer.ApplyTool_VerticalPlumbLine(width / 4, height / 5);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step3)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 4 :
                //While in the vertical plumb line mode move the cursor over one of the vertical lines, click and hold with the //left mouse button and drag the line.
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 3, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 3, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 3, height / 2).Release().Perform();
                }
                viewer.PlumbLineMove(width / 3, height / 2, width / 8, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 5:
                //Select other lines and try to move them
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                  (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 2, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                }
                viewer.PlumbLineMove(width / 2, height / 4, width / 2, height / 6);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 6:
                //Save the Series using Save series toolbox option.
                bool isPRCreated = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, 1, 1);
                IList<IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                if (ThumbnailModality[0].Text.Contains("PR") && isPRCreated)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //Step 7: Close the study and reopen the same study in the Universal viewer
                login.CreateNewSesion();
                BluRingViewer viewervar = BluRingViewer.LaunchBluRingViewer(mode: "Integrator", url: url);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                Thread.Sleep(1000);
                if (step7)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Step 8: 	Apply other available mixed annotation tools (i.e. Circle, Ellipse line , cob bangle etc.) along with Plumb lines.
                var step8 = viewer.SelectViewerTool(BluRingTools.Line_Measurement);
                viewer.ApplyTool_LineMeasurement();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step8_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step8 && step8_1)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }

        }
        /// <summary>
        /// Apply Plumb lines to shared studies
        /// </summary>
        /// <param name="testid"></param>
        /// <param name="teststeps"></param>
        /// <param name="stepcount"></param>
        /// <returns></returns>

        public TestCaseResult Test_168044(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables 
            ServiceTool servicetool = new ServiceTool();
            WpfObjects wpfobject = new WpfObjects();
            TestCaseResult result;
            result = new TestCaseResult(stepcount);
            int ExecutedSteps = -1;
            String AccessionList = null;

            //Set up Validation Steps
            result.SetTestStepDescription(teststeps);

            try
            {
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;
                DomainManagement domain = new DomainManagement();
                UserManagement usermanagement = new UserManagement();
                String domain1 = "Domain1_" + new Random().Next(1, 1000);
                String role1 = "Role1_" + new Random().Next(1, 1000);
                String role2 = "Role2_" + new Random().Next(1, 1000);
                String plumb11 = Config.newUserName + new Random().Next(1, 1000);
                String plumb22 = Config.newUserName + "2" + new Random().Next(1, 1000);
                AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                DomainManagement domainmanagement = new DomainManagement();
                //Step: 1 Pre-Condition:
                // Enabling "study sharing"
                servicetool.LaunchServiceTool();
                wpfobject.WaitTillLoad();
                servicetool.NavigateToEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.ModifyEnableFeatures();
                wpfobject.WaitTillLoad();
                servicetool.EnableStudySharing();
                wpfobject.WaitTillLoad();
                servicetool.ApplyEnableFeatures();
                wpfobject.WaitTillLoad();
                wpfobject.ClickOkPopUp();
                wpfobject.WaitTillLoad();

                // Restart and close the service tool
                servicetool.RestartIISandWindowsServices();
                servicetool.CloseServiceTool();
                servicetool.RestartIIS();

                // Creating a domain with email study and grant access enabled
                login.LoginIConnect(adminUserName, adminPassword);
                login.Navigate("DomainManagement");
                domain.CreateDomain(domain1, role1, datasources: null);
                domain.SetCheckBoxInEditDomain("grant", 0);
                // Add available tools
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                dictionary.Add("Save Annotated Images", group1);
                domainmanagement.AddToolsToToolbox(dictionary);
                domain.ClickSaveNewDomain();

                // Enabling the grant access in rolemanagement
                var rolemanagement = (RoleManagement)login.Navigate("RoleManagement");
                rolemanagement.SelectDomainfromDropDown(domain1);
                rolemanagement.SearchRole(role1);
                rolemanagement.SelectRole(role1);
                rolemanagement.ClickEditRole();
                rolemanagement.ClickElement(rolemanagement.GrantAccessRadioBtn_Anyone());
                rolemanagement.ClickSaveEditRole();
                rolemanagement.CreateRole(domain1, role2, roletype: "email");

                // Create a new user for the above domain
                login.Navigate("UserManagement");
                usermanagement.CreateUser(plumb11, domain1, role1);
                usermanagement.CreateUser(plumb22, domain1, role2);
                login.Logout();
                ExecutedSteps++;

                //Step :2 
                //Login to ICA with any privileged user.
                //From the Inbounds tab > query and load study with multiple series
                //Select Plumb lines from the floating toolbar.
                //Add/move/delete Plumb Lines (horizontal/vertical) from study.
                //Save.

                login.LoginIConnect(plumb11, plumb11);
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: AccessionList, Datasource: login.GetHostName(Config.EA91));
                studies.SelectStudy("Accession", AccessionList);
                studies.GrantAccessToUsers(domain1, plumb22);
                login.Logout();
                login.LoginIConnect(plumb22, plumb22);
                var inbounds = (Inbounds)login.Navigate("Inbounds");
                inbounds.SearchStudy(AccessionNo: AccessionList, Study_Performed_Period: "All Dates", Study_Received_Period: "All Dates");

                // Select the shared study and click on the 'Universal' button.	
                inbounds.SelectStudy("Accession", AccessionList);
                BluRingViewer viewer = BluRingViewer.LaunchBluRingViewer();

                //Add
                viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement);
                IWebElement element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step2_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //move
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 2, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                }
                viewer.PlumbLineMove(width / 2, height / 4, width / 2, height / 6);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step2_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Delete
                viewer.ToDeletAnnotation(element, width / 2, height / 6);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step2_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Select Plumb lines from the floating toolbar.Add / move / delete Plumb Lines( vertical) from study..
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    viewer.ClickElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.SetViewPort(1, 1)));
                    viewer.ClickElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.SetViewPort(0, 1)));
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line);
                }
                viewer.ApplyTool_VerticalPlumbLine(width / 3, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step2_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //move
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 3, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 3, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 3, height / 2).Release().Perform();
                }
                viewer.PlumbLineMove(width / 3, height / 2, width / 6, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step2_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Save
                bool isPRCreated = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, 1, 1);
                IList<IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));

                //Delete
                viewer.ToDeletAnnotation(element, width / 6, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 6);
                bool step2_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step2_1 && step2_2 && step2_3 && step2_4 && step2_5 && isPRCreated && step2_6)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                viewer.CloseBluRingViewer();
                login.Logout();

                //Step 3: Repeat test with Outbound studies.
                login.LoginIConnect(plumb11, plumb11);
                var outbounds = (Outbounds)login.Navigate("Outbounds");
                inbounds.SearchStudy(AccessionNo: AccessionList, Study_Performed_Period: "All Dates", Study_Received_Period: "All Dates");
                outbounds.SelectStudy("Accession", AccessionList);
                BluRingViewer viewer11 = BluRingViewer.LaunchBluRingViewer();

                //Add
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = element.Size.Width;
                height = element.Size.Height;
                viewer.SelectInnerViewerTool(BluRingTools.Horizontal_Plumb_Line, BluRingTools.Angle_Measurement);
                viewer.ApplyTool_HorizontalPlumbLine(width / 2, height / 4);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                //move
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 2, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 2, height / 4).Release().Perform();
                }
                viewer.PlumbLineMove(width / 2, height / 4, width / 8, height / 6);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Delete
                viewer.ToDeletAnnotation(element, width / 2, height / 6);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step3_3 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Select Plumb lines from the floating toolbar.Add / move / delete Plumb Lines( vertical) from study..
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    viewer.ClickElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.SetViewPort(1, 1)));
                    viewer.ClickElement(viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.SetViewPort(0, 1)));
                    var viewport_1 = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport_1).Perform();
                    viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SelectInnerViewerTool(BluRingTools.Vertical_Plumb_Line, BluRingTools.Horizontal_Plumb_Line);
                }
                viewer.ApplyTool_VerticalPlumbLine(width / 3, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step3_4 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                //move
                if ((((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("chrome")) ||
                (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.Contains("explorer")))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 3, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 3, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 3, height / 2).Release().Perform();
                }
                viewer.PlumbLineMove(width / 3, height / 2, width / 6, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step3_5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                //Delete
                viewer.ToDeletAnnotation(element, width / 6, height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 6);
                bool step3_6 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));

                if (step3_1 && step3_2 && step3_3 && step3_4 && step3_5 && step3_6)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Return Result
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                return result;
            }
            catch (Exception e)
            {
                //Log Exception
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result
                return result;
            }
            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA91 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA91 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", AccessionList);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }
		
		
        /// <summary>  
        ///Apply Transischial Lines tool to studies.
        /// </summary>  
        /// <param name="testid"></param>  
        /// <param name="teststeps"></param>  
        /// <param name="stepcount"></param>  
        /// <returns></returns>  
        public TestCaseResult Test_168027(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables         
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
            String[] accession = AccessionList.Split(':');
            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                Studies studies = new Studies();
                BluRingViewer viewer = new BluRingViewer();
                DomainManagement domain = new DomainManagement();
                String adminUserName = Config.adminUserName;
                String adminPassword = Config.adminPassword;

                // Step 1 
                login.LoginIConnect(adminUserName, adminPassword);
                domain = login.Navigate<DomainManagement>();
                domain.SearchDomain("SuperAdminGroup");
                domain.SelectDomain("SuperAdminGroup");
                domain.ClickEditDomain();
                BasePage.Driver.SwitchTo().DefaultContent().SwitchTo().Frame("UserHomeFrame");
                IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                var dictionary = new Dictionary<String, IWebElement>();
                dictionary.Add("Save Series", group1);
                domain.AddToolsToToolbox(dictionary, addToolAtEnd: true);
                domain.ClickSaveEditDomain();
                ExecutedSteps++;

                //step2  Select Transischial Lines tool.  Start at a point and click in three different locations to join all points to form a shape.
                studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: accession[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                IWebElement ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int Height = ele.Size.Height;
                int Width = ele.Size.Width;
                viewer.ApplyTool_TransischialMeasurement(0, Height / 2, Width / 2, Height / 2, Width / 5, Height / 4, Width / 3, Height / 3);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step2 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step3  Using the left mouse button press-and-drag to rotate, stretch, shorten the horizontal line using the holding points.
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 5, Height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 5, Height / 4).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 5, Height / 4).Release().Build().Perform();
                }
                viewer.PerformTool(Width / 5, Height / 4, Width / 6, Height / 3, isEdit: true);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step3 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, 0, Height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, 0, Height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, 0, Height / 2).Release().Build().Perform();
                }
                viewer.PerformTool(0, Height / 2, Width / 4, Height / 2 + Height / 4);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step3_1 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2 + Height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2 + Height / 4).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 4, Height / 2 + Height / 4).Release().Build().Perform();
                }
                viewer.PerformTool(Width / 4, Height / 2 + Height / 4, Width / 4, Height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step3_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 4, Height / 2).Release().Build().Perform();
                }
                viewer.PerformTool((Width / 4 + Width / 6), Height / 2, Width / 2, Height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step3_3 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, isOpenToolsPOPup: false);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step3_4 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                if (step3 && step3_1 && step3_2 && step3_3 && step3_4)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step4 Save the Series using Save series toolbox option.
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text,isOpenToolsPOPup:false);
                IList<IWebElement> ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                bool step4 = ThumbnailModality[0].GetAttribute("innerHTML").Equals("PR");
                if (step4)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //step5 Close the study and reopen the same study in the Universal viewer.
                viewer.CloseBluRingViewer();
                studies.SelectStudy("Accession", accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step5 = studies.CompareImage(result.steps[ExecutedSteps], viewer.GetElement(BasePage.SelectorType.CssSelector, viewer.Activeviewport));
                if (step5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step6 Create another Transischial Lines. Right click on anywhere on the Transischial lines.
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                Height = ele.Size.Height;
                Width = ele.Size.Width;
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement, false);
                viewer.ApplyTool_TransischialMeasurement(0, Height / 2, Width / 2, Height / 2, Width / 5, Height / 4, Width / 3, Height / 3);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                viewer.DeleteAnnotation(0, Height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step6_1 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step6 && step6_1)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step7 Apply other available mixed annotation tools (i.e. Circle, Ellipse line , cob angle etc.) along with Transischial Line.
                viewer.OpenViewerToolsPOPUp(Width / 2 - Width / 3, Height / 2 + Height / 3);
                viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false);
                viewer.ApplyTool_DrawEllipse((Width / 2), Height / 4, (Width / 4) * 3, Height / 2);
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectInnerViewerTool(BluRingTools.Cobb_Angle, BluRingTools.Angle_Measurement, false);
                viewer.ApplyTool_CobbAngle(Width / 4, (Height / 4) * 3, (Width / 4) * 3, ((Height / 4) * 3) + 50);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step7 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step7)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();


                //step8 Save the Series using Save Series/Save Annotated Images toolbox option.
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                bool step8 = ThumbnailModality[0].GetAttribute("innerHTML").Equals("PR");
                if (step8)
                    result.steps[++ExecutedSteps].StepPass();
                else
                    result.steps[++ExecutedSteps].StepFail();

                //step9 && step10  Repeat test with other modalities. Repeat test with multiple series. Scroll through series.
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: accession[1], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                Height = ele.Size.Height;
                Width = ele.Size.Width;
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement);
                viewer.ApplyTool_TransischialMeasurement(0, Height / 2, Width / 2, Height / 2, Width / 5, Height / 4, Width / 3, Height / 3);
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 5, Height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 5, Height / 4).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 5, Height / 4).Release().Build().Perform();
                }
                viewer.PerformTool(Width / 5, Height / 4, Width / 6, Height / 3, isEdit: true);
                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, 0, Height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, 0, Height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, 0, Height / 2).Release().Build().Perform();
                }
                viewer.PerformTool(0, Height / 2, Width / 4, Height / 2 + Height / 4);

                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2 + Height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2 + Height / 4).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 4, Height / 2 + Height / 4).Release().Build().Perform();
                }
                viewer.PerformTool(Width / 4, Height / 2 + Height / 4, Width / 4, Height / 2, isEdit: true);

                if (BasePage.SBrowserName.ToLower().Contains("firefox"))
                {
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(ele, Width / 4, Height / 2).Release().Perform();
                }
                else
                {
                    new Actions(BasePage.Driver).MoveToElement(ele, Width / 4, Height / 2).Release().Build().Perform();
                }
                viewer.PerformTool((Width / 4 + Width / 6), Height / 2, Width / 2, Height / 2, isEdit: true);
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise, isOpenToolsPOPup: false);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step9 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                bool step9_1 = ThumbnailModality[0].GetAttribute("innerHTML").Equals("PR");

                viewer.CloseBluRingViewer();
                studies.SelectStudy("Accession", accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();

                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                Height = ele.Size.Height;
                Width = ele.Size.Width;
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectInnerViewerTool(BluRingTools.Transischial_Measurement, BluRingTools.Line_Measurement, false);
                viewer.ApplyTool_TransischialMeasurement(0, Height / 2, Width / 2, Height / 2, Width / 5, Height / 4, Width / 3, Height / 3);
                viewer.DeleteAnnotation(0, Height / 2);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step9_2 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                viewer.OpenViewerToolsPOPUp(Width / 2 - Width / 3, Height / 2 + Height / 3);
                viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false);
                viewer.ApplyTool_DrawEllipse((Width / 2), Height / 4, (Width / 4) * 3, Height / 2);
                viewer.OpenViewerToolsPOPUp(Width / 2 + Width / 3, Height / 2 + Height / 3);
                viewer.SelectInnerViewerTool(BluRingTools.Cobb_Angle, BluRingTools.Angle_Measurement, false);
                viewer.ApplyTool_CobbAngle(Width / 4, (Height / 4) * 3, (Width / 4) * 3, ((Height / 4) * 3) + 50);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step9_3 = studies.CompareImage(result.steps[ExecutedSteps], ele);

                viewer.OpenViewerToolsPOPUp(Width / 2 - Width / 3, Height / 2 + Height / 3);
                viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text, isOpenToolsPOPup: false);
                ThumbnailModality = BasePage.Driver.FindElements(By.CssSelector(BluRingViewer.div_thumbnailModality));
                bool step9_4 = ThumbnailModality[0].GetAttribute("innerHTML").Equals("PR");
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: accession[1], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                ele = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                ele.SendKeys(OpenQA.Selenium.Keys.ArrowDown);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step10 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step9 && step9_1 && step9_2 && step9_3 && step9_4 && step10)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //step11  Change viewer layout.
                ele.SendKeys(OpenQA.Selenium.Keys.ArrowUp);
                viewer.ChangeViewerLayout("3x2");
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step11 = studies.CompareImage(result.steps[ExecutedSteps], ele);
                if (step11)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;
            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA1 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA1 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", accession[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }

        }

        // <summary>  
        /// Apply Joint Lines Measurement to studies
        /// </summary>  
        /// <param name="testid"></param>  
        /// <param name="teststeps"></param>  
        /// <param name="stepcount"></param>  
        /// <returns></returns>  
        public TestCaseResult Test_168026(String testid, String teststeps, int stepcount)
        {
            //Declare and initialize variables                
            TestCaseResult result = null;
            int ExecutedSteps = -1;
            String adminUserName = Config.adminUserName;
            String adminPassword = Config.adminPassword;
            String[] Accession = null;

            try
            {
                result = new TestCaseResult(stepcount);
                result.SetTestStepDescription(teststeps);
                String AccessionList = (String)ReadExcel.GetTestData(filepath, "TestData", testid, "AccessionIDList");
                Accession = AccessionList.Split(':');

                //Precondtion:
                login.LoginIConnect(adminUserName, adminPassword);
                var domain = (DomainManagement)login.Navigate("DomainManagement");
                domain.SearchDomain(Config.adminGroupName);
                domain.SelectDomain(Config.adminGroupName);
                domain.ClickEditDomain();
                var precond = login.GetConfiguredToolsInToolBoxConfig();
                if (!(precond.Contains(BluRingViewer.GetToolName(BluRingTools.Save_Series))))
                {
                    IWebElement group1 = BasePage.Driver.FindElement(By.CssSelector(BasePage.div_toolBoxConfiguration_Groups + ":nth-of-type(11)"));
                    var dictionary = new Dictionary<String, IWebElement>();
                    dictionary.Add(BluRingViewer.GetToolName(BluRingTools.Save_Series), group1);
                    domain.AddToolsToToolbox(dictionary);
                    Logger.Instance.InfoLog("Save Series is configured in the Floating ToolBox");
                }
                domain.ClickSaveEditDomain();

                // Step 1 - Objective - To verify Joint Lines functionality in the new viewer - This tool draws two Lines at an angle and a third Lines perpendicular to the last Lines drawn.
                //Preconditions:
                //ICA configured.
                //Universal Viewer enabled.
                //Joint Lines are configured in the toolbox.
                ExecutedSteps++;

                //Step 2 -  Login to Webacess.                
                //Load a study in the Universal Viewer.
                var studies = (Studies)login.Navigate("Studies");
                studies.SearchStudy(AccessionNo: Accession[0], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[0]);
                var viewer = BluRingViewer.LaunchBluRingViewer();

                //1.Select Joint Lines Measurement tool from floating toolbar.
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                var element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                int width = element.Size.Width;
                int height = element.Size.Height;

                //2.Start at a point and click in two different locations to form an angle
                viewer.ApplyTool_JointLines(0, height / 4, width / 3, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step2_1 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //3.Manipulate the angle: Using the left mouse button press-and hold
                //a.On any of the three initial points and -drag to rotate, stretch, shorten the Lines.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, 0, height / 4).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                }
                viewer.PerformTool(0, height / 4, width / 4, 0);
                viewer.PerformTool(width / 4, 0, width / 4, height / 8, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step2_2 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //b.Select the end points of the perpendicular Lines drag and rotate the end points.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                }
                viewer.PerformTool(width / 6, height / 2, width / 4, height / 2);
                viewer.PerformTool(width / 4, height / 2, width / 6, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step2_3 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //c.Select the middle of perpendicular Lines and move it left/ right.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, (height / 2 + height / 5)).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                }
                viewer.PerformTool(width / 6, (height / 2 + height / 5), width / 9, (height / 2 + height / 5), isEdit: true);

                //d.Select anywhere on the Lines(not on the perpendicular Lines) and move the whole angle including the perpendicular Lines
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 8, height / 2).Release().Build().Perform();
                else
                {
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                }
                viewer.PerformTool(width / 8, height / 2, width / 6, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step2_4 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //e.Rotate the image and observe the joint Lines.
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step2_5 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step2_1 && step2_2 && step2_3 && step2_4 && step2_5)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 3 - Save the Series using Save series toolbox option.	                                
                var step3 = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text);
                if (step3)
                    result.steps[++ExecutedSteps].StepPass();
                else
                {
                    result.steps[++ExecutedSteps].StepFail();
                }

                // Step 4 - Close the study and reopen the same study in the Universal viewer	
                viewer.CloseBluRingViewer();
                studies.SelectStudy("Accession", Accession[0]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = element.Size.Width;
                height = element.Size.Height;

                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                if (studies.CompareImage(result.steps[ExecutedSteps], element))
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 5 - Create another Joint Lines angle.
                //Right click on anywhere on the joint Lines.
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                viewer.ApplyTool_JointLines(0, height / 8, width / 3, height / 5);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step5_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.DeleteAnnotation(0, height / 5);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step5_2 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step5_1 && step5_2)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 6 - Apply other available mixed annotation tools (i.e. Circle, Ellipse Lines , cob angle etc.) along with Joint Lines.
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                    viewer.SelectViewerTool(BluRingTools.Draw_Ellipse, isOpenToolsPOPup: false);
                }
                else
                {
                    viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                }
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1);
                bool step6_1 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step6_1)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                // Step 7 and step 8 - Repeat test with other modalities and change layout.
                viewer.CloseBluRingViewer();
                studies.SearchStudy(AccessionNo: Accession[1], Datasource: login.GetHostName(Config.EA1));
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                viewer.ChangeViewerLayout("1x2");
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = element.Size.Width;
                height = element.Size.Height;

                //Start at a point and click in two different locations to form an angle
                viewer.ApplyTool_JointLines(0, height / 4, width / 3, height / 2);
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 1);
                bool step8_1 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //Manipulate the angle: Using the left mouse button press-and hold
                //a.On any of the three initial points and -drag to rotate, stretch, shorten the Lines.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, 0, height / 4).Release().Build().Perform();
                else
                    new TestCompleteAction().MoveToElement(element, 0, height / 4).Release().Perform();
                viewer.PerformTool(0, height / 4, width / 4, 0);
                viewer.PerformTool(width / 4, 0, width / 4, height / 8, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 2);
                bool step8_2 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //b.Select the end points of the perpendicular Lines drag and rotate the end points.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, height / 2).Release().Build().Perform();
                else
                    new TestCompleteAction().MoveToElement(element, width / 6, height / 2).Release().Perform();
                viewer.PerformTool(width / 6, height / 2, width / 4, height / 2);
                viewer.PerformTool(width / 4, height / 2, width / 6, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 3);
                bool step8_3 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //c.Select the middle of perpendicular Lines and move it left/ right.
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Build().Perform();
                else
                    new TestCompleteAction().MoveToElement(element, width / 6, (height / 2 + height / 10)).Release().Perform();
                viewer.PerformTool(width / 6, (height / 2 + height / 5), width / 9, (height / 2 + height / 5), isEdit: true);

                //d.Select anywhere on the Lines(not on the perpendicular Lines) and move the whole angle including the perpendicular Lines
                if (!((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                    new Actions(BasePage.Driver).MoveToElement(element, width / 8, height / 2).Release().Build().Perform();
                else
                    new TestCompleteAction().MoveToElement(element, width / 8, height / 2).Release().Perform();
                viewer.PerformTool(width / 8, height / 2, width / 6, height / 2, isEdit: true);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 4);
                bool step8_4 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //e.Rotate the image and observe the joint Lines.
                viewer.SelectViewerTool(BluRingTools.Rotate_Clockwise);
                Thread.Sleep(1000);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 5);
                bool step8_5 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //Save the Series using Save series toolbox option.	                                
                bool step8_6 = viewer.SavePresentationState(BluRingTools.Save_Series, BluRingTools.Add_Text);

                // Step Close the study and reopen the same study in the Universal viewer	
                viewer.CloseBluRingViewer();
                studies.SelectStudy("Accession", Accession[1]);
                viewer = BluRingViewer.LaunchBluRingViewer();
                element = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                width = element.Size.Width;
                height = element.Size.Height;

                // Step 5 - Create another Joint Lines angle.
                //Right click on anywhere on the joint Lines.
                viewer.SelectInnerViewerTool(BluRingTools.Joint_Line_Measurement, BluRingTools.Angle_Measurement);
                viewer.ApplyTool_JointLines(0, height / 8, width / 3, height / 5);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 6);
                bool step8_7 = studies.CompareImage(result.steps[ExecutedSteps], element);
                viewer.DeleteAnnotation(0, height / 5);
                result.steps[ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 7);
                bool step8_8 = studies.CompareImage(result.steps[ExecutedSteps], element);

                //Apply other available mixed annotation tools (i.e. Circle, Ellipse Lines , cob angle etc.) along with Joint Lines.
                if (((RemoteWebDriver)BasePage.Driver).Capabilities.BrowserName.ToLower().Contains("firefox"))
                {
                    var viewport = BasePage.Driver.FindElement(By.CssSelector(viewer.Activeviewport));
                    new TestCompleteAction().ContextClick(viewport).Perform();
                }
                viewer.SelectViewerTool(BluRingTools.Draw_Ellipse);
                viewer.ApplyTool_DrawEllipse();
                result.steps[++ExecutedSteps].SetPath(testid, ExecutedSteps + 1, 8);
                bool step8_9 = studies.CompareImage(result.steps[ExecutedSteps], element);
                if (step8_1 && step8_2 && step8_3 && step8_4 && step8_5 && step8_6 && step8_7 && step8_8 && step8_9)
                    result.steps[ExecutedSteps].StepPass();
                else
                    result.steps[ExecutedSteps].StepFail();

                //Return Result  
                result.FinalResult(ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);
                return result;

            }
            catch (Exception e)
            {
                //Log Exception  
                Logger.Instance.ErrorLog(e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);

                //Report Result  
                result.FinalResult(e, ExecutedSteps);
                Logger.Instance.InfoLog("Overall Test status--" + result.status);

                //Return Result  
                return result;
            }
            finally
            {
                try
                {
                    HPLogin hplogin = new HPLogin();
                    BasePage.Driver.Navigate().GoToUrl("https://" + Config.EA1 + "/webadmin");
                    HPHomePage hphome = (HPHomePage)hplogin.LoginHPen(Config.hpUserName, Config.hpPassword, EA_URL: "https://" + Config.EA1 + "/webadmin");
                    WorkFlow workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", Accession[0]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);

                    workflow = (WorkFlow)hphome.Navigate("Workflow");
                    workflow.NavigateToLink("Workflow", "Archive Search");
                    workflow.HPSearchStudy("Accessionno", Accession[1]);
                    if (BasePage.Driver.FindElements(By.CssSelector("#tabrow>tbody tr")).Count > 0)
                        workflow.DeleteSpecificModality("PR", true);
                    hplogin.LogoutHPen();
                }
                catch (Exception e)
                {
                    Logger.Instance.ErrorLog("PR delete exception -- " + e.Message + Environment.NewLine + e.StackTrace + Environment.NewLine + e.InnerException);
                }
            }
        }
    }
}
